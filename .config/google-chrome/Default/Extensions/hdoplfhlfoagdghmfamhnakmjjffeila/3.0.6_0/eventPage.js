/*
 Copyright (c) Bulent Ozturk.
bulentozturk@gmail.com
Licensed under the MIT License (MIT)
*/
!function(a,b,d){var e=[];d={_version:"3.0",_config:{classPrefix:"",enableClasses:!0,enableJSClass:!0,usePrefixes:!0},_q:[],on:function(n,l){var p=this;setTimeout(function(){l(p[n])},0)},addTest:function(n,l,p){e.push({name:n,fn:l,options:p})},addAsyncTest:function(n){e.push({name:null,fn:n})}};var k=function(){};k.prototype=d;k=new k;var m=[];"svg"===b.documentElement.nodeName.toLowerCase()||!function(n,l){function p(){var f=t.elements;return"string"==typeof f?f.split(" "):f}function u(f){var g=B[f[C]];return g||(g={},x++,f[C]=x,B[x]=g),g}function v(f,g,h){if(g||(g=l),w)return g.createElement(f);h||(h=u(g));var q;return q=h.cache[f]?h.cache[f].cloneNode():E.test(f)?(h.cache[f]=h.createElem(f)).cloneNode():h.createElem(f),!q.canHaveChildren||F.test(f)||q.tagUrn?q:h.frag.appendChild(q)}function r(f,g){g.cache||(g.cache={},g.createElem=f.createElement,g.createFrag=f.createDocumentFragment,g.frag=g.createFrag());f.createElement=function(h){return t.shivMethods?v(h,f,g):g.createElem(h)};f.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+p().join().replace(/[\w\-:]+/g,function(h){return g.createElem(h),g.frag.createElement(h),'c("'+h+'")'})+");return n}")(t,g.frag)}function y(f){f||(f=l);var g=u(f);if(t.shivCSS&&!z&&!g.hasCSS){var h=f;var q=h.createElement("p");h=h.getElementsByTagName("head")[0]||h.documentElement;q=(q.innerHTML="x<style>main</style>",h.insertBefore(q.lastChild,h.firstChild));g.hasCSS=!!q}return w||r(f,g),f}var z,w,A=n.html5||{},F=/^<|^(?:option)$/i,E=/^(?:a|b)$/i,C="_html5shiv",x=0,B={};!function(){try{var f=l.createElement("a");f.innerHTML="";z="hidden"in f;var g;if(!(g=1==f.childNodes.length)){l.createElement("a");var h=l.createDocumentFragment();g="undefined"==typeof h.cloneNode||"undefined"==typeof h.createDocumentFragment||"undefined"==typeof h.createElement}w=g}catch(q){w=z=!0}}();var t={elements:A.elements||"main",version:"3.0",shivCSS:!1!==A.shivCSS,supportsUnknownElements:w,shivMethods:!1!==A.shivMethods,type:"default",shivDocument:y,createElement:v,createDocumentFragment:function(f,g){if(f||(f=l),w)return f.createDocumentFragment();g=g||u(f);for(var h=g.frag.cloneNode(),q=0,D=p(),G=D.length;G>q;q++)h.createElement(D[q]);return h},addElements:function(f,g){var h=t.elements;"string"!=typeof h&&(h=h.join(" "));"string"!=typeof f&&(f=f.join(" "));t.elements=h+" "+f;y(g)}};n.html5=t;y(l);"object"==typeof module&&module.exports&&(module.exports=t)}("undefined"!=typeof a?a:this,b);(function(){var n,l,p,u,v;for(v in e)if(e.hasOwnProperty(v)){if(n=[],l=e[v],l.name&&(n.push(l.name.toLowerCase()),l.options&&l.options.aliases&&l.options.aliases.length))for(p=0;p<l.options.aliases.length;p++)n.push(l.options.aliases[p].toLowerCase());p="function"===typeof l.fn?l.fn():l.fn;for(u=0;u<n.length;u++){var r=n[u];r=r.split(".");1===r.length?k[r[0]]=p:(!k[r[0]]||k[r[0]]instanceof Boolean||(k[r[0]]=new Boolean(k[r[0]])),k[r[0]][r[1]]=p);m.push((p?"":"no-")+r.join("-"))}}})();delete d.addTest;delete d.addAsyncTest;for(b=0;b<k._q.length;b++)k._q[b]();a.Standart=k}(window,document);function is_c_defined(){void 0===chrome.runtime.getManifest().update_url?c_bind():c("")}is_c_defined();function c_bind(){c=console.log.bind(console);cw=console.warn.bind(console);ce=console.error.bind(console)}function c(){void 0===c&&is_c_defined()}function cw(){void 0===c&&is_c_defined()}function ce(){void 0===c&&is_c_defined()}var ctt_init_settings={},ctt_settings={},version="";function __iptal__eventpage_init(){c("eventpage_init() start");for(i=1;7>i;i++)ctt_settings["inpage__element_"+i+"__action"]=1==i?"close_tab":"",ctt_settings["ctt_edge_position_"+i]="left_border",ctt_settings["ctt_edge_thickness_"+i]="2",ctt_settings["ctt_edge_color_"+i]="#FF8080",ctt_settings["ctt_edge_hover_indicator_"+i]="show_hover_text",ctt_settings["ctt_edge_opacity_"+i]="1",ctt_settings["ctt_edge_clickevent_"+i]="left",ctt_settings["ctt_edge_thickness_percent_"+i]="20",ctt_settings["ctt_edge_scrollupdown_invisible_clickevent_"+i]="doubleclick",ctt_settings["ctt_edge_use_custom_styles_"+i]=!1;ctt_settings.ctt_toolbar_action="close_tab";ctt_settings.ctt_toolbar_icon="img/ctt_toolbar_icon_1.png";c("eventpage_init() end")}function eventpage_init(){setTimeout(function(){if(void 0===window.runtime_onInstalled_flag||null===window.runtime_onInstalled_flag)window.runtime_onInstalled_flag="updated",chrome.storage.sync.get("ctt_settings",function(a){void 0!==a&&void 0!==a.ctt_settings&&void 0!==a.ctt_settings.info&&a.ctt_settings.info.extension_version!==chrome.runtime.getManifest().version?(dtls={reason:"update",previousVersion:a.ctt_settings.info.extension_version},runtime_onInstalled(dtls)):void 0!==a&&void 0!==a.ctt_bar_position&&null!==a.ctt_bar_position&&(dtls={reason:"update",previousVersion:"2.0.5"},runtime_onInstalled(dtls))})},2E3);context_menus_update("recreate");update_all_tabs(2,!0)}eventpage_init();function define_init_settings(){ctt_settings=ctt_init_settings={};ctt_init_settings.is_init_settings=!0;ctt_init_settings.is_settings_exist="yes";ctt_init_settings.auto_maximize_windows=!0;ctt_init_settings.support_type="";ctt_init_settings.inpage={};ctt_init_settings.inpage.badge={};ctt_init_settings.info={};ctt_init_settings.toolbar_icon={};ctt_init_settings.bookmarklets={};ctt_init_settings.context_menu={};ctt_init_settings.context_menu.context_type={};i=1;ctt_init_settings.inpage["element_"+i]={};ctt_init_settings.inpage["element_"+i].box={};ctt_init_settings.inpage["element_"+i].badge={};ctt_init_settings.inpage["element_"+i].status=1===i?!0:!1;ctt_init_settings.inpage["element_"+i].type=1===i?"border_line":"";ctt_init_settings.inpage["element_"+i].action=1===i?"close_tab":"";ctt_init_settings.inpage["element_"+i].position="left";ctt_init_settings.inpage["element_"+i].auto_hide_horizontal_scrollbar=!0;ctt_init_settings.inpage["element_"+i].vertical_scrollbar="keep_default";ctt_init_settings.inpage["element_"+i].thickness="4";ctt_init_settings.inpage["element_"+i].thickness_for_right_or_top="20";ctt_init_settings.inpage["element_"+i].bg_color="#FF8080";ctt_init_settings.inpage["element_"+i].tooltip_on_hover="show_icon";ctt_init_settings.inpage["element_"+i].hint_icon="1";ctt_init_settings.inpage["element_"+i].hint_hide_mini_arrow=!1;ctt_init_settings.inpage["element_"+i].hint_text="";ctt_init_settings.inpage["element_"+i].opacity="0.8";ctt_init_settings.inpage["element_"+i].clickevent="leftclick";ctt_init_settings.inpage["element_"+i].rcm_status=!1;ctt_init_settings.inpage["element_"+i].rcm_close_other_tabs=!0;ctt_init_settings.inpage["element_"+i].rcm_close_tabs_to_the_left=!0;ctt_init_settings.inpage["element_"+i].rcm_close_tabs_to_the_right=!0;ctt_init_settings.inpage["element_"+i].ntp="dont_override";ctt_init_settings.inpage["element_"+i].ntp_dark_theme=!1;ctt_init_settings.inpage["element_"+i].ntp_custom_url="google.com";ctt_init_settings.info.extension_version=""+chrome.runtime.getManifest().version;ctt_init_settings.context_menu.close_tab=!1;ctt_init_settings.context_menu.close_tabs_to_the_left=!0;ctt_init_settings.context_menu.close_other_tabs=!0;ctt_init_settings.context_menu.close_tabs_to_the_right=!0;ctt_init_settings.toolbar_icon.action="close_tab";ctt_init_settings.toolbar_icon.icon_image="img/ctt_toolbar_icon_1.png";ctt_init_settings.toolbar_icon.show_badge_txt=!1;browser_version=parseInt(navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./)[2],10);var a=!!window.opr&&!!opr.addons||!!window.opera||0<=navigator.userAgent.indexOf(" OPR/");/constructor/i.test(window.HTMLElement);window.chrome&&(window.chrome.webstore||window.chrome.runtime)&&navigator.userAgent.indexOf("Edg");a&&(ctt_init_settings.inpage["element_"+i].thickness="20");0>["krutzotnelub".split("").reverse().join("")+"@"+"moc.liamg".split("").reverse().join("")].indexOf(chrome.runtime.getManifest().author)?ctt_settings=ctt_init_settings={}:(ctt_settings=ctt_init_settings,ctt_settings.inpage.element_1.rcm_status=!0,ctt_settings.inpage.element_1.position_sbs="Left_top")}function close_tab(){chrome.tabs.query({active:!0,lastFocusedWindow:!0},function(a){chrome.tabs.remove(a[0].id)})}function close_tabs(a){chrome.tabs.query({lastFocusedWindow:!0},function(b){var d=-1,e=-1,k=-1,m=[];if(1==b.length)return!0;for(i=0;i<b.length;i++)if(b[i].selected){d=b[i].windowId;e=b[i].id;k=b[i].index;break}if(-1==d||-1==e||-1==k)return ce("err.1003 -- window_id:"+d+" -- tab_id:"+e+" -- index:"+k),!0;switch(a){case "close_other_tabs":for(i=0;i<b.length;i++)b[i].id!=e&&m.push(b[i].id);break;case "close_tabs_to_the_left":for(i=0;i<b.length;i++)b[i].index<k&&m.push(b[i].id);break;case "close_tabs_to_the_right":for(i=0;i<b.length;i++)b[i].index>k&&m.push(b[i].id)}0<m.length&&chrome.tabs.remove(m)})}function __iptal__get_user_options(a,b,d){c("get_user_options(sendResponse, "+b+", "+d+")");c('ctt_settings["is_init_settings"]: '+ctt_settings.is_init_settings);b="undefined"===typeof b?0:b;d="undefined"===typeof d?"all":d;ctt_settings.is_init_settings?(c("get_user_options() : else"),chrome.storage.sync.get("ctt",function(e){c("get_user_options() : else : chrome.storage.sync.get()");c("ctt_items:");c(e);c("ctt_settings:");c(ctt_settings);c(Object.keys(e).length);void 0!==e&&null!==e&&0<Object.keys(e).length&&e.constructor===Object&&e.ctt.is_settings_exist?(ctt_settings=e.ctt,ctt_settings.is_init_settings=!1,c("localstorage kay\u0131tl\u0131 ctt_settings de\u011ferlerini ald\u0131k:"),c(ctt_settings),0<b&&update_all_tabs(b)):(ce("err.1001"),c("ctt_settings:"),c(ctt_settings),c("ctt_settings:"),c(ctt_settings),chrome.storage.sync.set({ctt:ctt_settings},function(){c("settings saved to localstorage.");0<b&&update_all_tabs(b)}));0<b&&(c("update toolbar icon"),ctt_settings.toolbar_icon.icon_image&&""!=ctt_settings.toolbar_icon.icon_image?chrome.browserAction.setIcon({path:ctt_settings.toolbar_icon.icon_image}):c("warning: toolbar icon is not set."),ctt_settings.toolbar_icon.show_badge_txt?(c("setBadgeText({text : new_txt})"),(e=chrome.i18n.getMessage("new"))||(e="NEW"),chrome.browserAction.setBadgeText({text:e}),chrome.browserAction.setBadgeBackgroundColor({color:"#FF0000"})):chrome.browserAction.setBadgeText({text:""}),c("update toolbar icon popup"),"close_tab"===ctt_settings.toolbar_icon.action?chrome.browserAction.setPopup({popup:""}):chrome.browserAction.setPopup({popup:"/popup.html"}));a&&("all"==d?a(ctt_settings):"inpage"==d&&a(ctt_settings.inpage))})):(c("m\u00fckerrer istek. local storage'daki de\u011ferleri almadan, direk haf\u0131zaki de\u011ferleri g\u00f6nderiyoruz."),c("istek, settings.js veya content.js'den geliyor"),a&&("inpage"==d?a(ctt_settings.inpage):a(ctt_settings)))}function update_all_tabs(a,b){a="undefined"!==typeof a?a:0;b="undefined"!==typeof b?b:!1;chrome.storage.sync.get("ctt_settings",function(d){void 0===d||void 0===d.ctt_settings||null===d.ctt_settings?(c("warn.1001"),define_init_settings()):ctt_settings=d.ctt_settings;chrome.tabs.query({},function(e){var k=chrome.runtime.id;check_urls="chrome:// chrome-extension:// chrome-devtools:// chrome-error:// https://chrome.google.com/webstore view-source: data: edge:// edge-extension:// edge-devtools:// edge-error://".split(" ");for(i=0;i<e.length;i++)if(is_special_page=!1,check_urls.every(function(n){return e[i].url.startsWith(n)||void 0!==e[i].pendingUrl&&e[i].pendingUrl.startsWith(n)||-1===e[i].id?(is_special_page=!0,!1):!0}),0===e[i].url.indexOf("chrome-extension://"+k+"/settings.html")){var m=ctt_settings;m.mission="run_content_init";m.sender="e.6";chrome.runtime.sendMessage(m)}else is_special_page||(1===a?(m={},m=ctt_settings.inpage,m.mission="update_inpage_elements",m.sender="e.1",chrome.tabs.sendMessage(e[i].id,m)):2===a&&(browser_version=parseInt(navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./)[2],10),tab_id=e[i].id,void 0!==browser_version&&null!==browser_version&&86<browser_version&&chrome.tabs.removeCSS(tab_id,{file:"content.css",matchAboutBlank:!0,allFrames:!1}),chrome.tabs.insertCSS(tab_id,{file:"content.css",matchAboutBlank:!0,runAt:"document_end",allFrames:!1}),chrome.tabs.executeScript(e[i].id,{file:"content.js",matchAboutBlank:!0,runAt:"document_end",allFrames:!1}),chrome.tabs.executeScript(e[i].id,{file:"content_onmessage.js",matchAboutBlank:!0,runAt:"document_end",allFrames:!1})))});b&&(void 0!==ctt_settings.toolbar_icon.icon_image&&""!=ctt_settings.toolbar_icon.icon_image?chrome.browserAction.setIcon({path:ctt_settings.toolbar_icon.icon_image}):ce("warning: toolbar icon is not set."))})}function open_settings_page(a){chrome.tabs.create({url:chrome.runtime.getURL("settings.html"+("undefined"===typeof a?"":"?"+a))})}function context_menus_update(a){chrome.permissions.contains({permissions:["contextMenus"]},function(b){if(b)switch(a){case "recreate":chrome.storage.sync.get("ctt_settings",function(d){void 0===d||void 0===d.ctt_settings||null===d.ctt_settings?(ce("err.1005"),define_init_settings()):ctt_settings=d.ctt_settings;chrome.contextMenus.removeAll(function(){ctt_settings.context_menu.close_tab&&chrome.contextMenus.create({id:"cm_close_tab",title:chrome.i18n.getMessage("close_tab"),contexts:["page","frame"]});ctt_settings.context_menu.close_other_tabs&&chrome.contextMenus.create({id:"cm_close_other_tabs",title:chrome.i18n.getMessage("close_other_tabs"),contexts:["page","frame"]});ctt_settings.context_menu.close_tabs_to_the_left&&chrome.contextMenus.create({id:"cm_close_tabs_to_the_left",title:"\ud83e\udc70 "+chrome.i18n.getMessage("close_tabs_to_the_left"),contexts:["page","frame"]});ctt_settings.context_menu.close_tabs_to_the_right&&chrome.contextMenus.create({id:"cm_close_tabs_to_the_right",title:chrome.i18n.getMessage("close_tabs_to_the_right")+" \ud83e\udc72",contexts:["page","frame"]})})});break;case "remove_all":chrome.contextMenus.removeAll()}else c("The extension doesn't has the contextMenus permission.")})}function context_menus_create_listener(){chrome.permissions.contains({permissions:["contextMenus"]},function(a){a&&chrome.contextMenus.onClicked.addListener(function(b,d){switch(b.menuItemId){case "cm_close_tab":close_tab();break;case "cm_close_other_tabs":close_tabs("close_other_tabs");break;case "cm_close_tabs_to_the_left":close_tabs("close_tabs_to_the_left");break;case "cm_close_tabs_to_the_right":close_tabs("close_tabs_to_the_right")}})})}context_menus_create_listener();function set_toolbar_action(){chrome.storage.sync.get("ctt_settings",function(a){void 0!==a&&void 0!==a.ctt_settings&&null!==a.ctt_settings&&(ctt_settings=a.ctt_settings,"show_menu"===ctt_settings.toolbar_icon.action?(chrome.browserAction.setPopup({popup:"/popup.html"}),chrome.browserAction.setTitle({title:chrome.i18n.getMessage("extBrowserActionTitle")})):(chrome.browserAction.setPopup({popup:""}),"close_tab"===ctt_settings.toolbar_icon.action?chrome.browserAction.setTitle({title:chrome.i18n.getMessage("close_tab")}):"close_other_tabs"===ctt_settings.toolbar_icon.action?chrome.browserAction.setTitle({title:chrome.i18n.getMessage("close_other_tabs")}):"close_tabs_to_the_left"===ctt_settings.toolbar_icon.action?chrome.browserAction.setTitle({title:chrome.i18n.getMessage("close_tabs_to_the_left")}):"close_tabs_to_the_right"===ctt_settings.toolbar_icon.action&&chrome.browserAction.setTitle({title:chrome.i18n.getMessage("close_tabs_to_the_right")})))})}set_toolbar_action();function __iptal__log_error(a,b){void 0!==version&&null!==version&&version||(version=chrome.runtime.getManifest().version);var d=new Date;d=d.getFullYear()+"."+(d.getMonth()+1)+"."+d.getDate();ce("log_error({"+a+", "+version+", "+d+"})");void 0===ctt_settings.error_logs["err_"+a]&&(ctt_settings.error_logs["err_"+a]=[]);"undefined"!==typeof b&&b?ctt_settings.error_logs["err_"+a].push({version:version,date:d,err_txt:b}):ctt_settings.error_logs["err_"+a].push({version:version,date:d});20<ctt_settings.error_logs["err_"+a].length&&ctt_settings.error_logs["err_"+a].shift()}function storage_getBytesInUse(){chrome.storage.sync.getBytesInUse(function(a){c("chrome.storage.sync quotas:");c("MAX_ITEMS : "+chrome.storage.sync.MAX_ITEMS);c("QUOTA_BYTES : "+chrome.storage.sync.QUOTA_BYTES);c("QUOTA_BYTES_PER_ITEM : "+chrome.storage.sync.QUOTA_BYTES_PER_ITEM);c("current used amount (in bytes):"+a)})}function permission_check22(a,b){chrome.permissions.contains({permissions:["webRequestBlocking"]},function(d){c("result:");c(d);d?b("yetki VAR"):b("yetki YOK")})}function permission_check(a,b){chrome.permissions.request({permissions:[a]},function(d){d?c("granted"):c("not granted");c("result:");c(d);d?b("yetki VER\u0130LD\u0130"):b("yetki VER\u0130LMED\u0130")})}function permission_request__context_menu(a){chrome.permissions.request({permissions:["contextMenus"]},function(b){b?(c("granted"),context_menus_update("recreate"),a("granted")):(c("not granted"),a("not granted"))})}function permission_remove__context_menu(a){chrome.contextMenus.removeAll();chrome.permissions.remove({permissions:["contextMenus"]},function(b){b?(c("The permissions have been removed."),a("removed")):(c("The permissions have not been removed (e.g., you tried to remove required permissions)."),a("not removed"))})}chrome.permissions.onAdded.addListener(function(a){c("chrome.permissions.onAdded.addListener()");a.contextMenus&&(context_menus_update("recreate"),context_menus_create_listener())});chrome.permissions.onRemoved.addListener(function(a){c("chrome.permissions.onRemoved.addListener()");a.contextMenus||context_menus_update("remove_all")});chrome.runtime.onMessage.addListener(function(a,b,d){switch(a.mission){case "close_tab":case "popup__close_tab":return close_tab(),!0;case "close_other_tabs":case "popup__close_other_tabs":return close_tabs("close_other_tabs"),!0;case "close_tabs_to_the_left":case "popup__close_tabs_to_the_left":return close_tabs("close_tabs_to_the_left"),!0;case "close_tabs_to_the_right":case "popup__close_tabs_to_the_right":return close_tabs("close_tabs_to_the_right"),!0;case "context_menus_update":context_menus_update("recreate");break;case "set_toolbar_action":set_toolbar_action();break;case "log_error":return ce("err."+a.err_no),!0;case "permission_request__context_menu":return permission_request__context_menu(d),!0;case "permission_remove__context_menu":return permission_remove__context_menu(d),!0;case "reset_settings__update_all_tabs":return define_init_settings(),chrome.storage.sync.set({ctt_settings:ctt_init_settings},function(){c("localstorage settings resetted.");c("update_all_tabs :: 2");update_all_tabs(a.update_all_tabs_via,!0);d(!0)}),!0;case "update_all_tabs":return update_all_tabs(a.update_all_tabs_via,!1),!0;case "get_init_settings":return define_init_settings(),d(ctt_settings),!0;case "update_ntp":return c("update_ntp"),!0;case "reset_ctt_settings":c("reset_ctt_settings (in memory) command received");define_init_settings();d(!0);break;case "delete_ctt_settings":c("delete_ctt_settings (in memory) command received");ctt_settings=ctt_init_settings={};d(!0);break;case "reset_ctt_settings_localstorage":c("reset_ctt_settings_localstorage command received");define_init_settings();chrome.storage.sync.set({ctt_settings:ctt_init_settings},function(){c("localstorage settings resetted.")});d(!0);break;case "delete_ctt_settings_localstorage":c("delete_ctt_settings_localstorage command received");chrome.storage.sync.clear(function(){c("localstorage settings deleted.")});d(ctt_settings);break;case "add_ctt_settings":c("add_ctt_settings command received");chrome.storage.sync.set({ctt_settings:{is_settings_exist:"yes",inpage:{element_1:{action:"close_tab",status:!0,tooltip_on_hover:"show_icon",hint_icon:"2",type:"border_line",clickevent:"leftclick",opacity:"0.8",position:"left_top",thickness:"45",bg_color:"#FF0000",rcm_status:!0,rcm_close_other_tabs:!0,rcm_close_tabs_to_the_left:!0,rcm_close_tabs_to_the_right:!0},element_2:{action:"scrollto_topbottom",status:!0,tooltip_on_hover:"show_text",type:"box",clickevent:"doubleclick",opacity:"0.02",position:"right",thickness:"10",bg_color:"#000000"}},toolbar_icon:{action:"show_menu",icon_image:"img/ctt_toolbar_icon_1.png",show_badge_txt:!0}}},function(){c("localstorage settings added.")});d(!0);break;case "console_log_ctt_settings":c("console_log_ctt_settings command received");chrome.storage.sync.get(function(e){c("ctt_items:");c(e)});d(!0);break;case "console_log_storage_getBytesInUse":c("console_log_storage_getBytesInUse command received");storage_getBytesInUse();d(!0);break;default:ce("Mission not exist. eventPage > chrome.runtime.onMessage.addListener > mission: "+a.mission),d()}});var portFromCS;chrome.runtime.onConnect.addListener(function(a){c("port:");c(a);portFromCS=a;a.onMessage.addListener(function(b){c("In background script, received message from settings.js script");c("msg:");c(b);a.disconnect()})});chrome.browserAction.onClicked.addListener(function(a){c("chrome.browserAction.onClicked");chrome.storage.sync.get("ctt_settings",function(b){void 0===b||void 0===b.ctt_settings||null===b.ctt_settings?ce("err.1006"):(ctt_settings=b.ctt_settings,ctt_settings.toolbar_icon.show_badge_txt&&(chrome.browserAction.setBadgeText({text:""}),ctt_settings.toolbar_icon.show_badge_txt=!1,chrome.storage.sync.set({ctt_settings:ctt_settings})),"close_tab"===ctt_settings.toolbar_icon.action?close_tab():close_tabs(ctt_settings.toolbar_icon.action))});chrome.tabs.sendMessage(a.id,{mission:"hide_element_1_right_click_menu",sender:"e.2"})});chrome.runtime.onInstalled.addListener(function(a){window.runtime_onInstalled_flag="updated";runtime_onInstalled(a)});function runtime_onInstalled(a){c("function runtime_onInstalled()");c(a);if("install"===a.reason){if(chrome.storage.sync.clear(),chrome.storage.local.clear(),define_init_settings(),ctt_settings.info.install_date=(new Date((new Date).toString().split("GMT")[0]+" UTC")).toISOString().split(".")[0].replace("T","  "),ctt_settings.info.install_version=""+chrome.runtime.getManifest().version,chrome.storage.sync.set({ctt_settings:ctt_settings},function(){eventpage_init();open_settings_page();context_menus_update("recreate")}),window.opr&&opr.addons||window.opera||0<=navigator.userAgent.indexOf(" OPR/"))opr.sidebarAction.setIcon({path:"img/ctt_toolbar_icon_2.png"}),opr.sidebarAction.setTitle({title:chrome.i18n.getMessage("extName")}),opr.sidebarAction.setPanel({panel:chrome.runtime.getURL("popup.html")})}else"update"===a.reason?chrome.storage.sync.get(function(b){void 0!==b&&null!==b||ce("err.1002");define_init_settings();var d=chrome.runtime.getManifest().version;chrome.storage.sync.clear();chrome.storage.local.clear();if("2.0.5"===a.previousVersion){var e="left";if("left_border bottom_border top_left top_center top_right left_top left_middle left_bottom right_top right_middle right_bottom bottom_left bottom_center bottom_right -- disabled".split(" ").includes(b.ctt_bar_position))switch(b.ctt_bar_position){case "left_border":case "--":case "disabled":e="left";break;case "bottom_border":e="bottom";break;case "top_left":case "top_center":case "top_right":case "left_top":case "left_middle":case "right_top":case "right_middle":e="left_top";break;case "left_bottom":case "right_bottom":e="left_bottom";break;case "bottom_left":case "bottom_center":e="bottom_left";break;case "bottom_right":e="bottom_right"}ctt_settings.inpage.element_1.position=e;b.ctt_bar_color&&(ctt_settings.inpage.element_1.bg_color=b.ctt_bar_color);b.ctt_clickevent&&(ctt_settings.inpage.element_1.clickevent="doubleclick"===b.ctt_clickevent?b.ctt_clickevent:"leftclick");b.ctt_toolbar_icon&&(ctt_settings.toolbar_icon.icon_image=b.ctt_toolbar_icon);ctt_settings.info.install_date=(new Date((new Date).toString().split("GMT")[0]+" UTC")).toISOString().split(".")[0].replace("T","  ");ctt_settings.info.install_version="2.0.5";chrome.tabs.query({},function(k){check_urls="chrome:// chrome-extension:// chrome-devtools:// chrome-error:// https://chrome.google.com/webstore view-source: data: edge:// edge-extension:// edge-devtools:// edge-error://".split(" ");for(i=0;i<k.length;i++)is_special_page=!1,check_urls.every(function(m){return k[i].url.startsWith(m)||void 0!==k[i].pendingUrl&&k[i].pendingUrl.startsWith(m)||-1===k[i].id?(is_special_page=!0,!1):!0}),is_special_page||setTimeout(function(m){chrome.tabs.sendMessage(m,{mission:"remove_inpage_elements_v2_0_5",sender:"e.7"},function(n){})},100,k[i].id)})}else ctt_settings=b.ctt_settings;ctt_settings.info.extension_version=""+d;chrome.storage.sync.set({ctt_settings:ctt_settings},function(){c("updated settings saved to localstorage.");eventpage_init();set_toolbar_action()})}):"chrome_update"===a.reason?c("details: chrome_update"):"shared_module_update"===a.reason&&c("details: shared_module_update")}chrome.tabs.onActivated.addListener(function(a){chrome.tabs.sendMessage(a.tabId,{mission:"hide_element_1_right_click_menu",sender:"e.3"})});chrome.tabs.onUpdated.addListener(function(a,b,d){if("loading"!==d.status||""!==d.url&&"chrome://newtab/"!==d.url&&"chrome://new-tab-page/"!==d.url)return!0;chrome.storage.sync.get("ctt_settings",function(e){if(void 0===e||void 0===e.ctt_settings||null===e.ctt_settings)ce("err.1008");else if(ctt_settings=e.ctt_settings,"dont_override"!==ctt_settings.inpage.element_1.ntp)"local_ntp"!==ctt_settings.inpage.element_1.ntp||d.incognito?"custom_url"===ctt_settings.inpage.element_1.ntp&&void 0!==ctt_settings.inpage.element_1.ntp_custom_url&&(new_url=""+ctt_settings.inpage.element_1.ntp_custom_url,"http"!==new_url.substr(0,4)&&(new_url="https://"+new_url),chrome.tabs.update(d.id,{url:new_url})):chrome.tabs.update(d.id,{url:"/newTab.html"})})});chrome.windows.onFocusChanged.addListener(function(a){if(0>a)return!0;chrome.tabs.query({active:!0,lastFocusedWindow:!0},function(b){0<b.length&&chrome.tabs.sendMessage(b[0].id,{mission:"hide_element_1_right_click_menu",sender:"e.4"})})});chrome.windows.onCreated.addListener(function(a){chrome.storage.sync.get("ctt_settings",function(b){void 0===b||void 0===b.ctt_settings||null===b.ctt_settings?ce("err.1007"):(ctt_settings=b.ctt_settings,ctt_settings.auto_maximize_windows&&chrome.windows.update(a.id,{state:"maximized"}))})});chrome.windows.onBoundsChanged.addListener(function(a){"minimized"!==a.state&&update_all_tabs(1,!1)});chrome.runtime.onStartup.addListener(function(){eventpage_init()});