var background=function(e){"use strict";function t(){let e=new Uint32Array(1);return crypto.getRandomValues(e),e[0]}function n(){return crypto.randomUUID()}function r(){const e=new Uint32Array(28);return crypto.getRandomValues(e),Array.from(e,(e=>("0"+e.toString(16)).slice(-2))).join("")}function o(e){try{return JSON.parse(atob(e.split(".")[1]))}catch(e){return null}}const s=[{langCode:"AR",langCodeForSpeech:"ar-AR",langCodeForIta:"ar"},{langCode:"BG",langCodeForSpeech:"bg-BG",langCodeForIta:"bg"},{langCode:"CS",langCodeForSpeech:"cs-CZ",langCodeForIta:"cs"},{langCode:"DA",langCodeForSpeech:"da-DK",langCodeForIta:"da"},{langCode:"DE",langCodeForSpeech:"de-DE",supportsFormality:!0,langCodeForIta:"de"},{langCode:"EL",langCodeForSpeech:"el-GR",langCodeForIta:"el"},{langCode:"EN-GB",langCodeForSpeech:"en",voice:"Google UK English Male",langCodeForIta:"en-GB"},{langCode:"EN-US",langCodeForSpeech:"en",voice:"Google UK English Male",langCodeForIta:"en-US"},{langCode:"ES",langCodeForSpeech:"es-ES",voice:"Google espaÃ±ol",label:"ES",supportsFormality:!0,langCodeForIta:"es"},{langCode:"ET",langCodeForSpeech:"et",langCodeForIta:"et"},{langCode:"FI",langCodeForSpeech:"fi-FI",voice:"Satu",langCodeForIta:"fi"},{langCode:"FR",langCodeForSpeech:"fr-FR",voice:"Thomas",supportsFormality:!0,langCodeForIta:"fr"},{langCode:"HU",langCodeForSpeech:"hu-HU",langCodeForIta:"hu"},{langCode:"ID",langCodeForSpeech:"id-ID",langCodeForIta:"id"},{langCode:"IT",langCodeForSpeech:"it-IT",supportsFormality:!0,langCodeForIta:"it"},{langCode:"JA",langCodeForSpeech:"ja-JP",supportsFormality:!0,langCodeForIta:"ja"},{langCode:"KO",langCodeForSpeech:"ko-KR",langCodeForIta:"ko"},{langCode:"LT",langCodeForSpeech:"lt",langCodeForIta:"lt"},{langCode:"LV",langCodeForSpeech:"lv",langCodeForIta:"lv"},{langCode:"NB",langCodeForSpeech:"nb-NO",langCodeForIta:"nb"},{langCode:"NL",langCodeForSpeech:"nl-NL",voice:"Google Nederlands",label:"NL",supportsFormality:!0,langCodeForIta:"nl"},{langCode:"PL",langCodeForSpeech:"pl-PL",supportsFormality:!0,langCodeForIta:"pl"},{langCode:"PT-BR",langCodeForSpeech:"pt-PT",supportsFormality:!0,langCodeForIta:"pt-BR"},{langCode:"PT-PT",langCodeForSpeech:"pt-PT",supportsFormality:!0,langCodeForIta:"pt-PT"},{langCode:"RO",langCodeForSpeech:"ro-RO",langCodeForIta:"ro"},{langCode:"RU",langCodeForSpeech:"ru-RU",supportsFormality:!0,langCodeForIta:"ru"},{langCode:"SK",langCodeForSpeech:"sk-SK",langCodeForIta:"sk"},{langCode:"SL",langCodeForSpeech:"sl",langCodeForIta:"sl"},{langCode:"SV",langCodeForSpeech:"sv-SE",langCodeForIta:"sv"},{langCode:"TR",langCodeForSpeech:"tr-TR",langCodeForIta:"tr"},{langCode:"UK",langCodeForSpeech:"uk-UA",langCodeForIta:"uk"},{langCode:"ZH",langCodeForSpeech:"zh-CN",langCodeForIta:"zh-Hans"},{langCode:"ZH-HANT",langCodeForSpeech:"zh-HANT",langCodeForIta:"zh-Hant"}],i=["EN-GB","EN-US","EN","DE","FR","ES","PT-PT","PT-BR","PT","IT"],a=["ES","FR","IT","PT","PT-BR","PT-PT"],c=0,l={inline:"inline",automatic:"automatic",manual:"manual",input:"input",input_alternatives:"input_alternatives"},u={notLoggedIn:1,loggedInPro:2,loggedInFree:3},d={notLoggedIn:1500,loggedInFree:5e3},p={notLoggedIn:2e3,loggedInFree:2e3},h={defaultPopup:1,fptInjectedPopup:2,inlineTooltipPopup:3,itaReviewPopup:4},f={extensionIcon:1,fptAutoInject:2},g={defaultPopup:1,injectedFptPopup:2,inlinePopup:3},m={hintKeyboardShortcut:"HINT_KEYBOARD_SHORTCUT",inputTranslation:"INPUT_TRANSLATION",inlineTranslation:"INLINE_TRANSLATION",fullPageTranslation:"FULL_PAGE_TRANSLATION",accountSuccessfullyCreated:"ACCOUNT_SUCCESSFULLY_CREATED",successfullyLoggedIn:"SUCCESSFULLY_LOGGED_IN",glidesPreventAssetLoss:"GSLIDES_WARNING_TO_AVOID_ASSET_LOSS",showAdsForMSAddins:"SHOW_ADS_FOR_MS_ADDINS"},y={inlineTranslationTriggerIcon:"INLINE_TRANSLATION_TRIGGER_ICON",inlineTranslationSettingsIcon:"INLINE_TRANSLATION_SETTINGS_ICON",inlineTranslationSettingPopup:"INLINE_TRANSLATION_SETTING_POPUP",inputTranslationTriggerIcon:"INPUT_TRANSLATION_TRIGGER_ICON",inputImproveTriggerIcon:"INPUT_IMPROVE_TRIGGER_ICON",inputTranslationSettingsIcon:"INPUT_TRANSLATION_SETTINGS_ICON",inputTranslationSettingPopup:"INPUT_TRANSLATION_SETTING_POPUP",settingsPageFPT:"SETTINGS_PAGE_FPT",settingsPageReading:"SETTINGS_PAGE_READING",settingsPageWriting:"SETTINGS_PAGE_WRITING",settingsPageIntegrations:"SETTINGS_PAGE_INTEGRATIONS",fptHideModal:"FPT_HIDE_MODAL",inputTranslationReadMoreLink:"INPUT_TRANSLATION_READ_MORE_LINK",inlineTranslationReadMoreLink:"INLINE_TRANSLATION_READ_MORE_LINK",fptTranslationReadMoreLink:"FPT_TRANSLATION_READ_MORE_LINK",extensionHubToggleSwitch:"EXTENSION_HUB_TOGGLE_SWITCH",hubCustomizeShortcut:"HUB_CUSTOMIZE_SHORTCUT",hubLoginButton:"HUB_LOGIN_BUTTON",hubUpgradeToProLink:"HUB_UPGRADE_TO_PRO_LINK",hubTryProLink:"HUB_TRY_PRO_LINK",hubTryWriteProLink:"HUB_TRY_WRITE_PRO_LINK",settingsPageCustomizeShortcutButton:"SETTINGS_PAGE_CUSTOMIZE_SHORTCUT_BUTTON",hubFPTEnableCheckbox:"HUB_FPT_ENABLE_CHECKBOX",hubFPTDisableCheckbox:"HUB_FPT_DISABLE_CHECKBOX",deeplWriteIcon:"DEEPL_WRITE_ICON",gmailOnboardingPopup:"gmailOnboardingPopup",gmailOnboardingIcon:"gmailOnboardingIcon",gmailCharLimitLogin:"gmailCharLimitLogin",gmailFeedbackSurvey:"gmailFeedbackSurvey",hubViewIntegrations:"HUB_VIEW_INTEGRATIONS",hubCloseCustomizationsWidget:"HUB_CLOSE_CUSTOMIZATIONS_WIDGET",gslidesFeedbackSurvey:"GSLIDES_FEEDBACK_SURVEY",gslidesCharLimitLogin:"GSLIDES_CHAR_LIMIT_LOGIN",zendeskTryProLink:"ZENDESK_TRY_PRO_LINK",onboardingSignUp:"ONBOARDING_SIGN_UP",onboardingSkipSignUp:"ONBOARDING_SKIP_SIGN_UP",onboardingLoginLink:"ONBOARDING_LOGIN_LINK",onboardingSeeAllIntegrations:"ONBOARDING_SEE_ALL_INTEGRATIONS",iconToggleInHubTranslator:"ICON_TOGGLE_IN_HUB_TRANSLATOR",iconToggleInHubWrite:"ICON_TOGGLE_IN_HUB_WRITE",manageIconSettings:"MANAGE_ICON_SETTINGS",writeLanguageSwitchedInHub:"WRITE_LANGUAGE_SWITCHED_IN_HUB",writeLanguageSwitchedInSettings:"WRITE_LANGUAGE_SWITCHED_IN_SETTINGS"},_={triggerTranslation:"trigger-translation",changeLanguage:"change-language"},v={clickOnShortcutNotifiction:"CLICK_ON_SHORTCUT_NOTIFICATION",clickOnInlineTranslationShowAlternatives:"CLICK_ON_INLINE_TRANSLATION_SHOW_ALTERNATIVES",clickOnInlineTranslationCloseIcon:"CLICK_ON_INLINE_TRANSLATION_CLOSE_ICON",clickOnLogoutMenuEntry:"CLICK_ON_LOGOUT_MENU_ENTRY",clickOnReviewWindowCloseAction:"CLICK_ON_REVIEW_WINDOW_CLOSE_ACTION"},S={disablePerSite:"DISABLE_PER_SITE",disableEverywhere:"DISABLE_EVERYWHERE",enableEverywhere:"ENABLE_EVERYWHERE",enablePerSite:"ENABLE_PER_SITE"},T={inputTranslation:"INPUT_TRANSLATION",inlineTranslation:"INLINE_TRANSLATION",fullPageTranslation:"FULL_PAGE_TRANSLATION",gdocs:"GDOCS"},b={top:1,right:2,bottom:3,left:4},w={openPage:"OPEN_PAGE",backButton:"BACK_BUTTON",nextButton:"NEXT_BUTTON",navigation:"NAVIGATION"},E={unspecified:0,chrome:1,edge:2,local:3,firefox:4},I={chrome:"cofdbpoegempjloogbagkncekinflcnj",edge:"fancfknaplihpclbhbpclnmmjcjanbaf",local:"ocpdpnakdghopjcifldjidbdmfobmmoi",firefox:"firefox-extension@deepl.com"},A={deepl:1,linguee:2,google_translate:3,word_365:4,power_point_365:5,jira:6,confluence:7,gmail:8},R=5,k={default:"DEFAULT",gdocs:"GDOCS",zendesk:"ZENDESK",whatsappWeb:"WHATSAPP_WEB",twitter:"TWITTER",gmail:"GMAIL",gslides:"GSLIDES",linkedIn:"LINKEDIN",youtube:"YOUTUBE"},C={translate:"translate",write:"write"},x={user:"USER",extension:"EXTENSION"},O={OPEN_TICKET:"OPEN_TICKET",DETECT_TICKET_LANGUAGE:"DETECT_TICKET_LANGUAGE",SWITCH_TICKET_LANGUAGE:"SWITCH_TICKET_LANGUAGE",ENABLE_AUTOTRANSLATE:"ENABLE_AUTOTRANSLATE",DISABLE_AUTOTRANSLATE:"DISABLE_AUTOTRANSLATE",TRANSLATE_MESSAGE:"TRANSLATE_MESSAGE",TRANSLATE_INPUT:"TRANSLATE_INPUT",ERROR:"ERROR"},L={translation:"TRANSLATION",login:"LOGIN"},N={chat:"CHAT",message:"MESSAGE"},P={TRANSLATOR:"TRANSLATOR",WRITE:"WRITE",API:"API",DOC_TRANSLATOR:"DOC_TRANSLATOR"},D={free:"free",pro:"pro",none:"none"},M={TEXT_REFINEMENT_REQUEST:"TEXT_REFINEMENT_REQUEST",GDOCS_INSERT_COPY:"GDOCS_INSERT_COPY",GDOCS_DISCARD_COPY:"GDOCS_DISCARD_COPY",GDOCS_CHAR_LIMIT_REACHED:"GDOCS_CHAR_LIMIT_REACHED",RESULT_ACCEPTED:"RESULT_ACCEPTED",RESULT_REVERTED:"RESULT_REVERTED",GET_ALTERNATIVES_FOR_INPUT:"GET_ALTERNATIVES_FOR_INPUT",ERROR:"ERROR"},U={RESULT_ACCEPTED:"RESULT_ACCEPTED",RESULT_REVERTED:"RESULT_REVERTED",ERROR:"ERROR"},$={ALTERNATIVES_OPENED:"ALTERNATIVES_OPENED",SEGMENTATION_SELECTED:"SEGMENTATION_SELECTED",ALTERNATIVE_SELECTED:"ALTERNATIVE_SELECTED"},F={READING_VIEW_TRANSLATE:"READING_VIEW_TRANSLATE",COMPOSE_VIEW_TRANSLATE:"COMPOSE_VIEW_TRANSLATE",COMPOSE_VIEW_IMPROVE:"COMPOSE_VIEW_IMPROVE"},j={ANONYMOUS_USER_LIMIT_EXCEEDED:"ANONYMOUS_USER_LIMIT_EXCEEDED",FREE_ACCOUNT_LIMIT_EXCEEDED:"FREE_ACCOUNT_LIMIT_EXCEEDED",WRITE_ANONYMOUS_USER_LIMIT_EXCEEDED:"WRITE_ANONYMOUS_USER_LIMIT_EXCEEDED",WRITE_FREE_ACCOUNT_LIMIT_EXCEEDED:"WRITE_FREE_ACCOUNT_LIMIT_EXCEEDED"},G={PRO_TRIAL:"PRO_TRIAL",LOGIN:"LOGIN",SIGNUP:"SIGNUP"},V={WORD:"word",SENTENCE:"sentence"},q={none:"None",pro:"Pro",free:"Free"},W={simple:"simple",business:"business",academic:"academic",casual:"casual",enthusiastic:"enthusiastic",friendly:"friendly",confident:"confident",diplomatic:"diplomatic"},B={chrome:"Chrome",edge:"Edge",brave:"Brave",firefox:"Firefox",opera:"Opera",safari:"Safari"};function H(e,t){let n;try{switch(e){case B.chrome:case B.brave:n=t.split("Chrome/")[1].split(" ")[0];break;case B.edge:n=t.split("Edg/")[1].split(" ")[0];break;case B.firefox:n=t.split("Firefox/")[1].split(" ")[0];break;case B.opera:n=t.split("OPR/")[1].split(" ")[0];break;case B.safari:n=t.split("Version/")[1].split(" ")[0]}}catch(t){console.error(`Could not get the browsers (${e}) version from user agent`,t)}try{!n&&navigator?.userAgentData&&function(e){return e===B.chrome||e===B.edge||e===B.brave||e===B.opera}(e)&&(n=J(e).version)}catch(t){console.error(`Could not get the chromium browsers (${e}) version`,t)}return n&&"string"==typeof n?n:"unknown_browser_version"}function J(e){if(!navigator.userAgentData||!e)return;const t=new RegExp(`${e}`,"i");return navigator.userAgentData.brands.filter((e=>t.test(e.brand)))[0]}function z(){const e=navigator?.userAgent||"unknown_user_agent",t=navigator?.userAgentData?.platform||navigator?.platform||"unknown_platform";let n="unknown_browser",r="unknown_browser_version";const o=navigator?.language||"unknown_browser_language";try{const t=e.match(/chrome|chromium|crios/i),o=e.match(/edg/i)||J(B.edge),s=e.match(/firefox|fxios/i),i=e.match(/opr\//i)||J(B.opera),a=e.match(/safari/i),c=J(B.brave);t?(n=B.chrome,o&&(n=B.edge),i&&(n=B.opera),c&&(n=B.brave)):o?n=B.edge:s?n=B.firefox:i?n=B.opera:a&&(n=B.safari),r=H(n,e)}catch(e){console.error("Could not get the name of the brower",e)}return{userAgent:e,platform:t,browser:n,browserVersion:r,browserLang:o}}function Y(){if({IS_PROD:!0,BASE_URLS:{dapApi:"https://s.deepl.com/chrome/statistics",toolingApiPro:"https://api.deepl.com/jsonrpc?client=chrome-extension,1.28.2",toolingApi:"https://www2.deepl.com/jsonrpc?client=chrome-extension,1.28.2",toolingWriteApiPro:"https://write-pro.www.deepl.com/jsonrpc?client=chrome-extension,1.28.2",toolingWriteApi:"https://write-free.www.deepl.com/jsonrpc?client=chrome-extension,1.28.2",classicApi:"https://www2.deepl.com/jsonrpc?client=chrome-extension,1.28.2",classicApiPro:"https://api.deepl.com/jsonrpc?client=chrome-extension,1.28.2",classicApiWrite:"https://write-free.www.deepl.com/jsonrpc?client=chrome-extension,1.28.2",classicApiWritePro:"https://write-pro.www.deepl.com/jsonrpc?client=chrome-extension,1.28.2",classicApiGlossary:"https://api.deepl.com/termbases/jsonrpc?client=chrome-extension,1.28.2",login:"https://www.deepl.com/auth/login",token:"https://w.deepl.com/oidc/token",logout:"https://www.deepl.com/auth/logout",feedbackSurvey:"https://deepl.typeform.com/to/MkMfP2Y6",newFeedbackSurvey:"https://deepl.qualtrics.com/jfe/form/SV_cMvbeX0WZGvkKGi",firefoxFeedbackSurvey:"https://deepl.qualtrics.com/jfe/form/SV_eyfDZqQmXuNTFOK",uninstallSurvey:"https://deepl.qualtrics.com/jfe/form/SV_eJxAD8c7J5hqSRU",gslidesFeedbackSurvey:"https://deepl.qualtrics.com/jfe/form/SV_9XBLSAbDmLq5emO",deeplPro:"https://www.deepl.com/pro",deeplProWrite:"https://www.deepl.com/pro-write",deeplTranslator:"https://www.deepl.com/translator",deeplDoctrans:"https://www.deepl.com/translator/files",deeplTermsOfServiceFree:"https://www.deepl.com/en/pro-license?tab=free",deeplCreateAccount:"https://www.deepl.com/signup",extensionStorePage:"https://bit.ly/DeepL-Chrome",supportArticle:"https://support.deepl.com/hc/articles/4407580229522",deeplSupport:"https://support.deepl.com/hc",chromeWebstore:"https://chrome.google.com/webstore/detail/deepl-translate-reading-w/cofdbpoegempjloogbagkncekinflcnj",edgeWebstore:"https://microsoftedge.microsoft.com/addons/detail/deepl-translate-reading-/fancfknaplihpclbhbpclnmmjcjanbaf",firefoxWebstore:"https://addons.mozilla.org/en-US/firefox/addon/deepl-translate",firefoxShortcutDocs:"https://support.mozilla.org/kb/manage-extension-shortcuts-firefox",firefoxPrivacyPolicy:"https://addons.mozilla.org/en-US/firefox/addon/deepl-translate/privacy/",clientStateApi:"https://w.deepl.com/web",experimentsEndpoint:"https://experimentation.deepl.com/experiments",gmailFeedbackSurvey:"https://deepl.qualtrics.com/jfe/form/SV_db8ItFTmYBcZjYW",customerSegmentationSurveyFree:"https://deepl.qualtrics.com/jfe/form/SV_3LbBcdg4mjQuCCq?desc=TG-2071",customerSegmentationSurveyPro:"https://deepl.qualtrics.com/jfe/form/SV_3LbBcdg4mjQuCCq?desc=TG-2070",arabicSurvey:"https://deepl.qualtrics.com/jfe/form/SV_ekTrC2ePp0wn7xQ",msAddinsDeepLAds:"https://www.deepl.com/en/microsoft-365"},APP_VERSION:"1.28.2",FEATURE_FLAGS:{TRANSLATE_INPUT:!0,PAGE_TRANSLATION:!0,IMPROVE_WRITING:!0,DOCUMENT_TRANSLATION:!0,RECOMMEND_TO_A_FRIEND:!0,PRO_LOGIN:!0,WEBPAGE_CUSTOMIZER:!0,GDOCS_INTEGRATION:!0,ZENDESK_INTEGRATION:!0,GMAIL_INTEGRATION:!0,GSLIDES_INTEGRATION:!0,ON_INSTALL_ONBOARDING:!0,WHATSAPP_TRANSLATE_ALL_CHAT:!1,DEEPL_WRITE_GENERAL:!1,DEEPL_WRITE_GDOCS:!0,SHOW_CUSTOMER_SEGMENTATION_SURVEY:!1,ARABIC_SURVEY:!0,REVIEW_UI_WITH_ITA:!1,BATCH_TRANSLATE_HTML_REQUEST:!1}}.browserBuild)return{IS_PROD:!0,BASE_URLS:{dapApi:"https://s.deepl.com/chrome/statistics",toolingApiPro:"https://api.deepl.com/jsonrpc?client=chrome-extension,1.28.2",toolingApi:"https://www2.deepl.com/jsonrpc?client=chrome-extension,1.28.2",toolingWriteApiPro:"https://write-pro.www.deepl.com/jsonrpc?client=chrome-extension,1.28.2",toolingWriteApi:"https://write-free.www.deepl.com/jsonrpc?client=chrome-extension,1.28.2",classicApi:"https://www2.deepl.com/jsonrpc?client=chrome-extension,1.28.2",classicApiPro:"https://api.deepl.com/jsonrpc?client=chrome-extension,1.28.2",classicApiWrite:"https://write-free.www.deepl.com/jsonrpc?client=chrome-extension,1.28.2",classicApiWritePro:"https://write-pro.www.deepl.com/jsonrpc?client=chrome-extension,1.28.2",classicApiGlossary:"https://api.deepl.com/termbases/jsonrpc?client=chrome-extension,1.28.2",login:"https://www.deepl.com/auth/login",token:"https://w.deepl.com/oidc/token",logout:"https://www.deepl.com/auth/logout",feedbackSurvey:"https://deepl.typeform.com/to/MkMfP2Y6",newFeedbackSurvey:"https://deepl.qualtrics.com/jfe/form/SV_cMvbeX0WZGvkKGi",firefoxFeedbackSurvey:"https://deepl.qualtrics.com/jfe/form/SV_eyfDZqQmXuNTFOK",uninstallSurvey:"https://deepl.qualtrics.com/jfe/form/SV_eJxAD8c7J5hqSRU",gslidesFeedbackSurvey:"https://deepl.qualtrics.com/jfe/form/SV_9XBLSAbDmLq5emO",deeplPro:"https://www.deepl.com/pro",deeplProWrite:"https://www.deepl.com/pro-write",deeplTranslator:"https://www.deepl.com/translator",deeplDoctrans:"https://www.deepl.com/translator/files",deeplTermsOfServiceFree:"https://www.deepl.com/en/pro-license?tab=free",deeplCreateAccount:"https://www.deepl.com/signup",extensionStorePage:"https://bit.ly/DeepL-Chrome",supportArticle:"https://support.deepl.com/hc/articles/4407580229522",deeplSupport:"https://support.deepl.com/hc",chromeWebstore:"https://chrome.google.com/webstore/detail/deepl-translate-reading-w/cofdbpoegempjloogbagkncekinflcnj",edgeWebstore:"https://microsoftedge.microsoft.com/addons/detail/deepl-translate-reading-/fancfknaplihpclbhbpclnmmjcjanbaf",firefoxWebstore:"https://addons.mozilla.org/en-US/firefox/addon/deepl-translate",firefoxShortcutDocs:"https://support.mozilla.org/kb/manage-extension-shortcuts-firefox",firefoxPrivacyPolicy:"https://addons.mozilla.org/en-US/firefox/addon/deepl-translate/privacy/",clientStateApi:"https://w.deepl.com/web",experimentsEndpoint:"https://experimentation.deepl.com/experiments",gmailFeedbackSurvey:"https://deepl.qualtrics.com/jfe/form/SV_db8ItFTmYBcZjYW",customerSegmentationSurveyFree:"https://deepl.qualtrics.com/jfe/form/SV_3LbBcdg4mjQuCCq?desc=TG-2071",customerSegmentationSurveyPro:"https://deepl.qualtrics.com/jfe/form/SV_3LbBcdg4mjQuCCq?desc=TG-2070",arabicSurvey:"https://deepl.qualtrics.com/jfe/form/SV_ekTrC2ePp0wn7xQ",msAddinsDeepLAds:"https://www.deepl.com/en/microsoft-365"},APP_VERSION:"1.28.2",FEATURE_FLAGS:{TRANSLATE_INPUT:!0,PAGE_TRANSLATION:!0,IMPROVE_WRITING:!0,DOCUMENT_TRANSLATION:!0,RECOMMEND_TO_A_FRIEND:!0,PRO_LOGIN:!0,WEBPAGE_CUSTOMIZER:!0,GDOCS_INTEGRATION:!0,ZENDESK_INTEGRATION:!0,GMAIL_INTEGRATION:!0,GSLIDES_INTEGRATION:!0,ON_INSTALL_ONBOARDING:!0,WHATSAPP_TRANSLATE_ALL_CHAT:!1,DEEPL_WRITE_GENERAL:!1,DEEPL_WRITE_GDOCS:!0,SHOW_CUSTOMER_SEGMENTATION_SURVEY:!1,ARABIC_SURVEY:!0,REVIEW_UI_WITH_ITA:!1,BATCH_TRANSLATE_HTML_REQUEST:!1}}.browserBuild.toLowerCase()===B.firefox.toLowerCase();const e=chrome.runtime.getURL("");return z().browser===B.firefox||/moz-extension:\/\//gm.test(e)}const X={share_feedback_survey:"DOCS_GOOGLE_COM_FEEDBACK_FORM",new_share_feedback_survey:"NEW_FEEDBACK_FORM",try_DeepL_Pro:"DEEPL_COM_PRO",try_DeepL_Pro_Write:"DEEPL_COM_PRO_WRITE",show_more_translation:"DEEPL_COM_TRANSLATOR",deepl_translator_home:"DEEPL_COM_HOMEPAGE",deepl_write_home:"DEEPL_COM_WRITE",deepl_terms_of_service_free:"DEEPL_COM_TERMS_OF_SERVICE_FREE",deepl_create_account:"DEEPL_CREATE_ACCOUNT",deepl_translator_docs:"DEEPL_COM_DOCTRANS",shortcut_settings:"SHORTCUT_SETTINGS",support_article:"SUPPORT_ARTICLE",chrome_write_a_review:"CHROME_WRITE_A_REVIEW",edge_write_a_review:"EDGE_WRITE_A_REVIEW",gmail_feedback_survey:"GMAIL_FEEDBACK_SURVEY",gslides_feedback_survey:"GSLIDES_FEEDBACK_SURVEY",firefox_write_a_review:"FIREFOX_WRITE_A_REVIEW",external:{whatsapp:"EXTERNAL_WHATSAPP",twitter:"EXTERNAL_TWITTER",youtube:"EXTERNAL_YOUTUBE",facebook:"EXTERNAL_FACEBOOK",github:"EXTERNAL_GITHUB",discord:"EXTERNAL_DISCORD",telegram:"EXTERNAL_TELEGRAM",reddit:"EXTERNAL_REDDIT",gmail:"EXTERNAL_GMAIL",gdocs:"EXTERNAL_GDOCS",gslides:"EXTERNAL_GSLIDES",linkedIn:"EXTERNAL_LINKEDIN",msOffice:"EXTERNAL_MS_OFFICE"},deepl_support:"DEEPL_SUPPORT",firefox_feedback_survey:"FIREFOX_FEEDBACK_SURVEY",firefox_shortcut_docs:"FIREFOX_SHORTCUT_DOCS",firefox_privacy_policy:"FIREFOX_PRIVACY_POLICY",customer_segmentation_survey_free:"CUSTOMER_SEGMENTATION_SURVEY_FREE",customer_segmentation_survey_pro:"CUSTOMER_SEGMENTATION_SURVEY_PRO",arabic_survey:"ARABIC_SURVEY",ms_office_addins_ads:"ADDINS_ADS"},K={DOCS_GOOGLE_COM_FEEDBACK_FORM:"https://deepl.typeform.com/to/MkMfP2Y6",NEW_FEEDBACK_FORM:"https://deepl.qualtrics.com/jfe/form/SV_cMvbeX0WZGvkKGi",DEEPL_COM_PRO:"https://www.deepl.com/pro",DEEPL_COM_PRO_WRITE:"https://www.deepl.com/pro-write",DEEPL_COM_TRANSLATOR:"https://www.deepl.com/translator",DEEPL_COM_WRITE:{dapApi:"https://s.deepl.com/chrome/statistics",toolingApiPro:"https://api.deepl.com/jsonrpc?client=chrome-extension,1.28.2",toolingApi:"https://www2.deepl.com/jsonrpc?client=chrome-extension,1.28.2",toolingWriteApiPro:"https://write-pro.www.deepl.com/jsonrpc?client=chrome-extension,1.28.2",toolingWriteApi:"https://write-free.www.deepl.com/jsonrpc?client=chrome-extension,1.28.2",classicApi:"https://www2.deepl.com/jsonrpc?client=chrome-extension,1.28.2",classicApiPro:"https://api.deepl.com/jsonrpc?client=chrome-extension,1.28.2",classicApiWrite:"https://write-free.www.deepl.com/jsonrpc?client=chrome-extension,1.28.2",classicApiWritePro:"https://write-pro.www.deepl.com/jsonrpc?client=chrome-extension,1.28.2",classicApiGlossary:"https://api.deepl.com/termbases/jsonrpc?client=chrome-extension,1.28.2",login:"https://www.deepl.com/auth/login",token:"https://w.deepl.com/oidc/token",logout:"https://www.deepl.com/auth/logout",feedbackSurvey:"https://deepl.typeform.com/to/MkMfP2Y6",newFeedbackSurvey:"https://deepl.qualtrics.com/jfe/form/SV_cMvbeX0WZGvkKGi",firefoxFeedbackSurvey:"https://deepl.qualtrics.com/jfe/form/SV_eyfDZqQmXuNTFOK",uninstallSurvey:"https://deepl.qualtrics.com/jfe/form/SV_eJxAD8c7J5hqSRU",gslidesFeedbackSurvey:"https://deepl.qualtrics.com/jfe/form/SV_9XBLSAbDmLq5emO",deeplPro:"https://www.deepl.com/pro",deeplProWrite:"https://www.deepl.com/pro-write",deeplTranslator:"https://www.deepl.com/translator",deeplDoctrans:"https://www.deepl.com/translator/files",deeplTermsOfServiceFree:"https://www.deepl.com/en/pro-license?tab=free",deeplCreateAccount:"https://www.deepl.com/signup",extensionStorePage:"https://bit.ly/DeepL-Chrome",supportArticle:"https://support.deepl.com/hc/articles/4407580229522",deeplSupport:"https://support.deepl.com/hc",chromeWebstore:"https://chrome.google.com/webstore/detail/deepl-translate-reading-w/cofdbpoegempjloogbagkncekinflcnj",edgeWebstore:"https://microsoftedge.microsoft.com/addons/detail/deepl-translate-reading-/fancfknaplihpclbhbpclnmmjcjanbaf",firefoxWebstore:"https://addons.mozilla.org/en-US/firefox/addon/deepl-translate",firefoxShortcutDocs:"https://support.mozilla.org/kb/manage-extension-shortcuts-firefox",firefoxPrivacyPolicy:"https://addons.mozilla.org/en-US/firefox/addon/deepl-translate/privacy/",clientStateApi:"https://w.deepl.com/web",experimentsEndpoint:"https://experimentation.deepl.com/experiments",gmailFeedbackSurvey:"https://deepl.qualtrics.com/jfe/form/SV_db8ItFTmYBcZjYW",customerSegmentationSurveyFree:"https://deepl.qualtrics.com/jfe/form/SV_3LbBcdg4mjQuCCq?desc=TG-2071",customerSegmentationSurveyPro:"https://deepl.qualtrics.com/jfe/form/SV_3LbBcdg4mjQuCCq?desc=TG-2070",arabicSurvey:"https://deepl.qualtrics.com/jfe/form/SV_ekTrC2ePp0wn7xQ",msAddinsDeepLAds:"https://www.deepl.com/en/microsoft-365"}.deeplWrite,DEEPL_COM_DOCTRANS:"https://www.deepl.com/translator/files",DEEPL_COM_TERMS_OF_SERVICE_FREE:"https://www.deepl.com/en/pro-license?tab=free",DEEPL_CREATE_ACCOUNT:"https://www.deepl.com/signup",SHORTCUT_SETTINGS:"chrome://extensions/shortcuts",SUPPORT_ARTICLE:"https://support.deepl.com/hc/articles/4407580229522",CHROME_WEBSTORE:"https://chrome.google.com/webstore/detail/deepl-translate-reading-w/cofdbpoegempjloogbagkncekinflcnj",FIREFOX_WEBSTORE:"https://addons.mozilla.org/en-US/firefox/addon/deepl-translate",EDGE_WEBSTORE:"https://microsoftedge.microsoft.com/addons/detail/deepl-translate-reading-/fancfknaplihpclbhbpclnmmjcjanbaf",GMAIL_FEEDBACK_SURVEY:"https://deepl.qualtrics.com/jfe/form/SV_db8ItFTmYBcZjYW",GSLIDES_FEEDBACK_SURVEY:"https://deepl.qualtrics.com/jfe/form/SV_9XBLSAbDmLq5emO",EXTERNAL:{WHATSAPP:"https://web.whatsapp.com",TWITTER:"https://www.twitter.com",YOUTUBE:"https://www.youtube.com",FACEBOOK:"https://www.facebook.com",GITHUB:"https://www.github.com",DISCORD:"https://www.discord.com",TELEGRAM:"https://web.telegram.org",REDDIT:"https://www.reddit.com",GMAIL:"https://www.gmail.com",GDOCS:"https://docs.google.com",GSLIDES:"https://slides.google.com",LINKEDIN:"https://www.linkedin.com/",MSOFFICE:"https://www.office.com/"},DEEPL_SUPPORT:"https://support.deepl.com/hc",FIREFOX_FEEDBACK:"https://deepl.qualtrics.com/jfe/form/SV_eyfDZqQmXuNTFOK",FIREFOX_SHORTCUT_DOCS:"https://support.mozilla.org/kb/manage-extension-shortcuts-firefox",FIREFOX_PRIVACY_POLICY:"https://addons.mozilla.org/en-US/firefox/addon/deepl-translate/privacy/",CUSTOMER_SEGMENTATION_SURVEY_FREE:"https://deepl.qualtrics.com/jfe/form/SV_3LbBcdg4mjQuCCq?desc=TG-2071",CUSTOMER_SEGMENTATION_SURVEY_PRO:"https://deepl.qualtrics.com/jfe/form/SV_3LbBcdg4mjQuCCq?desc=TG-2070",ARABIC_SURVEY:"https://deepl.qualtrics.com/jfe/form/SV_ekTrC2ePp0wn7xQ",MSOFFICE_ADDINS_ADS:"https://www.deepl.com/en/microsoft-365"};function Q(e){const{destination:t,...n}=e;if(void 0!==t)switch(t){case X.share_feedback_survey:return K.DOCS_GOOGLE_COM_FEEDBACK_FORM;case X.new_share_feedback_survey:return K.NEW_FEEDBACK_FORM;case X.try_DeepL_Pro:return n?.utmContent?ee(K.DEEPL_COM_PRO,[["utm_source","browser_extension"],["utm_medium","chrome"],["utm_content",n?.utmContent]]):K.DEEPL_COM_PRO;case X.try_DeepL_Pro_Write:return n?.utmContent?ee(K.DEEPL_COM_PRO_WRITE,[["utm_source","browser_extension"],["utm_medium","chrome"],["utm_content",n?.utmContent]]):K.DEEPL_COM_PRO_WRITE;case X.show_more_translation:return n?function({sourceLang:e,targetLang:t,textToShare:n}){if(!e||!t||!n)return"";const r=new URL(K.DEEPL_COM_TRANSLATOR);let o=`${e.toLowerCase()}/${t.toLowerCase()}/${encodeURIComponent(n)}`;return r.hash=o,r.href}(n):void console.error("Invalid action.");case X.deepl_translator_home:return n?.utmContent?ee(K.DEEPL_COM_TRANSLATOR,[["utm_source","browser_extension"],["utm_medium","chrome"],["utm_content",n?.utmContent]]):K.DEEPL_COM_TRANSLATOR;case X.deepl_write_home:return n?.utmContent?ee(K.DEEPL_COM_WRITE,[["utm_source","browser_extension"],["utm_medium","chrome"],["utm_content",n?.utmContent]]):K.DEEPL_COM_WRITE;case X.deepl_translator_docs:return n?.utmContent?ee(K.DEEPL_COM_DOCTRANS,[["utm_source","browser_extension"],["utm_medium","chrome"],["utm_content",n?.utmContent]]):K.DEEPL_COM_DOCTRANS;case X.deepl_terms_of_service_free:return K.DEEPL_COM_TERMS_OF_SERVICE_FREE;case X.shortcut_settings:return K.SHORTCUT_SETTINGS;case X.support_article:return K.SUPPORT_ARTICLE;case X.external.whatsapp:return K.EXTERNAL.WHATSAPP;case X.external.twitter:return K.EXTERNAL.TWITTER;case X.external.youtube:return K.EXTERNAL.YOUTUBE;case X.external.facebook:return K.EXTERNAL.FACEBOOK;case X.external.github:return K.EXTERNAL.GITHUB;case X.external.discord:return K.EXTERNAL.DISCORD;case X.external.telegram:return K.EXTERNAL.TELEGRAM;case X.external.reddit:return K.EXTERNAL.REDDIT;case X.external.gmail:return K.EXTERNAL.GMAIL;case X.external.gdocs:return K.EXTERNAL.GDOCS;case X.external.gslides:return K.EXTERNAL.GSLIDES;case X.external.linkedIn:return K.EXTERNAL.LINKEDIN;case X.external.msOffice:return K.EXTERNAL.MSOFFICE;case X.deepl_support:return K.DEEPL_SUPPORT;case X.chrome_write_a_review:return K.CHROME_WEBSTORE;case X.edge_write_a_review:return K.EDGE_WEBSTORE;case X.gmail_feedback_survey:return K.GMAIL_FEEDBACK_SURVEY;case X.gslides_feedback_survey:return K.GSLIDES_FEEDBACK_SURVEY;case X.firefox_write_a_review:return K.FIREFOX_WEBSTORE;case X.firefox_privacy_policy:return K.FIREFOX_PRIVACY_POLICY;case X.firefox_feedback_survey:return K.FIREFOX_FEEDBACK;case X.firefox_shortcut_docs:return K.FIREFOX_SHORTCUT_DOCS;case X.deepl_create_account:if(n){let e=[];if(n.utmContent){e=[...[["utm_source","browser_extension"],["utm_medium","chrome"],["utm_content",n.utmContent]]]}if(n.redirectToOnboarding&&!Y()){const t=`${chrome.runtime.getURL("")}onboarding.html`;e.push(["redirectUri",t])}return ee(K.DEEPL_CREATE_ACCOUNT,e)}return K.DEEPL_CREATE_ACCOUNT;case X.customer_segmentation_survey_free:return K.CUSTOMER_SEGMENTATION_SURVEY_FREE;case X.customer_segmentation_survey_pro:return K.CUSTOMER_SEGMENTATION_SURVEY_PRO;case X.arabic_survey:return K.ARABIC_SURVEY;case X.ms_office_addins_ads:return K.MSOFFICE_ADDINS_ADS;default:return}}function Z(e){const t=Q(e),{openInSameTab:n}=e;if(!t)return;const r=new URL(t).href;n?chrome.tabs.query({active:!0,currentWindow:!0},(function(e){const t=e[0];chrome.tabs.update(t.id,{url:r})})):chrome.tabs.create({url:r,active:!0})}function ee(e,t){if(0===t.length||!e)return;const n=new URL(e);return t.forEach((e=>{2===e.length&&n.searchParams.append(e[0],e[1])})),n.href}const te=Object.prototype.toString;function ne(e){switch(te.call(e)){case"[object Error]":case"[object Exception]":case"[object DOMException]":return!0;default:return fe(e,Error)}}function re(e,t){return te.call(e)===`[object ${t}]`}function oe(e){return re(e,"ErrorEvent")}function se(e){return re(e,"DOMError")}function ie(e){return re(e,"String")}function ae(e){return"object"==typeof e&&null!==e&&"__sentry_template_string__"in e&&"__sentry_template_values__"in e}function ce(e){return null===e||ae(e)||"object"!=typeof e&&"function"!=typeof e}function le(e){return re(e,"Object")}function ue(e){return"undefined"!=typeof Event&&fe(e,Event)}function de(e){return re(e,"RegExp")}function pe(e){return Boolean(e&&e.then&&"function"==typeof e.then)}function he(e){return"number"==typeof e&&e!=e}function fe(e,t){try{return e instanceof t}catch(e){return!1}}function ge(e){return!("object"!=typeof e||null===e||!e.__isVue&&!e._isVue)}function me(e,t=0){return"string"!=typeof e||0===t||e.length<=t?e:`${e.slice(0,t)}...`}function ye(e,t){let n=e;const r=n.length;if(r<=150)return n;t>r&&(t=r);let o=Math.max(t-60,0);o<5&&(o=0);let s=Math.min(o+140,r);return s>r-5&&(s=r),s===r&&(o=Math.max(s-140,0)),n=n.slice(o,s),o>0&&(n=`'{snip} ${n}`),s<r&&(n+=" {snip}"),n}function _e(e,t){if(!Array.isArray(e))return"";const n=[];for(let t=0;t<e.length;t++){const r=e[t];try{ge(r)?n.push("[VueViewModel]"):n.push(String(r))}catch(e){n.push("[value cannot be serialized]")}}return n.join(t)}function ve(e,t=[],n=!1){return t.some((t=>function(e,t,n=!1){return!!ie(e)&&(de(t)?t.test(e):!!ie(t)&&(n?e===t:e.includes(t)))}(e,t,n)))}function Se(e,t,n=250,r,o,s,i){if(!(s.exception&&s.exception.values&&i&&fe(i.originalException,Error)))return;const a=s.exception.values.length>0?s.exception.values[s.exception.values.length-1]:void 0;var c,l;a&&(s.exception.values=(c=Te(e,t,o,i.originalException,r,s.exception.values,a,0),l=n,c.map((e=>(e.value&&(e.value=me(e.value,l)),e)))))}function Te(e,t,n,r,o,s,i,a){if(s.length>=n+1)return s;let c=[...s];if(fe(r[o],Error)){be(i,a);const s=e(t,r[o]),l=c.length;we(s,o,l,a),c=Te(e,t,n,r[o],o,[s,...c],s,l)}return Array.isArray(r.errors)&&r.errors.forEach(((r,s)=>{if(fe(r,Error)){be(i,a);const l=e(t,r),u=c.length;we(l,`errors[${s}]`,u,a),c=Te(e,t,n,r,o,[l,...c],l,u)}})),c}function be(e,t){e.mechanism=e.mechanism||{type:"generic",handled:!0},e.mechanism={...e.mechanism,..."AggregateError"===e.type&&{is_exception_group:!0},exception_id:t}}function we(e,t,n,r){e.mechanism=e.mechanism||{type:"generic",handled:!0},e.mechanism={...e.mechanism,type:"chained",source:t,exception_id:n,parent_id:r}}function Ee(e){return e&&e.Math==Math?e:void 0}const Ie="object"==typeof globalThis&&Ee(globalThis)||"object"==typeof window&&Ee(window)||"object"==typeof self&&Ee(self)||"object"==typeof global&&Ee(global)||function(){return this}()||{};function Ae(){return Ie}function Re(e,t,n){const r=n||Ie,o=r.__SENTRY__=r.__SENTRY__||{};return o[e]||(o[e]=t())}const ke=Ae(),Ce=80;function xe(e,t={}){if(!e)return"<unknown>";try{let n=e;const r=5,o=[];let s=0,i=0;const a=" > ",c=a.length;let l;const u=Array.isArray(t)?t:t.keyAttrs,d=!Array.isArray(t)&&t.maxStringLength||Ce;for(;n&&s++<r&&(l=Oe(n,u),!("html"===l||s>1&&i+o.length*c+l.length>=d));)o.push(l),i+=l.length,n=n.parentNode;return o.reverse().join(a)}catch(e){return"<unknown>"}}function Oe(e,t){const n=e,r=[];let o,s,i,a,c;if(!n||!n.tagName)return"";if(ke.HTMLElement&&n instanceof HTMLElement&&n.dataset&&n.dataset.sentryComponent)return n.dataset.sentryComponent;r.push(n.tagName.toLowerCase());const l=t&&t.length?t.filter((e=>n.getAttribute(e))).map((e=>[e,n.getAttribute(e)])):null;if(l&&l.length)l.forEach((e=>{r.push(`[${e[0]}="${e[1]}"]`)}));else if(n.id&&r.push(`#${n.id}`),o=n.className,o&&ie(o))for(s=o.split(/\s+/),c=0;c<s.length;c++)r.push(`.${s[c]}`);const u=["aria-label","type","name","title","alt"];for(c=0;c<u.length;c++)i=u[c],a=n.getAttribute(i),a&&r.push(`[${i}="${a}"]`);return r.join("")}function Le(){try{return ke.document.location.href}catch(e){return""}}function Ne(e){return ke.document&&ke.document.querySelector?ke.document.querySelector(e):null}function Pe(e){if(!ke.HTMLElement)return null;let t=e;for(let e=0;e<5;e++){if(!t)return null;if(t instanceof HTMLElement&&t.dataset.sentryComponent)return t.dataset.sentryComponent;t=t.parentNode}return null}const De="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__,Me=["debug","info","warn","error","log","assert","trace"],Ue={};function $e(e){if(!("console"in Ie))return e();const t=Ie.console,n={},r=Object.keys(Ue);r.forEach((e=>{const r=Ue[e];n[e]=t[e],t[e]=r}));try{return e()}finally{r.forEach((e=>{t[e]=n[e]}))}}const Fe=function(){let e=!1;const t={enable:()=>{e=!0},disable:()=>{e=!1},isEnabled:()=>e};return De?Me.forEach((n=>{t[n]=(...t)=>{e&&$e((()=>{Ie.console[n](`Sentry Logger [${n}]:`,...t)}))}})):Me.forEach((e=>{t[e]=()=>{}})),t}(),je=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+)?)?@)([\w.-]+)(?::(\d+))?\/(.+)/;function Ge(e,t=!1){const{host:n,path:r,pass:o,port:s,projectId:i,protocol:a,publicKey:c}=e;return`${a}://${c}${t&&o?`:${o}`:""}@${n}${s?`:${s}`:""}/${r?`${r}/`:r}${i}`}function Ve(e){const t=je.exec(e);if(!t)return void $e((()=>{console.error(`Invalid Sentry Dsn: ${e}`)}));const[n,r,o="",s,i="",a]=t.slice(1);let c="",l=a;const u=l.split("/");if(u.length>1&&(c=u.slice(0,-1).join("/"),l=u.pop()),l){const e=l.match(/^\d+/);e&&(l=e[0])}return qe({host:s,pass:o,path:c,projectId:l,port:i,protocol:n,publicKey:r})}function qe(e){return{protocol:e.protocol,publicKey:e.publicKey||"",pass:e.pass||"",host:e.host,port:e.port||"",path:e.path||"",projectId:e.projectId}}function We(e){const t="string"==typeof e?Ve(e):qe(e);if(t&&function(e){if(!De)return!0;const{port:t,projectId:n,protocol:r}=e;return!(["protocol","publicKey","host","projectId"].find((t=>!e[t]&&(Fe.error(`Invalid Sentry Dsn: ${t} missing`),!0)))||(n.match(/^\d+$/)?function(e){return"http"===e||"https"===e}(r)?t&&isNaN(parseInt(t,10))&&(Fe.error(`Invalid Sentry Dsn: Invalid port ${t}`),1):(Fe.error(`Invalid Sentry Dsn: Invalid protocol ${r}`),1):(Fe.error(`Invalid Sentry Dsn: Invalid projectId ${n}`),1)))}(t))return t}class Be extends Error{constructor(e,t="warn"){super(e),this.message=e,this.name=new.target.prototype.constructor.name,Object.setPrototypeOf(this,new.target.prototype),this.logLevel=t}}function He(e,t,n){if(!(t in e))return;const r=e[t],o=n(r);"function"==typeof o&&ze(o,r),e[t]=o}function Je(e,t,n){try{Object.defineProperty(e,t,{value:n,writable:!0,configurable:!0})}catch(n){De&&Fe.log(`Failed to add non-enumerable property "${t}" to object`,e)}}function ze(e,t){try{const n=t.prototype||{};e.prototype=t.prototype=n,Je(e,"__sentry_original__",t)}catch(e){}}function Ye(e){return e.__sentry_original__}function Xe(e){if(ne(e))return{message:e.message,name:e.name,stack:e.stack,...Qe(e)};if(ue(e)){const t={type:e.type,target:Ke(e.target),currentTarget:Ke(e.currentTarget),...Qe(e)};return"undefined"!=typeof CustomEvent&&fe(e,CustomEvent)&&(t.detail=e.detail),t}return e}function Ke(e){try{return t=e,"undefined"!=typeof Element&&fe(t,Element)?xe(e):Object.prototype.toString.call(e)}catch(e){return"<unknown>"}var t}function Qe(e){if("object"==typeof e&&null!==e){const t={};for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}return{}}function Ze(e){return et(e,new Map)}function et(e,t){if(function(e){if(!le(e))return!1;try{const t=Object.getPrototypeOf(e).constructor.name;return!t||"Object"===t}catch(e){return!0}}(e)){const n=t.get(e);if(void 0!==n)return n;const r={};t.set(e,r);for(const n of Object.keys(e))void 0!==e[n]&&(r[n]=et(e[n],t));return r}if(Array.isArray(e)){const n=t.get(e);if(void 0!==n)return n;const r=[];return t.set(e,r),e.forEach((e=>{r.push(et(e,t))})),r}return e}const tt=50,nt=/\(error: (.*)\)/,rt=/captureMessage|captureException/;function ot(...e){const t=e.sort(((e,t)=>e[0]-t[0])).map((e=>e[1]));return(e,n=0)=>{const r=[],o=e.split("\n");for(let e=n;e<o.length;e++){const n=o[e];if(n.length>1024)continue;const s=nt.test(n)?n.replace(nt,"$1"):n;if(!s.match(/\S*Error: /)){for(const e of t){const t=e(s);if(t){r.push(t);break}}if(r.length>=tt)break}}return function(e){if(!e.length)return[];const t=Array.from(e);/sentryWrapped/.test(t[t.length-1].function||"")&&t.pop();t.reverse(),rt.test(t[t.length-1].function||"")&&(t.pop(),rt.test(t[t.length-1].function||"")&&t.pop());return t.slice(0,tt).map((e=>({...e,filename:e.filename||t[t.length-1].filename,function:e.function||"?"})))}(r)}}const st="<anonymous>";function it(e){try{return e&&"function"==typeof e&&e.name||st}catch(e){return st}}const at={},ct={};function lt(e,t){at[e]=at[e]||[],at[e].push(t)}function ut(e,t){ct[e]||(t(),ct[e]=!0)}function dt(e,t){const n=e&&at[e];if(n)for(const r of n)try{r(t)}catch(t){De&&Fe.error(`Error while triggering instrumentation handler.\nType: ${e}\nName: ${it(r)}\nError:`,t)}}function pt(e){const t="console";lt(t,e),ut(t,ht)}function ht(){"console"in Ie&&Me.forEach((function(e){e in Ie.console&&He(Ie.console,e,(function(t){return Ue[e]=t,function(...t){dt("console",{args:t,level:e});const n=Ue[e];n&&n.apply(Ie.console,t)}}))}))}function ft(){const e=Ie,t=e.crypto||e.msCrypto;let n=()=>16*Math.random();try{if(t&&t.randomUUID)return t.randomUUID().replace(/-/g,"");t&&t.getRandomValues&&(n=()=>{const e=new Uint8Array(1);return t.getRandomValues(e),e[0]})}catch(e){}return([1e7]+1e3+4e3+8e3+1e11).replace(/[018]/g,(e=>(e^(15&n())>>e/4).toString(16)))}function gt(e){return e.exception&&e.exception.values?e.exception.values[0]:void 0}function mt(e){const{message:t,event_id:n}=e;if(t)return t;const r=gt(e);return r?r.type&&r.value?`${r.type}: ${r.value}`:r.type||r.value||n||"<unknown>":n||"<unknown>"}function yt(e,t,n){const r=e.exception=e.exception||{},o=r.values=r.values||[],s=o[0]=o[0]||{};s.value||(s.value=t||""),s.type||(s.type=n||"Error")}function _t(e,t){const n=gt(e);if(!n)return;const r=n.mechanism;if(n.mechanism={type:"generic",handled:!0,...r,...t},t&&"data"in t){const e={...r&&r.data,...t.data};n.mechanism.data=e}}function vt(e){if(e&&e.__sentry_captured__)return!0;try{Je(e,"__sentry_captured__",!0)}catch(e){}return!1}function St(e){return Array.isArray(e)?e:[e]}const Tt=Ie,bt=1e3;let wt,Et,It;function At(e){lt("dom",e),ut("dom",Rt)}function Rt(){if(!Tt.document)return;const e=dt.bind(null,"dom"),t=kt(e,!0);Tt.document.addEventListener("click",t,!1),Tt.document.addEventListener("keypress",t,!1),["EventTarget","Node"].forEach((t=>{const n=Tt[t]&&Tt[t].prototype;n&&n.hasOwnProperty&&n.hasOwnProperty("addEventListener")&&(He(n,"addEventListener",(function(t){return function(n,r,o){if("click"===n||"keypress"==n)try{const r=this,s=r.__sentry_instrumentation_handlers__=r.__sentry_instrumentation_handlers__||{},i=s[n]=s[n]||{refCount:0};if(!i.handler){const r=kt(e);i.handler=r,t.call(this,n,r,o)}i.refCount++}catch(e){}return t.call(this,n,r,o)}})),He(n,"removeEventListener",(function(e){return function(t,n,r){if("click"===t||"keypress"==t)try{const n=this,o=n.__sentry_instrumentation_handlers__||{},s=o[t];s&&(s.refCount--,s.refCount<=0&&(e.call(this,t,s.handler,r),s.handler=void 0,delete o[t]),0===Object.keys(o).length&&delete n.__sentry_instrumentation_handlers__)}catch(e){}return e.call(this,t,n,r)}})))}))}function kt(e,t=!1){return n=>{if(!n||n._sentryCaptured)return;const r=function(e){try{return e.target}catch(e){return null}}(n);if(function(e,t){return"keypress"===e&&(!t||!t.tagName||"INPUT"!==t.tagName&&"TEXTAREA"!==t.tagName&&!t.isContentEditable)}(n.type,r))return;Je(n,"_sentryCaptured",!0),r&&!r._sentryId&&Je(r,"_sentryId",ft());const o="keypress"===n.type?"input":n.type;if(!function(e){if(e.type!==Et)return!1;try{if(!e.target||e.target._sentryId!==It)return!1}catch(e){}return!0}(n)){e({event:n,name:o,global:t}),Et=n.type,It=r?r._sentryId:void 0}clearTimeout(wt),wt=Tt.setTimeout((()=>{It=void 0,Et=void 0}),bt)}}const Ct=Ae();function xt(){if(!("fetch"in Ct))return!1;try{return new Headers,new Request("http://www.example.com"),new Response,!0}catch(e){return!1}}function Ot(e){return e&&/^function fetch\(\)\s+\{\s+\[native code\]\s+\}$/.test(e.toString())}function Lt(){if("string"==typeof EdgeRuntime)return!0;if(!xt())return!1;if(Ot(Ct.fetch))return!0;let e=!1;const t=Ct.document;if(t&&"function"==typeof t.createElement)try{const n=t.createElement("iframe");n.hidden=!0,t.head.appendChild(n),n.contentWindow&&n.contentWindow.fetch&&(e=Ot(n.contentWindow.fetch)),t.head.removeChild(n)}catch(e){De&&Fe.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",e)}return e}function Nt(e){const t="fetch";lt(t,e),ut(t,Pt)}function Pt(){Lt()&&He(Ie,"fetch",(function(e){return function(...t){const{method:n,url:r}=function(e){if(0===e.length)return{method:"GET",url:""};if(2===e.length){const[t,n]=e;return{url:Mt(t),method:Dt(n,"method")?String(n.method).toUpperCase():"GET"}}const t=e[0];return{url:Mt(t),method:Dt(t,"method")?String(t.method).toUpperCase():"GET"}}(t),o={args:t,fetchData:{method:n,url:r},startTimestamp:Date.now()};return dt("fetch",{...o}),e.apply(Ie,t).then((e=>(dt("fetch",{...o,endTimestamp:Date.now(),response:e}),e)),(e=>{throw dt("fetch",{...o,endTimestamp:Date.now(),error:e}),e}))}}))}function Dt(e,t){return!!e&&"object"==typeof e&&!!e[t]}function Mt(e){return"string"==typeof e?e:e?Dt(e,"url")?e.url:e.toString?e.toString():"":""}let Ut=null;function $t(e){const t="error";lt(t,e),ut(t,Ft)}function Ft(){Ut=Ie.onerror,Ie.onerror=function(e,t,n,r,o){return dt("error",{column:r,error:o,line:n,msg:e,url:t}),!(!Ut||Ut.__SENTRY_LOADER__)&&Ut.apply(this,arguments)},Ie.onerror.__SENTRY_INSTRUMENTED__=!0}let jt=null;function Gt(e){const t="unhandledrejection";lt(t,e),ut(t,Vt)}function Vt(){jt=Ie.onunhandledrejection,Ie.onunhandledrejection=function(e){return dt("unhandledrejection",e),!(jt&&!jt.__SENTRY_LOADER__)||jt.apply(this,arguments)},Ie.onunhandledrejection.__SENTRY_INSTRUMENTED__=!0}const qt=Ae();const Wt=Ie;let Bt;function Ht(e){const t="history";lt(t,e),ut(t,Jt)}function Jt(){if(!function(){const e=qt.chrome,t=e&&e.app&&e.app.runtime,n="history"in qt&&!!qt.history.pushState&&!!qt.history.replaceState;return!t&&n}())return;const e=Wt.onpopstate;function t(e){return function(...t){const n=t.length>2?t[2]:void 0;if(n){const e=Bt,t=String(n);Bt=t;dt("history",{from:e,to:t})}return e.apply(this,t)}}Wt.onpopstate=function(...t){const n=Wt.location.href,r=Bt;Bt=n;if(dt("history",{from:r,to:n}),e)try{return e.apply(this,t)}catch(e){}},He(Wt.history,"pushState",t),He(Wt.history,"replaceState",t)}const zt=Ie,Yt="__sentry_xhr_v3__";function Xt(e){lt("xhr",e),ut("xhr",Kt)}function Kt(){if(!zt.XMLHttpRequest)return;const e=XMLHttpRequest.prototype;He(e,"open",(function(e){return function(...t){const n=Date.now(),r=ie(t[0])?t[0].toUpperCase():void 0,o=function(e){if(ie(e))return e;try{return e.toString()}catch(e){}return}(t[1]);if(!r||!o)return e.apply(this,t);this[Yt]={method:r,url:o,request_headers:{}},"POST"===r&&o.match(/sentry_key/)&&(this.__sentry_own_request__=!0);const s=()=>{const e=this[Yt];if(e&&4===this.readyState){try{e.status_code=this.status}catch(e){}dt("xhr",{args:[r,o],endTimestamp:Date.now(),startTimestamp:n,xhr:this})}};return"onreadystatechange"in this&&"function"==typeof this.onreadystatechange?He(this,"onreadystatechange",(function(e){return function(...t){return s(),e.apply(this,t)}})):this.addEventListener("readystatechange",s),He(this,"setRequestHeader",(function(e){return function(...t){const[n,r]=t,o=this[Yt];return o&&ie(n)&&ie(r)&&(o.request_headers[n.toLowerCase()]=r),e.apply(this,t)}})),e.apply(this,t)}})),He(e,"send",(function(e){return function(...t){const n=this[Yt];if(!n)return e.apply(this,t);void 0!==t[0]&&(n.body=t[0]);return dt("xhr",{args:[n.method,n.url],startTimestamp:Date.now(),xhr:this}),e.apply(this,t)}}))}function Qt(){return!("undefined"!=typeof __SENTRY_BROWSER_BUNDLE__&&__SENTRY_BROWSER_BUNDLE__)&&"[object process]"===Object.prototype.toString.call("undefined"!=typeof process?process:0)}function Zt(e,t){return e.require(t)}function en(e){let t;try{t=Zt(module,e)}catch(e){}try{const{cwd:n}=Zt(module,"process");t=Zt(module,`${n()}/node_modules/${e}`)}catch(e){}return t}function tn(){return"undefined"!=typeof window&&(!Qt()||void 0!==Ie.process&&"renderer"===Ie.process.type)}function nn(e,t=100,n=1/0){try{return on("",e,t,n)}catch(e){return{ERROR:`**non-serializable** (${e})`}}}function rn(e,t=3,n=102400){const r=nn(e,t);return o=r,function(e){return~-encodeURI(e).split(/%..|./).length}(JSON.stringify(o))>n?rn(e,t-1,n):r;var o}function on(e,t,n=1/0,r=1/0,o=function(){const e="function"==typeof WeakSet,t=e?new WeakSet:[];return[function(n){if(e)return!!t.has(n)||(t.add(n),!1);for(let e=0;e<t.length;e++)if(t[e]===n)return!0;return t.push(n),!1},function(n){if(e)t.delete(n);else for(let e=0;e<t.length;e++)if(t[e]===n){t.splice(e,1);break}}]}()){const[s,i]=o;if(null==t||["number","boolean","string"].includes(typeof t)&&!he(t))return t;const a=function(e,t){try{if("domain"===e&&t&&"object"==typeof t&&t._events)return"[Domain]";if("domainEmitter"===e)return"[DomainEmitter]";if("undefined"!=typeof global&&t===global)return"[Global]";if("undefined"!=typeof window&&t===window)return"[Window]";if("undefined"!=typeof document&&t===document)return"[Document]";if(ge(t))return"[VueViewModel]";if(le(n=t)&&"nativeEvent"in n&&"preventDefault"in n&&"stopPropagation"in n)return"[SyntheticEvent]";if("number"==typeof t&&t!=t)return"[NaN]";if("function"==typeof t)return`[Function: ${it(t)}]`;if("symbol"==typeof t)return`[${String(t)}]`;if("bigint"==typeof t)return`[BigInt: ${String(t)}]`;const r=function(e){const t=Object.getPrototypeOf(e);return t?t.constructor.name:"null prototype"}(t);return/^HTML(\w*)Element$/.test(r)?`[HTMLElement: ${r}]`:`[object ${r}]`}catch(e){return`**non-serializable** (${e})`}var n}(e,t);if(!a.startsWith("[object "))return a;if(t.__sentry_skip_normalization__)return t;const c="number"==typeof t.__sentry_override_normalization_depth__?t.__sentry_override_normalization_depth__:n;if(0===c)return a.replace("object ","");if(s(t))return"[Circular ~]";const l=t;if(l&&"function"==typeof l.toJSON)try{return on("",l.toJSON(),c-1,r,o)}catch(e){}const u=Array.isArray(t)?[]:{};let d=0;const p=Xe(t);for(const e in p){if(!Object.prototype.hasOwnProperty.call(p,e))continue;if(d>=r){u[e]="[MaxProperties ~]";break}const t=p[e];u[e]=on(e,t,c-1,r,o),d++}return i(t),u}const sn=/^(\S+:\\|\/?)([\s\S]*?)((?:\.{1,2}|[^/\\]+?|)(\.[^./\\]*|))(?:[/\\]*)$/;function an(...e){let t="",n=!1;for(let r=e.length-1;r>=-1&&!n;r--){const o=r>=0?e[r]:"/";o&&(t=`${o}/${t}`,n="/"===o.charAt(0))}return t=function(e,t){let n=0;for(let t=e.length-1;t>=0;t--){const r=e[t];"."===r?e.splice(t,1):".."===r?(e.splice(t,1),n++):n&&(e.splice(t,1),n--)}if(t)for(;n--;n)e.unshift("..");return e}(t.split("/").filter((e=>!!e)),!n).join("/"),(n?"/":"")+t||"."}function cn(e){let t=0;for(;t<e.length&&""===e[t];t++);let n=e.length-1;for(;n>=0&&""===e[n];n--);return t>n?[]:e.slice(t,n-t+1)}function ln(e,t){let n=function(e){const t=e.length>1024?`<truncated>${e.slice(-1024)}`:e,n=sn.exec(t);return n?n.slice(1):[]}(e)[2];return t&&n.slice(-1*t.length)===t&&(n=n.slice(0,n.length-t.length)),n}var un;function dn(e){return new hn((t=>{t(e)}))}function pn(e){return new hn(((t,n)=>{n(e)}))}!function(e){e[e.PENDING=0]="PENDING";e[e.RESOLVED=1]="RESOLVED";e[e.REJECTED=2]="REJECTED"}(un||(un={}));class hn{constructor(e){hn.prototype.__init.call(this),hn.prototype.__init2.call(this),hn.prototype.__init3.call(this),hn.prototype.__init4.call(this),this._state=un.PENDING,this._handlers=[];try{e(this._resolve,this._reject)}catch(e){this._reject(e)}}then(e,t){return new hn(((n,r)=>{this._handlers.push([!1,t=>{if(e)try{n(e(t))}catch(e){r(e)}else n(t)},e=>{if(t)try{n(t(e))}catch(e){r(e)}else r(e)}]),this._executeHandlers()}))}catch(e){return this.then((e=>e),e)}finally(e){return new hn(((t,n)=>{let r,o;return this.then((t=>{o=!1,r=t,e&&e()}),(t=>{o=!0,r=t,e&&e()})).then((()=>{o?n(r):t(r)}))}))}__init(){this._resolve=e=>{this._setResult(un.RESOLVED,e)}}__init2(){this._reject=e=>{this._setResult(un.REJECTED,e)}}__init3(){this._setResult=(e,t)=>{this._state===un.PENDING&&(pe(t)?t.then(this._resolve,this._reject):(this._state=e,this._value=t,this._executeHandlers()))}}__init4(){this._executeHandlers=()=>{if(this._state===un.PENDING)return;const e=this._handlers.slice();this._handlers=[],e.forEach((e=>{e[0]||(this._state===un.RESOLVED&&e[1](this._value),this._state===un.REJECTED&&e[2](this._value),e[0]=!0)}))}}}function fn(e){const t=[];function n(e){return t.splice(t.indexOf(e),1)[0]}return{$:t,add:function(r){if(!(void 0===e||t.length<e))return pn(new Be("Not adding Promise because buffer limit was reached."));const o=r();return-1===t.indexOf(o)&&t.push(o),o.then((()=>n(o))).then(null,(()=>n(o).then(null,(()=>{})))),o},drain:function(e){return new hn(((n,r)=>{let o=t.length;if(!o)return n(!0);const s=setTimeout((()=>{e&&e>0&&n(!1)}),e);t.forEach((e=>{dn(e).then((()=>{--o||(clearTimeout(s),n(!0))}),r)}))}))}}}function gn(e){if(!e)return{};const t=e.match(/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!t)return{};const n=t[6]||"",r=t[8]||"";return{host:t[4],path:t[5],protocol:t[2],search:n,hash:r,relative:t[5]+n+r}}function mn(e){return e.split(/[\?#]/,1)[0]}function yn(e){return e.split(/\\?\//).filter((e=>e.length>0&&","!==e)).length}const _n={ip:!1,request:!0,transaction:!0,user:!0},vn=["cookies","data","headers","method","query_string","url"],Sn=["id","username","email"];function Tn(e,t={}){const n=e.method&&e.method.toUpperCase();let r="",o="url";t.customRoute||e.route?(r=t.customRoute||`${e.baseUrl||""}${e.route&&e.route.path}`,o="route"):(e.originalUrl||e.url)&&(r=mn(e.originalUrl||e.url||""));let s="";return t.method&&n&&(s+=n),t.method&&t.path&&(s+=" "),t.path&&r&&(s+=r),[s,o]}function bn(e,t){const{include:n=vn,deps:r}=t||{},o={},s=e.headers||{},i=e.method,a=s.host||e.hostname||e.host||"<no host>",c="https"===e.protocol||e.socket&&e.socket.encrypted?"https":"http",l=e.originalUrl||e.url||"",u=l.startsWith(c)?l:`${c}://${a}${l}`;return n.forEach((t=>{switch(t){case"headers":o.headers=s,n.includes("cookies")||delete o.headers.cookie;break;case"method":o.method=i;break;case"url":o.url=u;break;case"cookies":o.cookies=e.cookies||s.cookie&&function(e){const t={};let n=0;for(;n<e.length;){const r=e.indexOf("=",n);if(-1===r)break;let o=e.indexOf(";",n);if(-1===o)o=e.length;else if(o<r){n=e.lastIndexOf(";",r-1)+1;continue}const s=e.slice(n,r).trim();if(void 0===t[s]){let n=e.slice(r+1,o).trim();34===n.charCodeAt(0)&&(n=n.slice(1,-1));try{t[s]=-1!==n.indexOf("%")?decodeURIComponent(n):n}catch(e){t[s]=n}}n=o+1}return t}(s.cookie)||{};break;case"query_string":o.query_string=function(e,t){let n=e.originalUrl||e.url||"";if(!n)return;n.startsWith("/")&&(n=`http://dogs.are.great${n}`);try{return e.query||"undefined"!=typeof URL&&new URL(n).search.slice(1)||t&&t.url&&t.url.parse(n).query||void 0}catch(e){return}}(e,r);break;case"data":if("GET"===i||"HEAD"===i)break;void 0!==e.body&&(o.data=ie(e.body)?e.body:JSON.stringify(nn(e.body)));break;default:({}).hasOwnProperty.call(e,t)&&(o[t]=e[t])}})),o}function wn(e,t,n){const r={..._n,...n&&n.include};if(r.request){const o=Array.isArray(r.request)?bn(t,{include:r.request,deps:n&&n.deps}):bn(t,{deps:n&&n.deps});e.request={...e.request,...o}}if(r.user){const n=t.user&&le(t.user)?function(e,t){const n={};return(Array.isArray(t)?t:Sn).forEach((t=>{e&&t in e&&(n[t]=e[t])})),n}(t.user,r.user):{};Object.keys(n).length&&(e.user={...e.user,...n})}if(r.ip){const n=t.ip||t.socket&&t.socket.remoteAddress;n&&(e.user={...e.user,ip_address:n})}return r.transaction&&!e.transaction&&(e.transaction=function(e,t){switch(t){case"path":return Tn(e,{path:!0})[0];case"handler":return e.route&&e.route.stack&&e.route.stack[0]&&e.route.stack[0].name||"<anonymous>";default:return Tn(e,{path:!0,method:!0,customRoute:e._reconstructedRoute?e._reconstructedRoute:void 0})[0]}}(t,r.transaction)),e}const En=["fatal","error","warning","log","info","debug"];function In(e){return"warn"===e?"warning":En.includes(e)?e:"log"}const An=1e3;function Rn(){return Date.now()/An}const kn=function(){const{performance:e}=Ie;if(!e||!e.now)return Rn;const t=Date.now()-e.now(),n=null==e.timeOrigin?t:e.timeOrigin;return()=>(n+e.now())/An}(),Cn=(()=>{const{performance:e}=Ie;if(!e||!e.now)return;const t=36e5,n=e.now(),r=Date.now(),o=e.timeOrigin?Math.abs(e.timeOrigin+n-r):t,s=o<t,i=e.timing&&e.timing.navigationStart,a="number"==typeof i?Math.abs(i+n-r):t;return s||a<t?o<=a?e.timeOrigin:i:r})(),xn="baggage",On="sentry-",Ln=/^sentry-/,Nn=8192;function Pn(e){if(!ie(e)&&!Array.isArray(e))return;let t={};if(Array.isArray(e))t=e.reduce(((e,t)=>{const n=Mn(t);for(const t of Object.keys(n))e[t]=n[t];return e}),{});else{if(!e)return;t=Mn(e)}const n=Object.entries(t).reduce(((e,[t,n])=>{if(t.match(Ln)){e[t.slice(On.length)]=n}return e}),{});return Object.keys(n).length>0?n:void 0}function Dn(e){if(!e)return;return function(e){if(0===Object.keys(e).length)return;return Object.entries(e).reduce(((e,[t,n],r)=>{const o=`${encodeURIComponent(t)}=${encodeURIComponent(n)}`,s=0===r?o:`${e},${o}`;return s.length>Nn?(De&&Fe.warn(`Not adding key: ${t} with val: ${n} to baggage header due to exceeding baggage size limits.`),e):s}),"")}(Object.entries(e).reduce(((e,[t,n])=>(n&&(e[`${On}${t}`]=n),e)),{}))}function Mn(e){return e.split(",").map((e=>e.split("=").map((e=>decodeURIComponent(e.trim()))))).reduce(((e,[t,n])=>(e[t]=n,e)),{})}const Un=new RegExp("^[ \\t]*([0-9a-f]{32})?-?([0-9a-f]{16})?-?([01])?[ \\t]*$");function $n(e){if(!e)return;const t=e.match(Un);if(!t)return;let n;return"1"===t[3]?n=!0:"0"===t[3]&&(n=!1),{traceId:t[1],parentSampled:n,parentSpanId:t[2]}}function Fn(e,t){const n=$n(e),r=Pn(t),{traceId:o,parentSpanId:s,parentSampled:i}=n||{};return n?{traceId:o||ft(),parentSpanId:s||ft().substring(16),spanId:ft().substring(16),sampled:i,dsc:r||{}}:{traceId:o||ft(),spanId:ft().substring(16)}}function jn(e=ft(),t=ft().substring(16),n){let r="";return void 0!==n&&(r=n?"-1":"-0"),`${e}-${t}${r}`}function Gn(e,t=[]){return[e,t]}function Vn(e,t){const[n,r]=e;return[n,[...r,t]]}function qn(e,t){const n=e[1];for(const e of n){if(t(e,e[0].type))return!0}return!1}function Wn(e,t){return(t||new TextEncoder).encode(e)}function Bn(e,t){const[n,r]=e;let o=JSON.stringify(n);function s(e){"string"==typeof o?o="string"==typeof e?o+e:[Wn(o,t),e]:o.push("string"==typeof e?Wn(e,t):e)}for(const e of r){const[t,n]=e;if(s(`\n${JSON.stringify(t)}\n`),"string"==typeof n||n instanceof Uint8Array)s(n);else{let e;try{e=JSON.stringify(n)}catch(t){e=JSON.stringify(nn(n))}s(e)}}return"string"==typeof o?o:function(e){const t=e.reduce(((e,t)=>e+t.length),0),n=new Uint8Array(t);let r=0;for(const t of e)n.set(t,r),r+=t.length;return n}(o)}function Hn(e,t){const n="string"==typeof e.data?Wn(e.data,t):e.data;return[Ze({type:"attachment",length:n.length,filename:e.filename,content_type:e.contentType,attachment_type:e.attachmentType}),n]}const Jn={session:"session",sessions:"session",attachment:"attachment",transaction:"transaction",event:"error",client_report:"internal",user_report:"default",profile:"profile",replay_event:"replay",replay_recording:"replay",check_in:"monitor",feedback:"feedback",span:"span",statsd:"metric_bucket"};function zn(e){return Jn[e]}function Yn(e){if(!e||!e.sdk)return;const{name:t,version:n}=e.sdk;return{name:t,version:n}}function Xn(e,t,n,r){const o=e.sdkProcessingMetadata&&e.sdkProcessingMetadata.dynamicSamplingContext;return{event_id:e.event_id,sent_at:(new Date).toISOString(),...t&&{sdk:t},...!!n&&r&&{dsn:Ge(r)},...o&&{trace:Ze({...o})}}}const Kn=6e4;function Qn(e,t=Date.now()){const n=parseInt(`${e}`,10);if(!isNaN(n))return 1e3*n;const r=Date.parse(`${e}`);return isNaN(r)?Kn:r-t}function Zn(e,t,n=Date.now()){return function(e,t){return e[t]||e.all||0}(e,t)>n}function er(e,{statusCode:t,headers:n},r=Date.now()){const o={...e},s=n&&n["x-sentry-rate-limits"],i=n&&n["retry-after"];if(s)for(const e of s.trim().split(",")){const[t,n,,,s]=e.split(":",5),i=parseInt(t,10),a=1e3*(isNaN(i)?60:i);if(n)for(const e of n.split(";"))"metric_bucket"===e&&s&&!s.split(";").includes("custom")||(o[e]=r+a);else o.all=r+a}else i?o.all=r+Qn(i,r):429===t&&(o.all=r+6e4);return o}function tr(e,t){const n={type:t.name||t.constructor.name,value:t.message},r=function(e,t){return e(t.stack||"",1)}(e,t);return r.length&&(n.stacktrace={frames:r}),n}function nr(e){let t,n=e[0],r=1;for(;r<e.length;){const o=e[r],s=e[r+1];if(r+=2,("optionalAccess"===o||"optionalCall"===o)&&null==n)return;"access"===o||"optionalAccess"===o?(t=n,n=s(n)):"call"!==o&&"optionalCall"!==o||(n=s(((...e)=>n.call(t,...e))),t=void 0)}return n}const rr="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__,or="production";function sr(){return Re("globalEventProcessors",(()=>[]))}function ir(e){sr().push(e)}function ar(e,t,n,r=0){return new hn(((o,s)=>{const i=e[r];if(null===t||"function"!=typeof i)o(t);else{const a=i({...t},n);rr&&i.id&&null===a&&Fe.log(`Event processor "${i.id}" dropped event`),pe(a)?a.then((t=>ar(e,t,n,r+1).then(o))).then(null,s):ar(e,a,n,r+1).then(o).then(null,s)}}))}function cr(e){const t=kn(),n={sid:ft(),init:!0,timestamp:t,started:t,duration:0,status:"ok",errors:0,ignoreDuration:!1,toJSON:()=>function(e){return Ze({sid:`${e.sid}`,init:e.init,started:new Date(1e3*e.started).toISOString(),timestamp:new Date(1e3*e.timestamp).toISOString(),status:e.status,errors:e.errors,did:"number"==typeof e.did||"string"==typeof e.did?`${e.did}`:void 0,duration:e.duration,abnormal_mechanism:e.abnormal_mechanism,attrs:{release:e.release,environment:e.environment,ip_address:e.ipAddress,user_agent:e.userAgent}})}(n)};return e&&lr(n,e),n}function lr(e,t={}){if(t.user&&(!e.ipAddress&&t.user.ip_address&&(e.ipAddress=t.user.ip_address),e.did||t.did||(e.did=t.user.id||t.user.email||t.user.username)),e.timestamp=t.timestamp||kn(),t.abnormal_mechanism&&(e.abnormal_mechanism=t.abnormal_mechanism),t.ignoreDuration&&(e.ignoreDuration=t.ignoreDuration),t.sid&&(e.sid=32===t.sid.length?t.sid:ft()),void 0!==t.init&&(e.init=t.init),!e.did&&t.did&&(e.did=`${t.did}`),"number"==typeof t.started&&(e.started=t.started),e.ignoreDuration)e.duration=void 0;else if("number"==typeof t.duration)e.duration=t.duration;else{const t=e.timestamp-e.started;e.duration=t>=0?t:0}t.release&&(e.release=t.release),t.environment&&(e.environment=t.environment),!e.ipAddress&&t.ipAddress&&(e.ipAddress=t.ipAddress),!e.userAgent&&t.userAgent&&(e.userAgent=t.userAgent),"number"==typeof t.errors&&(e.errors=t.errors),t.status&&(e.status=t.status)}function ur(e,t){let n={};t?n={status:t}:"ok"===e.status&&(n={status:"exited"}),lr(e,n)}const dr=1;function pr(e){const{spanId:t,traceId:n}=e.spanContext(),{data:r,op:o,parent_span_id:s,status:i,tags:a,origin:c}=mr(e);return Ze({data:r,op:o,parent_span_id:s,span_id:t,status:i,tags:a,trace_id:n,origin:c})}function hr(e){const{traceId:t,spanId:n}=e.spanContext();return jn(t,n,yr(e))}function fr(e){return"number"==typeof e?gr(e):Array.isArray(e)?e[0]+e[1]/1e9:e instanceof Date?gr(e.getTime()):kn()}function gr(e){return e>9999999999?e/1e3:e}function mr(e){return function(e){return"function"==typeof e.getSpanJSON}(e)?e.getSpanJSON():"function"==typeof e.toJSON?e.toJSON():{}}function yr(e){const{traceFlags:t}=e.spanContext();return Boolean(t&dr)}function _r(e,t,n,r,o,s){const{normalizeDepth:i=3,normalizeMaxBreadth:a=1e3}=e,c={...t,event_id:t.event_id||n.event_id||ft(),timestamp:t.timestamp||Rn()},l=n.integrations||e.integrations.map((e=>e.name));!function(e,t){const{environment:n,release:r,dist:o,maxValueLength:s=250}=t;"environment"in e||(e.environment="environment"in t?n:or);void 0===e.release&&void 0!==r&&(e.release=r);void 0===e.dist&&void 0!==o&&(e.dist=o);e.message&&(e.message=me(e.message,s));const i=e.exception&&e.exception.values&&e.exception.values[0];i&&i.value&&(i.value=me(i.value,s));const a=e.request;a&&a.url&&(a.url=me(a.url,s))}(c,e),function(e,t){t.length>0&&(e.sdk=e.sdk||{},e.sdk.integrations=[...e.sdk.integrations||[],...t])}(c,l),void 0===t.type&&function(e,t){const n=Ie._sentryDebugIds;if(!n)return;let r;const o=vr.get(t);o?r=o:(r=new Map,vr.set(t,r));const s=Object.keys(n).reduce(((e,o)=>{let s;const i=r.get(o);i?s=i:(s=t(o),r.set(o,s));for(let t=s.length-1;t>=0;t--){const r=s[t];if(r.filename){e[r.filename]=n[o];break}}return e}),{});try{e.exception.values.forEach((e=>{e.stacktrace.frames.forEach((e=>{e.filename&&(e.debug_id=s[e.filename])}))}))}catch(e){}}(c,e.stackParser);const u=function(e,t){if(!t)return e;const n=e?e.clone():new Gr;return n.update(t),n}(r,n.captureContext);n.mechanism&&_t(c,n.mechanism);const d=o&&o.getEventProcessors?o.getEventProcessors():[],p=function(){jr||(jr=new Gr);return jr}().getScopeData();if(s){$r(p,s.getScopeData())}if(u){$r(p,u.getScopeData())}const h=[...n.attachments||[],...p.attachments];h.length&&(n.attachments=h),Ur(c,p);return ar([...d,...sr(),...p.eventProcessors],c,n).then((e=>(e&&function(e){const t={};try{e.exception.values.forEach((e=>{e.stacktrace.frames.forEach((e=>{e.debug_id&&(e.abs_path?t[e.abs_path]=e.debug_id:e.filename&&(t[e.filename]=e.debug_id),delete e.debug_id)}))}))}catch(e){}if(0===Object.keys(t).length)return;e.debug_meta=e.debug_meta||{},e.debug_meta.images=e.debug_meta.images||[];const n=e.debug_meta.images;Object.keys(t).forEach((e=>{n.push({type:"sourcemap",code_file:e,debug_id:t[e]})}))}(e),"number"==typeof i&&i>0?function(e,t,n){if(!e)return null;const r={...e,...e.breadcrumbs&&{breadcrumbs:e.breadcrumbs.map((e=>({...e,...e.data&&{data:nn(e.data,t,n)}})))},...e.user&&{user:nn(e.user,t,n)},...e.contexts&&{contexts:nn(e.contexts,t,n)},...e.extra&&{extra:nn(e.extra,t,n)}};e.contexts&&e.contexts.trace&&r.contexts&&(r.contexts.trace=e.contexts.trace,e.contexts.trace.data&&(r.contexts.trace.data=nn(e.contexts.trace.data,t,n)));e.spans&&(r.spans=e.spans.map((e=>{const r=mr(e).data;return r&&(e.data=nn(r,t,n)),e})));return r}(e,i,a):e)))}const vr=new WeakMap;function Sr(e){if(e)return function(e){return e instanceof Gr||"function"==typeof e}(e)||function(e){return Object.keys(e).some((e=>Tr.includes(e)))}(e)?{captureContext:e}:e}const Tr=["user","level","extra","contexts","tags","fingerprint","requestSession","propagationContext"];function br(e,t){return Yr().captureException(e,Sr(t))}function wr(e,t){const n="string"==typeof t?t:void 0,r="string"!=typeof t?{captureContext:t}:void 0;return Yr().captureMessage(e,n,r)}function Er(e,t){return Yr().captureEvent(e,t)}function Ir(e,t){Yr().addBreadcrumb(e,t)}function Ar(e,t){Yr().setContext(e,t)}function Rr(...e){const t=Yr();if(2===e.length){const[n,r]=e;return n?t.withScope((()=>(t.getStackTop().scope=n,r(n)))):t.withScope(r)}return t.withScope(e[0])}function kr(){return Yr().getClient()}function Cr(){return Yr().getScope()}function xr(e){const t=kr(),n=Xr(),r=Cr(),{release:o,environment:s=or}=t&&t.getOptions()||{},{userAgent:i}=Ie.navigator||{},a=cr({release:o,environment:s,user:r.getUser()||n.getUser(),...i&&{userAgent:i},...e}),c=n.getSession();return c&&"ok"===c.status&&lr(c,{status:"exited"}),Or(),n.setSession(a),r.setSession(a),a}function Or(){const e=Xr(),t=Cr(),n=t.getSession()||e.getSession();n&&ur(n),Lr(),e.setSession(),t.setSession()}function Lr(){const e=Xr(),t=Cr(),n=kr(),r=t.getSession()||e.getSession();r&&n&&n.captureSession&&n.captureSession(r)}function Nr(e=!1){e?Or():Lr()}function Pr(e){return e.transaction}function Dr(e,t,n){const r=t.getOptions(),{publicKey:o}=t.getDsn()||{},{segment:s}=n&&n.getUser()||{},i=Ze({environment:r.environment||or,release:r.release,user_segment:s,public_key:o,trace_id:e});return t.emit&&t.emit("createDsc",i),i}function Mr(e){const t=kr();if(!t)return{};const n=Dr(mr(e).trace_id||"",t,Cr()),r=Pr(e);if(!r)return n;const o=r&&r._frozenDynamicSamplingContext;if(o)return o;const{sampleRate:s,source:i}=r.metadata;null!=s&&(n.sample_rate=`${s}`);const a=mr(r);return i&&"url"!==i&&(n.transaction=a.description),n.sampled=String(yr(r)),t.emit&&t.emit("createDsc",n),n}function Ur(e,t){const{fingerprint:n,span:r,breadcrumbs:o,sdkProcessingMetadata:s}=t;!function(e,t){const{extra:n,tags:r,user:o,contexts:s,level:i,transactionName:a}=t,c=Ze(n);c&&Object.keys(c).length&&(e.extra={...c,...e.extra});const l=Ze(r);l&&Object.keys(l).length&&(e.tags={...l,...e.tags});const u=Ze(o);u&&Object.keys(u).length&&(e.user={...u,...e.user});const d=Ze(s);d&&Object.keys(d).length&&(e.contexts={...d,...e.contexts});i&&(e.level=i);a&&(e.transaction=a)}(e,t),r&&function(e,t){e.contexts={trace:pr(t),...e.contexts};const n=Pr(t);if(n){e.sdkProcessingMetadata={dynamicSamplingContext:Mr(t),...e.sdkProcessingMetadata};const r=mr(n).description;r&&(e.tags={transaction:r,...e.tags})}}(e,r),function(e,t){e.fingerprint=e.fingerprint?St(e.fingerprint):[],t&&(e.fingerprint=e.fingerprint.concat(t));e.fingerprint&&!e.fingerprint.length&&delete e.fingerprint}(e,n),function(e,t){const n=[...e.breadcrumbs||[],...t];e.breadcrumbs=n.length?n:void 0}(e,o),function(e,t){e.sdkProcessingMetadata={...e.sdkProcessingMetadata,...t}}(e,s)}function $r(e,t){const{extra:n,tags:r,user:o,contexts:s,level:i,sdkProcessingMetadata:a,breadcrumbs:c,fingerprint:l,eventProcessors:u,attachments:d,propagationContext:p,transactionName:h,span:f}=t;Fr(e,"extra",n),Fr(e,"tags",r),Fr(e,"user",o),Fr(e,"contexts",s),Fr(e,"sdkProcessingMetadata",a),i&&(e.level=i),h&&(e.transactionName=h),f&&(e.span=f),c.length&&(e.breadcrumbs=[...e.breadcrumbs,...c]),l.length&&(e.fingerprint=[...e.fingerprint,...l]),u.length&&(e.eventProcessors=[...e.eventProcessors,...u]),d.length&&(e.attachments=[...e.attachments,...d]),e.propagationContext={...e.propagationContext,...p}}function Fr(e,t,n){if(n&&Object.keys(n).length){e[t]={...e[t]};for(const r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[t][r]=n[r])}}let jr;class Gr{constructor(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._attachments=[],this._user={},this._tags={},this._extra={},this._contexts={},this._sdkProcessingMetadata={},this._propagationContext=Vr()}static clone(e){return e?e.clone():new Gr}clone(){const e=new Gr;return e._breadcrumbs=[...this._breadcrumbs],e._tags={...this._tags},e._extra={...this._extra},e._contexts={...this._contexts},e._user=this._user,e._level=this._level,e._span=this._span,e._session=this._session,e._transactionName=this._transactionName,e._fingerprint=this._fingerprint,e._eventProcessors=[...this._eventProcessors],e._requestSession=this._requestSession,e._attachments=[...this._attachments],e._sdkProcessingMetadata={...this._sdkProcessingMetadata},e._propagationContext={...this._propagationContext},e._client=this._client,e}setClient(e){this._client=e}getClient(){return this._client}addScopeListener(e){this._scopeListeners.push(e)}addEventProcessor(e){return this._eventProcessors.push(e),this}setUser(e){return this._user=e||{email:void 0,id:void 0,ip_address:void 0,segment:void 0,username:void 0},this._session&&lr(this._session,{user:e}),this._notifyScopeListeners(),this}getUser(){return this._user}getRequestSession(){return this._requestSession}setRequestSession(e){return this._requestSession=e,this}setTags(e){return this._tags={...this._tags,...e},this._notifyScopeListeners(),this}setTag(e,t){return this._tags={...this._tags,[e]:t},this._notifyScopeListeners(),this}setExtras(e){return this._extra={...this._extra,...e},this._notifyScopeListeners(),this}setExtra(e,t){return this._extra={...this._extra,[e]:t},this._notifyScopeListeners(),this}setFingerprint(e){return this._fingerprint=e,this._notifyScopeListeners(),this}setLevel(e){return this._level=e,this._notifyScopeListeners(),this}setTransactionName(e){return this._transactionName=e,this._notifyScopeListeners(),this}setContext(e,t){return null===t?delete this._contexts[e]:this._contexts[e]=t,this._notifyScopeListeners(),this}setSpan(e){return this._span=e,this._notifyScopeListeners(),this}getSpan(){return this._span}getTransaction(){const e=this._span;return e&&e.transaction}setSession(e){return e?this._session=e:delete this._session,this._notifyScopeListeners(),this}getSession(){return this._session}update(e){if(!e)return this;const t="function"==typeof e?e(this):e;if(t instanceof Gr){const e=t.getScopeData();this._tags={...this._tags,...e.tags},this._extra={...this._extra,...e.extra},this._contexts={...this._contexts,...e.contexts},e.user&&Object.keys(e.user).length&&(this._user=e.user),e.level&&(this._level=e.level),e.fingerprint.length&&(this._fingerprint=e.fingerprint),t.getRequestSession()&&(this._requestSession=t.getRequestSession()),e.propagationContext&&(this._propagationContext=e.propagationContext)}else if(le(t)){const t=e;this._tags={...this._tags,...t.tags},this._extra={...this._extra,...t.extra},this._contexts={...this._contexts,...t.contexts},t.user&&(this._user=t.user),t.level&&(this._level=t.level),t.fingerprint&&(this._fingerprint=t.fingerprint),t.requestSession&&(this._requestSession=t.requestSession),t.propagationContext&&(this._propagationContext=t.propagationContext)}return this}clear(){return this._breadcrumbs=[],this._tags={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._requestSession=void 0,this._span=void 0,this._session=void 0,this._notifyScopeListeners(),this._attachments=[],this._propagationContext=Vr(),this}addBreadcrumb(e,t){const n="number"==typeof t?t:100;if(n<=0)return this;const r={timestamp:Rn(),...e},o=this._breadcrumbs;return o.push(r),this._breadcrumbs=o.length>n?o.slice(-n):o,this._notifyScopeListeners(),this}getLastBreadcrumb(){return this._breadcrumbs[this._breadcrumbs.length-1]}clearBreadcrumbs(){return this._breadcrumbs=[],this._notifyScopeListeners(),this}addAttachment(e){return this._attachments.push(e),this}getAttachments(){return this.getScopeData().attachments}clearAttachments(){return this._attachments=[],this}getScopeData(){const{_breadcrumbs:e,_attachments:t,_contexts:n,_tags:r,_extra:o,_user:s,_level:i,_fingerprint:a,_eventProcessors:c,_propagationContext:l,_sdkProcessingMetadata:u,_transactionName:d,_span:p}=this;return{breadcrumbs:e,attachments:t,contexts:n,tags:r,extra:o,user:s,level:i,fingerprint:a||[],eventProcessors:c,propagationContext:l,sdkProcessingMetadata:u,transactionName:d,span:p}}applyToEvent(e,t={},n=[]){Ur(e,this.getScopeData());return ar([...n,...sr(),...this._eventProcessors],e,t)}setSDKProcessingMetadata(e){return this._sdkProcessingMetadata={...this._sdkProcessingMetadata,...e},this}setPropagationContext(e){return this._propagationContext=e,this}getPropagationContext(){return this._propagationContext}captureException(e,t){const n=t&&t.event_id?t.event_id:ft();if(!this._client)return Fe.warn("No client configured on scope - will not capture exception!"),n;const r=new Error("Sentry syntheticException");return this._client.captureException(e,{originalException:e,syntheticException:r,...t,event_id:n},this),n}captureMessage(e,t,n){const r=n&&n.event_id?n.event_id:ft();if(!this._client)return Fe.warn("No client configured on scope - will not capture message!"),r;const o=new Error(e);return this._client.captureMessage(e,t,{originalException:e,syntheticException:o,...n,event_id:r},this),r}captureEvent(e,t){const n=t&&t.event_id?t.event_id:ft();return this._client?(this._client.captureEvent(e,{...t,event_id:n},this),n):(Fe.warn("No client configured on scope - will not capture event!"),n)}_notifyScopeListeners(){this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach((e=>{e(this)})),this._notifyingListeners=!1)}}function Vr(){return{traceId:ft(),spanId:ft().substring(16)}}const qr="7.116.0",Wr=parseFloat(qr),Br=100;class Hr{constructor(e,t,n,r=Wr){let o,s;this._version=r,t?o=t:(o=new Gr,o.setClient(e)),n?s=n:(s=new Gr,s.setClient(e)),this._stack=[{scope:o}],e&&this.bindClient(e),this._isolationScope=s}isOlderThan(e){return this._version<e}bindClient(e){const t=this.getStackTop();t.client=e,t.scope.setClient(e),e&&e.setupIntegrations&&e.setupIntegrations()}pushScope(){const e=this.getScope().clone();return this.getStack().push({client:this.getClient(),scope:e}),e}popScope(){return!(this.getStack().length<=1)&&!!this.getStack().pop()}withScope(e){const t=this.pushScope();let n;try{n=e(t)}catch(e){throw this.popScope(),e}return pe(n)?n.then((e=>(this.popScope(),e)),(e=>{throw this.popScope(),e})):(this.popScope(),n)}getClient(){return this.getStackTop().client}getScope(){return this.getStackTop().scope}getIsolationScope(){return this._isolationScope}getStack(){return this._stack}getStackTop(){return this._stack[this._stack.length-1]}captureException(e,t){const n=this._lastEventId=t&&t.event_id?t.event_id:ft(),r=new Error("Sentry syntheticException");return this.getScope().captureException(e,{originalException:e,syntheticException:r,...t,event_id:n}),n}captureMessage(e,t,n){const r=this._lastEventId=n&&n.event_id?n.event_id:ft(),o=new Error(e);return this.getScope().captureMessage(e,t,{originalException:e,syntheticException:o,...n,event_id:r}),r}captureEvent(e,t){const n=t&&t.event_id?t.event_id:ft();return e.type||(this._lastEventId=n),this.getScope().captureEvent(e,{...t,event_id:n}),n}lastEventId(){return this._lastEventId}addBreadcrumb(e,t){const{scope:n,client:r}=this.getStackTop();if(!r)return;const{beforeBreadcrumb:o=null,maxBreadcrumbs:s=Br}=r.getOptions&&r.getOptions()||{};if(s<=0)return;const i={timestamp:Rn(),...e},a=o?$e((()=>o(i,t))):i;null!==a&&(r.emit&&r.emit("beforeAddBreadcrumb",a,t),n.addBreadcrumb(a,s))}setUser(e){this.getScope().setUser(e),this.getIsolationScope().setUser(e)}setTags(e){this.getScope().setTags(e),this.getIsolationScope().setTags(e)}setExtras(e){this.getScope().setExtras(e),this.getIsolationScope().setExtras(e)}setTag(e,t){this.getScope().setTag(e,t),this.getIsolationScope().setTag(e,t)}setExtra(e,t){this.getScope().setExtra(e,t),this.getIsolationScope().setExtra(e,t)}setContext(e,t){this.getScope().setContext(e,t),this.getIsolationScope().setContext(e,t)}configureScope(e){const{scope:t,client:n}=this.getStackTop();n&&e(t)}run(e){const t=zr(this);try{e(this)}finally{zr(t)}}getIntegration(e){const t=this.getClient();if(!t)return null;try{return t.getIntegration(e)}catch(t){return rr&&Fe.warn(`Cannot retrieve integration ${e.id} from the current Hub`),null}}startTransaction(e,t){const n=this._callExtensionMethod("startTransaction",e,t);if(rr&&!n){this.getClient()?Fe.warn("Tracing extension 'startTransaction' has not been added. Call 'addTracingExtensions' before calling 'init':\nSentry.addTracingExtensions();\nSentry.init({...});\n"):Fe.warn("Tracing extension 'startTransaction' is missing. You should 'init' the SDK before calling 'startTransaction'")}return n}traceHeaders(){return this._callExtensionMethod("traceHeaders")}captureSession(e=!1){if(e)return this.endSession();this._sendSessionUpdate()}endSession(){const e=this.getStackTop().scope,t=e.getSession();t&&ur(t),this._sendSessionUpdate(),e.setSession()}startSession(e){const{scope:t,client:n}=this.getStackTop(),{release:r,environment:o=or}=n&&n.getOptions()||{},{userAgent:s}=Ie.navigator||{},i=cr({release:r,environment:o,user:t.getUser(),...s&&{userAgent:s},...e}),a=t.getSession&&t.getSession();return a&&"ok"===a.status&&lr(a,{status:"exited"}),this.endSession(),t.setSession(i),i}shouldSendDefaultPii(){const e=this.getClient(),t=e&&e.getOptions();return Boolean(t&&t.sendDefaultPii)}_sendSessionUpdate(){const{scope:e,client:t}=this.getStackTop(),n=e.getSession();n&&t&&t.captureSession&&t.captureSession(n)}_callExtensionMethod(e,...t){const n=Jr().__SENTRY__;if(n&&n.extensions&&"function"==typeof n.extensions[e])return n.extensions[e].apply(this,t);rr&&Fe.warn(`Extension method ${e} couldn't be found, doing nothing.`)}}function Jr(){return Ie.__SENTRY__=Ie.__SENTRY__||{extensions:{},hub:void 0},Ie}function zr(e){const t=Jr(),n=Qr(t);return Zr(t,e),n}function Yr(){const e=Jr();if(e.__SENTRY__&&e.__SENTRY__.acs){const t=e.__SENTRY__.acs.getCurrentHub();if(t)return t}return function(e=Jr()){t=e,t&&t.__SENTRY__&&t.__SENTRY__.hub&&!Qr(e).isOlderThan(Wr)||Zr(e,new Hr);var t;return Qr(e)}(e)}function Xr(){return Yr().getIsolationScope()}function Kr(e,t={}){const n=Jr();return n.__SENTRY__&&n.__SENTRY__.acs?n.__SENTRY__.acs.runWithAsyncContext(e,t):e()}function Qr(e){return Re("hub",(()=>new Hr),e)}function Zr(e,t){if(!e)return!1;return(e.__SENTRY__=e.__SENTRY__||{}).hub=t,!0}function eo(e){return(e||Yr()).getScope().getTransaction()}const to=$n;let no=!1;function ro(){const e=eo();if(e){const t="internal_error";rr&&Fe.log(`[Tracing] Transaction: ${t} -> Global error occured`),e.setStatus(t)}}var oo;function so(e){if(e<400&&e>=100)return"ok";if(e>=400&&e<500)switch(e){case 401:return"unauthenticated";case 403:return"permission_denied";case 404:return"not_found";case 409:return"already_exists";case 413:return"failed_precondition";case 429:return"resource_exhausted";default:return"invalid_argument"}if(e>=500&&e<600)switch(e){case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline_exceeded";default:return"internal_error"}return"unknown_error"}ro.tag="sentry_tracingErrorCallback",function(e){e.Ok="ok";e.DeadlineExceeded="deadline_exceeded";e.Unauthenticated="unauthenticated";e.PermissionDenied="permission_denied";e.NotFound="not_found";e.ResourceExhausted="resource_exhausted";e.InvalidArgument="invalid_argument";e.Unimplemented="unimplemented";e.Unavailable="unavailable";e.InternalError="internal_error";e.UnknownError="unknown_error";e.Cancelled="cancelled";e.AlreadyExists="already_exists";e.FailedPrecondition="failed_precondition";e.Aborted="aborted";e.OutOfRange="out_of_range";e.DataLoss="data_loss"}(oo||(oo={}));const io=so;function ao(e,t){e.setTag("http.status_code",String(t)),e.setData("http.response.status_code",t);const n=so(t);"unknown_error"!==n&&e.setStatus(n)}function co(e,t,n=(()=>{})){let r;try{r=e()}catch(e){throw t(e),n(),e}return function(e,t,n){if(pe(e))return e.then((e=>(n(),e)),(e=>{throw t(e),n(),e}));return n(),e}(r,t,n)}function lo(e){if("boolean"==typeof __SENTRY_TRACING__&&!__SENTRY_TRACING__)return!1;const t=kr(),n=e||t&&t.getOptions();return!!n&&(n.enableTracing||"tracesSampleRate"in n||"tracesSampler"in n)}function uo(e,t){const n=go(e);return Kr((()=>Rr(e.scope,(r=>{const o=Yr(),s=r.getSpan(),i=e.onlyIfParent&&!s?void 0:fo(o,{parentSpan:s,spanContext:n,forceTransaction:e.forceTransaction,scope:r});return co((()=>t(i)),(()=>{if(i){const{status:e}=mr(i);e&&"ok"!==e||i.setStatus("internal_error")}}),(()=>i&&i.end()))}))))}function po(e){if(!lo())return;const t=go(e),n=Yr(),r=e.scope?e.scope.getSpan():ho();if(e.onlyIfParent&&!r)return;const o=(e.scope||Cr()).clone();return fo(n,{parentSpan:r,spanContext:t,forceTransaction:e.forceTransaction,scope:o})}function ho(){return Cr().getSpan()}function fo(e,{parentSpan:t,spanContext:n,forceTransaction:r,scope:o}){if(!lo())return;const s=Xr();let i;if(t&&!r)i=t.startChild(n);else if(t){const r=Mr(t),{traceId:o,spanId:s}=t.spanContext(),a=yr(t);i=e.startTransaction({traceId:o,parentSpanId:s,parentSampled:a,...n,metadata:{dynamicSamplingContext:r,...n.metadata}})}else{const{traceId:t,dsc:r,parentSpanId:a,sampled:c}={...s.getPropagationContext(),...o.getPropagationContext()};i=e.startTransaction({traceId:t,parentSpanId:a,parentSampled:c,...n,metadata:{dynamicSamplingContext:r,...n.metadata}})}return o.setSpan(i),function(e,t,n){e&&(Je(e,yo,n),Je(e,mo,t))}(i,o,s),i}function go(e){if(e.startTime){const t={...e};return t.startTimestamp=fr(e.startTime),delete t.startTime,t}return e}const mo="_sentryScope",yo="_sentryIsolationScope";let _o;function vo(e){return _o?_o.get(e):void 0}function So(e){const t=vo(e);if(!t)return;const n={};for(const[,[e,r]]of t)n[e]||(n[e]=[]),n[e].push(Ze(r));return n}const To="sentry.source",bo="sentry.sample_rate",wo="sentry.op",Eo="sentry.origin";class Io{constructor(e=1e3){this._maxlen=e,this.spans=[]}add(e){this.spans.length>this._maxlen?e.spanRecorder=void 0:this.spans.push(e)}}class Ao{constructor(e={}){this._traceId=e.traceId||ft(),this._spanId=e.spanId||ft().substring(16),this._startTime=e.startTimestamp||kn(),this.tags=e.tags?{...e.tags}:{},this.data=e.data?{...e.data}:{},this.instrumenter=e.instrumenter||"sentry",this._attributes={},this.setAttributes({[Eo]:e.origin||"manual",[wo]:e.op,...e.attributes}),this._name=e.name||e.description,e.parentSpanId&&(this._parentSpanId=e.parentSpanId),"sampled"in e&&(this._sampled=e.sampled),e.status&&(this._status=e.status),e.endTimestamp&&(this._endTime=e.endTimestamp),void 0!==e.exclusiveTime&&(this._exclusiveTime=e.exclusiveTime),this._measurements=e.measurements?{...e.measurements}:{}}get name(){return this._name||""}set name(e){this.updateName(e)}get description(){return this._name}set description(e){this._name=e}get traceId(){return this._traceId}set traceId(e){this._traceId=e}get spanId(){return this._spanId}set spanId(e){this._spanId=e}set parentSpanId(e){this._parentSpanId=e}get parentSpanId(){return this._parentSpanId}get sampled(){return this._sampled}set sampled(e){this._sampled=e}get attributes(){return this._attributes}set attributes(e){this._attributes=e}get startTimestamp(){return this._startTime}set startTimestamp(e){this._startTime=e}get endTimestamp(){return this._endTime}set endTimestamp(e){this._endTime=e}get status(){return this._status}set status(e){this._status=e}get op(){return this._attributes[wo]}set op(e){this.setAttribute(wo,e)}get origin(){return this._attributes[Eo]}set origin(e){this.setAttribute(Eo,e)}spanContext(){const{_spanId:e,_traceId:t,_sampled:n}=this;return{spanId:e,traceId:t,traceFlags:n?dr:0}}startChild(e){const t=new Ao({...e,parentSpanId:this._spanId,sampled:this._sampled,traceId:this._traceId});t.spanRecorder=this.spanRecorder,t.spanRecorder&&t.spanRecorder.add(t);const n=Pr(this);if(t.transaction=n,rr&&n){const r=`[Tracing] Starting '${e&&e.op||"< unknown op >"}' span on transaction '${mr(t).description||"< unknown name >"}' (${n.spanContext().spanId}).`;Fe.log(r),this._logMessage=r}return t}setTag(e,t){return this.tags={...this.tags,[e]:t},this}setData(e,t){return this.data={...this.data,[e]:t},this}setAttribute(e,t){void 0===t?delete this._attributes[e]:this._attributes[e]=t}setAttributes(e){Object.keys(e).forEach((t=>this.setAttribute(t,e[t])))}setStatus(e){return this._status=e,this}setHttpStatus(e){return ao(this,e),this}setName(e){this.updateName(e)}updateName(e){return this._name=e,this}isSuccess(){return"ok"===this._status}finish(e){return this.end(e)}end(e){if(this._endTime)return;const t=Pr(this);if(rr&&t&&t.spanContext().spanId!==this._spanId){const e=this._logMessage;e&&Fe.log(e.replace("Starting","Finishing"))}this._endTime=fr(e)}toTraceparent(){return hr(this)}toContext(){return Ze({data:this._getData(),description:this._name,endTimestamp:this._endTime,op:this.op,parentSpanId:this._parentSpanId,sampled:this._sampled,spanId:this._spanId,startTimestamp:this._startTime,status:this._status,tags:this.tags,traceId:this._traceId})}updateWithContext(e){return this.data=e.data||{},this._name=e.name||e.description,this._endTime=e.endTimestamp,this.op=e.op,this._parentSpanId=e.parentSpanId,this._sampled=e.sampled,this._spanId=e.spanId||this._spanId,this._startTime=e.startTimestamp||this._startTime,this._status=e.status,this.tags=e.tags||{},this._traceId=e.traceId||this._traceId,this}getTraceContext(){return pr(this)}getSpanJSON(){return Ze({data:this._getData(),description:this._name,op:this._attributes[wo],parent_span_id:this._parentSpanId,span_id:this._spanId,start_timestamp:this._startTime,status:this._status,tags:Object.keys(this.tags).length>0?this.tags:void 0,timestamp:this._endTime,trace_id:this._traceId,origin:this._attributes[Eo],_metrics_summary:So(this),profile_id:this._attributes.profile_id,exclusive_time:this._exclusiveTime,measurements:Object.keys(this._measurements).length>0?this._measurements:void 0})}isRecording(){return!this._endTime&&!!this._sampled}toJSON(){return this.getSpanJSON()}_getData(){const{data:e,_attributes:t}=this,n=Object.keys(e).length>0,r=Object.keys(t).length>0;if(n||r)return n&&r?{...e,...t}:n?e:t}}class Ro extends Ao{constructor(e,t){super(e),this._contexts={},this._hub=t||Yr(),this._name=e.name||"",this._metadata={...e.metadata},this._trimEnd=e.trimEnd,this.transaction=this;const n=this._metadata.dynamicSamplingContext;n&&(this._frozenDynamicSamplingContext={...n})}get name(){return this._name}set name(e){this.setName(e)}get metadata(){return{source:"custom",spanMetadata:{},...this._metadata,...this._attributes[To]&&{source:this._attributes[To]},...this._attributes[bo]&&{sampleRate:this._attributes[bo]}}}set metadata(e){this._metadata=e}setName(e,t="custom"){this._name=e,this.setAttribute(To,t)}updateName(e){return this._name=e,this}initSpanRecorder(e=1e3){this.spanRecorder||(this.spanRecorder=new Io(e)),this.spanRecorder.add(this)}setContext(e,t){null===t?delete this._contexts[e]:this._contexts[e]=t}setMeasurement(e,t,n=""){this._measurements[e]={value:t,unit:n}}setMetadata(e){this._metadata={...this._metadata,...e}}end(e){const t=fr(e),n=this._finishTransaction(t);if(n)return this._hub.captureEvent(n)}toContext(){return Ze({...super.toContext(),name:this._name,trimEnd:this._trimEnd})}updateWithContext(e){return super.updateWithContext(e),this._name=e.name||"",this._trimEnd=e.trimEnd,this}getDynamicSamplingContext(){return Mr(this)}setHub(e){this._hub=e}getProfileId(){if(void 0!==this._contexts&&void 0!==this._contexts.profile)return this._contexts.profile.profile_id}_finishTransaction(e){if(void 0!==this._endTime)return;this._name||(rr&&Fe.warn("Transaction has no name, falling back to `<unlabeled transaction>`."),this._name="<unlabeled transaction>"),super.end(e);const t=this._hub.getClient();if(t&&t.emit&&t.emit("finishTransaction",this),!0!==this._sampled)return rr&&Fe.log("[Tracing] Discarding transaction because its trace was not chosen to be sampled."),void(t&&t.recordDroppedEvent("sample_rate","transaction"));const n=this.spanRecorder?this.spanRecorder.spans.filter((e=>e!==this&&mr(e).timestamp)):[];if(this._trimEnd&&n.length>0){const e=n.map((e=>mr(e).timestamp)).filter(Boolean);this._endTime=e.reduce(((e,t)=>e>t?e:t))}const{scope:r,isolationScope:o}={scope:(s=this)[mo],isolationScope:s[yo]};var s;const{metadata:i}=this,{source:a}=i,c={contexts:{...this._contexts,trace:pr(this)},spans:n,start_timestamp:this._startTime,tags:this.tags,timestamp:this._endTime,transaction:this._name,type:"transaction",sdkProcessingMetadata:{...i,capturedSpanScope:r,capturedSpanIsolationScope:o,...Ze({dynamicSamplingContext:Mr(this)})},_metrics_summary:So(this),...a&&{transaction_info:{source:a}}};return Object.keys(this._measurements).length>0&&(rr&&Fe.log("[Measurements] Adding measurements to transaction",JSON.stringify(this._measurements,void 0,2)),c.measurements=this._measurements),rr&&Fe.log(`[Tracing] Finishing ${this.op} transaction: ${this._name}.`),c}}const ko={idleTimeout:1e3,finalTimeout:3e4,heartbeatInterval:5e3},Co=["heartbeatFailed","idleTimeout","documentHidden","finalTimeout","externalFinish","cancelled"];class xo extends Io{constructor(e,t,n,r){super(r),this._pushActivity=e,this._popActivity=t,this.transactionSpanId=n}add(e){if(e.spanContext().spanId!==this.transactionSpanId){const t=e.end;e.end=(...n)=>(this._popActivity(e.spanContext().spanId),t.apply(e,n)),void 0===mr(e).timestamp&&this._pushActivity(e.spanContext().spanId)}super.add(e)}}class Oo extends Ro{constructor(e,t,n=ko.idleTimeout,r=ko.finalTimeout,o=ko.heartbeatInterval,s=!1,i=!1){super(e,t),this._idleHub=t,this._idleTimeout=n,this._finalTimeout=r,this._heartbeatInterval=o,this._onScope=s,this.activities={},this._heartbeatCounter=0,this._finished=!1,this._idleTimeoutCanceledPermanently=!1,this._beforeFinishCallbacks=[],this._finishReason=Co[4],this._autoFinishAllowed=!i,s&&(rr&&Fe.log(`Setting idle transaction on scope. Span ID: ${this.spanContext().spanId}`),t.getScope().setSpan(this)),i||this._restartIdleTimeout(),setTimeout((()=>{this._finished||(this.setStatus("deadline_exceeded"),this._finishReason=Co[3],this.end())}),this._finalTimeout)}end(e){const t=fr(e);if(this._finished=!0,this.activities={},"ui.action.click"===this.op&&this.setAttribute("finishReason",this._finishReason),this.spanRecorder){rr&&Fe.log("[Tracing] finishing IdleTransaction",new Date(1e3*t).toISOString(),this.op);for(const e of this._beforeFinishCallbacks)e(this,t);this.spanRecorder.spans=this.spanRecorder.spans.filter((e=>{if(e.spanContext().spanId===this.spanContext().spanId)return!0;mr(e).timestamp||(e.setStatus("cancelled"),e.end(t),rr&&Fe.log("[Tracing] cancelling span since transaction ended early",JSON.stringify(e,void 0,2)));const{start_timestamp:n,timestamp:r}=mr(e),o=n&&n<t,s=(this._finalTimeout+this._idleTimeout)/1e3,i=r&&n&&r-n<s;if(rr){const t=JSON.stringify(e,void 0,2);o?i||Fe.log("[Tracing] discarding Span since it finished after Transaction final timeout",t):Fe.log("[Tracing] discarding Span since it happened after Transaction was finished",t)}return o&&i})),rr&&Fe.log("[Tracing] flushing IdleTransaction")}else rr&&Fe.log("[Tracing] No active IdleTransaction");if(this._onScope){const e=this._idleHub.getScope();e.getTransaction()===this&&e.setSpan(void 0)}return super.end(e)}registerBeforeFinishCallback(e){this._beforeFinishCallbacks.push(e)}initSpanRecorder(e){if(!this.spanRecorder){const t=e=>{this._finished||this._pushActivity(e)},n=e=>{this._finished||this._popActivity(e)};this.spanRecorder=new xo(t,n,this.spanContext().spanId,e),rr&&Fe.log("Starting heartbeat"),this._pingHeartbeat()}this.spanRecorder.add(this)}cancelIdleTimeout(e,{restartOnChildSpanChange:t}={restartOnChildSpanChange:!0}){this._idleTimeoutCanceledPermanently=!1===t,this._idleTimeoutID&&(clearTimeout(this._idleTimeoutID),this._idleTimeoutID=void 0,0===Object.keys(this.activities).length&&this._idleTimeoutCanceledPermanently&&(this._finishReason=Co[5],this.end(e)))}setFinishReason(e){this._finishReason=e}sendAutoFinishSignal(){this._autoFinishAllowed||(rr&&Fe.log("[Tracing] Received finish signal for idle transaction."),this._restartIdleTimeout(),this._autoFinishAllowed=!0)}_restartIdleTimeout(e){this.cancelIdleTimeout(),this._idleTimeoutID=setTimeout((()=>{this._finished||0!==Object.keys(this.activities).length||(this._finishReason=Co[1],this.end(e))}),this._idleTimeout)}_pushActivity(e){this.cancelIdleTimeout(void 0,{restartOnChildSpanChange:!this._idleTimeoutCanceledPermanently}),rr&&Fe.log(`[Tracing] pushActivity: ${e}`),this.activities[e]=!0,rr&&Fe.log("[Tracing] new activities count",Object.keys(this.activities).length)}_popActivity(e){if(this.activities[e]&&(rr&&Fe.log(`[Tracing] popActivity ${e}`),delete this.activities[e],rr&&Fe.log("[Tracing] new activities count",Object.keys(this.activities).length)),0===Object.keys(this.activities).length){const e=kn();this._idleTimeoutCanceledPermanently?this._autoFinishAllowed&&(this._finishReason=Co[5],this.end(e)):this._restartIdleTimeout(e+this._idleTimeout/1e3)}}_beat(){if(this._finished)return;const e=Object.keys(this.activities).join("");e===this._prevHeartbeatString?this._heartbeatCounter++:this._heartbeatCounter=1,this._prevHeartbeatString=e,this._heartbeatCounter>=3?this._autoFinishAllowed&&(rr&&Fe.log("[Tracing] Transaction finished because of no change for 3 heart beats"),this.setStatus("deadline_exceeded"),this._finishReason=Co[0],this.end()):this._pingHeartbeat()}_pingHeartbeat(){rr&&Fe.log(`pinging Heartbeat -> current counter: ${this._heartbeatCounter}`),setTimeout((()=>{this._beat()}),this._heartbeatInterval)}}function Lo(e,t,n){if(!lo(t))return e.sampled=!1,e;if(void 0!==e.sampled)return e.setAttribute(bo,Number(e.sampled)),e;let r;return"function"==typeof t.tracesSampler?(r=t.tracesSampler(n),e.setAttribute(bo,Number(r))):void 0!==n.parentSampled?r=n.parentSampled:void 0!==t.tracesSampleRate?(r=t.tracesSampleRate,e.setAttribute(bo,Number(r))):(r=1,e.setAttribute(bo,r)),No(r)?r?(e.sampled=Math.random()<r,e.sampled?(rr&&Fe.log(`[Tracing] starting ${e.op} transaction - ${mr(e).description}`),e):(rr&&Fe.log(`[Tracing] Discarding transaction because it's not included in the random sample (sampling rate = ${Number(r)})`),e)):(rr&&Fe.log("[Tracing] Discarding transaction because "+("function"==typeof t.tracesSampler?"tracesSampler returned 0 or false":"a negative sampling decision was inherited or tracesSampleRate is set to 0")),e.sampled=!1,e):(rr&&Fe.warn("[Tracing] Discarding transaction because of invalid sample rate."),e.sampled=!1,e)}function No(e){return he(e)||"number"!=typeof e&&"boolean"!=typeof e?(rr&&Fe.warn(`[Tracing] Given sample rate is invalid. Sample rate must be a boolean or a number between 0 and 1. Got ${JSON.stringify(e)} of type ${JSON.stringify(typeof e)}.`),!1):!(e<0||e>1)||(rr&&Fe.warn(`[Tracing] Given sample rate is invalid. Sample rate must be between 0 and 1. Got ${e}.`),!1)}function Po(){const e=this.getScope().getSpan();return e?{"sentry-trace":hr(e)}:{}}function Do(e,t){const n=this.getClient(),r=n&&n.getOptions()||{},o=r.instrumenter||"sentry",s=e.instrumenter||"sentry";o!==s&&(rr&&Fe.error(`A transaction was started with instrumenter=\`${s}\`, but the SDK is configured with the \`${o}\` instrumenter.\nThe transaction will not be sampled. Please use the ${o} instrumentation to start transactions.`),e.sampled=!1);let i=new Ro(e,this);return i=Lo(i,r,{name:e.name,parentSampled:e.parentSampled,transactionContext:e,attributes:{...e.data,...e.attributes},...t}),i.isRecording()&&i.initSpanRecorder(r._experiments&&r._experiments.maxSpans),n&&n.emit&&n.emit("startTransaction",i),i}function Mo(e,t,n,r,o,s,i,a=!1){const c=e.getClient(),l=c&&c.getOptions()||{};let u=new Oo(t,e,n,r,i,o,a);return u=Lo(u,l,{name:t.name,parentSampled:t.parentSampled,transactionContext:t,attributes:{...t.data,...t.attributes},...s}),u.isRecording()&&u.initSpanRecorder(l._experiments&&l._experiments.maxSpans),c&&c.emit&&c.emit("startTransaction",u),u}function Uo(){const e=Jr();e.__SENTRY__&&(e.__SENTRY__.extensions=e.__SENTRY__.extensions||{},e.__SENTRY__.extensions.startTransaction||(e.__SENTRY__.extensions.startTransaction=Do),e.__SENTRY__.extensions.traceHeaders||(e.__SENTRY__.extensions.traceHeaders=Po),no||(no=!0,$t(ro),Gt(ro)))}function $o(e,t,n){const r=eo();r&&r.setMeasurement(e,t,n)}function Fo(e,t,n,r){const o=Yn(n),s=e.type&&"replay_event"!==e.type?e.type:"event";!function(e,t){t&&(e.sdk=e.sdk||{},e.sdk.name=e.sdk.name||t.name,e.sdk.version=e.sdk.version||t.version,e.sdk.integrations=[...e.sdk.integrations||[],...t.integrations||[]],e.sdk.packages=[...e.sdk.packages||[],...t.packages||[]])}(e,n&&n.sdk);const i=Xn(e,o,r,t);delete e.sdkProcessingMetadata;return Gn(i,[[{type:s},e]])}const jo="7";function Go(e){const t=e.protocol?`${e.protocol}:`:"",n=e.port?`:${e.port}`:"";return`${t}//${e.host}${n}${e.path?`/${e.path}`:""}/api/`}function Vo(e,t){return n={sentry_key:e.publicKey,sentry_version:jo,...t&&{sentry_client:`${t.name}/${t.version}`}},Object.keys(n).map((e=>`${encodeURIComponent(e)}=${encodeURIComponent(n[e])}`)).join("&");var n}function qo(e,t={}){const n="string"==typeof t?t:t.tunnel,r="string"!=typeof t&&t._metadata?t._metadata.sdk:void 0;return n||`${function(e){return`${Go(e)}${e.projectId}/envelope/`}(e)}?${Vo(e,r)}`}const Wo=[];function Bo(e){const t=e.defaultIntegrations||[],n=e.integrations;let r;t.forEach((e=>{e.isDefaultInstance=!0})),r=Array.isArray(n)?[...t,...n]:"function"==typeof n?St(n(t)):t;const o=function(e){const t={};return e.forEach((e=>{const{name:n}=e,r=t[n];r&&!r.isDefaultInstance&&e.isDefaultInstance||(t[n]=e)})),Object.keys(t).map((e=>t[e]))}(r),s=function(e,t){for(let n=0;n<e.length;n++)if(!0===t(e[n]))return n;return-1}(o,(e=>"Debug"===e.name));if(-1!==s){const[e]=o.splice(s,1);o.push(e)}return o}function Ho(e,t){for(const n of t)n&&n.afterAllSetup&&n.afterAllSetup(e)}function Jo(e,t,n){if(n[t.name])rr&&Fe.log(`Integration skipped because it was already installed: ${t.name}`);else{if(n[t.name]=t,-1===Wo.indexOf(t.name)&&(t.setupOnce(ir,Yr),Wo.push(t.name)),t.setup&&"function"==typeof t.setup&&t.setup(e),e.on&&"function"==typeof t.preprocessEvent){const n=t.preprocessEvent.bind(t);e.on("preprocessEvent",((t,r)=>n(t,r,e)))}if(e.addEventProcessor&&"function"==typeof t.processEvent){const n=t.processEvent.bind(t),r=Object.assign(((t,r)=>n(t,r,e)),{id:t.name});e.addEventProcessor(r)}rr&&Fe.log(`Integration installed: ${t.name}`)}}function zo(e,t){return Object.assign((function(...e){return t(...e)}),{id:e})}function Yo(e){return e.replace(/[^\w\-./]+/gi,"")}const Xo=[["\n","\\n"],["\r","\\r"],["\t","\\t"],["\\","\\\\"],["|","\\u{7c}"],[",","\\u{2c}"]];function Ko(e){return[...e].reduce(((e,t)=>e+function(e){for(const[t,n]of Xo)if(e===t)return n;return e}(t)),"")}function Qo(e,t,n,r){const o={sent_at:(new Date).toISOString()};n&&n.sdk&&(o.sdk={name:n.sdk.name,version:n.sdk.version}),r&&t&&(o.dsn=Ge(t));const s=function(e){const t=function(e){let t="";for(const n of e){const e=Object.entries(n.tags),r=e.length>0?`|#${e.map((([e,t])=>`${e}:${t}`)).join(",")}`:"";t+=`${n.name}@${n.unit}:${n.metric}|${n.metricType}${r}|T${n.timestamp}\n`}return t}(e);return[{type:"statsd",length:t.length},t]}(e);return Gn(o,[s])}const Zo="Not capturing exception because it's already been captured.";class es{constructor(e){if(this._options=e,this._integrations={},this._integrationsInitialized=!1,this._numProcessing=0,this._outcomes={},this._hooks={},this._eventProcessors=[],e.dsn?this._dsn=We(e.dsn):rr&&Fe.warn("No DSN provided, client will not send events."),this._dsn){const t=qo(this._dsn,e);this._transport=e.transport({tunnel:this._options.tunnel,recordDroppedEvent:this.recordDroppedEvent.bind(this),...e.transportOptions,url:t})}}captureException(e,t,n){if(vt(e))return void(rr&&Fe.log(Zo));let r=t&&t.event_id;return this._process(this.eventFromException(e,t).then((e=>this._captureEvent(e,t,n))).then((e=>{r=e}))),r}captureMessage(e,t,n,r){let o=n&&n.event_id;const s=ae(e)?e:String(e),i=ce(e)?this.eventFromMessage(s,t,n):this.eventFromException(e,n);return this._process(i.then((e=>this._captureEvent(e,n,r))).then((e=>{o=e}))),o}captureEvent(e,t,n){if(t&&t.originalException&&vt(t.originalException))return void(rr&&Fe.log(Zo));let r=t&&t.event_id;const o=(e.sdkProcessingMetadata||{}).capturedSpanScope;return this._process(this._captureEvent(e,t,o||n).then((e=>{r=e}))),r}captureSession(e){"string"!=typeof e.release?rr&&Fe.warn("Discarded session because of missing or non-string release"):(this.sendSession(e),lr(e,{init:!1}))}getDsn(){return this._dsn}getOptions(){return this._options}getSdkMetadata(){return this._options._metadata}getTransport(){return this._transport}flush(e){const t=this._transport;return t?(this.metricsAggregator&&this.metricsAggregator.flush(),this._isClientDoneProcessing(e).then((n=>t.flush(e).then((e=>n&&e))))):dn(!0)}close(e){return this.flush(e).then((e=>(this.getOptions().enabled=!1,this.metricsAggregator&&this.metricsAggregator.close(),e)))}getEventProcessors(){return this._eventProcessors}addEventProcessor(e){this._eventProcessors.push(e)}setupIntegrations(e){(e&&!this._integrationsInitialized||this._isEnabled()&&!this._integrationsInitialized)&&this._setupIntegrations()}init(){this._isEnabled()&&this._setupIntegrations()}getIntegrationById(e){return this.getIntegrationByName(e)}getIntegrationByName(e){return this._integrations[e]}getIntegration(e){try{return this._integrations[e.id]||null}catch(t){return rr&&Fe.warn(`Cannot retrieve integration ${e.id} from the current Client`),null}}addIntegration(e){const t=this._integrations[e.name];Jo(this,e,this._integrations),t||Ho(this,[e])}sendEvent(e,t={}){this.emit("beforeSendEvent",e,t);let n=Fo(e,this._dsn,this._options._metadata,this._options.tunnel);for(const e of t.attachments||[])n=Vn(n,Hn(e,this._options.transportOptions&&this._options.transportOptions.textEncoder));const r=this._sendEnvelope(n);r&&r.then((t=>this.emit("afterSendEvent",e,t)),null)}sendSession(e){const t=function(e,t,n,r){const o=Yn(n);return Gn({sent_at:(new Date).toISOString(),...o&&{sdk:o},...!!r&&t&&{dsn:Ge(t)}},["aggregates"in e?[{type:"sessions"},e]:[{type:"session"},e.toJSON()]])}(e,this._dsn,this._options._metadata,this._options.tunnel);this._sendEnvelope(t)}recordDroppedEvent(e,t,n){if(this._options.sendClientReports){const n=`${e}:${t}`;rr&&Fe.log(`Adding outcome: "${n}"`),this._outcomes[n]=this._outcomes[n]+1||1}}captureAggregateMetrics(e){rr&&Fe.log(`Flushing aggregated metrics, number of metrics: ${e.length}`);const t=Qo(e,this._dsn,this._options._metadata,this._options.tunnel);this._sendEnvelope(t)}on(e,t){this._hooks[e]||(this._hooks[e]=[]),this._hooks[e].push(t)}emit(e,...t){this._hooks[e]&&this._hooks[e].forEach((e=>e(...t)))}_setupIntegrations(){const{integrations:e}=this._options;this._integrations=function(e,t){const n={};return t.forEach((t=>{t&&Jo(e,t,n)})),n}(this,e),Ho(this,e),this._integrationsInitialized=!0}_updateSessionFromEvent(e,t){let n=!1,r=!1;const o=t.exception&&t.exception.values;if(o){r=!0;for(const e of o){const t=e.mechanism;if(t&&!1===t.handled){n=!0;break}}}const s="ok"===e.status;(s&&0===e.errors||s&&n)&&(lr(e,{...n&&{status:"crashed"},errors:e.errors||Number(r||n)}),this.captureSession(e))}_isClientDoneProcessing(e){return new hn((t=>{let n=0;const r=setInterval((()=>{0==this._numProcessing?(clearInterval(r),t(!0)):(n+=1,e&&n>=e&&(clearInterval(r),t(!1)))}),1)}))}_isEnabled(){return!1!==this.getOptions().enabled&&void 0!==this._transport}_prepareEvent(e,t,n,r=Xr()){const o=this.getOptions(),s=Object.keys(this._integrations);return!t.integrations&&s.length>0&&(t.integrations=s),this.emit("preprocessEvent",e,t),_r(o,e,t,n,this,r).then((e=>{if(null===e)return e;const t={...r.getPropagationContext(),...n?n.getPropagationContext():void 0};if(!(e.contexts&&e.contexts.trace)&&t){const{traceId:r,spanId:o,parentSpanId:s,dsc:i}=t;e.contexts={trace:{trace_id:r,span_id:o,parent_span_id:s},...e.contexts};const a=i||Dr(r,this,n);e.sdkProcessingMetadata={dynamicSamplingContext:a,...e.sdkProcessingMetadata}}return e}))}_captureEvent(e,t={},n){return this._processEvent(e,t,n).then((e=>e.event_id),(e=>{if(rr){const t=e;"log"===t.logLevel?Fe.log(t.message):Fe.warn(t)}}))}_processEvent(e,t,n){const r=this.getOptions(),{sampleRate:o}=r,s=ns(e),i=ts(e),a=e.type||"error",c=`before send for type \`${a}\``;if(i&&"number"==typeof o&&Math.random()>o)return this.recordDroppedEvent("sample_rate","error",e),pn(new Be(`Discarding event because it's not included in the random sample (sampling rate = ${o})`,"log"));const l="replay_event"===a?"replay":a,u=(e.sdkProcessingMetadata||{}).capturedSpanIsolationScope;return this._prepareEvent(e,t,n,u).then((n=>{if(null===n)throw this.recordDroppedEvent("event_processor",l,e),new Be("An event processor returned `null`, will not send event.","log");if(t.data&&!0===t.data.__sentry__)return n;const o=function(e,t,n){const{beforeSend:r,beforeSendTransaction:o}=e;if(ts(t)&&r)return r(t,n);if(ns(t)&&o)return o(t,n);return t}(r,n,t);return function(e,t){const n=`${t} must return \`null\` or a valid event.`;if(pe(e))return e.then((e=>{if(!le(e)&&null!==e)throw new Be(n);return e}),(e=>{throw new Be(`${t} rejected with ${e}`)}));if(!le(e)&&null!==e)throw new Be(n);return e}(o,c)})).then((r=>{if(null===r)throw this.recordDroppedEvent("before_send",l,e),new Be(`${c} returned \`null\`, will not send event.`,"log");const o=n&&n.getSession();!s&&o&&this._updateSessionFromEvent(o,r);const i=r.transaction_info;if(s&&i&&r.transaction!==e.transaction){const e="custom";r.transaction_info={...i,source:e}}return this.sendEvent(r,t),r})).then(null,(e=>{if(e instanceof Be)throw e;throw this.captureException(e,{data:{__sentry__:!0},originalException:e}),new Be(`Event processing pipeline threw an error, original event will not be sent. Details have been sent as a new event.\nReason: ${e}`)}))}_process(e){this._numProcessing++,e.then((e=>(this._numProcessing--,e)),(e=>(this._numProcessing--,e)))}_sendEnvelope(e){if(this.emit("beforeEnvelope",e),this._isEnabled()&&this._transport)return this._transport.send(e).then(null,(e=>{rr&&Fe.error("Error while sending event:",e)}));rr&&Fe.error("Transport disabled")}_clearOutcomes(){const e=this._outcomes;return this._outcomes={},Object.keys(e).map((t=>{const[n,r]=t.split(":");return{reason:n,category:r,quantity:e[t]}}))}}function ts(e){return void 0===e.type}function ns(e){return"transaction"===e.type}function rs(e){const t=kr();t&&t.addEventProcessor&&t.addEventProcessor(e)}const os={c:class{constructor(e){this._value=e}get weight(){return 1}add(e){this._value+=e}toString(){return`${this._value}`}},g:class{constructor(e){this._last=e,this._min=e,this._max=e,this._sum=e,this._count=1}get weight(){return 5}add(e){this._last=e,e<this._min&&(this._min=e),e>this._max&&(this._max=e),this._sum+=e,this._count++}toString(){return`${this._last}:${this._min}:${this._max}:${this._sum}:${this._count}`}},d:class{constructor(e){this._value=[e]}get weight(){return this._value.length}add(e){this._value.push(e)}toString(){return this._value.join(":")}},s:class{constructor(e){this.first=e,this._value=new Set([e])}get weight(){return this._value.size}add(e){this._value.add(e)}toString(){return Array.from(this._value).map((e=>"string"==typeof e?function(e){let t=0;for(let n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t&=t;return t>>>0}(e):e)).join(":")}}};function ss(e){const t=Yr().getStackTop();t.client=e,t.scope.setClient(e)}const is=30;function as(e,t,n=fn(e.bufferSize||is)){let r={};function o(o){const s=[];if(qn(o,((t,n)=>{const o=zn(n);if(Zn(r,o)){const r=cs(t,n);e.recordDroppedEvent("ratelimit_backoff",o,r)}else s.push(t)})),0===s.length)return dn();const i=Gn(o[0],s),a=t=>{qn(i,((n,r)=>{const o=cs(n,r);e.recordDroppedEvent(t,zn(r),o)}))};return n.add((()=>t({body:Bn(i,e.textEncoder)}).then((e=>(void 0!==e.statusCode&&(e.statusCode<200||e.statusCode>=300)&&rr&&Fe.warn(`Sentry responded with status code ${e.statusCode} to sent event.`),r=er(r,e),e)),(e=>{throw a("network_error"),e})))).then((e=>e),(e=>{if(e instanceof Be)return rr&&Fe.error("Skipped sending event because buffer is full."),a("queue_overflow"),dn();throw e}))}return o.__sentry__baseTransport__=!0,{send:o,flush:e=>n.drain(e)}}function cs(e,t){if("event"===t||"transaction"===t)return Array.isArray(e)?e[1]:void 0}const ls=100,us=5e3,ds=36e5;function ps(e,t){rr&&Fe.info(`[Offline]: ${e}`,t)}function hs(e){return t=>{const n=e(t),r=t.createStore?t.createStore(t):void 0;let o,s=us;function i(e,n,r){return o=["replay_event","replay_recording","client_report"],!qn(e,((e,t)=>o.includes(t)))&&(!t.shouldStore||t.shouldStore(e,n,r));var o}function a(e){r&&(o&&clearTimeout(o),o=setTimeout((async()=>{o=void 0;const e=await r.pop();e&&(ps("Attempting to send previously queued event"),l(e).catch((e=>{ps("Failed to retry sending",e)})))}),e),"number"!=typeof o&&o.unref&&o.unref())}function c(){o||(a(s),s=Math.min(2*s,ds))}async function l(e){try{const t=await n.send(e);let r=ls;if(t)if(t.headers&&t.headers["retry-after"])r=Qn(t.headers["retry-after"]);else if((t.statusCode||0)>=400)return t;return a(r),s=us,t}catch(t){if(r&&await i(e,t,s))return await r.insert(e),c(),ps("Error sending. Event queued",t),{};throw t}}return t.flushAtStartup&&c(),{send:l,flush:e=>n.flush(e)}}}function fs(e,t){let n;return qn(e,((e,r)=>(t.includes(r)&&(n=Array.isArray(e)?e[1]:void 0),!!n))),n}function gs(e){return[{type:"span"},e]}function ms(e,t){const n=t&&function(e){return void 0!==e.getClient}(t)?t.getClient():t,r=n&&n.getDsn(),o=n&&n.getOptions().tunnel;return function(e,t){return!!t&&e.includes(t.host)}(e,r)||function(e,t){if(!t)return!1;return ys(e)===ys(t)}(e,o)}function ys(e){return"/"===e[e.length-1]?e.slice(0,-1):e}const _s=new Map,vs=new Set;function Ss(e,t){return function(e){if(Ie._sentryModuleMetadata)for(const t of Object.keys(Ie._sentryModuleMetadata)){const n=Ie._sentryModuleMetadata[t];if(vs.has(t))continue;vs.add(t);const r=e(t);for(const e of r.reverse())if(e.filename){_s.set(e.filename,n);break}}}(e),_s.get(t)}const Ts="ModuleMetadata",bs=()=>({name:Ts,setupOnce(){},setup(e){"function"==typeof e.on&&e.on("beforeEnvelope",(e=>{qn(e,((e,t)=>{if("event"===t){const t=Array.isArray(e)?e[1]:void 0;t&&(!function(e){try{e.exception.values.forEach((e=>{if(e.stacktrace)for(const t of e.stacktrace.frames||[])delete t.module_metadata}))}catch(e){}}(t),e[1]=t)}}))}))},processEvent:(e,t,n)=>(function(e,t){try{t.exception.values.forEach((t=>{if(t.stacktrace)for(const n of t.stacktrace.frames||[]){if(!n.filename)continue;const t=Ss(e,n.filename);t&&(n.module_metadata=t)}}))}catch(e){}}(n.getOptions().stackParser,e),e)}),ws=zo(Ts,bs),Es={include:{cookies:!0,data:!0,headers:!0,ip:!1,query_string:!0,url:!0,user:{id:!0,username:!0,email:!0}},transactionNamingScheme:"methodPath"},Is="RequestData";zo(Is,((e={})=>{const t=wn,n={...Es,...e,include:{method:!0,...Es.include,...e.include,user:e.include&&"boolean"==typeof e.include.user?e.include.user:{...Es.include.user,...(e.include||{}).user}}};return{name:Is,setupOnce(){},processEvent(e,r,o){const{transactionNamingScheme:s}=n,{sdkProcessingMetadata:i={}}=e,a=i.request;if(!a)return e;const c=i.requestDataOptionsFromExpressHandler||i.requestDataOptionsFromGCPWrapper||function(e){const{transactionNamingScheme:t,include:{ip:n,user:r,...o}}=e,s=[];for(const[e,t]of Object.entries(o))t&&s.push(e);let i;if(void 0===r)i=!0;else if("boolean"==typeof r)i=r;else{const e=[];for(const[t,n]of Object.entries(r))n&&e.push(t);i=e}return{include:{ip:n,user:i,request:0!==s.length?s:void 0,transaction:t}}}(n),l=t(e,a,c);if("transaction"===e.type||"handler"===s)return l;const u=a._sentryTransaction;if(u){const e=mr(u).description||"",t="sentry.javascript.nextjs"===function(e){try{return e.getOptions()._metadata.sdk.name}catch(e){return}}(o)?e.startsWith("/api"):"path"!==s,[n]=Tn(a,{path:!0,method:t,customRoute:e});l.transaction=n}return l}}}));const As=[/^Script error\.?$/,/^Javascript error: Script error\.? on line 0$/,/^ResizeObserver loop completed with undelivered notifications.$/,/^Cannot redefine property: googletag$/],Rs=[/^.*\/healthcheck$/,/^.*\/healthy$/,/^.*\/live$/,/^.*\/ready$/,/^.*\/heartbeat$/,/^.*\/health$/,/^.*\/healthz$/],ks="InboundFilters",Cs=(e={})=>({name:ks,setupOnce(){},processEvent(t,n,r){const o=r.getOptions(),s=function(e={},t={}){return{allowUrls:[...e.allowUrls||[],...t.allowUrls||[]],denyUrls:[...e.denyUrls||[],...t.denyUrls||[]],ignoreErrors:[...e.ignoreErrors||[],...t.ignoreErrors||[],...e.disableErrorDefaults?[]:As],ignoreTransactions:[...e.ignoreTransactions||[],...t.ignoreTransactions||[],...e.disableTransactionDefaults?[]:Rs],ignoreInternal:void 0===e.ignoreInternal||e.ignoreInternal}}(e,o);return function(e,t){if(t.ignoreInternal&&function(e){try{return"SentryError"===e.exception.values[0].type}catch(e){}return!1}(e))return rr&&Fe.warn(`Event dropped due to being internal Sentry Error.\nEvent: ${mt(e)}`),!0;if(function(e,t){if(e.type||!t||!t.length)return!1;return function(e){const t=[];e.message&&t.push(e.message);let n;try{n=e.exception.values[e.exception.values.length-1]}catch(e){}n&&n.value&&(t.push(n.value),n.type&&t.push(`${n.type}: ${n.value}`));rr&&0===t.length&&Fe.error(`Could not extract message for event ${mt(e)}`);return t}(e).some((e=>ve(e,t)))}(e,t.ignoreErrors))return rr&&Fe.warn(`Event dropped due to being matched by \`ignoreErrors\` option.\nEvent: ${mt(e)}`),!0;if(function(e,t){if("transaction"!==e.type||!t||!t.length)return!1;const n=e.transaction;return!!n&&ve(n,t)}(e,t.ignoreTransactions))return rr&&Fe.warn(`Event dropped due to being matched by \`ignoreTransactions\` option.\nEvent: ${mt(e)}`),!0;if(function(e,t){if(!t||!t.length)return!1;const n=Os(e);return!!n&&ve(n,t)}(e,t.denyUrls))return rr&&Fe.warn(`Event dropped due to being matched by \`denyUrls\` option.\nEvent: ${mt(e)}.\nUrl: ${Os(e)}`),!0;if(!function(e,t){if(!t||!t.length)return!0;const n=Os(e);return!n||ve(n,t)}(e,t.allowUrls))return rr&&Fe.warn(`Event dropped due to not being matched by \`allowUrls\` option.\nEvent: ${mt(e)}.\nUrl: ${Os(e)}`),!0;return!1}(t,s)?null:t}}),xs=zo(ks,Cs);function Os(e){try{let t;try{t=e.exception.values[0].stacktrace.frames}catch(e){}return t?function(e=[]){for(let t=e.length-1;t>=0;t--){const n=e[t];if(n&&"<anonymous>"!==n.filename&&"[native code]"!==n.filename)return n.filename||null}return null}(t):null}catch(t){return rr&&Fe.error(`Cannot extract url for event ${mt(e)}`),null}}let Ls;const Ns="FunctionToString",Ps=new WeakMap,Ds=()=>({name:Ns,setupOnce(){Ls=Function.prototype.toString;try{Function.prototype.toString=function(...e){const t=Ye(this),n=Ps.has(kr())&&void 0!==t?t:this;return Ls.apply(n,e)}}catch(e){}},setup(e){Ps.set(e,!0)}}),Ms=zo(Ns,Ds),Us="LinkedErrors",$s=zo(Us,((e={})=>{const t=e.limit||5,n=e.key||"cause";return{name:Us,setupOnce(){},preprocessEvent(e,r,o){const s=o.getOptions();Se(tr,s.stackParser,s.maxValueLength,n,t,e,r)}}}));var Fs=Object.freeze({__proto__:null,FunctionToString:Ms,InboundFilters:xs,LinkedErrors:$s});class js{constructor(e){this._client=e,this._buckets=new Map,this._interval=setInterval((()=>this.flush()),5e3)}add(e,t,n,r="none",o={},s=kn()){const i=Math.floor(s),a=t.replace(/[^\w\-.]+/gi,"_");const c=function(e){const t={};for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[Yo(n)]=Ko(String(e[n])));return t}(o),l=function(e){return e.replace(/[^\w]+/gi,"_")}(r),u=function(e,t,n,r){return`${e}${t}${n}${Object.entries(Ze(r)).sort(((e,t)=>e[0].localeCompare(t[0])))}`}(e,a,l,c);let d=this._buckets.get(u);const p=d&&"s"===e?d.metric.weight:0;d?(d.metric.add(n),d.timestamp<i&&(d.timestamp=i)):(d={metric:new os[e](n),timestamp:i,metricType:e,name:a,unit:l,tags:c},this._buckets.set(u,d));!function(e,t,n,r,o,s){const i=ho();if(i){const a=vo(i)||new Map,c=`${e}:${t}@${r}`,l=a.get(s);if(l){const[,e]=l;a.set(s,[c,{min:Math.min(e.min,n),max:Math.max(e.max,n),count:e.count+=1,sum:e.sum+=n,tags:e.tags}])}else a.set(s,[c,{min:n,max:n,count:1,sum:n,tags:o}]);_o||(_o=new WeakMap),_o.set(i,a)}}(e,a,"string"==typeof n?d.metric.weight-p:n,l,o,u)}flush(){if(0!==this._buckets.size){if(this._client.captureAggregateMetrics){const e=Array.from(this._buckets).map((([,e])=>e));this._client.captureAggregateMetrics(e)}this._buckets.clear()}}close(){clearInterval(this._interval),this.flush()}}const Gs="MetricsAggregator",Vs=()=>({name:Gs,setupOnce(){},setup(e){e.metricsAggregator=new js(e)}});function qs(e,t,n,r={}){const o=kr(),s=Cr();if(o){if(!o.metricsAggregator)return void(rr&&Fe.warn("No metrics aggregator enabled. Please add the MetricsAggregator integration to use metrics APIs"));const{unit:i,tags:a,timestamp:c}=r,{release:l,environment:u}=o.getOptions(),d=s.getTransaction(),p={};l&&(p.release=l),u&&(p.environment=u),d&&(p.transaction=mr(d).description||""),rr&&Fe.log(`Adding value of ${n} to ${e} metric ${t}`),o.metricsAggregator.add(e,t,n,i,{...p,...a},c)}}const Ws={increment:function(e,t=1,n){qs("c",e,t,n)},distribution:function(e,t,n){qs("d",e,t,n)},set:function(e,t,n){qs("s",e,t,n)},gauge:function(e,t,n){qs("g",e,t,n)},MetricsAggregator:zo(Gs,Vs),metricsAggregatorIntegration:Vs},Bs=Fs,Hs="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__;function Js(e){const t=nr([e,"call",e=>e(),"access",e=>e.getClient,"call",e=>e(),"optionalAccess",e=>e.getOptions,"call",e=>e()]);return"sentry"!==(nr([t,"optionalAccess",e=>e.instrumenter])||"sentry")}class zs{static __initStatic(){this.id="Express"}constructor(e={}){this.name=zs.id,this._router=e.router||e.app,this._methods=(Array.isArray(e.methods)?e.methods:[]).concat("use")}setupOnce(e,t){this._router?Js(t)?Hs&&Fe.log("Express Integration is skipped because of instrumenter configuration."):(function(e,t=[]){t.forEach((t=>function(e,t){const n=e[t];return e[t]=function(...e){return n.call(this,...function(e,t){return e.map((e=>"function"==typeof e?Ys(e,t):Array.isArray(e)?e.map((e=>"function"==typeof e?Ys(e,t):e)):e))}(e,t))},e}(e,t)))}(this._router,this._methods),function(e){const t="settings"in e;t&&void 0===e._router&&e.lazyrouter&&e.lazyrouter();const n=t?e._router:e;if(!n)return Hs&&Fe.debug("Cannot instrument router for URL Parameterization (did not find a valid router)."),void(Hs&&Fe.debug("Routing instrumentation is currently only supported in Express 4."));const r=Object.getPrototypeOf(n),o=r.process_params;r.process_params=function(e,t,n,r,s){n._reconstructedRoute||(n._reconstructedRoute="");const{layerRoutePath:i,isRegex:a,isArray:c,numExtraSegments:l}=function(e){let t=nr([e,"access",e=>e.route,"optionalAccess",e=>e.path]);const n=de(t),r=Array.isArray(t);if(!t){const[n]=Ie.process.versions.node.split(".").map(Number);n>=16&&(t=Xs(e.path,e.regexp,e.keys))}if(!t)return{isRegex:n,isArray:r,numExtraSegments:0};const o=r?Math.max((i=t,i.reduce(((e,t)=>e+yn(t.toString())),0)-yn(e.path||"")),0):0,s=function(e,t){if(e)return t.map((e=>e.toString())).join(",");return t&&t.toString()}(r,t);var i;return{layerRoutePath:s,isRegex:n,isArray:r,numExtraSegments:o}}(e);let u;(i||a||c)&&(n._hasParameters=!0),u=i||(function(e,t,n){const r=nr([mn(e||""),"optionalAccess",e=>e.split,"call",e=>e("/"),"access",e=>e.filter,"call",e=>e((e=>!!e))]);let o=0;const s=nr([t,"optionalAccess",e=>e.split,"call",e=>e("/"),"access",e=>e.filter,"call",e=>e((e=>!!e)),"access",e=>e.length])||0;return nr([n,"optionalAccess",e=>e.split,"call",e=>e("/"),"access",e=>e.filter,"call",e=>e((e=>nr([r,"optionalAccess",e=>e[s+o]])===e&&(o+=1,!0))),"access",e=>e.join,"call",e=>e("/")])}(n.originalUrl,n._reconstructedRoute,e.path)||"");const d=u.split("/").filter((e=>e.length>0&&(a||c||!e.includes("*")))).join("/");d&&d.length>0&&(n._reconstructedRoute+=`/${d}${a?"/":""}`);if(yn(mn(n.originalUrl||""))+l===yn(n._reconstructedRoute)){n._hasParameters||n._reconstructedRoute!==n.originalUrl&&(n._reconstructedRoute=n.originalUrl?mn(n.originalUrl):n.originalUrl);const e=r.__sentry_transaction,t=e&&mr(e).data||{};if(e&&"custom"!==t[To]){const t=n._reconstructedRoute||"/",[r,o]=Tn(n,{path:!0,method:!0,customRoute:t});e.updateName(r),e.setAttribute(To,o)}}return o.call(this,e,t,n,r,s)}}(this._router)):Hs&&Fe.error("ExpressIntegration is missing an Express instance")}}function Ys(e,t){const n=e.length;switch(n){case 2:return function(n,r){const o=r.__sentry_transaction;if(o){const n=o.startChild({description:e.name,op:`middleware.express.${t}`,origin:"auto.middleware.express"});r.once("finish",(()=>{n.end()}))}return e.call(this,n,r)};case 3:return function(n,r,o){const s=nr([r.__sentry_transaction,"optionalAccess",e=>e.startChild,"call",n=>n({description:e.name,op:`middleware.express.${t}`,origin:"auto.middleware.express"})]);e.call(this,n,r,(function(...e){nr([s,"optionalAccess",e=>e.end,"call",e=>e()]),o.call(this,...e)}))};case 4:return function(n,r,o,s){const i=nr([o.__sentry_transaction,"optionalAccess",e=>e.startChild,"call",n=>n({description:e.name,op:`middleware.express.${t}`,origin:"auto.middleware.express"})]);e.call(this,n,r,o,(function(...e){nr([i,"optionalAccess",e=>e.end,"call",e=>e()]),s.call(this,...e)}))};default:throw new Error(`Express middleware takes 2-4 arguments. Got: ${n}`)}}zs.__initStatic();const Xs=(e,t,n)=>{if(!(e&&t&&n&&0!==Object.keys(n).length&&nr([n,"access",e=>e[0],"optionalAccess",e=>e.offset])))return;const r=n.sort(((e,t)=>e.offset-t.offset)),o=new RegExp(t,`${t.flags}d`).exec(e);if(!o||!o.indices)return;const[,...s]=o.indices;if(s.length!==r.length)return;let i=e,a=0;return s.forEach(((e,t)=>{if(e){const[n,o]=e,s=i.substring(0,n-a),c=`:${r[t].name}`,l=i.substring(o-a);i=s+c+l,a+=o-n-c.length}})),i};class Ks{static __initStatic(){this.id="Postgres"}constructor(e={}){this.name=Ks.id,this._usePgNative=!!e.usePgNative,this._module=e.module}loadDependency(){return this._module=this._module||en("pg")}setupOnce(e,t){if(Js(t))return void(Hs&&Fe.log("Postgres Integration is skipped because of instrumenter configuration."));const n=this.loadDependency();if(!n)return void(Hs&&Fe.error("Postgres Integration was unable to require `pg` package."));const r=this._usePgNative?nr([n,"access",e=>e.native,"optionalAccess",e=>e.Client]):n.Client;r?He(r.prototype,"query",(function(e){return function(n,r,o){const s=t().getScope().getSpan(),i={"db.system":"postgresql"};try{this.database&&(i["db.name"]=this.database),this.host&&(i["server.address"]=this.host),this.port&&(i["server.port"]=this.port),this.user&&(i["db.user"]=this.user)}catch(e){}const a=nr([s,"optionalAccess",e=>e.startChild,"call",e=>e({description:"string"==typeof n?n:n.text,op:"db",origin:"auto.db.postgres",data:i})]);if("function"==typeof o)return e.call(this,n,r,(function(e,t){nr([a,"optionalAccess",e=>e.end,"call",e=>e()]),o(e,t)}));if("function"==typeof r)return e.call(this,n,(function(e,t){nr([a,"optionalAccess",e=>e.end,"call",e=>e()]),r(e,t)}));const c=void 0!==r?e.call(this,n,r):e.call(this,n);return pe(c)?c.then((e=>(nr([a,"optionalAccess",e=>e.end,"call",e=>e()]),e))):(nr([a,"optionalAccess",e=>e.end,"call",e=>e()]),c)}})):Hs&&Fe.error("Postgres Integration was unable to access 'pg-native' bindings.")}}Ks.__initStatic();class Qs{static __initStatic(){this.id="Mysql"}constructor(){this.name=Qs.id}loadDependency(){return this._module=this._module||en("mysql/lib/Connection.js")}setupOnce(e,t){if(Js(t))return void(Hs&&Fe.log("Mysql Integration is skipped because of instrumenter configuration."));const n=this.loadDependency();if(!n)return void(Hs&&Fe.error("Mysql Integration was unable to require `mysql` package."));let r;try{n.prototype.connect=new Proxy(n.prototype.connect,{apply:(e,t,n)=>(r||(r=t.config),e.apply(t,n))})}catch(e){Hs&&Fe.error("Mysql Integration was unable to instrument `mysql` config.")}function o(e){if(!e)return;const t=r?{"server.address":r.host,"server.port":r.port,"db.user":r.user}:{};Object.keys(t).forEach((n=>{e.setAttribute(n,t[n])})),e.end()}He(n,"createQuery",(function(e){return function(n,r,s){const i=nr([t().getScope().getSpan(),"optionalAccess",e=>e.startChild,"call",e=>e({description:"string"==typeof n?n:n.sql,op:"db",origin:"auto.db.mysql",data:{"db.system":"mysql"}})]);if("function"==typeof s)return e.call(this,n,r,(function(e,t,n){o(i),s(e,t,n)}));if("function"==typeof r)return e.call(this,n,(function(e,t,n){o(i),r(e,t,n)}));const a=e.call(this,n,r);return a.on("end",(()=>{o(i)})),a}}))}}Qs.__initStatic();const Zs=["aggregate","bulkWrite","countDocuments","createIndex","createIndexes","deleteMany","deleteOne","distinct","drop","dropIndex","dropIndexes","estimatedDocumentCount","find","findOne","findOneAndDelete","findOneAndReplace","findOneAndUpdate","indexes","indexExists","indexInformation","initializeOrderedBulkOp","insertMany","insertOne","isCapped","mapReduce","options","parallelCollectionScan","rename","replaceOne","stats","updateMany","updateOne"],ei={bulkWrite:["operations"],countDocuments:["query"],createIndex:["fieldOrSpec"],createIndexes:["indexSpecs"],deleteMany:["filter"],deleteOne:["filter"],distinct:["key","query"],dropIndex:["indexName"],find:["query"],findOne:["query"],findOneAndDelete:["filter"],findOneAndReplace:["filter","replacement"],findOneAndUpdate:["filter","update"],indexExists:["indexes"],insertMany:["docs"],insertOne:["doc"],mapReduce:["map","reduce"],rename:["newName"],replaceOne:["filter","doc"],updateMany:["filter","update"],updateOne:["filter","update"]};class ti{static __initStatic(){this.id="Mongo"}constructor(e={}){this.name=ti.id,this._operations=Array.isArray(e.operations)?e.operations:Zs,this._describeOperations=!("describeOperations"in e)||e.describeOperations,this._useMongoose=!!e.useMongoose}loadDependency(){const e=this._useMongoose?"mongoose":"mongodb";return this._module=this._module||en(e)}setupOnce(e,t){if(Js(t))return void(Hs&&Fe.log("Mongo Integration is skipped because of instrumenter configuration."));const n=this.loadDependency();if(n)this._instrumentOperations(n.Collection,this._operations,t);else{const e=this._useMongoose?"mongoose":"mongodb";Hs&&Fe.error(`Mongo Integration was unable to require \`${e}\` package.`)}}_instrumentOperations(e,t,n){t.forEach((t=>this._patchOperation(e,t,n)))}_patchOperation(e,t,n){if(!(t in e.prototype))return;const r=this._getSpanContextFromOperationArguments.bind(this);He(e.prototype,t,(function(e){return function(...o){const s=o[o.length-1],i=n(),a=i.getScope(),c=i.getClient(),l=a.getSpan(),u=nr([c,"optionalAccess",e=>e.getOptions,"call",e=>e(),"access",e=>e.sendDefaultPii]);if("function"!=typeof s||"mapReduce"===t&&2===o.length){const n=nr([l,"optionalAccess",e=>e.startChild,"call",e=>e(r(this,t,o,u))]),s=e.call(this,...o);if(pe(s))return s.then((e=>(nr([n,"optionalAccess",e=>e.end,"call",e=>e()]),e)));if((d=s)&&"object"==typeof d&&d.once&&"function"==typeof d.once){const e=s;try{e.once("close",(()=>{nr([n,"optionalAccess",e=>e.end,"call",e=>e()])}))}catch(e){nr([n,"optionalAccess",e=>e.end,"call",e=>e()])}return e}return nr([n,"optionalAccess",e=>e.end,"call",e=>e()]),s}var d;const p=nr([l,"optionalAccess",e=>e.startChild,"call",e=>e(r(this,t,o.slice(0,-1)))]);return e.call(this,...o.slice(0,-1),(function(e,t){nr([p,"optionalAccess",e=>e.end,"call",e=>e()]),s(e,t)}))}}))}_getSpanContextFromOperationArguments(e,t,n,r=!1){const o={"db.system":"mongodb","db.name":e.dbName,"db.operation":t,"db.mongodb.collection":e.collectionName},s={op:"db",origin:"auto.db.mongo",description:t,data:o},i=ei[t],a=Array.isArray(this._describeOperations)?this._describeOperations.includes(t):this._describeOperations;if(!i||!a||!r)return s;try{if("mapReduce"===t){const[e,t]=n;o[i[0]]="string"==typeof e?e:e.name||"<anonymous>",o[i[1]]="string"==typeof t?t:t.name||"<anonymous>"}else for(let e=0;e<i.length;e++)o[`db.mongodb.${i[e]}`]=JSON.stringify(n[e])}catch(e){}return s}}ti.__initStatic();class ni{static __initStatic(){this.id="Prisma"}constructor(e={}){if(this.name=ni.id,(t=e.client)&&t.$use&&!e.client._sentryInstrumented){Je(e.client,"_sentryInstrumented",!0);const t={};try{const n=e.client._engineConfig;if(n){const{activeProvider:e,clientVersion:r}=n;e&&(t["db.system"]=e),r&&(t["db.prisma.version"]=r)}}catch(e){}e.client.$use(((e,n)=>{if(Js(Yr))return n(e);const r=e.action,o=e.model;return uo({name:o?`${o} ${r}`:r,onlyIfParent:!0,op:"db.prisma",attributes:{[Eo]:"auto.db.prisma"},data:{...t,"db.operation":r}},(()=>n(e)))}))}else Hs&&Fe.warn("Unsupported Prisma client provided to PrismaIntegration. Provided client:",e.client);var t}setupOnce(){}}ni.__initStatic();class ri{static __initStatic(){this.id="GraphQL"}constructor(){this.name=ri.id}loadDependency(){return this._module=this._module||en("graphql/execution/execute.js")}setupOnce(e,t){if(Js(t))return void(Hs&&Fe.log("GraphQL Integration is skipped because of instrumenter configuration."));const n=this.loadDependency();n?He(n,"execute",(function(e){return function(...n){const r=t().getScope(),o=r.getSpan(),s=nr([o,"optionalAccess",e=>e.startChild,"call",e=>e({description:"execute",op:"graphql.execute",origin:"auto.graphql.graphql"})]);nr([r,"optionalAccess",e=>e.setSpan,"call",e=>e(s)]);const i=e.call(this,...n);return pe(i)?i.then((e=>(nr([s,"optionalAccess",e=>e.end,"call",e=>e()]),nr([r,"optionalAccess",e=>e.setSpan,"call",e=>e(o)]),e))):(nr([s,"optionalAccess",e=>e.end,"call",e=>e()]),nr([r,"optionalAccess",e=>e.setSpan,"call",e=>e(o)]),i)}})):Hs&&Fe.error("GraphQL Integration was unable to require graphql/execution package.")}}ri.__initStatic();class oi{static __initStatic(){this.id="Apollo"}constructor(e={useNestjs:!1}){this.name=oi.id,this._useNest=!!e.useNestjs}loadDependency(){return this._useNest?this._module=this._module||en("@nestjs/graphql"):this._module=this._module||en("apollo-server-core"),this._module}setupOnce(e,t){if(Js(t))Hs&&Fe.log("Apollo Integration is skipped because of instrumenter configuration.");else if(this._useNest){const e=this.loadDependency();if(!e)return void(Hs&&Fe.error("Apollo-NestJS Integration was unable to require @nestjs/graphql package."));He(e.GraphQLFactory.prototype,"mergeWithSchema",(function(e){return function(...n){return He(this.resolversExplorerService,"explore",(function(e){return function(){return si(St(e.call(this)),t)}})),e.call(this,...n)}}))}else{const e=this.loadDependency();if(!e)return void(Hs&&Fe.error("Apollo Integration was unable to require apollo-server-core package."));He(e.ApolloServerBase.prototype,"constructSchema",(function(e){return function(){if(!this.config.resolvers)return Hs&&(this.config.schema?(Fe.warn("Apollo integration is not able to trace `ApolloServer` instances constructed via `schema` property.If you are using NestJS with Apollo, please use `Sentry.Integrations.Apollo({ useNestjs: true })` instead."),Fe.warn()):this.config.modules&&Fe.warn("Apollo integration is not able to trace `ApolloServer` instances constructed via `modules` property."),Fe.error("Skipping tracing as no resolvers found on the `ApolloServer` instance.")),e.call(this);const n=St(this.config.resolvers);return this.config.resolvers=si(n,t),e.call(this)}}))}}}function si(e,t){return e.map((e=>(Object.keys(e).forEach((n=>{Object.keys(e[n]).forEach((r=>{"function"==typeof e[n][r]&&function(e,t,n,r){He(e[t],n,(function(e){return function(...o){const s=nr([r().getScope().getSpan(),"optionalAccess",e=>e.startChild,"call",e=>e({description:`${t}.${n}`,op:"graphql.resolve",origin:"auto.graphql.apollo"})]),i=e.call(this,...o);return pe(i)?i.then((e=>(nr([s,"optionalAccess",e=>e.end,"call",e=>e()]),e))):(nr([s,"optionalAccess",e=>e.end,"call",e=>e()]),i)}}))}(e,n,r,t)}))})),e)))}oi.__initStatic();const ii=Ie;function ai(){ii.document?ii.document.addEventListener("visibilitychange",(()=>{const e=eo();if(ii.document.hidden&&e){const t="cancelled",{op:n,status:r}=mr(e);Hs&&Fe.log(`[Tracing] Transaction: ${t} -> since tab moved to the background, op: ${n}`),r||e.setStatus(t),e.setTag("visibilitychange","document.hidden"),e.end()}})):Hs&&Fe.warn("[Tracing] Could not set up background tab detection due to lack of global document")}const ci=(e,t,n)=>{let r,o;return s=>{t.value>=0&&(s||n)&&(o=t.value-(r||0),(o||void 0===r)&&(r=t.value,t.delta=o,e(t)))}},li=()=>ii.__WEB_VITALS_POLYFILL__?ii.performance&&(performance.getEntriesByType&&performance.getEntriesByType("navigation")[0]||(()=>{const e=ii.performance.timing,t=ii.performance.navigation.type,n={entryType:"navigation",startTime:0,type:2==t?"back_forward":1===t?"reload":"navigate"};for(const t in e)"navigationStart"!==t&&"toJSON"!==t&&(n[t]=Math.max(e[t]-e.navigationStart,0));return n})()):ii.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0],ui=()=>{const e=li();return e&&e.activationStart||0},di=(e,t)=>{const n=li();let r="navigate";return n&&(r=ii.document&&ii.document.prerendering||ui()>0?"prerender":n.type.replace(/_/g,"-")),{name:e,value:void 0===t?-1:t,rating:"good",delta:0,entries:[],id:`v3-${Date.now()}-${Math.floor(8999999999999*Math.random())+1e12}`,navigationType:r}},pi=(e,t,n)=>{try{if(PerformanceObserver.supportedEntryTypes.includes(e)){const r=new PerformanceObserver((e=>{t(e.getEntries())}));return r.observe(Object.assign({type:e,buffered:!0},n||{})),r}}catch(e){}},hi=(e,t)=>{const n=r=>{"pagehide"!==r.type&&"hidden"!==ii.document.visibilityState||(e(r),t&&(removeEventListener("visibilitychange",n,!0),removeEventListener("pagehide",n,!0)))};ii.document&&(addEventListener("visibilitychange",n,!0),addEventListener("pagehide",n,!0))},fi=(e,t={})=>{const n=di("CLS",0);let r,o=0,s=[];const i=e=>{e.forEach((e=>{if(!e.hadRecentInput){const t=s[0],i=s[s.length-1];o&&0!==s.length&&e.startTime-i.startTime<1e3&&e.startTime-t.startTime<5e3?(o+=e.value,s.push(e)):(o=e.value,s=[e]),o>n.value&&(n.value=o,n.entries=s,r&&r())}}))},a=pi("layout-shift",i);if(a){r=ci(e,n,t.reportAllChanges);const o=()=>{i(a.takeRecords()),r(!0)};return hi(o),o}};let gi=-1;const mi=()=>(gi<0&&(ii.document&&ii.document.visibilityState&&(gi="hidden"!==ii.document.visibilityState||ii.document.prerendering?1/0:0),hi((({timeStamp:e})=>{gi=e}),!0)),{get firstHiddenTime(){return gi}}),yi=e=>{const t=mi(),n=di("FID");let r;const o=e=>{e.startTime<t.firstHiddenTime&&(n.value=e.processingStart-e.startTime,n.entries.push(e),r(!0))},s=e=>{e.forEach(o)},i=pi("first-input",s);r=ci(e,n),i&&hi((()=>{s(i.takeRecords()),i.disconnect()}),!0)};let _i=0,vi=1/0,Si=0;const Ti=e=>{e.forEach((e=>{e.interactionId&&(vi=Math.min(vi,e.interactionId),Si=Math.max(Si,e.interactionId),_i=Si?(Si-vi)/7+1:0)}))};let bi;const wi=()=>{"interactionCount"in performance||bi||(bi=pi("event",Ti,{type:"event",buffered:!0,durationThreshold:0}))},Ei=()=>bi?_i:performance.interactionCount||0,Ii=[],Ai={},Ri=e=>{const t=Ii[Ii.length-1],n=Ai[e.interactionId];if(n||Ii.length<10||e.duration>t.latency){if(n)n.entries.push(e),n.latency=Math.max(n.latency,e.duration);else{const t={id:e.interactionId,latency:e.duration,entries:[e]};Ai[t.id]=t,Ii.push(t)}Ii.sort(((e,t)=>t.latency-e.latency)),Ii.splice(10).forEach((e=>{delete Ai[e.id]}))}},ki=(e,t)=>{t=t||{},wi();const n=di("INP");let r;const o=e=>{e.forEach((e=>{if(e.interactionId&&Ri(e),"first-input"===e.entryType){!Ii.some((t=>t.entries.some((t=>e.duration===t.duration&&e.startTime===t.startTime))))&&Ri(e)}}));const t=(()=>{const e=Math.min(Ii.length-1,Math.floor(Ei()/50));return Ii[e]})();t&&t.latency!==n.value&&(n.value=t.latency,n.entries=t.entries,r())},s=pi("event",o,{durationThreshold:t.durationThreshold||40});r=ci(e,n,t.reportAllChanges),s&&(s.observe({type:"first-input",buffered:!0}),hi((()=>{o(s.takeRecords()),n.value<0&&Ei()>0&&(n.value=0,n.entries=[]),r(!0)})))},Ci={},xi=e=>{const t=mi(),n=di("LCP");let r;const o=e=>{const o=e[e.length-1];if(o){const e=Math.max(o.startTime-ui(),0);e<t.firstHiddenTime&&(n.value=e,n.entries=[o],r())}},s=pi("largest-contentful-paint",o);if(s){r=ci(e,n);const t=()=>{Ci[n.id]||(o(s.takeRecords()),s.disconnect(),Ci[n.id]=!0,r(!0))};return["keydown","click"].forEach((e=>{ii.document&&addEventListener(e,t,{once:!0,capture:!0})})),hi(t,!0),t}},Oi=e=>{ii.document&&(ii.document.prerendering?addEventListener("prerenderingchange",(()=>Oi(e)),!0):"complete"!==ii.document.readyState?addEventListener("load",(()=>Oi(e)),!0):setTimeout(e,0))},Li=(e,t)=>{t=t||{};const n=di("TTFB"),r=ci(e,n,t.reportAllChanges);Oi((()=>{const e=li();if(e){if(n.value=Math.max(e.responseStart-ui(),0),n.value<0||n.value>performance.now())return;n.entries=[e],r(!0)}}))},Ni={},Pi={};let Di,Mi,Ui,$i,Fi;function ji(e,t=!1){return zi("lcp",e,Bi,Ui,t)}function Gi(e,t){return Yi(e,t),Pi[e]||(!function(e){const t={};"event"===e&&(t.durationThreshold=0);pi(e,(t=>{Vi(e,{entries:t})}),t)}(e),Pi[e]=!0),Xi(e,t)}function Vi(e,t){const n=Ni[e];if(n&&n.length)for(const r of n)try{r(t)}catch(t){Hs&&Fe.error(`Error while triggering instrumentation handler.\nType: ${e}\nName: ${it(r)}\nError:`,t)}}function qi(){return fi((e=>{Vi("cls",{metric:e}),Di=e}),{reportAllChanges:!0})}function Wi(){return yi((e=>{Vi("fid",{metric:e}),Mi=e}))}function Bi(){return xi((e=>{Vi("lcp",{metric:e}),Ui=e}))}function Hi(){return Li((e=>{Vi("ttfb",{metric:e}),$i=e}))}function Ji(){return ki((e=>{Vi("inp",{metric:e}),Fi=e}))}function zi(e,t,n,r,o=!1){let s;return Yi(e,t),Pi[e]||(s=n(),Pi[e]=!0),r&&t({metric:r}),Xi(e,t,o?s:void 0)}function Yi(e,t){Ni[e]=Ni[e]||[],Ni[e].push(t)}function Xi(e,t,n){return()=>{n&&n();const r=Ni[e];if(!r)return;const o=r.indexOf(t);-1!==o&&r.splice(o,1)}}function Ki(e){return"number"==typeof e&&isFinite(e)}function Qi(e,{startTimestamp:t,...n}){return t&&e.startTimestamp>t&&(e.startTimestamp=t),e.startChild({startTimestamp:t,...n})}const Zi=2147483647;function ea(e){return e/1e3}function ta(){return ii&&ii.addEventListener&&ii.performance}let na,ra,oa=0,sa={};function ia(){const e=ta();if(e&&Cn){e.mark&&ii.performance.mark("sentry-tracing-init");const t=zi("fid",(({metric:e})=>{const t=e.entries[e.entries.length-1];if(!t)return;const n=ea(Cn),r=ea(t.startTime);Hs&&Fe.log("[Measurements] Adding FID"),sa.fid={value:e.value,unit:"millisecond"},sa["mark.fid"]={value:n+r,unit:"second"}}),Wi,Mi),n=function(e,t=!1){return zi("cls",e,qi,Di,t)}((({metric:e})=>{const t=e.entries[e.entries.length-1];t&&(Hs&&Fe.log("[Measurements] Adding CLS"),sa.cls={value:e.value,unit:""},ra=t)}),!0),r=ji((({metric:e})=>{const t=e.entries[e.entries.length-1];t&&(Hs&&Fe.log("[Measurements] Adding LCP"),sa.lcp={value:e.value,unit:"millisecond"},na=t)}),!0),o=function(e){return zi("ttfb",e,Hi,$i)}((({metric:e})=>{e.entries[e.entries.length-1]&&(Hs&&Fe.log("[Measurements] Adding TTFB"),sa.ttfb={value:e.value,unit:"millisecond"})}));return()=>{t(),n(),r(),o()}}return()=>{}}function aa(){Gi("longtask",(({entries:e})=>{for(const t of e){const e=eo();if(!e)return;const n=ea(Cn+t.startTime),r=ea(t.duration);e.startChild({description:"Main UI thread blocked",op:"ui.long-task",origin:"auto.ui.browser.metrics",startTimestamp:n,endTimestamp:n+r})}}))}function ca(){Gi("event",(({entries:e})=>{for(const t of e){const e=eo();if(!e)return;if("click"===t.name){const n=ea(Cn+t.startTime),r=ea(t.duration),o={description:xe(t.target),op:`ui.interaction.${t.name}`,origin:"auto.ui.browser.metrics",startTimestamp:n,endTimestamp:n+r},s=Pe(t.target);s&&(o.attributes={"ui.component_name":s}),e.startChild(o)}}}))}function la(e,t){if(ta()&&Cn){const n=function(e,t){return n=({metric:n})=>{if(void 0===n.value)return;const r=n.entries.find((e=>e.duration===n.value&&void 0!==ua[e.name])),o=kr();if(!r||!o)return;const s=ua[r.name],i=o.getOptions(),a=ea(Cn+r.startTime),c=ea(n.value),l=void 0!==r.interactionId?e[r.interactionId]:void 0;if(void 0===l)return;const{routeName:u,parentContext:d,activeTransaction:p,user:h,replayId:f}=l,g=void 0!==h?h.email||h.id||h.ip_address:void 0,m=void 0!==p?p.getProfileId():void 0,y=new Ao({startTimestamp:a,endTimestamp:a+c,op:`ui.interaction.${s}`,name:xe(r.target),attributes:{release:i.release,environment:i.environment,transaction:u,...void 0!==g&&""!==g?{user:g}:{},...void 0!==m?{profile_id:m}:{},...void 0!==f?{replay_id:f}:{}},exclusiveTime:n.value,measurements:{inp:{value:n.value,unit:"millisecond"}}}),_=function(e,t,n){if(!lo(t))return!1;let r;return r=void 0!==e&&"function"==typeof t.tracesSampler?t.tracesSampler({transactionContext:e,name:e.name,parentSampled:e.parentSampled,attributes:{...e.data,...e.attributes},location:ii.location}):void 0!==e&&void 0!==e.sampled?e.sampled:void 0!==t.tracesSampleRate?t.tracesSampleRate:1,No(r)?!0===r?n:!1===r?0:r*n:(Hs&&Fe.warn("[Tracing] Discarding interaction span because of invalid sample rate."),!1)}(d,i,t);if(_&&Math.random()<_){const e=y?function(e,t){const n={sent_at:(new Date).toISOString()};return t&&(n.dsn=Ge(t)),Gn(n,e.map(gs))}([y],o.getDsn()):void 0,t=o&&o.getTransport();t&&e&&t.send(e).then(null,(e=>{Hs&&Fe.error("Error while sending interaction:",e)}))}},zi("inp",n,Ji,Fi);var n}(e,t);return()=>{n()}}return()=>{}}const ua={click:"click",pointerdown:"click",pointerup:"click",mousedown:"click",mouseup:"click",touchstart:"click",touchend:"click",mouseover:"hover",mouseout:"hover",mouseenter:"hover",mouseleave:"hover",pointerover:"hover",pointerout:"hover",pointerenter:"hover",pointerleave:"hover",dragstart:"drag",dragend:"drag",drag:"drag",dragenter:"drag",dragleave:"drag",dragover:"drag",drop:"drag",keydown:"press",keyup:"press",keypress:"press",input:"press"};function da(e){const t=ta();if(!t||!ii.performance.getEntries||!Cn)return;Hs&&Fe.log("[Tracing] Adding & adjusting spans using Performance API");const n=ea(Cn),r=t.getEntries(),{op:o,start_timestamp:s}=mr(e);if(r.slice(oa).forEach((t=>{const r=ea(t.startTime),o=ea(t.duration);if(!("navigation"===e.op&&s&&n+r<s))switch(t.entryType){case"navigation":!function(e,t,n){["unloadEvent","redirect","domContentLoadedEvent","loadEvent","connect"].forEach((r=>{pa(e,t,r,n)})),pa(e,t,"secureConnection",n,"TLS/SSL","connectEnd"),pa(e,t,"fetch",n,"cache","domainLookupStart"),pa(e,t,"domainLookup",n,"DNS"),function(e,t,n){t.responseEnd&&(Qi(e,{op:"browser",origin:"auto.browser.browser.metrics",description:"request",startTimestamp:n+ea(t.requestStart),endTimestamp:n+ea(t.responseEnd)}),Qi(e,{op:"browser",origin:"auto.browser.browser.metrics",description:"response",startTimestamp:n+ea(t.responseStart),endTimestamp:n+ea(t.responseEnd)}))}(e,t,n)}(e,t,n);break;case"mark":case"paint":case"measure":{!function(e,t,n,r,o){const s=o+n,i=s+r;Qi(e,{description:t.name,endTimestamp:i,op:t.entryType,origin:"auto.resource.browser.metrics",startTimestamp:s})}(e,t,r,o,n);const s=mi(),i=t.startTime<s.firstHiddenTime;"first-paint"===t.name&&i&&(Hs&&Fe.log("[Measurements] Adding FP"),sa.fp={value:t.startTime,unit:"millisecond"}),"first-contentful-paint"===t.name&&i&&(Hs&&Fe.log("[Measurements] Adding FCP"),sa.fcp={value:t.startTime,unit:"millisecond"});break}case"resource":!function(e,t,n,r,o,s){if("xmlhttprequest"===t.initiatorType||"fetch"===t.initiatorType)return;const i=gn(n),a={};ha(a,t,"transferSize","http.response_transfer_size"),ha(a,t,"encodedBodySize","http.response_content_length"),ha(a,t,"decodedBodySize","http.decoded_response_content_length"),"renderBlockingStatus"in t&&(a["resource.render_blocking_status"]=t.renderBlockingStatus);i.protocol&&(a["url.scheme"]=i.protocol.split(":").pop());i.host&&(a["server.address"]=i.host);a["url.same_origin"]=n.includes(ii.location.origin);const c=s+r,l=c+o;Qi(e,{description:n.replace(ii.location.origin,""),endTimestamp:l,op:t.initiatorType?`resource.${t.initiatorType}`:"resource.other",origin:"auto.resource.browser.metrics",startTimestamp:c,data:a})}(e,t,t.name,r,o,n)}})),oa=Math.max(r.length-1,0),function(e){const t=ii.navigator;if(!t)return;const n=t.connection;n&&(n.effectiveType&&e.setTag("effectiveConnectionType",n.effectiveType),n.type&&e.setTag("connectionType",n.type),Ki(n.rtt)&&(sa["connection.rtt"]={value:n.rtt,unit:"millisecond"}));Ki(t.deviceMemory)&&e.setTag("deviceMemory",`${t.deviceMemory} GB`);Ki(t.hardwareConcurrency)&&e.setTag("hardwareConcurrency",String(t.hardwareConcurrency))}(e),"pageload"===o){!function(e){const t=li();if(!t)return;const{responseStart:n,requestStart:r}=t;r<=n&&(Hs&&Fe.log("[Measurements] Adding TTFB Request Time"),e["ttfb.requestTime"]={value:n-r,unit:"millisecond"})}(sa),["fcp","fp","lcp"].forEach((e=>{if(!sa[e]||!s||n>=s)return;const t=sa[e].value,r=n+ea(t),o=Math.abs(1e3*(r-s)),i=o-t;Hs&&Fe.log(`[Measurements] Normalized ${e} from ${t} to ${o} (${i})`),sa[e].value=o}));const t=sa["mark.fid"];t&&sa.fid&&(Qi(e,{description:"first input delay",endTimestamp:t.value+ea(sa.fid.value),op:"ui.action",origin:"auto.ui.browser.metrics",startTimestamp:t.value}),delete sa["mark.fid"]),"fcp"in sa||delete sa.cls,Object.keys(sa).forEach((e=>{$o(e,sa[e].value,sa[e].unit)})),function(e){na&&(Hs&&Fe.log("[Measurements] Adding LCP Data"),na.element&&e.setTag("lcp.element",xe(na.element)),na.id&&e.setTag("lcp.id",na.id),na.url&&e.setTag("lcp.url",na.url.trim().slice(0,200)),e.setTag("lcp.size",na.size));ra&&ra.sources&&(Hs&&Fe.log("[Measurements] Adding CLS Data"),ra.sources.forEach(((t,n)=>e.setTag(`cls.source.${n+1}`,xe(t.node)))))}(e)}na=void 0,ra=void 0,sa={}}function pa(e,t,n,r,o,s){const i=s?t[s]:t[`${n}End`],a=t[`${n}Start`];a&&i&&Qi(e,{op:"browser",origin:"auto.browser.browser.metrics",description:o||n,startTimestamp:r+ea(a),endTimestamp:r+ea(i)})}function ha(e,t,n,r){const o=t[n];null!=o&&o<Zi&&(e[r]=o)}function fa(e,t,n,r,o="auto.http.browser"){if(!lo()||!e.fetchData)return;const s=t(e.fetchData.url);if(e.endTimestamp&&s){const t=e.fetchData.__span;if(!t)return;const n=r[t];return void(n&&(!function(e,t){if(t.response){ao(e,t.response.status);const n=t.response&&t.response.headers&&t.response.headers.get("content-length");if(n){const t=parseInt(n);t>0&&e.setAttribute("http.response_content_length",t)}}else t.error&&e.setStatus("internal_error");e.end()}(n,e),delete r[t]))}const i=Cr(),a=kr(),{method:c,url:l}=e.fetchData,u=function(e){try{return new URL(e).href}catch(e){return}}(l),d=u?gn(u).host:void 0,p=s?po({name:`${c} ${l}`,onlyIfParent:!0,attributes:{url:l,type:"fetch","http.method":c,"http.url":u,"server.address":d,[Eo]:o},op:"http.client"}):void 0;if(p&&(e.fetchData.__span=p.spanContext().spanId,r[p.spanContext().spanId]=p),n(e.fetchData.url)&&a){const t=e.args[0];e.args[1]=e.args[1]||{};const n=e.args[1];n.headers=function(e,t,n,r,o){const s=o||n.getSpan(),i=Xr(),{traceId:a,spanId:c,sampled:l,dsc:u}={...i.getPropagationContext(),...n.getPropagationContext()},d=s?hr(s):jn(a,c,l),p=Dn(u||(s?Mr(s):Dr(a,t,n))),h=r.headers||("undefined"!=typeof Request&&fe(e,Request)?e.headers:void 0);if(h){if("undefined"!=typeof Headers&&fe(h,Headers)){const e=new Headers(h);return e.append("sentry-trace",d),p&&e.append(xn,p),e}if(Array.isArray(h)){const e=[...h,["sentry-trace",d]];return p&&e.push([xn,p]),e}{const e="baggage"in h?h.baggage:void 0,t=[];return Array.isArray(e)?t.push(...e):e&&t.push(e),p&&t.push(p),{...h,"sentry-trace":d,baggage:t.length>0?t.join(","):void 0}}}return{"sentry-trace":d,baggage:p}}(t,a,i,n,p)}return p}const ga=["localhost",/^\/(?!\/)/],ma={traceFetch:!0,traceXHR:!0,enableHTTPTimings:!0,tracingOrigins:ga,tracePropagationTargets:ga};function ya(e){const{traceFetch:t,traceXHR:n,tracePropagationTargets:r,tracingOrigins:o,shouldCreateSpanForRequest:s,enableHTTPTimings:i}={traceFetch:ma.traceFetch,traceXHR:ma.traceXHR,...e},a="function"==typeof s?s:e=>!0,c=e=>function(e,t){return ve(e,t||ga)}(e,r||o),l={};t&&Nt((e=>{const t=fa(e,a,c,l);if(t){const n=Sa(e.fetchData.url),r=n?gn(n).host:void 0;t.setAttributes({"http.url":n,"server.address":r})}i&&t&&_a(t)})),n&&Xt((e=>{const t=function(e,t,n,r){const o=e.xhr,s=o&&o[Yt];if(!lo()||!o||o.__sentry_own_request__||!s)return;const i=t(s.url);if(e.endTimestamp&&i){const e=o.__sentry_xhr_span_id__;if(!e)return;const t=r[e];return void(t&&void 0!==s.status_code&&(ao(t,s.status_code),t.end(),delete r[e]))}const a=Cr(),c=Xr(),l=Sa(s.url),u=l?gn(l).host:void 0,d=i?po({name:`${s.method} ${s.url}`,onlyIfParent:!0,attributes:{type:"xhr","http.method":s.method,"http.url":l,url:s.url,"server.address":u,[Eo]:"auto.http.browser"},op:"http.client"}):void 0;d&&(o.__sentry_xhr_span_id__=d.spanContext().spanId,r[o.__sentry_xhr_span_id__]=d);const p=kr();if(o.setRequestHeader&&n(s.url)&&p){const{traceId:e,spanId:t,sampled:n,dsc:r}={...c.getPropagationContext(),...a.getPropagationContext()};!function(e,t,n){try{e.setRequestHeader("sentry-trace",t),n&&e.setRequestHeader(xn,n)}catch(e){}}(o,d?hr(d):jn(e,t,n),Dn(r||(d?Mr(d):Dr(e,p,a))))}return d}(e,a,c,l);i&&t&&_a(t)}))}function _a(e){const{url:t}=mr(e).data||{};if(!t||"string"!=typeof t)return;const n=Gi("resource",(({entries:r})=>{r.forEach((r=>{if(function(e){return"resource"===e.entryType&&"initiatorType"in e&&"string"==typeof e.nextHopProtocol&&("fetch"===e.initiatorType||"xmlhttprequest"===e.initiatorType)}(r)&&r.name.endsWith(t)){(function(e){const{name:t,version:n}=function(e){let t="unknown",n="unknown",r="";for(const o of e){if("/"===o){[t,n]=e.split("/");break}if(!isNaN(Number(o))){t="h"===r?"http":r,n=e.split(r)[1];break}r+=o}r===e&&(t=r);return{name:t,version:n}}(e.nextHopProtocol),r=[];if(r.push(["network.protocol.version",n],["network.protocol.name",t]),!Cn)return r;return[...r,["http.request.redirect_start",va(e.redirectStart)],["http.request.fetch_start",va(e.fetchStart)],["http.request.domain_lookup_start",va(e.domainLookupStart)],["http.request.domain_lookup_end",va(e.domainLookupEnd)],["http.request.connect_start",va(e.connectStart)],["http.request.secure_connection_start",va(e.secureConnectionStart)],["http.request.connection_end",va(e.connectEnd)],["http.request.request_start",va(e.requestStart)],["http.request.response_start",va(e.responseStart)],["http.request.response_end",va(e.responseEnd)]]})(r).forEach((t=>e.setAttribute(...t))),setTimeout(n)}}))}))}function va(e=0){return((Cn||performance.timeOrigin)+e)/1e3}function Sa(e){try{return new URL(e,ii.location.origin).href}catch(e){return}}const Ta={...ko,markBackgroundTransactions:!0,routingInstrumentation:function(e,t=!0,n=!0){if(!ii||!ii.location)return void(Hs&&Fe.warn("Could not initialize routing instrumentation due to invalid location"));let r,o=ii.location.href;t&&(r=e({name:ii.location.pathname,startTimestamp:Cn?Cn/1e3:void 0,op:"pageload",origin:"auto.pageload.browser",metadata:{source:"url"}})),n&&Ht((({to:t,from:n})=>{void 0===n&&o&&-1!==o.indexOf(t)?o=void 0:n!==t&&(o=void 0,r&&(Hs&&Fe.log(`[Tracing] Finishing current transaction with op: ${r.op}`),r.end()),r=e({name:ii.location.pathname,op:"navigation",origin:"auto.navigation.browser",metadata:{source:"url"}}))}))},startTransactionOnLocationChange:!0,startTransactionOnPageLoad:!0,enableLongTask:!0,enableInp:!1,interactionsSampleRate:1,_experiments:{},...ma};function ba(e){const t=Ne(`meta[name=${e}]`);return t?t.getAttribute("content"):void 0}function wa(e){const t=e.attributes&&e.attributes[To],n=e.data&&e.data[To],r=e.metadata&&e.metadata.source;return t||n||r}const Ea={...ko,instrumentNavigation:!0,instrumentPageLoad:!0,markBackgroundSpan:!0,enableLongTask:!0,enableInp:!1,interactionsSampleRate:1,_experiments:{},...ma};function Ia(e,t){if(!e.emit)return;e.emit("startPageLoadSpan",t);const n=ho();return"pageload"===(n&&mr(n).op)?n:void 0}function Aa(e,t){if(!e.emit)return;e.emit("startNavigationSpan",t);const n=ho();return"navigation"===(n&&mr(n).op)?n:void 0}function Ra(e){const t=Ne(`meta[name=${e}]`);return t?t.getAttribute("content"):void 0}const ka=10;function Ca(e){const t=e.attributes&&e.attributes[To],n=e.data&&e.data[To],r=e.metadata&&e.metadata.source;return t||n||r}const xa=Ie;let Oa=0;function La(){return Oa>0}function Na(e,t={},n){if("function"!=typeof e)return e;try{const t=e.__sentry_wrapped__;if(t)return t;if(Ye(e))return e}catch(t){return e}const r=function(){const r=Array.prototype.slice.call(arguments);try{n&&"function"==typeof n&&n.apply(this,arguments);const o=r.map((e=>Na(e,t)));return e.apply(this,o)}catch(e){throw Oa++,setTimeout((()=>{Oa--})),Rr((n=>{n.addEventProcessor((e=>(t.mechanism&&(yt(e,void 0,void 0),_t(e,t.mechanism)),e.extra={...e.extra,arguments:r},e))),br(e)})),e}};try{for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=e[t])}catch(e){}ze(r,e),Je(e,"__sentry_wrapped__",r);try{Object.getOwnPropertyDescriptor(r,"name").configurable&&Object.defineProperty(r,"name",{get:()=>e.name})}catch(e){}return r}const Pa="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__;function Da(e,t){const n=Ua(e,t),r={type:t&&t.name,value:Fa(t)};return n.length&&(r.stacktrace={frames:n}),void 0===r.type&&""===r.value&&(r.value="Unrecoverable error caught"),r}function Ma(e,t){return{exception:{values:[Da(e,t)]}}}function Ua(e,t){const n=t.stacktrace||t.stack||"",r=function(e){if(e){if("number"==typeof e.framesToPop)return e.framesToPop;if($a.test(e.message))return 1}return 0}(t);try{return e(n,r)}catch(e){}return[]}const $a=/Minified React error #\d+;/i;function Fa(e){const t=e&&e.message;return t?t.error&&"string"==typeof t.error.message?t.error.message:t:"No error message"}function ja(e,t,n,r){const o=Va(e,t,n&&n.syntheticException||void 0,r);return _t(o),o.level="error",n&&n.event_id&&(o.event_id=n.event_id),dn(o)}function Ga(e,t,n="info",r,o){const s=qa(e,t,r&&r.syntheticException||void 0,o);return s.level=n,r&&r.event_id&&(s.event_id=r.event_id),dn(s)}function Va(e,t,n,r,o){let s;if(oe(t)&&t.error){return Ma(e,t.error)}if(se(t)||re(t,"DOMException")){const o=t;if("stack"in t)s=Ma(e,t);else{const t=o.name||(se(o)?"DOMError":"DOMException"),i=o.message?`${t}: ${o.message}`:t;s=qa(e,i,n,r),yt(s,i)}return"code"in o&&(s.tags={...s.tags,"DOMException.code":`${o.code}`}),s}if(ne(t))return Ma(e,t);if(le(t)||ue(t)){return s=function(e,t,n,r){const o=kr(),s=o&&o.getOptions().normalizeDepth,i={exception:{values:[{type:ue(t)?t.constructor.name:r?"UnhandledRejection":"Error",value:Wa(t,{isUnhandledRejection:r})}]},extra:{__serialized__:rn(t,s)}};if(n){const t=Ua(e,n);t.length&&(i.exception.values[0].stacktrace={frames:t})}return i}(e,t,n,o),_t(s,{synthetic:!0}),s}return s=qa(e,t,n,r),yt(s,`${t}`,void 0),_t(s,{synthetic:!0}),s}function qa(e,t,n,r){const o={};if(r&&n){const r=Ua(e,n);r.length&&(o.exception={values:[{value:t,stacktrace:{frames:r}}]})}if(ae(t)){const{__sentry_template_string__:e,__sentry_template_values__:n}=t;return o.logentry={message:e,params:n},o}return o.message=t,o}function Wa(e,{isUnhandledRejection:t}){const n=function(e,t=40){const n=Object.keys(Xe(e));if(n.sort(),!n.length)return"[object has no keys]";if(n[0].length>=t)return me(n[0],t);for(let e=n.length;e>0;e--){const r=n.slice(0,e).join(", ");if(!(r.length>t))return e===n.length?r:me(r,t)}return""}(e),r=t?"promise rejection":"exception";if(oe(e))return`Event \`ErrorEvent\` captured as ${r} with message \`${e.message}\``;if(ue(e)){return`Event \`${function(e){try{const t=Object.getPrototypeOf(e);return t?t.constructor.name:void 0}catch(e){}}(e)}\` (type=${e.type}) captured as ${r}`}return`Object captured as ${r} with keys: ${n}`}function Ba(e,{metadata:t,tunnel:n,dsn:r}){const o={event_id:e.event_id,sent_at:(new Date).toISOString(),...t&&t.sdk&&{sdk:{name:t.sdk.name,version:t.sdk.version}},...!!n&&!!r&&{dsn:Ge(r)}},s=function(e){return[{type:"user_report"},e]}(e);return Gn(o,[s])}class Ha extends es{constructor(e){!function(e,t,n=[t],r="npm"){const o=e._metadata||{};o.sdk||(o.sdk={name:`sentry.javascript.${t}`,packages:n.map((e=>({name:`${r}:@sentry/${e}`,version:qr}))),version:qr}),e._metadata=o}(e,"browser",["browser"],xa.SENTRY_SDK_SOURCE||"npm"),super(e),e.sendClientReports&&xa.document&&xa.document.addEventListener("visibilitychange",(()=>{"hidden"===xa.document.visibilityState&&this._flushOutcomes()}))}eventFromException(e,t){return ja(this._options.stackParser,e,t,this._options.attachStacktrace)}eventFromMessage(e,t="info",n){return Ga(this._options.stackParser,e,t,n,this._options.attachStacktrace)}captureUserFeedback(e){if(!this._isEnabled())return void(Pa&&Fe.warn("SDK not enabled, will not capture user feedback."));const t=Ba(e,{metadata:this.getSdkMetadata(),dsn:this.getDsn(),tunnel:this.getOptions().tunnel});this._sendEnvelope(t)}_prepareEvent(e,t,n){return e.platform=e.platform||"javascript",super._prepareEvent(e,t,n)}_flushOutcomes(){const e=this._clearOutcomes();if(0===e.length)return void(Pa&&Fe.log("No outcomes to send"));if(!this._dsn)return void(Pa&&Fe.log("No dsn provided, will not send outcomes"));Pa&&Fe.log("Sending outcomes:",e);const t=(n=e,Gn((r=this._options.tunnel&&Ge(this._dsn))?{dsn:r}:{},[[{type:"client_report"},{timestamp:o||Rn(),discarded_events:n}]]));var n,r,o;this._sendEnvelope(t)}}let Ja;function za(e,t=function(){if(Ja)return Ja;if(Ot(xa.fetch))return Ja=xa.fetch.bind(xa);const e=xa.document;let t=xa.fetch;if(e&&"function"==typeof e.createElement)try{const n=e.createElement("iframe");n.hidden=!0,e.head.appendChild(n);const r=n.contentWindow;r&&r.fetch&&(t=r.fetch),e.head.removeChild(n)}catch(e){Pa&&Fe.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",e)}return Ja=t.bind(xa)}()){let n=0,r=0;return as(e,(function(o){const s=o.body.length;n+=s,r++;const i={body:o.body,method:"POST",referrerPolicy:"origin",headers:e.headers,keepalive:n<=6e4&&r<15,...e.fetchOptions};try{return t(e.url,i).then((e=>(n-=s,r--,{statusCode:e.status,headers:{"x-sentry-rate-limits":e.headers.get("X-Sentry-Rate-Limits"),"retry-after":e.headers.get("Retry-After")}})))}catch(e){return Ja=void 0,n-=s,r--,pn(e)}}))}const Ya=4;function Xa(e){return as(e,(function(t){return new hn(((n,r)=>{const o=new XMLHttpRequest;o.onerror=r,o.onreadystatechange=()=>{o.readyState===Ya&&n({statusCode:o.status,headers:{"x-sentry-rate-limits":o.getResponseHeader("X-Sentry-Rate-Limits"),"retry-after":o.getResponseHeader("Retry-After")}})},o.open("POST",e.url);for(const t in e.headers)Object.prototype.hasOwnProperty.call(e.headers,t)&&o.setRequestHeader(t,e.headers[t]);o.send(t.body)}))}))}const Ka="?";function Qa(e,t,n,r){const o={filename:e,function:t,in_app:!0};return void 0!==n&&(o.lineno=n),void 0!==r&&(o.colno=r),o}const Za=/^\s*at (?:(.+?\)(?: \[.+\])?|.*?) ?\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\/)?.*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,ec=/\((\S*)(?::(\d+))(?::(\d+))\)/,tc=[30,e=>{const t=Za.exec(e);if(t){if(t[2]&&0===t[2].indexOf("eval")){const e=ec.exec(t[2]);e&&(t[2]=e[1],t[3]=e[2],t[4]=e[3])}const[e,n]=hc(t[1]||Ka,t[2]);return Qa(n,e,t[3]?+t[3]:void 0,t[4]?+t[4]:void 0)}}],nc=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:[-a-z]+)?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,rc=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,oc=[50,e=>{const t=nc.exec(e);if(t){if(t[3]&&t[3].indexOf(" > eval")>-1){const e=rc.exec(t[3]);e&&(t[1]=t[1]||"eval",t[3]=e[1],t[4]=e[2],t[5]="")}let e=t[3],n=t[1]||Ka;return[n,e]=hc(n,e),Qa(e,n,t[4]?+t[4]:void 0,t[5]?+t[5]:void 0)}}],sc=/^\s*at (?:((?:\[object object\])?.+) )?\(?((?:[-a-z]+):.*?):(\d+)(?::(\d+))?\)?\s*$/i,ic=[40,e=>{const t=sc.exec(e);return t?Qa(t[2],t[1]||Ka,+t[3],t[4]?+t[4]:void 0):void 0}],ac=/ line (\d+).*script (?:in )?(\S+)(?:: in function (\S+))?$/i,cc=[10,e=>{const t=ac.exec(e);return t?Qa(t[2],t[3]||Ka,+t[1]):void 0}],lc=/ line (\d+), column (\d+)\s*(?:in (?:<anonymous function: ([^>]+)>|([^)]+))\(.*\))? in (.*):\s*$/i,uc=[20,e=>{const t=lc.exec(e);return t?Qa(t[5],t[3]||t[4]||Ka,+t[1],+t[2]):void 0}],dc=[tc,oc,ic],pc=ot(...dc),hc=(e,t)=>{const n=-1!==e.indexOf("safari-extension"),r=-1!==e.indexOf("safari-web-extension");return n||r?[-1!==e.indexOf("@")?e.split("@")[0]:Ka,n?`safari-extension:${t}`:`safari-web-extension:${t}`]:[e,t]},fc=1024,gc="Breadcrumbs",mc=(e={})=>{const t={console:!0,dom:!0,fetch:!0,history:!0,sentry:!0,xhr:!0,...e};return{name:gc,setupOnce(){},setup(e){t.console&&pt(function(e){return function(t){if(kr()!==e)return;const n={category:"console",data:{arguments:t.args,logger:"console"},level:In(t.level),message:_e(t.args," ")};if("assert"===t.level){if(!1!==t.args[0])return;n.message=`Assertion failed: ${_e(t.args.slice(1)," ")||"console.assert"}`,n.data.arguments=t.args.slice(1)}Ir(n,{input:t.args,level:t.level})}}(e)),t.dom&&At(function(e,t){return function(n){if(kr()!==e)return;let r,o,s="object"==typeof t?t.serializeAttribute:void 0,i="object"==typeof t&&"number"==typeof t.maxStringLength?t.maxStringLength:void 0;i&&i>fc&&(Pa&&Fe.warn(`\`dom.maxStringLength\` cannot exceed 1024, but a value of ${i} was configured. Sentry will use 1024 instead.`),i=fc),"string"==typeof s&&(s=[s]);try{const e=n.event,t=function(e){return!!e&&!!e.target}(e)?e.target:e;r=xe(t,{keyAttrs:s,maxStringLength:i}),o=Pe(t)}catch(e){r="<unknown>"}if(0===r.length)return;const a={category:`ui.${n.name}`,message:r};o&&(a.data={"ui.component_name":o}),Ir(a,{event:n.event,name:n.name,global:n.global})}}(e,t.dom)),t.xhr&&Xt(function(e){return function(t){if(kr()!==e)return;const{startTimestamp:n,endTimestamp:r}=t,o=t.xhr[Yt];if(!n||!r||!o)return;const{method:s,url:i,status_code:a,body:c}=o;Ir({category:"xhr",data:{method:s,url:i,status_code:a},type:"http"},{xhr:t.xhr,input:c,startTimestamp:n,endTimestamp:r})}}(e)),t.fetch&&Nt(function(e){return function(t){if(kr()!==e)return;const{startTimestamp:n,endTimestamp:r}=t;if(r&&(!t.fetchData.url.match(/sentry_key/)||"POST"!==t.fetchData.method))if(t.error){Ir({category:"fetch",data:t.fetchData,level:"error",type:"http"},{data:t.error,input:t.args,startTimestamp:n,endTimestamp:r})}else{const e=t.response;Ir({category:"fetch",data:{...t.fetchData,status_code:e&&e.status},type:"http"},{input:t.args,response:e,startTimestamp:n,endTimestamp:r})}}}(e)),t.history&&Ht(function(e){return function(t){if(kr()!==e)return;let n=t.from,r=t.to;const o=gn(xa.location.href);let s=n?gn(n):void 0;const i=gn(r);s&&s.path||(s=o),o.protocol===i.protocol&&o.host===i.host&&(r=i.relative),o.protocol===s.protocol&&o.host===s.host&&(n=s.relative),Ir({category:"navigation",data:{from:n,to:r}})}}(e)),t.sentry&&e.on&&e.on("beforeSendEvent",function(e){return function(t){kr()===e&&Ir({category:"sentry."+("transaction"===t.type?"transaction":"event"),event_id:t.event_id,level:t.level,message:mt(t)},{event:t})}}(e))}}},yc=zo(gc,mc);const _c="Dedupe",vc=()=>{let e;return{name:_c,setupOnce(){},processEvent(t){if(t.type)return t;try{if(function(e,t){if(!t)return!1;if(function(e,t){const n=e.message,r=t.message;if(!n&&!r)return!1;if(n&&!r||!n&&r)return!1;if(n!==r)return!1;if(!bc(e,t))return!1;if(!Tc(e,t))return!1;return!0}(e,t))return!0;if(function(e,t){const n=wc(t),r=wc(e);if(!n||!r)return!1;if(n.type!==r.type||n.value!==r.value)return!1;if(!bc(e,t))return!1;if(!Tc(e,t))return!1;return!0}(e,t))return!0;return!1}(t,e))return Pa&&Fe.warn("Event dropped due to being a duplicate of previously captured event."),null}catch(e){}return e=t}}},Sc=zo(_c,vc);function Tc(e,t){let n=Ec(e),r=Ec(t);if(!n&&!r)return!0;if(n&&!r||!n&&r)return!1;if(r.length!==n.length)return!1;for(let e=0;e<r.length;e++){const t=r[e],o=n[e];if(t.filename!==o.filename||t.lineno!==o.lineno||t.colno!==o.colno||t.function!==o.function)return!1}return!0}function bc(e,t){let n=e.fingerprint,r=t.fingerprint;if(!n&&!r)return!0;if(n&&!r||!n&&r)return!1;try{return!(n.join("")!==r.join(""))}catch(e){return!1}}function wc(e){return e.exception&&e.exception.values&&e.exception.values[0]}function Ec(e){const t=e.exception;if(t)try{return t.values[0].stacktrace.frames}catch(e){return}}const Ic="GlobalHandlers",Ac=(e={})=>{const t={onerror:!0,onunhandledrejection:!0,...e};return{name:Ic,setupOnce(){Error.stackTraceLimit=50},setup(e){t.onerror&&(!function(e){$t((t=>{const{stackParser:n,attachStacktrace:r}=xc();if(kr()!==e||La())return;const{msg:o,url:s,line:i,column:a,error:c}=t,l=void 0===c&&ie(o)?function(e,t,n,r){const o=/^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?(.*)$/i;let s=oe(e)?e.message:e,i="Error";const a=s.match(o);a&&(i=a[1],s=a[2]);const c={exception:{values:[{type:i,value:s}]}};return kc(c,t,n,r)}(o,s,i,a):kc(Va(n,c||o,void 0,r,!1),s,i,a);l.level="error",Er(l,{originalException:c,mechanism:{handled:!1,type:"onerror"}})}))}(e),Cc("onerror")),t.onunhandledrejection&&(!function(e){Gt((t=>{const{stackParser:n,attachStacktrace:r}=xc();if(kr()!==e||La())return;const o=function(e){if(ce(e))return e;const t=e;try{if("reason"in t)return t.reason;if("detail"in t&&"reason"in t.detail)return t.detail.reason}catch(e){}return e}(t),s=ce(o)?{exception:{values:[{type:"UnhandledRejection",value:`Non-Error promise rejection captured with value: ${String(o)}`}]}}:Va(n,o,void 0,r,!0);s.level="error",Er(s,{originalException:o,mechanism:{handled:!1,type:"onunhandledrejection"}})}))}(e),Cc("onunhandledrejection"))}}},Rc=zo(Ic,Ac);function kc(e,t,n,r){const o=e.exception=e.exception||{},s=o.values=o.values||[],i=s[0]=s[0]||{},a=i.stacktrace=i.stacktrace||{},c=a.frames=a.frames||[],l=isNaN(parseInt(r,10))?void 0:r,u=isNaN(parseInt(n,10))?void 0:n,d=ie(t)&&t.length>0?t:Le();return 0===c.length&&c.push({colno:l,filename:d,function:"?",in_app:!0,lineno:u}),e}function Cc(e){Pa&&Fe.log(`Global Handler attached: ${e}`)}function xc(){const e=kr();return e&&e.getOptions()||{stackParser:()=>[],attachStacktrace:!1}}const Oc="HttpContext",Lc=()=>({name:Oc,setupOnce(){},preprocessEvent(e){if(!xa.navigator&&!xa.location&&!xa.document)return;const t=e.request&&e.request.url||xa.location&&xa.location.href,{referrer:n}=xa.document||{},{userAgent:r}=xa.navigator||{},o={...e.request&&e.request.headers,...n&&{Referer:n},...r&&{"User-Agent":r}},s={...e.request,...t&&{url:t},headers:o};e.request=s}}),Nc=zo(Oc,Lc),Pc="LinkedErrors",Dc=(e={})=>{const t=e.limit||5,n=e.key||"cause";return{name:Pc,setupOnce(){},preprocessEvent(e,r,o){const s=o.getOptions();Se(Da,s.stackParser,s.maxValueLength,n,t,e,r)}}},Mc=zo(Pc,Dc),Uc=["EventTarget","Window","Node","ApplicationCache","AudioTrackList","BroadcastChannel","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","SharedWorker","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"],$c="TryCatch",Fc=(e={})=>{const t={XMLHttpRequest:!0,eventTarget:!0,requestAnimationFrame:!0,setInterval:!0,setTimeout:!0,...e};return{name:$c,setupOnce(){t.setTimeout&&He(xa,"setTimeout",Gc),t.setInterval&&He(xa,"setInterval",Gc),t.requestAnimationFrame&&He(xa,"requestAnimationFrame",Vc),t.XMLHttpRequest&&"XMLHttpRequest"in xa&&He(XMLHttpRequest.prototype,"send",qc);const e=t.eventTarget;if(e){(Array.isArray(e)?e:Uc).forEach(Wc)}}}},jc=zo($c,Fc);function Gc(e){return function(...t){const n=t[0];return t[0]=Na(n,{mechanism:{data:{function:it(e)},handled:!1,type:"instrument"}}),e.apply(this,t)}}function Vc(e){return function(t){return e.apply(this,[Na(t,{mechanism:{data:{function:"requestAnimationFrame",handler:it(e)},handled:!1,type:"instrument"}})])}}function qc(e){return function(...t){const n=this;return["onload","onerror","onprogress","onreadystatechange"].forEach((e=>{e in n&&"function"==typeof n[e]&&He(n,e,(function(t){const n={mechanism:{data:{function:e,handler:it(t)},handled:!1,type:"instrument"}},r=Ye(t);return r&&(n.mechanism.data.handler=it(r)),Na(t,n)}))})),e.apply(this,t)}}function Wc(e){const t=xa,n=t[e]&&t[e].prototype;n&&n.hasOwnProperty&&n.hasOwnProperty("addEventListener")&&(He(n,"addEventListener",(function(t){return function(n,r,o){try{"function"==typeof r.handleEvent&&(r.handleEvent=Na(r.handleEvent,{mechanism:{data:{function:"handleEvent",handler:it(r),target:e},handled:!1,type:"instrument"}}))}catch(e){}return t.apply(this,[n,Na(r,{mechanism:{data:{function:"addEventListener",handler:it(r),target:e},handled:!1,type:"instrument"}}),o])}})),He(n,"removeEventListener",(function(e){return function(t,n,r){const o=n;try{const n=o&&o.__sentry_wrapped__;n&&e.call(this,t,n,r)}catch(e){}return e.call(this,t,o,r)}})))}const Bc=[Cs(),Ds(),Fc(),mc(),Ac(),Dc(),vc(),Lc()];function Hc(e){return[...Bc]}function Jc(e={}){void 0===e.defaultIntegrations&&(e.defaultIntegrations=Hc()),void 0===e.release&&("string"==typeof __SENTRY_RELEASE__&&(e.release=__SENTRY_RELEASE__),xa.SENTRY_RELEASE&&xa.SENTRY_RELEASE.id&&(e.release=xa.SENTRY_RELEASE.id)),void 0===e.autoSessionTracking&&(e.autoSessionTracking=!0),void 0===e.sendClientReports&&(e.sendClientReports=!0);const t={...e,stackParser:(n=e.stackParser||pc,Array.isArray(n)?ot(...n):n),integrations:Bo(e),transport:e.transport||(xt()?za:Xa)};var n;!function(e,t){!0===t.debug&&(rr?Fe.enable():$e((()=>{console.warn("[Sentry] Cannot initialize SDK with `debug` option using a non-debug bundle.")}))),Cr().update(t.initialScope);const n=new e(t);ss(n),function(e){e.init?e.init():e.setupIntegrations&&e.setupIntegrations()}(n)}(Ha,t),e.autoSessionTracking&&function(){if(void 0===xa.document)return void(Pa&&Fe.warn("Session tracking in non-browser environment with @sentry/browser is not supported."));xr({ignoreDuration:!0}),Nr(),Ht((({from:e,to:t})=>{void 0!==e&&e!==t&&(xr({ignoreDuration:!0}),Nr())}))}()}var zc=Object.freeze({__proto__:null,GlobalHandlers:Rc,TryCatch:jc,Breadcrumbs:yc,LinkedErrors:Mc,HttpContext:Nc,Dedupe:Sc});const Yc=Ie,Xc="sentryReplaySession",Kc="replay_event",Qc="Unable to send Replay",Zc=15e4,el=5e3,tl=2e7,nl=36e5;function rl(e){let t,n=e[0],r=1;for(;r<e.length;){const o=e[r],s=e[r+1];if(r+=2,("optionalAccess"===o||"optionalCall"===o)&&null==n)return;"access"===o||"optionalAccess"===o?(t=n,n=s(n)):"call"!==o&&"optionalCall"!==o||(n=s(((...e)=>n.call(t,...e))),t=void 0)}return n}var ol;function sl(e){const t=rl([e,"optionalAccess",e=>e.host]);return Boolean(rl([t,"optionalAccess",e=>e.shadowRoot])===e)}function il(e){return"[object ShadowRoot]"===Object.prototype.toString.call(e)}function al(e){try{const n=e.rules||e.cssRules;return n?((t=Array.from(n,cl).join("")).includes(" background-clip: text;")&&!t.includes(" -webkit-background-clip: text;")&&(t=t.replace(" background-clip: text;"," -webkit-background-clip: text; background-clip: text;")),t):null}catch(e){return null}var t}function cl(e){let t;if(function(e){return"styleSheet"in e}(e))try{t=al(e.styleSheet)||function(e){const{cssText:t}=e;if(t.split('"').length<3)return t;const n=["@import",`url(${JSON.stringify(e.href)})`];return""===e.layerName?n.push("layer"):e.layerName&&n.push(`layer(${e.layerName})`),e.supportsText&&n.push(`supports(${e.supportsText})`),e.media.length&&n.push(e.media.mediaText),n.join(" ")+";"}(e)}catch(e){}else if(function(e){return"selectorText"in e}(e)&&e.selectorText.includes(":"))return function(e){const t=/(\[(?:[\w-]+)[^\\])(:(?:[\w-]+)\])/gm;return e.replace(t,"$1\\$2")}(e.cssText);return t||e.cssText}!function(e){e[e.Document=0]="Document",e[e.DocumentType=1]="DocumentType",e[e.Element=2]="Element",e[e.Text=3]="Text",e[e.CDATA=4]="CDATA",e[e.Comment=5]="Comment"}(ol||(ol={}));class ll{constructor(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}getId(e){if(!e)return-1;const t=rl([this,"access",e=>e.getMeta,"call",t=>t(e),"optionalAccess",e=>e.id]);return r=()=>-1,null!=(n=t)?n:r();var n,r}getNode(e){return this.idNodeMap.get(e)||null}getIds(){return Array.from(this.idNodeMap.keys())}getMeta(e){return this.nodeMetaMap.get(e)||null}removeNodeFromMap(e){const t=this.getId(e);this.idNodeMap.delete(t),e.childNodes&&e.childNodes.forEach((e=>this.removeNodeFromMap(e)))}has(e){return this.idNodeMap.has(e)}hasNode(e){return this.nodeMetaMap.has(e)}add(e,t){const n=t.id;this.idNodeMap.set(n,e),this.nodeMetaMap.set(e,t)}replace(e,t){const n=this.getNode(e);if(n){const e=this.nodeMetaMap.get(n);e&&this.nodeMetaMap.set(t,e)}this.idNodeMap.set(e,t)}reset(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}}function ul({maskInputOptions:e,tagName:t,type:n}){return"OPTION"===t&&(t="SELECT"),Boolean(e[t.toLowerCase()]||n&&e[n]||"password"===n||"INPUT"===t&&!n&&e.text)}function dl({isMasked:e,element:t,value:n,maskInputFn:r}){let o=n||"";return e?(r&&(o=r(o,t)),"*".repeat(o.length)):o}function pl(e){return e.toLowerCase()}function hl(e){return e.toUpperCase()}const fl="__rrweb_original__";function gl(e){const t=e.type;return e.hasAttribute("data-rr-is-password")?"password":t?pl(t):null}function ml(e,t,n){return"INPUT"!==t||"radio"!==n&&"checkbox"!==n?e.value:e.getAttribute("value")||""}let yl=1;const _l=new RegExp("[^a-z0-9-_:]"),vl=-2;function Sl(){return yl++}let Tl,bl;const wl=/url\((?:(')([^']*)'|(")(.*?)"|([^)]*))\)/gm,El=/^(?:[a-z+]+:)?\/\//i,Il=/^www\..*/i,Al=/^(data:)([^,]*),(.*)/i;function Rl(e,t){return(e||"").replace(wl,((e,n,r,o,s,i)=>{const a=r||s||i,c=n||o||"";if(!a)return e;if(El.test(a)||Il.test(a))return`url(${c}${a}${c})`;if(Al.test(a))return`url(${c}${a}${c})`;if("/"===a[0])return`url(${c}${function(e){let t="";return t=e.indexOf("//")>-1?e.split("/").slice(0,3).join("/"):e.split("/")[0],t=t.split("?")[0],t}(t)+a}${c})`;const l=t.split("/"),u=a.split("/");l.pop();for(const e of u)"."!==e&&(".."===e?l.pop():l.push(e));return`url(${c}${l.join("/")}${c})`}))}const kl=/^[^ \t\n\r\u000c]+/,Cl=/^[, \t\n\r\u000c]+/;function xl(e,t){if(!t||""===t.trim())return t;const n=e.createElement("a");return n.href=t,n.href}function Ol(e){return Boolean("svg"===e.tagName||e.ownerSVGElement)}function Ll(){const e=document.createElement("a");return e.href="",e.href}function Nl(e,t,n,r,o,s){return r?"src"===n||"href"===n&&("use"!==t||"#"!==r[0])||"xlink:href"===n&&"#"!==r[0]?xl(e,r):"background"!==n||"table"!==t&&"td"!==t&&"th"!==t?"srcset"===n?function(e,t){if(""===t.trim())return t;let n=0;function r(e){let r;const o=e.exec(t.substring(n));return o?(r=o[0],n+=r.length,r):""}const o=[];for(;r(Cl),!(n>=t.length);){let s=r(kl);if(","===s.slice(-1))s=xl(e,s.substring(0,s.length-1)),o.push(s);else{let r="";s=xl(e,s);let i=!1;for(;;){const e=t.charAt(n);if(""===e){o.push((s+r).trim());break}if(i)")"===e&&(i=!1);else{if(","===e){n+=1,o.push((s+r).trim());break}"("===e&&(i=!0)}r+=e,n+=1}}}return o.join(", ")}(e,r):"style"===n?Rl(r,Ll()):"object"===t&&"data"===n?xl(e,r):"function"==typeof s?s(n,r,o):r:xl(e,r):r}function Pl(e,t,n){return("video"===e||"audio"===e)&&"autoplay"===t}function Dl(e,t,n=1/0,r=0){return e?e.nodeType!==e.ELEMENT_NODE||r>n?-1:t(e)?r:Dl(e.parentNode,t,n,r+1):-1}function Ml(e,t){return n=>{const r=n;if(null===r)return!1;try{if(e)if("string"==typeof e){if(r.matches(`.${e}`))return!0}else if(function(e,t){for(let n=e.classList.length;n--;){const r=e.classList[n];if(t.test(r))return!0}return!1}(r,e))return!0;return!(!t||!r.matches(t))}catch(e){return!1}}}function Ul(e,t,n,r,o,s){try{const i=e.nodeType===e.ELEMENT_NODE?e:e.parentElement;if(null===i)return!1;if("INPUT"===i.tagName){const e=i.getAttribute("autocomplete");if(["current-password","new-password","cc-number","cc-exp","cc-exp-month","cc-exp-year","cc-csc"].includes(e))return!0}let a=-1,c=-1;if(s){if(c=Dl(i,Ml(r,o)),c<0)return!0;a=Dl(i,Ml(t,n),c>=0?c:1/0)}else{if(a=Dl(i,Ml(t,n)),a<0)return!1;c=Dl(i,Ml(r,o),a>=0?a:1/0)}return a>=0?!(c>=0)||a<=c:!(c>=0)&&!!s}catch(e){}return!!s}function $l(e,t){const{doc:n,mirror:r,blockClass:o,blockSelector:s,unblockSelector:i,maskAllText:a,maskAttributeFn:c,maskTextClass:l,unmaskTextClass:u,maskTextSelector:d,unmaskTextSelector:p,inlineStylesheet:h,maskInputOptions:f={},maskTextFn:g,maskInputFn:m,dataURLOptions:y={},inlineImages:_,recordCanvas:v,keepIframeSrcFn:S,newlyAddedElement:T=!1}=t,b=function(e,t){if(!t.hasNode(e))return;const n=t.getId(e);return 1===n?void 0:n}(n,r);switch(e.nodeType){case e.DOCUMENT_NODE:return"CSS1Compat"!==e.compatMode?{type:ol.Document,childNodes:[],compatMode:e.compatMode}:{type:ol.Document,childNodes:[]};case e.DOCUMENT_TYPE_NODE:return{type:ol.DocumentType,name:e.name,publicId:e.publicId,systemId:e.systemId,rootId:b};case e.ELEMENT_NODE:return function(e,t){const{doc:n,blockClass:r,blockSelector:o,unblockSelector:s,inlineStylesheet:i,maskInputOptions:a={},maskAttributeFn:c,maskInputFn:l,dataURLOptions:u={},inlineImages:d,recordCanvas:p,keepIframeSrcFn:h,newlyAddedElement:f=!1,rootId:g,maskAllText:m,maskTextClass:y,unmaskTextClass:_,maskTextSelector:v,unmaskTextSelector:S}=t,T=function(e,t,n,r){try{if(r&&e.matches(r))return!1;if("string"==typeof t){if(e.classList.contains(t))return!0}else for(let n=e.classList.length;n--;){const r=e.classList[n];if(t.test(r))return!0}if(n)return e.matches(n)}catch(e){}return!1}(e,r,o,s),b=function(e){if(e instanceof HTMLFormElement)return"form";const t=pl(e.tagName);return _l.test(t)?"div":t}(e);let w={};const E=e.attributes.length;for(let t=0;t<E;t++){const r=e.attributes[t];r.name&&!Pl(b,r.name,r.value)&&(w[r.name]=Nl(n,b,pl(r.name),r.value,e,c))}if("link"===b&&i){const t=Array.from(n.styleSheets).find((t=>t.href===e.href));let r=null;t&&(r=al(t)),r&&(delete w.rel,delete w.href,w._cssText=Rl(r,t.href))}if("style"===b&&e.sheet&&!(e.innerText||e.textContent||"").trim().length){const t=al(e.sheet);t&&(w._cssText=Rl(t,Ll()))}if("input"===b||"textarea"===b||"select"===b||"option"===b){const t=e,n=gl(t),r=ml(t,hl(b),n),o=t.checked;if("submit"!==n&&"button"!==n&&r){const e=Ul(t,y,v,_,S,ul({type:n,tagName:hl(b),maskInputOptions:a}));w.value=dl({isMasked:e,element:t,value:r,maskInputFn:l})}o&&(w.checked=o)}"option"===b&&(e.selected&&!a.select?w.selected=!0:delete w.selected);if("canvas"===b&&p)if("2d"===e.__context)(function(e){const t=e.getContext("2d");if(!t)return!0;for(let n=0;n<e.width;n+=50)for(let r=0;r<e.height;r+=50){const o=t.getImageData,s=fl in o?o[fl]:o;if(new Uint32Array(s.call(t,n,r,Math.min(50,e.width-n),Math.min(50,e.height-r)).data.buffer).some((e=>0!==e)))return!1}return!0})(e)||(w.rr_dataURL=e.toDataURL(u.type,u.quality));else if(!("__context"in e)){const t=e.toDataURL(u.type,u.quality),n=document.createElement("canvas");n.width=e.width,n.height=e.height;t!==n.toDataURL(u.type,u.quality)&&(w.rr_dataURL=t)}if("img"===b&&d){Tl||(Tl=n.createElement("canvas"),bl=Tl.getContext("2d"));const t=e,r=t.crossOrigin;t.crossOrigin="anonymous";const o=()=>{t.removeEventListener("load",o);try{Tl.width=t.naturalWidth,Tl.height=t.naturalHeight,bl.drawImage(t,0,0),w.rr_dataURL=Tl.toDataURL(u.type,u.quality)}catch(e){console.warn(`Cannot inline img src=${t.currentSrc}! Error: ${e}`)}r?w.crossOrigin=r:t.removeAttribute("crossorigin")};t.complete&&0!==t.naturalWidth?o():t.addEventListener("load",o)}"audio"!==b&&"video"!==b||(w.rr_mediaState=e.paused?"paused":"played",w.rr_mediaCurrentTime=e.currentTime);f||(e.scrollLeft&&(w.rr_scrollLeft=e.scrollLeft),e.scrollTop&&(w.rr_scrollTop=e.scrollTop));if(T){const{width:t,height:n}=e.getBoundingClientRect();w={class:w.class,rr_width:`${t}px`,rr_height:`${n}px`}}"iframe"!==b||h(w.src)||(e.contentDocument||(w.rr_src=w.src),delete w.src);let I;try{customElements.get(b)&&(I=!0)}catch(e){}return{type:ol.Element,tagName:b,attributes:w,childNodes:[],isSVG:Ol(e)||void 0,needBlock:T,rootId:g,isCustom:I}}(e,{doc:n,blockClass:o,blockSelector:s,unblockSelector:i,inlineStylesheet:h,maskAttributeFn:c,maskInputOptions:f,maskInputFn:m,dataURLOptions:y,inlineImages:_,recordCanvas:v,keepIframeSrcFn:S,newlyAddedElement:T,rootId:b,maskAllText:a,maskTextClass:l,unmaskTextClass:u,maskTextSelector:d,unmaskTextSelector:p});case e.TEXT_NODE:return function(e,t){const{maskAllText:n,maskTextClass:r,unmaskTextClass:o,maskTextSelector:s,unmaskTextSelector:i,maskTextFn:a,maskInputOptions:c,maskInputFn:l,rootId:u}=t,d=e.parentNode&&e.parentNode.tagName;let p=e.textContent;const h="STYLE"===d||void 0,f="SCRIPT"===d||void 0,g="TEXTAREA"===d||void 0;if(h&&p){try{e.nextSibling||e.previousSibling||rl([e,"access",e=>e.parentNode,"access",e=>e.sheet,"optionalAccess",e=>e.cssRules])&&(p=al(e.parentNode.sheet))}catch(t){console.warn(`Cannot get CSS styles from text's parentNode. Error: ${t}`,e)}p=Rl(p,Ll())}f&&(p="SCRIPT_PLACEHOLDER");const m=Ul(e,r,s,o,i,n);h||f||g||!p||!m||(p=a?a(p,e.parentElement):p.replace(/[\S]/g,"*"));g&&p&&(c.textarea||m)&&(p=l?l(p,e.parentNode):p.replace(/[\S]/g,"*"));if("OPTION"===d&&p){p=dl({isMasked:Ul(e,r,s,o,i,ul({type:null,tagName:d,maskInputOptions:c})),element:e,value:p,maskInputFn:l})}return{type:ol.Text,textContent:p||"",isStyle:h,rootId:u}}(e,{maskAllText:a,maskTextClass:l,unmaskTextClass:u,maskTextSelector:d,unmaskTextSelector:p,maskTextFn:g,maskInputOptions:f,maskInputFn:m,rootId:b});case e.CDATA_SECTION_NODE:return{type:ol.CDATA,textContent:"",rootId:b};case e.COMMENT_NODE:return{type:ol.Comment,textContent:e.textContent||"",rootId:b};default:return!1}}function Fl(e){return null==e?"":e.toLowerCase()}function jl(e,t){const{doc:n,mirror:r,blockClass:o,blockSelector:s,unblockSelector:i,maskAllText:a,maskTextClass:c,unmaskTextClass:l,maskTextSelector:u,unmaskTextSelector:d,skipChild:p=!1,inlineStylesheet:h=!0,maskInputOptions:f={},maskAttributeFn:g,maskTextFn:m,maskInputFn:y,slimDOMOptions:_,dataURLOptions:v={},inlineImages:S=!1,recordCanvas:T=!1,onSerialize:b,onIframeLoad:w,iframeLoadTimeout:E=5e3,onStylesheetLoad:I,stylesheetLoadTimeout:A=5e3,keepIframeSrcFn:R=(()=>!1),newlyAddedElement:k=!1}=t;let{preserveWhiteSpace:C=!0}=t;const x=$l(e,{doc:n,mirror:r,blockClass:o,blockSelector:s,maskAllText:a,unblockSelector:i,maskTextClass:c,unmaskTextClass:l,maskTextSelector:u,unmaskTextSelector:d,inlineStylesheet:h,maskInputOptions:f,maskAttributeFn:g,maskTextFn:m,maskInputFn:y,dataURLOptions:v,inlineImages:S,recordCanvas:T,keepIframeSrcFn:R,newlyAddedElement:k});if(!x)return console.warn(e,"not serialized"),null;let O;O=r.hasNode(e)?r.getId(e):!function(e,t){if(t.comment&&e.type===ol.Comment)return!0;if(e.type===ol.Element){if(t.script&&("script"===e.tagName||"link"===e.tagName&&("preload"===e.attributes.rel||"modulepreload"===e.attributes.rel)&&"script"===e.attributes.as||"link"===e.tagName&&"prefetch"===e.attributes.rel&&"string"==typeof e.attributes.href&&e.attributes.href.endsWith(".js")))return!0;if(t.headFavicon&&("link"===e.tagName&&"shortcut icon"===e.attributes.rel||"meta"===e.tagName&&(Fl(e.attributes.name).match(/^msapplication-tile(image|color)$/)||"application-name"===Fl(e.attributes.name)||"icon"===Fl(e.attributes.rel)||"apple-touch-icon"===Fl(e.attributes.rel)||"shortcut icon"===Fl(e.attributes.rel))))return!0;if("meta"===e.tagName){if(t.headMetaDescKeywords&&Fl(e.attributes.name).match(/^description|keywords$/))return!0;if(t.headMetaSocial&&(Fl(e.attributes.property).match(/^(og|twitter|fb):/)||Fl(e.attributes.name).match(/^(og|twitter):/)||"pinterest"===Fl(e.attributes.name)))return!0;if(t.headMetaRobots&&("robots"===Fl(e.attributes.name)||"googlebot"===Fl(e.attributes.name)||"bingbot"===Fl(e.attributes.name)))return!0;if(t.headMetaHttpEquiv&&void 0!==e.attributes["http-equiv"])return!0;if(t.headMetaAuthorship&&("author"===Fl(e.attributes.name)||"generator"===Fl(e.attributes.name)||"framework"===Fl(e.attributes.name)||"publisher"===Fl(e.attributes.name)||"progid"===Fl(e.attributes.name)||Fl(e.attributes.property).match(/^article:/)||Fl(e.attributes.property).match(/^product:/)))return!0;if(t.headMetaVerification&&("google-site-verification"===Fl(e.attributes.name)||"yandex-verification"===Fl(e.attributes.name)||"csrf-token"===Fl(e.attributes.name)||"p:domain_verify"===Fl(e.attributes.name)||"verify-v1"===Fl(e.attributes.name)||"verification"===Fl(e.attributes.name)||"shopify-checkout-api-token"===Fl(e.attributes.name)))return!0}}return!1}(x,_)&&(C||x.type!==ol.Text||x.isStyle||x.textContent.replace(/^\s+|\s+$/gm,"").length)?Sl():vl;const L=Object.assign(x,{id:O});if(r.add(e,L),O===vl)return null;b&&b(e);let N=!p;if(L.type===ol.Element){N=N&&!L.needBlock,delete L.needBlock;const t=e.shadowRoot;t&&il(t)&&(L.isShadowHost=!0)}if((L.type===ol.Document||L.type===ol.Element)&&N){_.headWhitespace&&L.type===ol.Element&&"head"===L.tagName&&(C=!1);const t={doc:n,mirror:r,blockClass:o,blockSelector:s,maskAllText:a,unblockSelector:i,maskTextClass:c,unmaskTextClass:l,maskTextSelector:u,unmaskTextSelector:d,skipChild:p,inlineStylesheet:h,maskInputOptions:f,maskAttributeFn:g,maskTextFn:m,maskInputFn:y,slimDOMOptions:_,dataURLOptions:v,inlineImages:S,recordCanvas:T,preserveWhiteSpace:C,onSerialize:b,onIframeLoad:w,iframeLoadTimeout:E,onStylesheetLoad:I,stylesheetLoadTimeout:A,keepIframeSrcFn:R};for(const n of Array.from(e.childNodes)){const e=jl(n,t);e&&L.childNodes.push(e)}if(function(e){return e.nodeType===e.ELEMENT_NODE}(e)&&e.shadowRoot)for(const n of Array.from(e.shadowRoot.childNodes)){const r=jl(n,t);r&&(il(e.shadowRoot)&&(r.isShadow=!0),L.childNodes.push(r))}}return e.parentNode&&sl(e.parentNode)&&il(e.parentNode)&&(L.isShadow=!0),L.type===ol.Element&&"iframe"===L.tagName&&function(e,t,n){const r=e.contentWindow;if(!r)return;let o,s=!1;try{o=r.document.readyState}catch(e){return}if("complete"!==o){const r=setTimeout((()=>{s||(t(),s=!0)}),n);return void e.addEventListener("load",(()=>{clearTimeout(r),s=!0,t()}))}const i="about:blank";if(r.location.href!==i||e.src===i||""===e.src)return setTimeout(t,0),e.addEventListener("load",t);e.addEventListener("load",t)}(e,(()=>{const t=e.contentDocument;if(t&&w){const n=jl(t,{doc:t,mirror:r,blockClass:o,blockSelector:s,unblockSelector:i,maskAllText:a,maskTextClass:c,unmaskTextClass:l,maskTextSelector:u,unmaskTextSelector:d,skipChild:!1,inlineStylesheet:h,maskInputOptions:f,maskAttributeFn:g,maskTextFn:m,maskInputFn:y,slimDOMOptions:_,dataURLOptions:v,inlineImages:S,recordCanvas:T,preserveWhiteSpace:C,onSerialize:b,onIframeLoad:w,iframeLoadTimeout:E,onStylesheetLoad:I,stylesheetLoadTimeout:A,keepIframeSrcFn:R});n&&w(e,n)}}),E),L.type===ol.Element&&"link"===L.tagName&&"stylesheet"===L.attributes.rel&&function(e,t,n){let r,o=!1;try{r=e.sheet}catch(e){return}if(r)return;const s=setTimeout((()=>{o||(t(),o=!0)}),n);e.addEventListener("load",(()=>{clearTimeout(s),o=!0,t()}))}(e,(()=>{if(I){const t=jl(e,{doc:n,mirror:r,blockClass:o,blockSelector:s,unblockSelector:i,maskAllText:a,maskTextClass:c,unmaskTextClass:l,maskTextSelector:u,unmaskTextSelector:d,skipChild:!1,inlineStylesheet:h,maskInputOptions:f,maskAttributeFn:g,maskTextFn:m,maskInputFn:y,slimDOMOptions:_,dataURLOptions:v,inlineImages:S,recordCanvas:T,preserveWhiteSpace:C,onSerialize:b,onIframeLoad:w,iframeLoadTimeout:E,onStylesheetLoad:I,stylesheetLoadTimeout:A,keepIframeSrcFn:R});t&&I(e,t)}}),A),L}function Gl(e){let t,n=e[0],r=1;for(;r<e.length;){const o=e[r],s=e[r+1];if(r+=2,("optionalAccess"===o||"optionalCall"===o)&&null==n)return;"access"===o||"optionalAccess"===o?(t=n,n=s(n)):"call"!==o&&"optionalCall"!==o||(n=s(((...e)=>n.call(t,...e))),t=void 0)}return n}function Vl(e,t,n=document){const r={capture:!0,passive:!0};return n.addEventListener(e,t,r),()=>n.removeEventListener(e,t,r)}const ql="Please stop import mirror directly. Instead of that,\r\nnow you can use replayer.getMirror() to access the mirror instance of a replayer,\r\nor you can use record.mirror to access the mirror instance during recording.";let Wl={map:{},getId:()=>(console.error(ql),-1),getNode:()=>(console.error(ql),null),removeNodeFromMap(){console.error(ql)},has:()=>(console.error(ql),!1),reset(){console.error(ql)}};function Bl(e,t,n={}){let r=null,o=0;return function(...s){const i=Date.now();o||!1!==n.leading||(o=i);const a=t-(i-o),c=this;a<=0||a>t?(r&&(!function(...e){du("clearTimeout")(...e)}(r),r=null),o=i,e.apply(c,s)):r||!1===n.trailing||(r=pu((()=>{o=!1===n.leading?0:Date.now(),r=null,e.apply(c,s)}),a))}}function Hl(e,t,n,r,o=window){const s=o.Object.getOwnPropertyDescriptor(e,t);return o.Object.defineProperty(e,t,r?n:{set(e){pu((()=>{n.set.call(this,e)}),0),s&&s.set&&s.set.call(this,e)}}),()=>Hl(e,t,s||{},!0)}function Jl(e,t,n){try{if(!(t in e))return()=>{};const r=e[t],o=n(r);return"function"==typeof o&&(o.prototype=o.prototype||{},Object.defineProperties(o,{__rrweb_original__:{enumerable:!1,value:r}})),e[t]=o,()=>{e[t]=r}}catch(e){return()=>{}}}"undefined"!=typeof window&&window.Proxy&&window.Reflect&&(Wl=new Proxy(Wl,{get:(e,t,n)=>("map"===t&&console.error(ql),Reflect.get(e,t,n))}));let zl=Date.now;function Yl(e){const t=e.document;return{left:t.scrollingElement?t.scrollingElement.scrollLeft:void 0!==e.pageXOffset?e.pageXOffset:Gl([t,"optionalAccess",e=>e.documentElement,"access",e=>e.scrollLeft])||Gl([t,"optionalAccess",e=>e.body,"optionalAccess",e=>e.parentElement,"optionalAccess",e=>e.scrollLeft])||Gl([t,"optionalAccess",e=>e.body,"optionalAccess",e=>e.scrollLeft])||0,top:t.scrollingElement?t.scrollingElement.scrollTop:void 0!==e.pageYOffset?e.pageYOffset:Gl([t,"optionalAccess",e=>e.documentElement,"access",e=>e.scrollTop])||Gl([t,"optionalAccess",e=>e.body,"optionalAccess",e=>e.parentElement,"optionalAccess",e=>e.scrollTop])||Gl([t,"optionalAccess",e=>e.body,"optionalAccess",e=>e.scrollTop])||0}}function Xl(){return window.innerHeight||document.documentElement&&document.documentElement.clientHeight||document.body&&document.body.clientHeight}function Kl(){return window.innerWidth||document.documentElement&&document.documentElement.clientWidth||document.body&&document.body.clientWidth}function Ql(e){if(!e)return null;return e.nodeType===e.ELEMENT_NODE?e:e.parentElement}function Zl(e,t,n,r,o){if(!e)return!1;const s=Ql(e);if(!s)return!1;const i=Ml(t,n);if(!o){const e=r&&s.matches(r);return i(s)&&!e}const a=Dl(s,i);let c=-1;return!(a<0)&&(r&&(c=Dl(s,Ml(null,r))),a>-1&&c<0||a<c)}function eu(e,t){return t.getId(e)===vl}function tu(e,t){if(sl(e))return!1;const n=t.getId(e);return!t.has(n)||(!e.parentNode||e.parentNode.nodeType!==e.DOCUMENT_NODE)&&(!e.parentNode||tu(e.parentNode,t))}function nu(e){return Boolean(e.changedTouches)}function ru(e,t){return Boolean("IFRAME"===e.nodeName&&t.getMeta(e))}function ou(e,t){return Boolean("LINK"===e.nodeName&&e.nodeType===e.ELEMENT_NODE&&e.getAttribute&&"stylesheet"===e.getAttribute("rel")&&t.getMeta(e))}function su(e){return Boolean(Gl([e,"optionalAccess",e=>e.shadowRoot]))}/[1-9][0-9]{12}/.test(Date.now().toString())||(zl=()=>(new Date).getTime());class iu{constructor(){this.id=1,this.styleIDMap=new WeakMap,this.idStyleMap=new Map}getId(e){return t=this.styleIDMap.get(e),n=()=>-1,null!=t?t:n();var t,n}has(e){return this.styleIDMap.has(e)}add(e,t){if(this.has(e))return this.getId(e);let n;return n=void 0===t?this.id++:t,this.styleIDMap.set(e,n),this.idStyleMap.set(n,e),n}getStyle(e){return this.idStyleMap.get(e)||null}reset(){this.styleIDMap=new WeakMap,this.idStyleMap=new Map,this.id=1}generateId(){return this.id++}}function au(e){let t=null;return Gl([e,"access",e=>e.getRootNode,"optionalCall",e=>e(),"optionalAccess",e=>e.nodeType])===Node.DOCUMENT_FRAGMENT_NODE&&e.getRootNode().host&&(t=e.getRootNode().host),t}function cu(e){const t=e.ownerDocument;if(!t)return!1;const n=function(e){let t,n=e;for(;t=au(n);)n=t;return n}(e);return t.contains(n)}function lu(e){const t=e.ownerDocument;return!!t&&(t.contains(e)||cu(e))}const uu={};function du(e){const t=uu[e];if(t)return t;const n=window.document;let r=window[e];if(n&&"function"==typeof n.createElement)try{const t=n.createElement("iframe");t.hidden=!0,n.head.appendChild(t);const o=t.contentWindow;o&&o[e]&&(r=o[e]),n.head.removeChild(t)}catch(e){}return uu[e]=r.bind(window)}function pu(...e){return du("setTimeout")(...e)}var hu=(e=>(e[e.DomContentLoaded=0]="DomContentLoaded",e[e.Load=1]="Load",e[e.FullSnapshot=2]="FullSnapshot",e[e.IncrementalSnapshot=3]="IncrementalSnapshot",e[e.Meta=4]="Meta",e[e.Custom=5]="Custom",e[e.Plugin=6]="Plugin",e))(hu||{}),fu=(e=>(e[e.Mutation=0]="Mutation",e[e.MouseMove=1]="MouseMove",e[e.MouseInteraction=2]="MouseInteraction",e[e.Scroll=3]="Scroll",e[e.ViewportResize=4]="ViewportResize",e[e.Input=5]="Input",e[e.TouchMove=6]="TouchMove",e[e.MediaInteraction=7]="MediaInteraction",e[e.StyleSheetRule=8]="StyleSheetRule",e[e.CanvasMutation=9]="CanvasMutation",e[e.Font=10]="Font",e[e.Log=11]="Log",e[e.Drag=12]="Drag",e[e.StyleDeclaration=13]="StyleDeclaration",e[e.Selection=14]="Selection",e[e.AdoptedStyleSheet=15]="AdoptedStyleSheet",e[e.CustomElement=16]="CustomElement",e))(fu||{}),gu=(e=>(e[e.MouseUp=0]="MouseUp",e[e.MouseDown=1]="MouseDown",e[e.Click=2]="Click",e[e.ContextMenu=3]="ContextMenu",e[e.DblClick=4]="DblClick",e[e.Focus=5]="Focus",e[e.Blur=6]="Blur",e[e.TouchStart=7]="TouchStart",e[e.TouchMove_Departed=8]="TouchMove_Departed",e[e.TouchEnd=9]="TouchEnd",e[e.TouchCancel=10]="TouchCancel",e))(gu||{}),mu=(e=>(e[e.Mouse=0]="Mouse",e[e.Pen=1]="Pen",e[e.Touch=2]="Touch",e))(mu||{});function yu(e){let t,n=e[0],r=1;for(;r<e.length;){const o=e[r],s=e[r+1];if(r+=2,("optionalAccess"===o||"optionalCall"===o)&&null==n)return;"access"===o||"optionalAccess"===o?(t=n,n=s(n)):"call"!==o&&"optionalCall"!==o||(n=s(((...e)=>n.call(t,...e))),t=void 0)}return n}function _u(e){return"__ln"in e}class vu{constructor(){this.length=0,this.head=null,this.tail=null}get(e){if(e>=this.length)throw new Error("Position outside of list range");let t=this.head;for(let n=0;n<e;n++)t=yu([t,"optionalAccess",e=>e.next])||null;return t}addNode(e){const t={value:e,previous:null,next:null};if(e.__ln=t,e.previousSibling&&_u(e.previousSibling)){const n=e.previousSibling.__ln.next;t.next=n,t.previous=e.previousSibling.__ln,e.previousSibling.__ln.next=t,n&&(n.previous=t)}else if(e.nextSibling&&_u(e.nextSibling)&&e.nextSibling.__ln.previous){const n=e.nextSibling.__ln.previous;t.previous=n,t.next=e.nextSibling.__ln,e.nextSibling.__ln.previous=t,n&&(n.next=t)}else this.head&&(this.head.previous=t),t.next=this.head,this.head=t;null===t.next&&(this.tail=t),this.length++}removeNode(e){const t=e.__ln;this.head&&(t.previous?(t.previous.next=t.next,t.next?t.next.previous=t.previous:this.tail=t.previous):(this.head=t.next,this.head?this.head.previous=null:this.tail=null),e.__ln&&delete e.__ln,this.length--)}}const Su=(e,t)=>`${e}@${t}`;class Tu{constructor(){this.frozen=!1,this.locked=!1,this.texts=[],this.attributes=[],this.attributeMap=new WeakMap,this.removes=[],this.mapRemoves=[],this.movedMap={},this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.processMutations=e=>{e.forEach(this.processMutation),this.emit()},this.emit=()=>{if(this.frozen||this.locked)return;const e=[],t=new Set,n=new vu,r=e=>{let t=e,n=vl;for(;n===vl;)t=t&&t.nextSibling,n=t&&this.mirror.getId(t);return n},o=o=>{if(!o.parentNode||!lu(o))return;const s=sl(o.parentNode)?this.mirror.getId(au(o)):this.mirror.getId(o.parentNode),i=r(o);if(-1===s||-1===i)return n.addNode(o);const a=jl(o,{doc:this.doc,mirror:this.mirror,blockClass:this.blockClass,blockSelector:this.blockSelector,maskAllText:this.maskAllText,unblockSelector:this.unblockSelector,maskTextClass:this.maskTextClass,unmaskTextClass:this.unmaskTextClass,maskTextSelector:this.maskTextSelector,unmaskTextSelector:this.unmaskTextSelector,skipChild:!0,newlyAddedElement:!0,inlineStylesheet:this.inlineStylesheet,maskInputOptions:this.maskInputOptions,maskAttributeFn:this.maskAttributeFn,maskTextFn:this.maskTextFn,maskInputFn:this.maskInputFn,slimDOMOptions:this.slimDOMOptions,dataURLOptions:this.dataURLOptions,recordCanvas:this.recordCanvas,inlineImages:this.inlineImages,onSerialize:e=>{ru(e,this.mirror)&&this.iframeManager.addIframe(e),ou(e,this.mirror)&&this.stylesheetManager.trackLinkElement(e),su(o)&&this.shadowDomManager.addShadowRoot(o.shadowRoot,this.doc)},onIframeLoad:(e,t)=>{this.iframeManager.attachIframe(e,t),this.shadowDomManager.observeAttachShadow(e)},onStylesheetLoad:(e,t)=>{this.stylesheetManager.attachLinkElement(e,t)}});a&&(e.push({parentId:s,nextId:i,node:a}),t.add(a.id))};for(;this.mapRemoves.length;)this.mirror.removeNodeFromMap(this.mapRemoves.shift());for(const e of this.movedSet)wu(this.removes,e,this.mirror)&&!this.movedSet.has(e.parentNode)||o(e);for(const e of this.addedSet)Iu(this.droppedSet,e)||wu(this.removes,e,this.mirror)?Iu(this.movedSet,e)?o(e):this.droppedSet.add(e):o(e);let s=null;for(;n.length;){let e=null;if(s){const t=this.mirror.getId(s.value.parentNode),n=r(s.value);-1!==t&&-1!==n&&(e=s)}if(!e){let t=n.tail;for(;t;){const n=t;if(t=t.previous,n){const t=this.mirror.getId(n.value.parentNode);if(-1===r(n.value))continue;if(-1!==t){e=n;break}{const t=n.value;if(t.parentNode&&t.parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE){const r=t.parentNode.host;if(-1!==this.mirror.getId(r)){e=n;break}}}}}}if(!e){for(;n.head;)n.removeNode(n.head.value);break}s=e.previous,n.removeNode(e.value),o(e.value)}const i={texts:this.texts.map((e=>({id:this.mirror.getId(e.node),value:e.value}))).filter((e=>!t.has(e.id))).filter((e=>this.mirror.has(e.id))),attributes:this.attributes.map((e=>{const{attributes:t}=e;if("string"==typeof t.style){const n=JSON.stringify(e.styleDiff),r=JSON.stringify(e._unchangedStyles);n.length<t.style.length&&(n+r).split("var(").length===t.style.split("var(").length&&(t.style=e.styleDiff)}return{id:this.mirror.getId(e.node),attributes:t}})).filter((e=>!t.has(e.id))).filter((e=>this.mirror.has(e.id))),removes:this.removes,adds:e};(i.texts.length||i.attributes.length||i.removes.length||i.adds.length)&&(this.texts=[],this.attributes=[],this.attributeMap=new WeakMap,this.removes=[],this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.movedMap={},this.mutationCb(i))},this.processMutation=e=>{if(!eu(e.target,this.mirror))switch(e.type){case"characterData":{const t=e.target.textContent;Zl(e.target,this.blockClass,this.blockSelector,this.unblockSelector,!1)||t===e.oldValue||this.texts.push({value:Ul(e.target,this.maskTextClass,this.maskTextSelector,this.unmaskTextClass,this.unmaskTextSelector,this.maskAllText)&&t?this.maskTextFn?this.maskTextFn(t,Ql(e.target)):t.replace(/[\S]/g,"*"):t,node:e.target});break}case"attributes":{const t=e.target;let n=e.attributeName,r=e.target.getAttribute(n);if("value"===n){const n=gl(t),o=t.tagName;r=ml(t,o,n);const s=ul({maskInputOptions:this.maskInputOptions,tagName:o,type:n});r=dl({isMasked:Ul(e.target,this.maskTextClass,this.maskTextSelector,this.unmaskTextClass,this.unmaskTextSelector,s),element:t,value:r,maskInputFn:this.maskInputFn})}if(Zl(e.target,this.blockClass,this.blockSelector,this.unblockSelector,!1)||r===e.oldValue)return;let o=this.attributeMap.get(e.target);if("IFRAME"===t.tagName&&"src"===n&&!this.keepIframeSrcFn(r)){if(t.contentDocument)return;n="rr_src"}if(o||(o={node:e.target,attributes:{},styleDiff:{},_unchangedStyles:{}},this.attributes.push(o),this.attributeMap.set(e.target,o)),"type"===n&&"INPUT"===t.tagName&&"password"===(e.oldValue||"").toLowerCase()&&t.setAttribute("data-rr-is-password","true"),!Pl(t.tagName,n)&&(o.attributes[n]=Nl(this.doc,pl(t.tagName),pl(n),r,t,this.maskAttributeFn),"style"===n)){if(!this.unattachedDoc)try{this.unattachedDoc=document.implementation.createHTMLDocument()}catch(e){this.unattachedDoc=this.doc}const n=this.unattachedDoc.createElement("span");e.oldValue&&n.setAttribute("style",e.oldValue);for(const e of Array.from(t.style)){const r=t.style.getPropertyValue(e),s=t.style.getPropertyPriority(e);r!==n.style.getPropertyValue(e)||s!==n.style.getPropertyPriority(e)?o.styleDiff[e]=""===s?r:[r,s]:o._unchangedStyles[e]=[r,s]}for(const e of Array.from(n.style))""===t.style.getPropertyValue(e)&&(o.styleDiff[e]=!1)}break}case"childList":if(Zl(e.target,this.blockClass,this.blockSelector,this.unblockSelector,!0))return;e.addedNodes.forEach((t=>this.genAdds(t,e.target))),e.removedNodes.forEach((t=>{const n=this.mirror.getId(t),r=sl(e.target)?this.mirror.getId(e.target.host):this.mirror.getId(e.target);Zl(e.target,this.blockClass,this.blockSelector,this.unblockSelector,!1)||eu(t,this.mirror)||!function(e,t){return-1!==t.getId(e)}(t,this.mirror)||(this.addedSet.has(t)?(bu(this.addedSet,t),this.droppedSet.add(t)):this.addedSet.has(e.target)&&-1===n||tu(e.target,this.mirror)||(this.movedSet.has(t)&&this.movedMap[Su(n,r)]?bu(this.movedSet,t):this.removes.push({parentId:r,id:n,isShadow:!(!sl(e.target)||!il(e.target))||void 0})),this.mapRemoves.push(t))}))}},this.genAdds=(e,t)=>{if(!this.processedNodeManager.inOtherBuffer(e,this)&&!this.addedSet.has(e)&&!this.movedSet.has(e)){if(this.mirror.hasNode(e)){if(eu(e,this.mirror))return;this.movedSet.add(e);let n=null;t&&this.mirror.hasNode(t)&&(n=this.mirror.getId(t)),n&&-1!==n&&(this.movedMap[Su(this.mirror.getId(e),n)]=!0)}else this.addedSet.add(e),this.droppedSet.delete(e);Zl(e,this.blockClass,this.blockSelector,this.unblockSelector,!1)||(e.childNodes.forEach((e=>this.genAdds(e))),su(e)&&e.shadowRoot.childNodes.forEach((t=>{this.processedNodeManager.add(t,this),this.genAdds(t,e)})))}}}init(e){["mutationCb","blockClass","blockSelector","unblockSelector","maskAllText","maskTextClass","unmaskTextClass","maskTextSelector","unmaskTextSelector","inlineStylesheet","maskInputOptions","maskAttributeFn","maskTextFn","maskInputFn","keepIframeSrcFn","recordCanvas","inlineImages","slimDOMOptions","dataURLOptions","doc","mirror","iframeManager","stylesheetManager","shadowDomManager","canvasManager","processedNodeManager"].forEach((t=>{this[t]=e[t]}))}freeze(){this.frozen=!0,this.canvasManager.freeze()}unfreeze(){this.frozen=!1,this.canvasManager.unfreeze(),this.emit()}isFrozen(){return this.frozen}lock(){this.locked=!0,this.canvasManager.lock()}unlock(){this.locked=!1,this.canvasManager.unlock(),this.emit()}reset(){this.shadowDomManager.reset(),this.canvasManager.reset()}}function bu(e,t){e.delete(t),t.childNodes.forEach((t=>bu(e,t)))}function wu(e,t,n){return 0!==e.length&&Eu(e,t,n)}function Eu(e,t,n){const{parentNode:r}=t;if(!r)return!1;const o=n.getId(r);return!!e.some((e=>e.id===o))||Eu(e,r,n)}function Iu(e,t){return 0!==e.size&&Au(e,t)}function Au(e,t){const{parentNode:n}=t;return!!n&&(!!e.has(n)||Au(e,n))}let Ru;const ku=e=>{if(!Ru)return e;return(...t)=>{try{return e(...t)}catch(e){if(Ru&&!0===Ru(e))return()=>{};throw e}}};function Cu(e){let t,n=e[0],r=1;for(;r<e.length;){const o=e[r],s=e[r+1];if(r+=2,("optionalAccess"===o||"optionalCall"===o)&&null==n)return;"access"===o||"optionalAccess"===o?(t=n,n=s(n)):"call"!==o&&"optionalCall"!==o||(n=s(((...e)=>n.call(t,...e))),t=void 0)}return n}const xu=[];function Ou(e){try{if("composedPath"in e){const t=e.composedPath();if(t.length)return t[0]}else if("path"in e&&e.path.length)return e.path[0]}catch(e){}return e&&e.target}function Lu(e,t){const n=new Tu;xu.push(n),n.init(e);let r=window.MutationObserver||window.__rrMutationObserver;const o=Cu([window,"optionalAccess",e=>e.Zone,"optionalAccess",e=>e.__symbol__,"optionalCall",e=>e("MutationObserver")]);o&&window[o]&&(r=window[o]);const s=new r(ku((t=>{e.onMutation&&!1===e.onMutation(t)||n.processMutations.bind(n)(t)})));return s.observe(t,{attributes:!0,attributeOldValue:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0}),s}function Nu({mouseInteractionCb:e,doc:t,mirror:n,blockClass:r,blockSelector:o,unblockSelector:s,sampling:i}){if(!1===i.mouseInteraction)return()=>{};const a=!0===i.mouseInteraction||void 0===i.mouseInteraction?{}:i.mouseInteraction,c=[];let l=null;return Object.keys(gu).filter((e=>Number.isNaN(Number(e))&&!e.endsWith("_Departed")&&!1!==a[e])).forEach((i=>{let a=pl(i);const u=(t=>i=>{const a=Ou(i);if(Zl(a,r,o,s,!0))return;let c=null,u=t;if("pointerType"in i){switch(i.pointerType){case"mouse":c=mu.Mouse;break;case"touch":c=mu.Touch;break;case"pen":c=mu.Pen}c===mu.Touch?gu[t]===gu.MouseDown?u="TouchStart":gu[t]===gu.MouseUp&&(u="TouchEnd"):mu.Pen}else nu(i)&&(c=mu.Touch);null!==c?(l=c,(u.startsWith("Touch")&&c===mu.Touch||u.startsWith("Mouse")&&c===mu.Mouse)&&(c=null)):gu[t]===gu.Click&&(c=l,l=null);const d=nu(i)?i.changedTouches[0]:i;if(!d)return;const p=n.getId(a),{clientX:h,clientY:f}=d;ku(e)({type:gu[u],id:p,x:h,y:f,...null!==c&&{pointerType:c}})})(i);if(window.PointerEvent)switch(gu[i]){case gu.MouseDown:case gu.MouseUp:a=a.replace("mouse","pointer");break;case gu.TouchStart:case gu.TouchEnd:return}c.push(Vl(a,u,t))})),ku((()=>{c.forEach((e=>e()))}))}function Pu({scrollCb:e,doc:t,mirror:n,blockClass:r,blockSelector:o,unblockSelector:s,sampling:i}){return Vl("scroll",ku(Bl(ku((i=>{const a=Ou(i);if(!a||Zl(a,r,o,s,!0))return;const c=n.getId(a);if(a===t&&t.defaultView){const n=Yl(t.defaultView);e({id:c,x:n.left,y:n.top})}else e({id:c,x:a.scrollLeft,y:a.scrollTop})})),i.scroll||100)),t)}const Du=["INPUT","TEXTAREA","SELECT"],Mu=new WeakMap;function Uu({inputCb:e,doc:t,mirror:n,blockClass:r,blockSelector:o,unblockSelector:s,ignoreClass:i,ignoreSelector:a,maskInputOptions:c,maskInputFn:l,sampling:u,userTriggeredOnInput:d,maskTextClass:p,unmaskTextClass:h,maskTextSelector:f,unmaskTextSelector:g}){function m(e){let n=Ou(e);const u=e.isTrusted,m=n&&hl(n.tagName);if("OPTION"===m&&(n=n.parentElement),!n||!m||Du.indexOf(m)<0||Zl(n,r,o,s,!0))return;const _=n;if(_.classList.contains(i)||a&&_.matches(a))return;const v=gl(n);let S=ml(_,m,v),T=!1;const b=ul({maskInputOptions:c,tagName:m,type:v}),w=Ul(n,p,f,h,g,b);"radio"!==v&&"checkbox"!==v||(T=n.checked),S=dl({isMasked:w,element:n,value:S,maskInputFn:l}),y(n,d?{text:S,isChecked:T,userTriggered:u}:{text:S,isChecked:T});const E=n.name;"radio"===v&&E&&T&&t.querySelectorAll(`input[type="radio"][name="${E}"]`).forEach((e=>{if(e!==n){const t=dl({isMasked:w,element:e,value:ml(e,m,v),maskInputFn:l});y(e,d?{text:t,isChecked:!T,userTriggered:!1}:{text:t,isChecked:!T})}}))}function y(t,r){const o=Mu.get(t);if(!o||o.text!==r.text||o.isChecked!==r.isChecked){Mu.set(t,r);const o=n.getId(t);ku(e)({...r,id:o})}}const _=("last"===u.input?["change"]:["input","change"]).map((e=>Vl(e,ku(m),t))),v=t.defaultView;if(!v)return()=>{_.forEach((e=>e()))};const S=v.Object.getOwnPropertyDescriptor(v.HTMLInputElement.prototype,"value"),T=[[v.HTMLInputElement.prototype,"value"],[v.HTMLInputElement.prototype,"checked"],[v.HTMLSelectElement.prototype,"value"],[v.HTMLTextAreaElement.prototype,"value"],[v.HTMLSelectElement.prototype,"selectedIndex"],[v.HTMLOptionElement.prototype,"selected"]];return S&&S.set&&_.push(...T.map((e=>Hl(e[0],e[1],{set(){ku(m)({target:this,isTrusted:!1})}},!1,v)))),ku((()=>{_.forEach((e=>e()))}))}function $u(e){return function(e,t){if(Vu("CSSGroupingRule")&&e.parentRule instanceof CSSGroupingRule||Vu("CSSMediaRule")&&e.parentRule instanceof CSSMediaRule||Vu("CSSSupportsRule")&&e.parentRule instanceof CSSSupportsRule||Vu("CSSConditionRule")&&e.parentRule instanceof CSSConditionRule){const n=Array.from(e.parentRule.cssRules).indexOf(e);t.unshift(n)}else if(e.parentStyleSheet){const n=Array.from(e.parentStyleSheet.cssRules).indexOf(e);t.unshift(n)}return t}(e,[])}function Fu(e,t,n){let r,o;return e?(e.ownerNode?r=t.getId(e.ownerNode):o=n.getId(e),{styleId:o,id:r}):{}}function ju({mirror:e,stylesheetManager:t},n){let r=null;r="#document"===n.nodeName?e.getId(n):e.getId(n.host);const o="#document"===n.nodeName?Cu([n,"access",e=>e.defaultView,"optionalAccess",e=>e.Document]):Cu([n,"access",e=>e.ownerDocument,"optionalAccess",e=>e.defaultView,"optionalAccess",e=>e.ShadowRoot]),s=Cu([o,"optionalAccess",e=>e.prototype])?Object.getOwnPropertyDescriptor(Cu([o,"optionalAccess",e=>e.prototype]),"adoptedStyleSheets"):void 0;return null!==r&&-1!==r&&o&&s?(Object.defineProperty(n,"adoptedStyleSheets",{configurable:s.configurable,enumerable:s.enumerable,get(){return Cu([s,"access",e=>e.get,"optionalAccess",e=>e.call,"call",e=>e(this)])},set(e){const n=Cu([s,"access",e=>e.set,"optionalAccess",e=>e.call,"call",t=>t(this,e)]);if(null!==r&&-1!==r)try{t.adoptStyleSheets(e,r)}catch(e){}return n}}),ku((()=>{Object.defineProperty(n,"adoptedStyleSheets",{configurable:s.configurable,enumerable:s.enumerable,get:s.get,set:s.set})}))):()=>{}}function Gu(e,t={}){const n=e.doc.defaultView;if(!n)return()=>{};const r=Lu(e,e.doc),o=function({mousemoveCb:e,sampling:t,doc:n,mirror:r}){if(!1===t.mousemove)return()=>{};const o="number"==typeof t.mousemove?t.mousemove:50,s="number"==typeof t.mousemoveCallback?t.mousemoveCallback:500;let i,a=[];const c=Bl(ku((t=>{const n=Date.now()-i;e(a.map((e=>(e.timeOffset-=n,e))),t),a=[],i=null})),s),l=ku(Bl(ku((e=>{const t=Ou(e),{clientX:n,clientY:o}=nu(e)?e.changedTouches[0]:e;i||(i=zl()),a.push({x:n,y:o,id:r.getId(t),timeOffset:zl()-i}),c("undefined"!=typeof DragEvent&&e instanceof DragEvent?fu.Drag:e instanceof MouseEvent?fu.MouseMove:fu.TouchMove)})),o,{trailing:!1})),u=[Vl("mousemove",l,n),Vl("touchmove",l,n),Vl("drag",l,n)];return ku((()=>{u.forEach((e=>e()))}))}(e),s=Nu(e),i=Pu(e),a=function({viewportResizeCb:e},{win:t}){let n=-1,r=-1;return Vl("resize",ku(Bl(ku((()=>{const t=Xl(),o=Kl();n===t&&r===o||(e({width:Number(o),height:Number(t)}),n=t,r=o)})),200)),t)}(e,{win:n}),c=Uu(e),l=function({mediaInteractionCb:e,blockClass:t,blockSelector:n,unblockSelector:r,mirror:o,sampling:s,doc:i}){const a=ku((i=>Bl(ku((s=>{const a=Ou(s);if(!a||Zl(a,t,n,r,!0))return;const{currentTime:c,volume:l,muted:u,playbackRate:d}=a;e({type:i,id:o.getId(a),currentTime:c,volume:l,muted:u,playbackRate:d})})),s.media||500))),c=[Vl("play",a(0),i),Vl("pause",a(1),i),Vl("seeked",a(2),i),Vl("volumechange",a(3),i),Vl("ratechange",a(4),i)];return ku((()=>{c.forEach((e=>e()))}))}(e),u=function({styleSheetRuleCb:e,mirror:t,stylesheetManager:n},{win:r}){if(!r.CSSStyleSheet||!r.CSSStyleSheet.prototype)return()=>{};const o=r.CSSStyleSheet.prototype.insertRule;r.CSSStyleSheet.prototype.insertRule=new Proxy(o,{apply:ku(((r,o,s)=>{const[i,a]=s,{id:c,styleId:l}=Fu(o,t,n.styleMirror);return(c&&-1!==c||l&&-1!==l)&&e({id:c,styleId:l,adds:[{rule:i,index:a}]}),r.apply(o,s)}))});const s=r.CSSStyleSheet.prototype.deleteRule;let i,a;r.CSSStyleSheet.prototype.deleteRule=new Proxy(s,{apply:ku(((r,o,s)=>{const[i]=s,{id:a,styleId:c}=Fu(o,t,n.styleMirror);return(a&&-1!==a||c&&-1!==c)&&e({id:a,styleId:c,removes:[{index:i}]}),r.apply(o,s)}))}),r.CSSStyleSheet.prototype.replace&&(i=r.CSSStyleSheet.prototype.replace,r.CSSStyleSheet.prototype.replace=new Proxy(i,{apply:ku(((r,o,s)=>{const[i]=s,{id:a,styleId:c}=Fu(o,t,n.styleMirror);return(a&&-1!==a||c&&-1!==c)&&e({id:a,styleId:c,replace:i}),r.apply(o,s)}))})),r.CSSStyleSheet.prototype.replaceSync&&(a=r.CSSStyleSheet.prototype.replaceSync,r.CSSStyleSheet.prototype.replaceSync=new Proxy(a,{apply:ku(((r,o,s)=>{const[i]=s,{id:a,styleId:c}=Fu(o,t,n.styleMirror);return(a&&-1!==a||c&&-1!==c)&&e({id:a,styleId:c,replaceSync:i}),r.apply(o,s)}))}));const c={};qu("CSSGroupingRule")?c.CSSGroupingRule=r.CSSGroupingRule:(qu("CSSMediaRule")&&(c.CSSMediaRule=r.CSSMediaRule),qu("CSSConditionRule")&&(c.CSSConditionRule=r.CSSConditionRule),qu("CSSSupportsRule")&&(c.CSSSupportsRule=r.CSSSupportsRule));const l={};return Object.entries(c).forEach((([r,o])=>{l[r]={insertRule:o.prototype.insertRule,deleteRule:o.prototype.deleteRule},o.prototype.insertRule=new Proxy(l[r].insertRule,{apply:ku(((r,o,s)=>{const[i,a]=s,{id:c,styleId:l}=Fu(o.parentStyleSheet,t,n.styleMirror);return(c&&-1!==c||l&&-1!==l)&&e({id:c,styleId:l,adds:[{rule:i,index:[...$u(o),a||0]}]}),r.apply(o,s)}))}),o.prototype.deleteRule=new Proxy(l[r].deleteRule,{apply:ku(((r,o,s)=>{const[i]=s,{id:a,styleId:c}=Fu(o.parentStyleSheet,t,n.styleMirror);return(a&&-1!==a||c&&-1!==c)&&e({id:a,styleId:c,removes:[{index:[...$u(o),i]}]}),r.apply(o,s)}))})})),ku((()=>{r.CSSStyleSheet.prototype.insertRule=o,r.CSSStyleSheet.prototype.deleteRule=s,i&&(r.CSSStyleSheet.prototype.replace=i),a&&(r.CSSStyleSheet.prototype.replaceSync=a),Object.entries(c).forEach((([e,t])=>{t.prototype.insertRule=l[e].insertRule,t.prototype.deleteRule=l[e].deleteRule}))}))}(e,{win:n}),d=ju(e,e.doc),p=function({styleDeclarationCb:e,mirror:t,ignoreCSSAttributes:n,stylesheetManager:r},{win:o}){const s=o.CSSStyleDeclaration.prototype.setProperty;o.CSSStyleDeclaration.prototype.setProperty=new Proxy(s,{apply:ku(((o,i,a)=>{const[c,l,u]=a;if(n.has(c))return s.apply(i,[c,l,u]);const{id:d,styleId:p}=Fu(Cu([i,"access",e=>e.parentRule,"optionalAccess",e=>e.parentStyleSheet]),t,r.styleMirror);return(d&&-1!==d||p&&-1!==p)&&e({id:d,styleId:p,set:{property:c,value:l,priority:u},index:$u(i.parentRule)}),o.apply(i,a)}))});const i=o.CSSStyleDeclaration.prototype.removeProperty;return o.CSSStyleDeclaration.prototype.removeProperty=new Proxy(i,{apply:ku(((o,s,a)=>{const[c]=a;if(n.has(c))return i.apply(s,[c]);const{id:l,styleId:u}=Fu(Cu([s,"access",e=>e.parentRule,"optionalAccess",e=>e.parentStyleSheet]),t,r.styleMirror);return(l&&-1!==l||u&&-1!==u)&&e({id:l,styleId:u,remove:{property:c},index:$u(s.parentRule)}),o.apply(s,a)}))}),ku((()=>{o.CSSStyleDeclaration.prototype.setProperty=s,o.CSSStyleDeclaration.prototype.removeProperty=i}))}(e,{win:n}),h=e.collectFonts?function({fontCb:e,doc:t}){const n=t.defaultView;if(!n)return()=>{};const r=[],o=new WeakMap,s=n.FontFace;n.FontFace=function(e,t,n){const r=new s(e,t,n);return o.set(r,{family:e,buffer:"string"!=typeof t,descriptors:n,fontSource:"string"==typeof t?t:JSON.stringify(Array.from(new Uint8Array(t)))}),r};const i=Jl(t.fonts,"add",(function(t){return function(n){return pu(ku((()=>{const t=o.get(n);t&&(e(t),o.delete(n))})),0),t.apply(this,[n])}}));return r.push((()=>{n.FontFace=s})),r.push(i),ku((()=>{r.forEach((e=>e()))}))}(e):()=>{},f=function(e){const{doc:t,mirror:n,blockClass:r,blockSelector:o,unblockSelector:s,selectionCb:i}=e;let a=!0;const c=ku((()=>{const e=t.getSelection();if(!e||a&&Cu([e,"optionalAccess",e=>e.isCollapsed]))return;a=e.isCollapsed||!1;const c=[],l=e.rangeCount||0;for(let t=0;t<l;t++){const i=e.getRangeAt(t),{startContainer:a,startOffset:l,endContainer:u,endOffset:d}=i;Zl(a,r,o,s,!0)||Zl(u,r,o,s,!0)||c.push({start:n.getId(a),startOffset:l,end:n.getId(u),endOffset:d})}i({ranges:c})}));return c(),Vl("selectionchange",c)}(e),g=function({doc:e,customElementCb:t}){const n=e.defaultView;return n&&n.customElements?Jl(n.customElements,"define",(function(e){return function(n,r,o){try{t({define:{name:n}})}catch(e){}return e.apply(this,[n,r,o])}})):()=>{}}(e),m=[];for(const t of e.plugins)m.push(t.observer(t.callback,n,t.options));return ku((()=>{xu.forEach((e=>e.reset())),r.disconnect(),o(),s(),i(),a(),c(),l(),u(),d(),p(),h(),f(),g(),m.forEach((e=>e()))}))}function Vu(e){return void 0!==window[e]}function qu(e){return Boolean(void 0!==window[e]&&window[e].prototype&&"insertRule"in window[e].prototype&&"deleteRule"in window[e].prototype)}class Wu{constructor(e){this.generateIdFn=e,this.iframeIdToRemoteIdMap=new WeakMap,this.iframeRemoteIdToIdMap=new WeakMap}getId(e,t,n,r){const o=n||this.getIdToRemoteIdMap(e),s=r||this.getRemoteIdToIdMap(e);let i=o.get(t);return i||(i=this.generateIdFn(),o.set(t,i),s.set(i,t)),i}getIds(e,t){const n=this.getIdToRemoteIdMap(e),r=this.getRemoteIdToIdMap(e);return t.map((t=>this.getId(e,t,n,r)))}getRemoteId(e,t,n){const r=n||this.getRemoteIdToIdMap(e);if("number"!=typeof t)return t;const o=r.get(t);return o||-1}getRemoteIds(e,t){const n=this.getRemoteIdToIdMap(e);return t.map((t=>this.getRemoteId(e,t,n)))}reset(e){if(!e)return this.iframeIdToRemoteIdMap=new WeakMap,void(this.iframeRemoteIdToIdMap=new WeakMap);this.iframeIdToRemoteIdMap.delete(e),this.iframeRemoteIdToIdMap.delete(e)}getIdToRemoteIdMap(e){let t=this.iframeIdToRemoteIdMap.get(e);return t||(t=new Map,this.iframeIdToRemoteIdMap.set(e,t)),t}getRemoteIdToIdMap(e){let t=this.iframeRemoteIdToIdMap.get(e);return t||(t=new Map,this.iframeRemoteIdToIdMap.set(e,t)),t}}function Bu(e){let t,n=e[0],r=1;for(;r<e.length;){const o=e[r],s=e[r+1];if(r+=2,("optionalAccess"===o||"optionalCall"===o)&&null==n)return;"access"===o||"optionalAccess"===o?(t=n,n=s(n)):"call"!==o&&"optionalCall"!==o||(n=s(((...e)=>n.call(t,...e))),t=void 0)}return n}class Hu{constructor(){this.crossOriginIframeMirror=new Wu(Sl),this.crossOriginIframeRootIdMap=new WeakMap}addIframe(){}addLoadListener(){}attachIframe(){}}class Ju{constructor(e){this.iframes=new WeakMap,this.crossOriginIframeMap=new WeakMap,this.crossOriginIframeMirror=new Wu(Sl),this.crossOriginIframeRootIdMap=new WeakMap,this.mutationCb=e.mutationCb,this.wrappedEmit=e.wrappedEmit,this.stylesheetManager=e.stylesheetManager,this.recordCrossOriginIframes=e.recordCrossOriginIframes,this.crossOriginIframeStyleMirror=new Wu(this.stylesheetManager.styleMirror.generateId.bind(this.stylesheetManager.styleMirror)),this.mirror=e.mirror,this.recordCrossOriginIframes&&window.addEventListener("message",this.handleMessage.bind(this))}addIframe(e){this.iframes.set(e,!0),e.contentWindow&&this.crossOriginIframeMap.set(e.contentWindow,e)}addLoadListener(e){this.loadListener=e}attachIframe(e,t){this.mutationCb({adds:[{parentId:this.mirror.getId(e),nextId:null,node:t}],removes:[],texts:[],attributes:[],isAttachIframe:!0}),Bu([this,"access",e=>e.loadListener,"optionalCall",t=>t(e)]),e.contentDocument&&e.contentDocument.adoptedStyleSheets&&e.contentDocument.adoptedStyleSheets.length>0&&this.stylesheetManager.adoptStyleSheets(e.contentDocument.adoptedStyleSheets,this.mirror.getId(e.contentDocument))}handleMessage(e){const t=e;if("rrweb"!==t.data.type||t.origin!==t.data.origin)return;if(!e.source)return;const n=this.crossOriginIframeMap.get(e.source);if(!n)return;const r=this.transformCrossOriginEvent(n,t.data.event);r&&this.wrappedEmit(r,t.data.isCheckout)}transformCrossOriginEvent(e,t){switch(t.type){case hu.FullSnapshot:{this.crossOriginIframeMirror.reset(e),this.crossOriginIframeStyleMirror.reset(e),this.replaceIdOnNode(t.data.node,e);const n=t.data.node.id;return this.crossOriginIframeRootIdMap.set(e,n),this.patchRootIdOnNode(t.data.node,n),{timestamp:t.timestamp,type:hu.IncrementalSnapshot,data:{source:fu.Mutation,adds:[{parentId:this.mirror.getId(e),nextId:null,node:t.data.node}],removes:[],texts:[],attributes:[],isAttachIframe:!0}}}case hu.Meta:case hu.Load:case hu.DomContentLoaded:return!1;case hu.Plugin:return t;case hu.Custom:return this.replaceIds(t.data.payload,e,["id","parentId","previousId","nextId"]),t;case hu.IncrementalSnapshot:switch(t.data.source){case fu.Mutation:return t.data.adds.forEach((t=>{this.replaceIds(t,e,["parentId","nextId","previousId"]),this.replaceIdOnNode(t.node,e);const n=this.crossOriginIframeRootIdMap.get(e);n&&this.patchRootIdOnNode(t.node,n)})),t.data.removes.forEach((t=>{this.replaceIds(t,e,["parentId","id"])})),t.data.attributes.forEach((t=>{this.replaceIds(t,e,["id"])})),t.data.texts.forEach((t=>{this.replaceIds(t,e,["id"])})),t;case fu.Drag:case fu.TouchMove:case fu.MouseMove:return t.data.positions.forEach((t=>{this.replaceIds(t,e,["id"])})),t;case fu.ViewportResize:return!1;case fu.MediaInteraction:case fu.MouseInteraction:case fu.Scroll:case fu.CanvasMutation:case fu.Input:return this.replaceIds(t.data,e,["id"]),t;case fu.StyleSheetRule:case fu.StyleDeclaration:return this.replaceIds(t.data,e,["id"]),this.replaceStyleIds(t.data,e,["styleId"]),t;case fu.Font:return t;case fu.Selection:return t.data.ranges.forEach((t=>{this.replaceIds(t,e,["start","end"])})),t;case fu.AdoptedStyleSheet:return this.replaceIds(t.data,e,["id"]),this.replaceStyleIds(t.data,e,["styleIds"]),Bu([t,"access",e=>e.data,"access",e=>e.styles,"optionalAccess",e=>e.forEach,"call",t=>t((t=>{this.replaceStyleIds(t,e,["styleId"])}))]),t}}return!1}replace(e,t,n,r){for(const o of r)(Array.isArray(t[o])||"number"==typeof t[o])&&(Array.isArray(t[o])?t[o]=e.getIds(n,t[o]):t[o]=e.getId(n,t[o]));return t}replaceIds(e,t,n){return this.replace(this.crossOriginIframeMirror,e,t,n)}replaceStyleIds(e,t,n){return this.replace(this.crossOriginIframeStyleMirror,e,t,n)}replaceIdOnNode(e,t){this.replaceIds(e,t,["id","rootId"]),"childNodes"in e&&e.childNodes.forEach((e=>{this.replaceIdOnNode(e,t)}))}patchRootIdOnNode(e,t){e.type===ol.Document||e.rootId||(e.rootId=t),"childNodes"in e&&e.childNodes.forEach((e=>{this.patchRootIdOnNode(e,t)}))}}class zu{init(){}addShadowRoot(){}observeAttachShadow(){}reset(){}}class Yu{constructor(e){this.shadowDoms=new WeakSet,this.restoreHandlers=[],this.mutationCb=e.mutationCb,this.scrollCb=e.scrollCb,this.bypassOptions=e.bypassOptions,this.mirror=e.mirror,this.init()}init(){this.reset(),this.patchAttachShadow(Element,document)}addShadowRoot(e,t){if(!il(e))return;if(this.shadowDoms.has(e))return;this.shadowDoms.add(e);const n=Lu({...this.bypassOptions,doc:t,mutationCb:this.mutationCb,mirror:this.mirror,shadowDomManager:this},e);this.restoreHandlers.push((()=>n.disconnect())),this.restoreHandlers.push(Pu({...this.bypassOptions,scrollCb:this.scrollCb,doc:e,mirror:this.mirror})),pu((()=>{e.adoptedStyleSheets&&e.adoptedStyleSheets.length>0&&this.bypassOptions.stylesheetManager.adoptStyleSheets(e.adoptedStyleSheets,this.mirror.getId(e.host)),this.restoreHandlers.push(ju({mirror:this.mirror,stylesheetManager:this.bypassOptions.stylesheetManager},e))}),0)}observeAttachShadow(e){e.contentWindow&&e.contentDocument&&this.patchAttachShadow(e.contentWindow.Element,e.contentDocument)}patchAttachShadow(e,t){const n=this;this.restoreHandlers.push(Jl(e.prototype,"attachShadow",(function(e){return function(r){const o=e.call(this,r);return this.shadowRoot&&lu(this)&&n.addShadowRoot(this.shadowRoot,t),o}})))}reset(){this.restoreHandlers.forEach((e=>{try{e()}catch(e){}})),this.restoreHandlers=[],this.shadowDoms=new WeakSet}}class Xu{reset(){}freeze(){}unfreeze(){}lock(){}unlock(){}snapshot(){}}class Ku{constructor(e){this.trackedLinkElements=new WeakSet,this.styleMirror=new iu,this.mutationCb=e.mutationCb,this.adoptedStyleSheetCb=e.adoptedStyleSheetCb}attachLinkElement(e,t){"_cssText"in t.attributes&&this.mutationCb({adds:[],removes:[],texts:[],attributes:[{id:t.id,attributes:t.attributes}]}),this.trackLinkElement(e)}trackLinkElement(e){this.trackedLinkElements.has(e)||(this.trackedLinkElements.add(e),this.trackStylesheetInLinkElement(e))}adoptStyleSheets(e,t){if(0===e.length)return;const n={id:t,styleIds:[]},r=[];for(const t of e){let e;this.styleMirror.has(t)?e=this.styleMirror.getId(t):(e=this.styleMirror.add(t),r.push({styleId:e,rules:Array.from(t.rules||CSSRule,((e,t)=>({rule:cl(e),index:t})))})),n.styleIds.push(e)}r.length>0&&(n.styles=r),this.adoptedStyleSheetCb(n)}reset(){this.styleMirror.reset(),this.trackedLinkElements=new WeakSet}trackStylesheetInLinkElement(e){}}class Qu{constructor(){this.nodeMap=new WeakMap,this.loop=!0,this.periodicallyClear()}periodicallyClear(){!function(...e){du("requestAnimationFrame")(...e)}((()=>{this.clear(),this.loop&&this.periodicallyClear()}))}inOtherBuffer(e,t){const n=this.nodeMap.get(e);return n&&Array.from(n).some((e=>e!==t))}add(e,t){this.nodeMap.set(e,(this.nodeMap.get(e)||new Set).add(t))}clear(){this.nodeMap=new WeakMap}destroy(){this.loop=!1}}let Zu,ed;const td=new ll;function nd(e={}){const{emit:t,checkoutEveryNms:n,checkoutEveryNth:r,blockClass:o="rr-block",blockSelector:s=null,unblockSelector:i=null,ignoreClass:a="rr-ignore",ignoreSelector:c=null,maskAllText:l=!1,maskTextClass:u="rr-mask",unmaskTextClass:d=null,maskTextSelector:p=null,unmaskTextSelector:h=null,inlineStylesheet:f=!0,maskAllInputs:g,maskInputOptions:m,slimDOMOptions:y,maskAttributeFn:_,maskInputFn:v,maskTextFn:S,maxCanvasSize:T=null,packFn:b,sampling:w={},dataURLOptions:E={},mousemoveWait:I,recordCanvas:A=!1,recordCrossOriginIframes:R=!1,recordAfter:k=("DOMContentLoaded"===e.recordAfter?e.recordAfter:"load"),userTriggeredOnInput:C=!1,collectFonts:x=!1,inlineImages:O=!1,plugins:L,keepIframeSrcFn:N=(()=>!1),ignoreCSSAttributes:P=new Set([]),errorHandler:D,onMutation:M,getCanvasManager:U}=e;Ru=D;const $=!R||window.parent===window;let F=!1;if(!$)try{window.parent.document&&(F=!1)}catch(e){F=!0}if($&&!t)throw new Error("emit function is required");void 0!==I&&void 0===w.mousemove&&(w.mousemove=I),td.reset();const j=!0===g?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,radio:!0,checkbox:!0}:void 0!==m?m:{},G=!0===y||"all"===y?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaVerification:!0,headMetaAuthorship:"all"===y,headMetaDescKeywords:"all"===y}:y||{};let V;!function(e=window){"NodeList"in e&&!e.NodeList.prototype.forEach&&(e.NodeList.prototype.forEach=Array.prototype.forEach),"DOMTokenList"in e&&!e.DOMTokenList.prototype.forEach&&(e.DOMTokenList.prototype.forEach=Array.prototype.forEach),Node.prototype.contains||(Node.prototype.contains=(...e)=>{let t=e[0];if(!(0 in e))throw new TypeError("1 argument is required");do{if(this===t)return!0}while(t=t&&t.parentNode);return!1})}();let q=0;const W=e=>{for(const t of L||[])t.eventProcessor&&(e=t.eventProcessor(e));return b&&!F&&(e=b(e)),e};Zu=(e,o)=>{const s=e;if(s.timestamp=zl(),!nr([xu,"access",e=>e[0],"optionalAccess",e=>e.isFrozen,"call",e=>e()])||s.type===hu.FullSnapshot||s.type===hu.IncrementalSnapshot&&s.data.source===fu.Mutation||xu.forEach((e=>e.unfreeze())),$)nr([t,"optionalCall",e=>e(W(s),o)]);else if(F){const e={type:"rrweb",event:W(s),origin:window.location.origin,isCheckout:o};window.parent.postMessage(e,"*")}if(s.type===hu.FullSnapshot)V=s,q=0;else if(s.type===hu.IncrementalSnapshot){if(s.data.source===fu.Mutation&&s.data.isAttachIframe)return;q++;const e=r&&q>=r,t=n&&V&&s.timestamp-V.timestamp>n;(e||t)&&Z(!0)}};const B=e=>{Zu({type:hu.IncrementalSnapshot,data:{source:fu.Mutation,...e}})},H=e=>Zu({type:hu.IncrementalSnapshot,data:{source:fu.Scroll,...e}}),J=e=>Zu({type:hu.IncrementalSnapshot,data:{source:fu.CanvasMutation,...e}}),z=new Ku({mutationCb:B,adoptedStyleSheetCb:e=>Zu({type:hu.IncrementalSnapshot,data:{source:fu.AdoptedStyleSheet,...e}})}),Y="boolean"==typeof __RRWEB_EXCLUDE_IFRAME__&&__RRWEB_EXCLUDE_IFRAME__?new Hu:new Ju({mirror:td,mutationCb:B,stylesheetManager:z,recordCrossOriginIframes:R,wrappedEmit:Zu});for(const e of L||[])e.getMirror&&e.getMirror({nodeMirror:td,crossOriginIframeMirror:Y.crossOriginIframeMirror,crossOriginIframeStyleMirror:Y.crossOriginIframeStyleMirror});const X=new Qu,K=function(e,t){try{return e?e(t):new Xu}catch(e){return console.warn("Unable to initialize CanvasManager"),new Xu}}(U,{mirror:td,win:window,mutationCb:e=>Zu({type:hu.IncrementalSnapshot,data:{source:fu.CanvasMutation,...e}}),recordCanvas:A,blockClass:o,blockSelector:s,unblockSelector:i,maxCanvasSize:T,sampling:w.canvas,dataURLOptions:E,errorHandler:D}),Q="boolean"==typeof __RRWEB_EXCLUDE_SHADOW_DOM__&&__RRWEB_EXCLUDE_SHADOW_DOM__?new zu:new Yu({mutationCb:B,scrollCb:H,bypassOptions:{onMutation:M,blockClass:o,blockSelector:s,unblockSelector:i,maskAllText:l,maskTextClass:u,unmaskTextClass:d,maskTextSelector:p,unmaskTextSelector:h,inlineStylesheet:f,maskInputOptions:j,dataURLOptions:E,maskAttributeFn:_,maskTextFn:S,maskInputFn:v,recordCanvas:A,inlineImages:O,sampling:w,slimDOMOptions:G,iframeManager:Y,stylesheetManager:z,canvasManager:K,keepIframeSrcFn:N,processedNodeManager:X},mirror:td}),Z=(e=!1)=>{Zu({type:hu.Meta,data:{href:window.location.href,width:Kl(),height:Xl()}},e),z.reset(),Q.init(),xu.forEach((e=>e.lock()));const t=function(e,t){const{mirror:n=new ll,blockClass:r="rr-block",blockSelector:o=null,unblockSelector:s=null,maskAllText:i=!1,maskTextClass:a="rr-mask",unmaskTextClass:c=null,maskTextSelector:l=null,unmaskTextSelector:u=null,inlineStylesheet:d=!0,inlineImages:p=!1,recordCanvas:h=!1,maskAllInputs:f=!1,maskAttributeFn:g,maskTextFn:m,maskInputFn:y,slimDOM:_=!1,dataURLOptions:v,preserveWhiteSpace:S,onSerialize:T,onIframeLoad:b,iframeLoadTimeout:w,onStylesheetLoad:E,stylesheetLoadTimeout:I,keepIframeSrcFn:A=(()=>!1)}=t||{};return jl(e,{doc:e,mirror:n,blockClass:r,blockSelector:o,unblockSelector:s,maskAllText:i,maskTextClass:a,unmaskTextClass:c,maskTextSelector:l,unmaskTextSelector:u,skipChild:!1,inlineStylesheet:d,maskInputOptions:!0===f?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0}:!1===f?{}:f,maskAttributeFn:g,maskTextFn:m,maskInputFn:y,slimDOMOptions:!0===_||"all"===_?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaDescKeywords:"all"===_,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaAuthorship:!0,headMetaVerification:!0}:!1===_?{}:_,dataURLOptions:v,inlineImages:p,recordCanvas:h,preserveWhiteSpace:S,onSerialize:T,onIframeLoad:b,iframeLoadTimeout:w,onStylesheetLoad:E,stylesheetLoadTimeout:I,keepIframeSrcFn:A,newlyAddedElement:!1})}(document,{mirror:td,blockClass:o,blockSelector:s,unblockSelector:i,maskAllText:l,maskTextClass:u,unmaskTextClass:d,maskTextSelector:p,unmaskTextSelector:h,inlineStylesheet:f,maskAllInputs:j,maskAttributeFn:_,maskInputFn:v,maskTextFn:S,slimDOM:G,dataURLOptions:E,recordCanvas:A,inlineImages:O,onSerialize:e=>{ru(e,td)&&Y.addIframe(e),ou(e,td)&&z.trackLinkElement(e),su(e)&&Q.addShadowRoot(e.shadowRoot,document)},onIframeLoad:(e,t)=>{Y.attachIframe(e,t),Q.observeAttachShadow(e)},onStylesheetLoad:(e,t)=>{z.attachLinkElement(e,t)},keepIframeSrcFn:N});if(!t)return console.warn("Failed to snapshot the document");Zu({type:hu.FullSnapshot,data:{node:t,initialOffset:Yl(window)}}),xu.forEach((e=>e.unlock())),document.adoptedStyleSheets&&document.adoptedStyleSheets.length>0&&z.adoptStyleSheets(document.adoptedStyleSheets,td.getId(document))};ed=Z;try{const e=[],t=e=>ku(Gu)({onMutation:M,mutationCb:B,mousemoveCb:(e,t)=>Zu({type:hu.IncrementalSnapshot,data:{source:t,positions:e}}),mouseInteractionCb:e=>Zu({type:hu.IncrementalSnapshot,data:{source:fu.MouseInteraction,...e}}),scrollCb:H,viewportResizeCb:e=>Zu({type:hu.IncrementalSnapshot,data:{source:fu.ViewportResize,...e}}),inputCb:e=>Zu({type:hu.IncrementalSnapshot,data:{source:fu.Input,...e}}),mediaInteractionCb:e=>Zu({type:hu.IncrementalSnapshot,data:{source:fu.MediaInteraction,...e}}),styleSheetRuleCb:e=>Zu({type:hu.IncrementalSnapshot,data:{source:fu.StyleSheetRule,...e}}),styleDeclarationCb:e=>Zu({type:hu.IncrementalSnapshot,data:{source:fu.StyleDeclaration,...e}}),canvasMutationCb:J,fontCb:e=>Zu({type:hu.IncrementalSnapshot,data:{source:fu.Font,...e}}),selectionCb:e=>{Zu({type:hu.IncrementalSnapshot,data:{source:fu.Selection,...e}})},customElementCb:e=>{Zu({type:hu.IncrementalSnapshot,data:{source:fu.CustomElement,...e}})},blockClass:o,ignoreClass:a,ignoreSelector:c,maskAllText:l,maskTextClass:u,unmaskTextClass:d,maskTextSelector:p,unmaskTextSelector:h,maskInputOptions:j,inlineStylesheet:f,sampling:w,recordCanvas:A,inlineImages:O,userTriggeredOnInput:C,collectFonts:x,doc:e,maskAttributeFn:_,maskInputFn:v,maskTextFn:S,keepIframeSrcFn:N,blockSelector:s,unblockSelector:i,slimDOMOptions:G,dataURLOptions:E,mirror:td,iframeManager:Y,stylesheetManager:z,shadowDomManager:Q,processedNodeManager:X,canvasManager:K,ignoreCSSAttributes:P,plugins:nr([L,"optionalAccess",e=>e.filter,"call",e=>e((e=>e.observer)),"optionalAccess",e=>e.map,"call",e=>e((e=>({observer:e.observer,options:e.options,callback:t=>Zu({type:hu.Plugin,data:{plugin:e.name,payload:t}})})))])||[]},{});Y.addLoadListener((n=>{try{e.push(t(n.contentDocument))}catch(e){console.warn(e)}}));const n=()=>{Z(),e.push(t(document))};return"interactive"===document.readyState||"complete"===document.readyState?n():(e.push(Vl("DOMContentLoaded",(()=>{Zu({type:hu.DomContentLoaded,data:{}}),"DOMContentLoaded"===k&&n()}))),e.push(Vl("load",(()=>{Zu({type:hu.Load,data:{}}),"load"===k&&n()}),window))),()=>{e.forEach((e=>e())),X.destroy(),ed=void 0,Ru=void 0}}catch(e){console.warn(e)}}nd.mirror=td,nd.takeFullSnapshot=function(e){if(!ed)throw new Error("please take full snapshot after start recording");ed(e)};const rd=3;function od(e){return e>9999999999?e:1e3*e}function sd(e){return e>9999999999?e/1e3:e}function id(e,t){"sentry.transaction"!==t.category&&(["ui.click","ui.input"].includes(t.category)?e.triggerUserActivity():e.checkAndHandleExpiredSession(),e.addUpdate((()=>(e.throttledAddEvent({type:hu.Custom,timestamp:1e3*(t.timestamp||0),data:{tag:"breadcrumb",payload:nn(t,10,1e3)}}),"console"===t.category))))}const ad="button,a";function cd(e){return e.closest(ad)||e}function ld(e){const t=ud(e);return t&&t instanceof Element?cd(t):t}function ud(e){return function(e){return"object"==typeof e&&!!e&&"target"in e}(e)?e.target:e}let dd;function pd(e){return dd||(dd=[],He(Yc,"open",(function(e){return function(...t){if(dd)try{dd.forEach((e=>e()))}catch(e){}return e.apply(Yc,t)}}))),dd.push(e),()=>{const t=dd?dd.indexOf(e):-1;t>-1&&dd.splice(t,1)}}class hd{constructor(e,t,n=id){this._lastMutation=0,this._lastScroll=0,this._clicks=[],this._timeout=t.timeout/1e3,this._threshold=t.threshold/1e3,this._scollTimeout=t.scrollTimeout/1e3,this._replay=e,this._ignoreSelector=t.ignoreSelector,this._addBreadcrumbEvent=n}addListeners(){const e=pd((()=>{this._lastMutation=gd()}));this._teardown=()=>{e(),this._clicks=[],this._lastMutation=0,this._lastScroll=0}}removeListeners(){this._teardown&&this._teardown(),this._checkClickTimeout&&clearTimeout(this._checkClickTimeout)}handleClick(e,t){if(function(e,t){if(!fd.includes(e.tagName))return!0;if("INPUT"===e.tagName&&!["submit","button"].includes(e.getAttribute("type")||""))return!0;if("A"===e.tagName&&(e.hasAttribute("download")||e.hasAttribute("target")&&"_self"!==e.getAttribute("target")))return!0;if(t&&e.matches(t))return!0;return!1}(t,this._ignoreSelector)||!function(e){return!(!e.data||"number"!=typeof e.data.nodeId||!e.timestamp)}(e))return;const n={timestamp:sd(e.timestamp),clickBreadcrumb:e,clickCount:0,node:t};this._clicks.some((e=>e.node===n.node&&Math.abs(e.timestamp-n.timestamp)<1))||(this._clicks.push(n),1===this._clicks.length&&this._scheduleCheckClicks())}registerMutation(e=Date.now()){this._lastMutation=sd(e)}registerScroll(e=Date.now()){this._lastScroll=sd(e)}registerClick(e){const t=cd(e);this._handleMultiClick(t)}_handleMultiClick(e){this._getClicks(e).forEach((e=>{e.clickCount++}))}_getClicks(e){return this._clicks.filter((t=>t.node===e))}_checkClicks(){const e=[],t=gd();this._clicks.forEach((n=>{!n.mutationAfter&&this._lastMutation&&(n.mutationAfter=n.timestamp<=this._lastMutation?this._lastMutation-n.timestamp:void 0),!n.scrollAfter&&this._lastScroll&&(n.scrollAfter=n.timestamp<=this._lastScroll?this._lastScroll-n.timestamp:void 0),n.timestamp+this._timeout<=t&&e.push(n)}));for(const t of e){const e=this._clicks.indexOf(t);e>-1&&(this._generateBreadcrumbs(t),this._clicks.splice(e,1))}this._clicks.length&&this._scheduleCheckClicks()}_generateBreadcrumbs(e){const t=this._replay,n=e.scrollAfter&&e.scrollAfter<=this._scollTimeout,r=e.mutationAfter&&e.mutationAfter<=this._threshold,o=!n&&!r,{clickCount:s,clickBreadcrumb:i}=e;if(o){const n=1e3*Math.min(e.mutationAfter||this._timeout,this._timeout),r=n<1e3*this._timeout?"mutation":"timeout",o={type:"default",message:i.message,timestamp:i.timestamp,category:"ui.slowClickDetected",data:{...i.data,url:Yc.location.href,route:t.getCurrentRoute(),timeAfterClickMs:n,endReason:r,clickCount:s||1}};this._addBreadcrumbEvent(t,o)}else if(s>1){const e={type:"default",message:i.message,timestamp:i.timestamp,category:"ui.multiClick",data:{...i.data,url:Yc.location.href,route:t.getCurrentRoute(),clickCount:s,metric:!0}};this._addBreadcrumbEvent(t,e)}}_scheduleCheckClicks(){this._checkClickTimeout&&clearTimeout(this._checkClickTimeout),this._checkClickTimeout=setTimeout((()=>this._checkClicks()),1e3)}}const fd=["A","BUTTON","INPUT"];function gd(){return Date.now()/1e3}function md(e,t){try{if(!function(e){return e.type===rd}(t))return;const{source:n}=t.data;if(n===fu.Mutation&&e.registerMutation(t.timestamp),n===fu.Scroll&&e.registerScroll(t.timestamp),function(e){return e.data.source===fu.MouseInteraction}(t)){const{type:n,id:r}=t.data,o=nd.mirror.getNode(r);o instanceof HTMLElement&&n===gu.Click&&e.registerClick(o)}}catch(e){}}function yd(e){return{timestamp:Date.now()/1e3,type:"default",...e}}var _d;!function(e){e[e.Document=0]="Document",e[e.DocumentType=1]="DocumentType",e[e.Element=2]="Element",e[e.Text=3]="Text",e[e.CDATA=4]="CDATA",e[e.Comment=5]="Comment"}(_d||(_d={}));const vd=new Set(["id","class","aria-label","role","name","alt","title","data-test-id","data-testid","disabled","aria-disabled","data-sentry-component"]);function Sd(e){const t={};for(const n in e)if(vd.has(n)){let r=n;"data-testid"!==n&&"data-test-id"!==n||(r="testId"),t[r]=e[n]}return t}const Td=e=>t=>{if(!e.isEnabled())return;const n=function(e){const{target:t,message:n}=function(e){const t="click"===e.name;let n,r=null;try{r=t?ld(e.event):ud(e.event),n=xe(r,{maxStringLength:200})||"<unknown>"}catch(e){n="<unknown>"}return{target:r,message:n}}(e);return yd({category:`ui.${e.name}`,...bd(t,n)})}(t);if(!n)return;const r="click"===t.name,o=r?t.event:void 0;var s,i,a;!(r&&e.clickDetector&&o&&o.target)||o.altKey||o.metaKey||o.ctrlKey||o.shiftKey||(s=e.clickDetector,i=n,a=ld(t.event),s.handleClick(i,a)),id(e,n)};function bd(e,t){const n=nd.mirror.getId(e),r=n&&nd.mirror.getNode(n),o=r&&nd.mirror.getMeta(r),s=o&&function(e){return e.type===_d.Element}(o)?o:null;return{message:t,data:s?{nodeId:n,node:{id:n,tagName:s.tagName,textContent:Array.from(s.childNodes).map((e=>e.type===_d.Text&&e.textContent)).filter(Boolean).map((e=>e.trim())).join(""),attributes:Sd(s.attributes)}}:{}}}function wd(e,t){if(!e.isEnabled())return;e.updateUserActivity();const n=function(e){const{metaKey:t,shiftKey:n,ctrlKey:r,altKey:o,key:s,target:i}=e;if(!i||function(e){return"INPUT"===e.tagName||"TEXTAREA"===e.tagName||e.isContentEditable}(i)||!s)return null;const a=t||r||o,c=1===s.length;if(!a&&c)return null;const l=xe(i,{maxStringLength:200})||"<unknown>",u=bd(i,l);return yd({category:"ui.keyDown",message:l,data:{...u.data,metaKey:t,shiftKey:n,ctrlKey:r,altKey:o,key:s}})}(t);n&&id(e,n)}const Ed={resource:function(e){const{entryType:t,initiatorType:n,name:r,responseEnd:o,startTime:s,decodedBodySize:i,encodedBodySize:a,responseStatus:c,transferSize:l}=e;if(["fetch","xmlhttprequest"].includes(n))return null;return{type:`${t}.${n}`,start:Ad(s),end:Ad(o),name:r,data:{size:l,statusCode:c,decodedBodySize:i,encodedBodySize:a}}},paint:function(e){const{duration:t,entryType:n,name:r,startTime:o}=e,s=Ad(o);return{type:n,name:r,start:s,end:s+t,data:void 0}},navigation:function(e){const{entryType:t,name:n,decodedBodySize:r,duration:o,domComplete:s,encodedBodySize:i,domContentLoadedEventStart:a,domContentLoadedEventEnd:c,domInteractive:l,loadEventStart:u,loadEventEnd:d,redirectCount:p,startTime:h,transferSize:f,type:g}=e;if(0===o)return null;return{type:`${t}.${g}`,start:Ad(h),end:Ad(s),name:n,data:{size:f,decodedBodySize:r,encodedBodySize:i,duration:o,domInteractive:l,domContentLoadedEventStart:a,domContentLoadedEventEnd:c,loadEventStart:u,loadEventEnd:d,domComplete:s,redirectCount:p}}}};function Id(e){return Ed[e.entryType]?Ed[e.entryType](e):null}function Ad(e){return((Cn||Yc.performance.timeOrigin)+e)/1e3}function Rd(e){function t(t){e.performanceEntries.includes(t)||e.performanceEntries.push(t)}function n({entries:e}){e.forEach(t)}const r=[];return["navigation","paint","resource"].forEach((e=>{r.push(Gi(e,n))})),r.push(ji((({metric:t})=>{e.replayPerformanceEntries.push(function(e){const t=e.entries,n=t[t.length-1],r=n?n.element:void 0,o=e.value,s=Ad(o);return{type:"largest-contentful-paint",name:"largest-contentful-paint",start:s,end:s,data:{value:o,size:o,nodeId:r?nd.mirror.getId(r):void 0}}}(t))}))),()=>{r.forEach((e=>e()))}}const kd="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__,Cd='var t=Uint8Array,n=Uint16Array,r=Int32Array,e=new t([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),i=new t([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),a=new t([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),s=function(t,e){for(var i=new n(31),a=0;a<31;++a)i[a]=e+=1<<t[a-1];var s=new r(i[30]);for(a=1;a<30;++a)for(var o=i[a];o<i[a+1];++o)s[o]=o-i[a]<<5|a;return{b:i,r:s}},o=s(e,2),f=o.b,h=o.r;f[28]=258,h[258]=28;for(var l=s(i,0).r,u=new n(32768),c=0;c<32768;++c){var v=(43690&c)>>1|(21845&c)<<1;v=(61680&(v=(52428&v)>>2|(13107&v)<<2))>>4|(3855&v)<<4,u[c]=((65280&v)>>8|(255&v)<<8)>>1}var d=function(t,r,e){for(var i=t.length,a=0,s=new n(r);a<i;++a)t[a]&&++s[t[a]-1];var o,f=new n(r);for(a=1;a<r;++a)f[a]=f[a-1]+s[a-1]<<1;if(e){o=new n(1<<r);var h=15-r;for(a=0;a<i;++a)if(t[a])for(var l=a<<4|t[a],c=r-t[a],v=f[t[a]-1]++<<c,d=v|(1<<c)-1;v<=d;++v)o[u[v]>>h]=l}else for(o=new n(i),a=0;a<i;++a)t[a]&&(o[a]=u[f[t[a]-1]++]>>15-t[a]);return o},g=new t(288);for(c=0;c<144;++c)g[c]=8;for(c=144;c<256;++c)g[c]=9;for(c=256;c<280;++c)g[c]=7;for(c=280;c<288;++c)g[c]=8;var w=new t(32);for(c=0;c<32;++c)w[c]=5;var p=d(g,9,0),y=d(w,5,0),m=function(t){return(t+7)/8|0},b=function(n,r,e){return(null==r||r<0)&&(r=0),(null==e||e>n.length)&&(e=n.length),new t(n.subarray(r,e))},M=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],E=function(t,n,r){var e=new Error(n||M[t]);if(e.code=t,Error.captureStackTrace&&Error.captureStackTrace(e,E),!r)throw e;return e},z=function(t,n,r){r<<=7&n;var e=n/8|0;t[e]|=r,t[e+1]|=r>>8},A=function(t,n,r){r<<=7&n;var e=n/8|0;t[e]|=r,t[e+1]|=r>>8,t[e+2]|=r>>16},_=function(r,e){for(var i=[],a=0;a<r.length;++a)r[a]&&i.push({s:a,f:r[a]});var s=i.length,o=i.slice();if(!s)return{t:F,l:0};if(1==s){var f=new t(i[0].s+1);return f[i[0].s]=1,{t:f,l:1}}i.sort((function(t,n){return t.f-n.f})),i.push({s:-1,f:25001});var h=i[0],l=i[1],u=0,c=1,v=2;for(i[0]={s:-1,f:h.f+l.f,l:h,r:l};c!=s-1;)h=i[i[u].f<i[v].f?u++:v++],l=i[u!=c&&i[u].f<i[v].f?u++:v++],i[c++]={s:-1,f:h.f+l.f,l:h,r:l};var d=o[0].s;for(a=1;a<s;++a)o[a].s>d&&(d=o[a].s);var g=new n(d+1),w=x(i[c-1],g,0);if(w>e){a=0;var p=0,y=w-e,m=1<<y;for(o.sort((function(t,n){return g[n.s]-g[t.s]||t.f-n.f}));a<s;++a){var b=o[a].s;if(!(g[b]>e))break;p+=m-(1<<w-g[b]),g[b]=e}for(p>>=y;p>0;){var M=o[a].s;g[M]<e?p-=1<<e-g[M]++-1:++a}for(;a>=0&&p;--a){var E=o[a].s;g[E]==e&&(--g[E],++p)}w=e}return{t:new t(g),l:w}},x=function(t,n,r){return-1==t.s?Math.max(x(t.l,n,r+1),x(t.r,n,r+1)):n[t.s]=r},D=function(t){for(var r=t.length;r&&!t[--r];);for(var e=new n(++r),i=0,a=t[0],s=1,o=function(t){e[i++]=t},f=1;f<=r;++f)if(t[f]==a&&f!=r)++s;else{if(!a&&s>2){for(;s>138;s-=138)o(32754);s>2&&(o(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(o(a),--s;s>6;s-=6)o(8304);s>2&&(o(s-3<<5|8208),s=0)}for(;s--;)o(a);s=1,a=t[f]}return{c:e.subarray(0,i),n:r}},T=function(t,n){for(var r=0,e=0;e<n.length;++e)r+=t[e]*n[e];return r},k=function(t,n,r){var e=r.length,i=m(n+2);t[i]=255&e,t[i+1]=e>>8,t[i+2]=255^t[i],t[i+3]=255^t[i+1];for(var a=0;a<e;++a)t[i+a+4]=r[a];return 8*(i+4+e)},C=function(t,r,s,o,f,h,l,u,c,v,m){z(r,m++,s),++f[256];for(var b=_(f,15),M=b.t,E=b.l,x=_(h,15),C=x.t,U=x.l,F=D(M),I=F.c,S=F.n,L=D(C),O=L.c,j=L.n,q=new n(19),B=0;B<I.length;++B)++q[31&I[B]];for(B=0;B<O.length;++B)++q[31&O[B]];for(var G=_(q,7),H=G.t,J=G.l,K=19;K>4&&!H[a[K-1]];--K);var N,P,Q,R,V=v+5<<3,W=T(f,g)+T(h,w)+l,X=T(f,M)+T(h,C)+l+14+3*K+T(q,H)+2*q[16]+3*q[17]+7*q[18];if(c>=0&&V<=W&&V<=X)return k(r,m,t.subarray(c,c+v));if(z(r,m,1+(X<W)),m+=2,X<W){N=d(M,E,0),P=M,Q=d(C,U,0),R=C;var Y=d(H,J,0);z(r,m,S-257),z(r,m+5,j-1),z(r,m+10,K-4),m+=14;for(B=0;B<K;++B)z(r,m+3*B,H[a[B]]);m+=3*K;for(var Z=[I,O],$=0;$<2;++$){var tt=Z[$];for(B=0;B<tt.length;++B){var nt=31&tt[B];z(r,m,Y[nt]),m+=H[nt],nt>15&&(z(r,m,tt[B]>>5&127),m+=tt[B]>>12)}}}else N=p,P=g,Q=y,R=w;for(B=0;B<u;++B){var rt=o[B];if(rt>255){A(r,m,N[(nt=rt>>18&31)+257]),m+=P[nt+257],nt>7&&(z(r,m,rt>>23&31),m+=e[nt]);var et=31&rt;A(r,m,Q[et]),m+=R[et],et>3&&(A(r,m,rt>>5&8191),m+=i[et])}else A(r,m,N[rt]),m+=P[rt]}return A(r,m,N[256]),m+P[256]},U=new r([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),F=new t(0),I=function(){for(var t=new Int32Array(256),n=0;n<256;++n){for(var r=n,e=9;--e;)r=(1&r&&-306674912)^r>>>1;t[n]=r}return t}(),S=function(){var t=1,n=0;return{p:function(r){for(var e=t,i=n,a=0|r.length,s=0;s!=a;){for(var o=Math.min(s+2655,a);s<o;++s)i+=e+=r[s];e=(65535&e)+15*(e>>16),i=(65535&i)+15*(i>>16)}t=e,n=i},d:function(){return(255&(t%=65521))<<24|(65280&t)<<8|(255&(n%=65521))<<8|n>>8}}},L=function(a,s,o,f,u){if(!u&&(u={l:1},s.dictionary)){var c=s.dictionary.subarray(-32768),v=new t(c.length+a.length);v.set(c),v.set(a,c.length),a=v,u.w=c.length}return function(a,s,o,f,u,c){var v=c.z||a.length,d=new t(f+v+5*(1+Math.ceil(v/7e3))+u),g=d.subarray(f,d.length-u),w=c.l,p=7&(c.r||0);if(s){p&&(g[0]=c.r>>3);for(var y=U[s-1],M=y>>13,E=8191&y,z=(1<<o)-1,A=c.p||new n(32768),_=c.h||new n(z+1),x=Math.ceil(o/3),D=2*x,T=function(t){return(a[t]^a[t+1]<<x^a[t+2]<<D)&z},F=new r(25e3),I=new n(288),S=new n(32),L=0,O=0,j=c.i||0,q=0,B=c.w||0,G=0;j+2<v;++j){var H=T(j),J=32767&j,K=_[H];if(A[J]=K,_[H]=J,B<=j){var N=v-j;if((L>7e3||q>24576)&&(N>423||!w)){p=C(a,g,0,F,I,S,O,q,G,j-G,p),q=L=O=0,G=j;for(var P=0;P<286;++P)I[P]=0;for(P=0;P<30;++P)S[P]=0}var Q=2,R=0,V=E,W=J-K&32767;if(N>2&&H==T(j-W))for(var X=Math.min(M,N)-1,Y=Math.min(32767,j),Z=Math.min(258,N);W<=Y&&--V&&J!=K;){if(a[j+Q]==a[j+Q-W]){for(var $=0;$<Z&&a[j+$]==a[j+$-W];++$);if($>Q){if(Q=$,R=W,$>X)break;var tt=Math.min(W,$-2),nt=0;for(P=0;P<tt;++P){var rt=j-W+P&32767,et=rt-A[rt]&32767;et>nt&&(nt=et,K=rt)}}}W+=(J=K)-(K=A[J])&32767}if(R){F[q++]=268435456|h[Q]<<18|l[R];var it=31&h[Q],at=31&l[R];O+=e[it]+i[at],++I[257+it],++S[at],B=j+Q,++L}else F[q++]=a[j],++I[a[j]]}}for(j=Math.max(j,B);j<v;++j)F[q++]=a[j],++I[a[j]];p=C(a,g,w,F,I,S,O,q,G,j-G,p),w||(c.r=7&p|g[p/8|0]<<3,p-=7,c.h=_,c.p=A,c.i=j,c.w=B)}else{for(j=c.w||0;j<v+w;j+=65535){var st=j+65535;st>=v&&(g[p/8|0]=w,st=v),p=k(g,p+1,a.subarray(j,st))}c.i=v}return b(d,0,f+m(p)+u)}(a,null==s.level?6:s.level,null==s.mem?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(a.length)))):12+s.mem,o,f,u)},O=function(t,n,r){for(;r;++n)t[n]=r,r>>>=8},j=function(){function n(n,r){if("function"==typeof n&&(r=n,n={}),this.ondata=r,this.o=n||{},this.s={l:0,i:32768,w:32768,z:32768},this.b=new t(98304),this.o.dictionary){var e=this.o.dictionary.subarray(-32768);this.b.set(e,32768-e.length),this.s.i=32768-e.length}}return n.prototype.p=function(t,n){this.ondata(L(t,this.o,0,0,this.s),n)},n.prototype.push=function(n,r){this.ondata||E(5),this.s.l&&E(4);var e=n.length+this.s.z;if(e>this.b.length){if(e>2*this.b.length-32768){var i=new t(-32768&e);i.set(this.b.subarray(0,this.s.z)),this.b=i}var a=this.b.length-this.s.z;a&&(this.b.set(n.subarray(0,a),this.s.z),this.s.z=this.b.length,this.p(this.b,!1)),this.b.set(this.b.subarray(-32768)),this.b.set(n.subarray(a),32768),this.s.z=n.length-a+32768,this.s.i=32766,this.s.w=32768}else this.b.set(n,this.s.z),this.s.z+=n.length;this.s.l=1&r,(this.s.z>this.s.w+8191||r)&&(this.p(this.b,r||!1),this.s.w=this.s.i,this.s.i-=2)},n}();function q(t,n){n||(n={});var r=function(){var t=-1;return{p:function(n){for(var r=t,e=0;e<n.length;++e)r=I[255&r^n[e]]^r>>>8;t=r},d:function(){return~t}}}(),e=t.length;r.p(t);var i,a=L(t,n,10+((i=n).filename?i.filename.length+1:0),8),s=a.length;return function(t,n){var r=n.filename;if(t[0]=31,t[1]=139,t[2]=8,t[8]=n.level<2?4:9==n.level?2:0,t[9]=3,0!=n.mtime&&O(t,4,Math.floor(new Date(n.mtime||Date.now())/1e3)),r){t[3]=8;for(var e=0;e<=r.length;++e)t[e+10]=r.charCodeAt(e)}}(a,n),O(a,s-8,r.d()),O(a,s-4,e),a}var B=function(){function t(t,n){this.c=S(),this.v=1,j.call(this,t,n)}return t.prototype.push=function(t,n){this.c.p(t),j.prototype.push.call(this,t,n)},t.prototype.p=function(t,n){var r=L(t,this.o,this.v&&(this.o.dictionary?6:2),n&&4,this.s);this.v&&(function(t,n){var r=n.level,e=0==r?0:r<6?1:9==r?3:2;if(t[0]=120,t[1]=e<<6|(n.dictionary&&32),t[1]|=31-(t[0]<<8|t[1])%31,n.dictionary){var i=S();i.p(n.dictionary),O(t,2,i.d())}}(r,this.o),this.v=0),n&&O(r,r.length-4,this.c.d()),this.ondata(r,n)},t}(),G="undefined"!=typeof TextEncoder&&new TextEncoder,H="undefined"!=typeof TextDecoder&&new TextDecoder;try{H.decode(F,{stream:!0})}catch(t){}var J=function(){function t(t){this.ondata=t}return t.prototype.push=function(t,n){this.ondata||E(5),this.d&&E(4),this.ondata(K(t),this.d=n||!1)},t}();function K(n,r){if(r){for(var e=new t(n.length),i=0;i<n.length;++i)e[i]=n.charCodeAt(i);return e}if(G)return G.encode(n);var a=n.length,s=new t(n.length+(n.length>>1)),o=0,f=function(t){s[o++]=t};for(i=0;i<a;++i){if(o+5>s.length){var h=new t(o+8+(a-i<<1));h.set(s),s=h}var l=n.charCodeAt(i);l<128||r?f(l):l<2048?(f(192|l>>6),f(128|63&l)):l>55295&&l<57344?(f(240|(l=65536+(1047552&l)|1023&n.charCodeAt(++i))>>18),f(128|l>>12&63),f(128|l>>6&63),f(128|63&l)):(f(224|l>>12),f(128|l>>6&63),f(128|63&l))}return b(s,0,o)}const N=new class{constructor(){this._init()}clear(){this._init()}addEvent(t){if(!t)throw new Error("Adding invalid event");const n=this._hasEvents?",":"";this.stream.push(n+t),this._hasEvents=!0}finish(){this.stream.push("]",!0);const t=function(t){let n=0;for(let r=0,e=t.length;r<e;r++)n+=t[r].length;const r=new Uint8Array(n);for(let n=0,e=0,i=t.length;n<i;n++){const i=t[n];r.set(i,e),e+=i.length}return r}(this._deflatedData);return this._init(),t}_init(){this._hasEvents=!1,this._deflatedData=[],this.deflate=new B,this.deflate.ondata=(t,n)=>{this._deflatedData.push(t)},this.stream=new J(((t,n)=>{this.deflate.push(t,n)})),this.stream.push("[")}},P={clear:()=>{N.clear()},addEvent:t=>N.addEvent(t),finish:()=>N.finish(),compress:t=>function(t){return q(K(t))}(t)};addEventListener("message",(function(t){const n=t.data.method,r=t.data.id,e=t.data.arg;if(n in P&&"function"==typeof P[n])try{const t=P[n](e);postMessage({id:r,method:n,success:!0,response:t})}catch(t){postMessage({id:r,method:n,success:!1,response:t.message}),console.error(t)}})),postMessage({id:void 0,method:"init",success:!0,response:void 0});';function xd(e,t){kd&&(Fe.info(e),t&&Ld(e))}function Od(e,t){kd&&(Fe.info(e),t&&setTimeout((()=>{Ld(e)}),0))}function Ld(e){Ir({category:"console",data:{logger:"replay"},level:"info",message:e},{level:"info"})}class Nd extends Error{constructor(){super("Event buffer exceeded maximum size of 20000000.")}}class Pd{constructor(){this.events=[],this._totalSize=0,this.hasCheckout=!1}get hasEvents(){return this.events.length>0}get type(){return"sync"}destroy(){this.events=[]}async addEvent(e){const t=JSON.stringify(e).length;if(this._totalSize+=t,this._totalSize>tl)throw new Nd;this.events.push(e)}finish(){return new Promise((e=>{const t=this.events;this.clear(),e(JSON.stringify(t))}))}clear(){this.events=[],this._totalSize=0,this.hasCheckout=!1}getEarliestTimestamp(){const e=this.events.map((e=>e.timestamp)).sort()[0];return e?od(e):null}}class Dd{constructor(e){this._worker=e,this._id=0}ensureReady(){return this._ensureReadyPromise||(this._ensureReadyPromise=new Promise(((e,t)=>{this._worker.addEventListener("message",(({data:n})=>{n.success?e():t()}),{once:!0}),this._worker.addEventListener("error",(e=>{t(e)}),{once:!0})}))),this._ensureReadyPromise}destroy(){xd("[Replay] Destroying compression worker"),this._worker.terminate()}postMessage(e,t){const n=this._getAndIncrementId();return new Promise(((r,o)=>{const s=({data:t})=>{const i=t;if(i.method===e&&i.id===n){if(this._worker.removeEventListener("message",s),!i.success)return kd&&Fe.error("[Replay]",i.response),void o(new Error("Error in compression worker"));r(i.response)}};this._worker.addEventListener("message",s),this._worker.postMessage({id:n,method:e,arg:t})}))}_getAndIncrementId(){return this._id++}}class Md{constructor(e){this._worker=new Dd(e),this._earliestTimestamp=null,this._totalSize=0,this.hasCheckout=!1}get hasEvents(){return!!this._earliestTimestamp}get type(){return"worker"}ensureReady(){return this._worker.ensureReady()}destroy(){this._worker.destroy()}addEvent(e){const t=od(e.timestamp);(!this._earliestTimestamp||t<this._earliestTimestamp)&&(this._earliestTimestamp=t);const n=JSON.stringify(e);return this._totalSize+=n.length,this._totalSize>tl?Promise.reject(new Nd):this._sendEventToWorker(n)}finish(){return this._finishRequest()}clear(){this._earliestTimestamp=null,this._totalSize=0,this.hasCheckout=!1,this._worker.postMessage("clear").then(null,(e=>{kd&&Fe.warn('[Replay] Sending "clear" message to worker failed',e)}))}getEarliestTimestamp(){return this._earliestTimestamp}_sendEventToWorker(e){return this._worker.postMessage("addEvent",e)}async _finishRequest(){const e=await this._worker.postMessage("finish");return this._earliestTimestamp=null,this._totalSize=0,e}}class Ud{constructor(e){this._fallback=new Pd,this._compression=new Md(e),this._used=this._fallback,this._ensureWorkerIsLoadedPromise=this._ensureWorkerIsLoaded()}get type(){return this._used.type}get hasEvents(){return this._used.hasEvents}get hasCheckout(){return this._used.hasCheckout}set hasCheckout(e){this._used.hasCheckout=e}destroy(){this._fallback.destroy(),this._compression.destroy()}clear(){return this._used.clear()}getEarliestTimestamp(){return this._used.getEarliestTimestamp()}addEvent(e){return this._used.addEvent(e)}async finish(){return await this.ensureWorkerIsLoaded(),this._used.finish()}ensureWorkerIsLoaded(){return this._ensureWorkerIsLoadedPromise}async _ensureWorkerIsLoaded(){try{await this._compression.ensureReady()}catch(e){return void xd("[Replay] Failed to load the compression worker, falling back to simple buffer")}await this._switchToCompressionWorker()}async _switchToCompressionWorker(){const{events:e,hasCheckout:t}=this._fallback,n=[];for(const t of e)n.push(this._compression.addEvent(t));this._compression.hasCheckout=t,this._used=this._compression;try{await Promise.all(n)}catch(e){kd&&Fe.warn("[Replay] Failed to add events when switching buffers.",e)}}}function $d({useCompression:e,workerUrl:t}){if(e&&window.Worker){const e=function(e){try{const t=e||function(){if("undefined"==typeof __SENTRY_EXCLUDE_REPLAY_WORKER__||!__SENTRY_EXCLUDE_REPLAY_WORKER__)return function(){const e=new Blob([Cd]);return URL.createObjectURL(e)}();return""}();if(!t)return;xd("[Replay] Using compression worker"+(e?` from ${e}`:""));const n=new Worker(t);return new Ud(n)}catch(e){xd("[Replay] Failed to create compression worker")}}(t);if(e)return e}return xd("[Replay] Using simple buffer"),new Pd}function Fd(){try{return"sessionStorage"in Yc&&!!Yc.sessionStorage}catch(e){return!1}}function jd(e){!function(){if(!Fd())return;try{Yc.sessionStorage.removeItem(Xc)}catch(e){}}(),e.session=void 0}function Gd(e){return void 0!==e&&Math.random()<e}function Vd(e){const t=Date.now();return{id:e.id||ft(),started:e.started||t,lastActivity:e.lastActivity||t,segmentId:e.segmentId||0,sampled:e.sampled,previousSessionId:e.previousSessionId}}function qd(e){if(Fd())try{Yc.sessionStorage.setItem(Xc,JSON.stringify(e))}catch(e){}}function Wd({sessionSampleRate:e,allowBuffering:t,stickySession:n=!1},{previousSessionId:r}={}){const o=function(e,t){return Gd(e)?"session":!!t&&"buffer"}(e,t),s=Vd({sampled:o,previousSessionId:r});return n&&qd(s),s}function Bd(e,t,n=+new Date){return null===e||void 0===t||t<0||0!==t&&e+t<=n}function Hd(e,{maxReplayDuration:t,sessionIdleExpire:n,targetTime:r=Date.now()}){return Bd(e.started,t,r)||Bd(e.lastActivity,n,r)}function Jd(e,{sessionIdleExpire:t,maxReplayDuration:n}){return!!Hd(e,{sessionIdleExpire:t,maxReplayDuration:n})&&("buffer"!==e.sampled||0!==e.segmentId)}function zd({traceInternals:e,sessionIdleExpire:t,maxReplayDuration:n,previousSessionId:r},o){const s=o.stickySession&&function(e){if(!Fd())return null;try{const t=Yc.sessionStorage.getItem(Xc);if(!t)return null;const n=JSON.parse(t);return Od("[Replay] Loading existing session",e),Vd(n)}catch(e){return null}}(e);return s?Jd(s,{sessionIdleExpire:t,maxReplayDuration:n})?(Od("[Replay] Session in sessionStorage is expired, creating new one..."),Wd(o,{previousSessionId:s.id})):s:(Od("[Replay] Creating new session",e),Wd(o,{previousSessionId:r}))}function Yd(e,t,n){return!!Kd(e,t)&&(Xd(e,t,n),!0)}async function Xd(e,t,n){if(!e.eventBuffer)return null;try{n&&"buffer"===e.recordingMode&&e.eventBuffer.clear(),n&&(e.eventBuffer.hasCheckout=!0);const r=function(e,t){try{if("function"==typeof t&&function(e){return e.type===hu.Custom}(e))return t(e)}catch(e){return kd&&Fe.error("[Replay] An error occured in the `beforeAddRecordingEvent` callback, skipping the event...",e),null}return e}(t,e.getOptions().beforeAddRecordingEvent);if(!r)return;return await e.eventBuffer.addEvent(r)}catch(t){const n=t&&t instanceof Nd?"addEventSizeExceeded":"addEvent";kd&&Fe.error(t),await e.stop({reason:n});const r=kr();r&&r.recordDroppedEvent("internal_sdk_error","replay")}}function Kd(e,t){if(!e.eventBuffer||e.isPaused()||!e.isEnabled())return!1;const n=od(t.timestamp);return!(n+e.timeouts.sessionIdlePause<Date.now())&&(!(n>e.getContext().initialTimestamp+e.getOptions().maxReplayDuration)||(xd(`[Replay] Skipping event with timestamp ${n} because it is after maxReplayDuration`,e.getOptions()._experiments.traceInternals),!1))}function Qd(e){return!e.type}function Zd(e){return"transaction"===e.type}function ep(e){return"feedback"===e.type}function tp(e){const t=function(){const e=kr();if(!e)return!1;const t=e.getTransport();if(!t)return!1;return t.send.__sentry__baseTransport__||!1}();return(n,r)=>{if(!e.isEnabled()||!Qd(n)&&!Zd(n))return;const o=r&&r.statusCode;t&&(!o||o<200||o>=300)||(Zd(n)?function(e,t){const n=e.getContext();t.contexts&&t.contexts.trace&&t.contexts.trace.trace_id&&n.traceIds.size<100&&n.traceIds.add(t.contexts.trace.trace_id)}(e,n):function(e,t){const n=e.getContext();t.event_id&&n.errorIds.size<100&&n.errorIds.add(t.event_id);if("buffer"!==e.recordingMode||!t.tags||!t.tags.replayId)return;const{beforeErrorSampling:r}=e.getOptions();if("function"==typeof r&&!r(t))return;setTimeout((()=>{e.sendBufferedReplayOrFlush()}))}(e,n))}}function np(e){return t=>{e.isEnabled()&&Qd(t)&&function(e,t){const n=t.exception&&t.exception.values&&t.exception.values[0].value;if("string"!=typeof n)return;if(n.match(/reactjs\.org\/docs\/error-decoder\.html\?invariant=(418|419|422|423|425)/)||n.match(/(does not match server-rendered HTML|Hydration failed because)/i)){id(e,yd({category:"replay.hydrate-error"}))}}(e,t)}}function rp(e,t=!1){const n=t?tp(e):void 0;return Object.assign(((t,r)=>{if(!e.isEnabled())return t;if(function(e){return"replay_event"===e.type}(t))return delete t.breadcrumbs,t;if(!Qd(t)&&!Zd(t)&&!ep(t))return t;if(!e.checkAndHandleExpiredSession())return t;if(ep(t))return e.flush(),t.contexts.feedback.replay_id=e.getSessionId(),function(e,t){e.triggerUserActivity(),e.addUpdate((()=>!t.timestamp||(e.throttledAddEvent({type:hu.Custom,timestamp:1e3*t.timestamp,data:{tag:"breadcrumb",payload:{timestamp:t.timestamp,type:"default",category:"sentry.feedback",data:{feedbackId:t.event_id}}}}),!1)))}(e,t),t;if(function(e,t){return!(e.type||!e.exception||!e.exception.values||!e.exception.values.length||!t.originalException||!t.originalException.__rrweb__)}(t,r)&&!e.getOptions()._experiments.captureExceptions)return kd&&Fe.log("[Replay] Ignoring error from rrweb internals",t),null;const o=function(e,t){return"buffer"===e.recordingMode&&t.message!==Qc&&!(!t.exception||t.type)&&Gd(e.getOptions().errorSampleRate)}(e,t);return(o||"session"===e.recordingMode)&&(t.tags={...t.tags,replayId:e.getSessionId()}),n&&n(t,{statusCode:200}),t}),{id:"Replay"})}function op(e,t){return t.map((({type:t,start:n,end:r,name:o,data:s})=>{const i=e.throttledAddEvent({type:hu.Custom,timestamp:n,data:{tag:"performanceSpan",payload:{op:t,description:o,startTimestamp:n,endTimestamp:r,data:s}}});return"string"==typeof i?Promise.resolve(null):i}))}function sp(e){return t=>{if(!e.isEnabled())return;const n=function(e){const{from:t,to:n}=e,r=Date.now()/1e3;return{type:"navigation.push",start:r,end:r,name:n,data:{previous:t}}}(t);null!==n&&(e.getContext().urls.push(n.name),e.triggerUserActivity(),e.addUpdate((()=>(op(e,[n]),!1))))}}function ip(e,t){e.isEnabled()&&null!==t&&(function(e,t){return(!kd||!e.getOptions()._experiments.traceInternals)&&ms(t,kr())}(e,t.name)||e.addUpdate((()=>(op(e,[t]),!0))))}function ap(e){return t=>{if(!e.isEnabled())return;const n=function(e){const{startTimestamp:t,endTimestamp:n,xhr:r}=e,o=r[Yt];if(!t||!n||!o)return null;const{method:s,url:i,status_code:a}=o;return void 0===i?null:{type:"resource.xhr",name:i,start:t/1e3,end:n/1e3,data:{method:s,statusCode:a}}}(t);ip(e,n)}}function cp(e,t){if(e)try{if("string"==typeof e)return t.encode(e).length;if(e instanceof URLSearchParams)return t.encode(e.toString()).length;if(e instanceof FormData){const n=mp(e);return t.encode(n).length}if(e instanceof Blob)return e.size;if(e instanceof ArrayBuffer)return e.byteLength}catch(e){}}function lp(e){if(!e)return;const t=parseInt(e,10);return isNaN(t)?void 0:t}function up(e){try{if("string"==typeof e)return[e];if(e instanceof URLSearchParams)return[e.toString()];if(e instanceof FormData)return[mp(e)];if(!e)return[void 0]}catch(t){return kd&&Fe.warn("[Replay] Failed to serialize body",e),[void 0,"BODY_PARSE_ERROR"]}return kd&&Fe.info("[Replay] Skipping network body because of body type",e),[void 0,"UNPARSEABLE_BODY_TYPE"]}function dp(e,t){if(!e)return{headers:{},size:void 0,_meta:{warnings:[t]}};const n={...e._meta},r=n.warnings||[];return n.warnings=[...r,t],e._meta=n,e}function pp(e,t){if(!t)return null;const{startTimestamp:n,endTimestamp:r,url:o,method:s,statusCode:i,request:a,response:c}=t;return{type:e,start:n/1e3,end:r/1e3,name:o,data:Ze({method:s,statusCode:i,request:a,response:c})}}function hp(e){return{headers:{},size:e,_meta:{warnings:["URL_SKIPPED"]}}}function fp(e,t,n){if(!t&&0===Object.keys(e).length)return;if(!t)return{headers:e};if(!n)return{headers:e,size:t};const r={headers:e,size:t},{body:o,warnings:s}=function(e){if(!e||"string"!=typeof e)return{body:e};const t=e.length>Zc,n=function(e){const t=e[0],n=e[e.length-1];return"["===t&&"]"===n||"{"===t&&"}"===n}(e);if(t){const t=e.slice(0,Zc);return n?{body:t,warnings:["MAYBE_JSON_TRUNCATED"]}:{body:`${t}â¦`,warnings:["TEXT_TRUNCATED"]}}if(n)try{return{body:JSON.parse(e)}}catch(e){}return{body:e}}(n);return r.body=o,s&&s.length>0&&(r._meta={warnings:s}),r}function gp(e,t){return Object.keys(e).reduce(((n,r)=>{const o=r.toLowerCase();return t.includes(o)&&e[r]&&(n[o]=e[r]),n}),{})}function mp(e){return new URLSearchParams(e).toString()}function yp(e,t){const n=function(e,t=Yc.document.baseURI){if(e.startsWith("http://")||e.startsWith("https://")||e.startsWith(Yc.location.origin))return e;const n=new URL(e,t);if(n.origin!==new URL(t).origin)return e;const r=n.href;if(!e.endsWith("/")&&r.endsWith("/"))return r.slice(0,-1);return r}(e);return ve(n,t)}async function _p(e,t,n){try{const r=await async function(e,t,n){const r=Date.now(),{startTimestamp:o=r,endTimestamp:s=r}=t,{url:i,method:a,status_code:c=0,request_body_size:l,response_body_size:u}=e.data,d=yp(i,n.networkDetailAllowUrls)&&!yp(i,n.networkDetailDenyUrls),p=d?function({networkCaptureBodies:e,networkRequestHeaders:t},n,r){const o=n?function(e,t){if(1===e.length&&"string"!=typeof e[0])return Tp(e[0],t);if(2===e.length)return Tp(e[1],t);return{}}(n,t):{};if(!e)return fp(o,r,void 0);const s=vp(n),[i,a]=up(s),c=fp(o,r,i);if(a)return dp(c,a);return c}(n,t.input,l):hp(l),h=await async function(e,{networkCaptureBodies:t,textEncoder:n,networkResponseHeaders:r},o,s){if(!e&&void 0!==s)return hp(s);const i=o?Sp(o.headers,r):{};if(!o||!t&&void 0!==s)return fp(i,s,void 0);const[a,c]=await async function(e){const t=function(e){try{return e.clone()}catch(e){kd&&Fe.warn("[Replay] Failed to clone response body",e)}}(e);if(!t)return[void 0,"BODY_PARSE_ERROR"];try{const e=await function(e){return new Promise(((t,n)=>{const r=setTimeout((()=>n(new Error("Timeout while trying to read response body"))),500);(async function(e){return await e.text()})(e).then((e=>t(e)),(e=>n(e))).finally((()=>clearTimeout(r)))}))}(t);return[e]}catch(e){return kd&&Fe.warn("[Replay] Failed to get text body from response",e),[void 0,"BODY_PARSE_ERROR"]}}(o),l=function(e,{networkCaptureBodies:t,textEncoder:n,responseBodySize:r,captureDetails:o,headers:s}){try{const i=e&&e.length&&void 0===r?cp(e,n):r;return o?fp(s,i,t?e:void 0):hp(i)}catch(e){return kd&&Fe.warn("[Replay] Failed to serialize response body",e),fp(s,r,void 0)}}(a,{networkCaptureBodies:t,textEncoder:n,responseBodySize:s,captureDetails:e,headers:i});if(c)return dp(l,c);return l}(d,n,t.response,u);return{startTimestamp:o,endTimestamp:s,url:i,method:a,statusCode:c,request:p,response:h}}(e,t,n),o=pp("resource.fetch",r);ip(n.replay,o)}catch(e){kd&&Fe.error("[Replay] Failed to capture fetch breadcrumb",e)}}function vp(e=[]){if(2===e.length&&"object"==typeof e[1])return e[1].body}function Sp(e,t){const n={};return t.forEach((t=>{e.get(t)&&(n[t]=e.get(t))})),n}function Tp(e,t){if(!e)return{};const n=e.headers;return n?n instanceof Headers?Sp(n,t):Array.isArray(n)?{}:gp(n,t):{}}async function bp(e,t,n){try{const r=function(e,t,n){const r=Date.now(),{startTimestamp:o=r,endTimestamp:s=r,input:i,xhr:a}=t,{url:c,method:l,status_code:u=0,request_body_size:d,response_body_size:p}=e.data;if(!c)return null;if(!a||!yp(c,n.networkDetailAllowUrls)||yp(c,n.networkDetailDenyUrls)){return{startTimestamp:o,endTimestamp:s,url:c,method:l,statusCode:u,request:hp(d),response:hp(p)}}const h=a[Yt],f=h?gp(h.request_headers,n.networkRequestHeaders):{},g=gp(function(e){const t=e.getAllResponseHeaders();if(!t)return{};return t.split("\r\n").reduce(((e,t)=>{const[n,r]=t.split(": ");return e[n.toLowerCase()]=r,e}),{})}(a),n.networkResponseHeaders),[m,y]=n.networkCaptureBodies?up(i):[void 0],[_,v]=n.networkCaptureBodies?function(e){const t=[];try{return[e.responseText]}catch(e){t.push(e)}try{return function(e,t){try{if("string"==typeof e)return[e];if(e instanceof Document)return[e.body.outerHTML];if("json"===t&&e&&"object"==typeof e)return[JSON.stringify(e)];if(!e)return[void 0]}catch(t){return kd&&Fe.warn("[Replay] Failed to serialize body",e),[void 0,"BODY_PARSE_ERROR"]}return kd&&Fe.info("[Replay] Skipping network body because of body type",e),[void 0,"UNPARSEABLE_BODY_TYPE"]}(e.response,e.responseType)}catch(e){t.push(e)}return kd&&Fe.warn("[Replay] Failed to get xhr response body",...t),[void 0]}(a):[void 0],S=fp(f,d,m),T=fp(g,p,_);return{startTimestamp:o,endTimestamp:s,url:c,method:l,statusCode:u,request:y?dp(S,y):S,response:v?dp(T,v):T}}(e,t,n),o=pp("resource.xhr",r);ip(n.replay,o)}catch(e){kd&&Fe.error("[Replay] Failed to capture xhr breadcrumb",e)}}function wp(e,t,n){const{xhr:r,input:o}=t;if(!r)return;const s=cp(o,n.textEncoder),i=r.getResponseHeader("content-length")?lp(r.getResponseHeader("content-length")):function(e,t,n){try{return cp("json"===t&&e&&"object"==typeof e?JSON.stringify(e):e,n)}catch(e){return}}(r.response,r.responseType,n.textEncoder);void 0!==s&&(e.data.request_body_size=s),void 0!==i&&(e.data.response_body_size=i)}function Ep(e){const t=kr();try{const n=new TextEncoder,{networkDetailAllowUrls:r,networkDetailDenyUrls:o,networkCaptureBodies:s,networkRequestHeaders:i,networkResponseHeaders:a}=e.getOptions(),c={replay:e,textEncoder:n,networkDetailAllowUrls:r,networkDetailDenyUrls:o,networkCaptureBodies:s,networkRequestHeaders:i,networkResponseHeaders:a};t&&t.on?t.on("beforeAddBreadcrumb",((e,t)=>function(e,t,n){if(!t.data)return;try{(function(e){return"xhr"===e.category})(t)&&function(e){return e&&e.xhr}(n)&&(wp(t,n,e),bp(t,n,e)),function(e){return"fetch"===e.category}(t)&&function(e){return e&&e.response}(n)&&(!function(e,t,n){const{input:r,response:o}=t,s=cp(r?vp(r):void 0,n.textEncoder),i=o?lp(o.headers.get("content-length")):void 0;void 0!==s&&(e.data.request_body_size=s),void 0!==i&&(e.data.response_body_size=i)}(t,n,e),_p(t,n,e))}catch(e){kd&&Fe.warn("Error when enriching network breadcrumb")}}(c,e,t))):(Nt(function(e){return t=>{if(!e.isEnabled())return;const n=function(e){const{startTimestamp:t,endTimestamp:n,fetchData:r,response:o}=e;if(!n)return null;const{method:s,url:i}=r;return{type:"resource.fetch",start:t/1e3,end:n/1e3,name:i,data:{method:s,statusCode:o?o.status:void 0}}}(t);ip(e,n)}}(e)),Xt(ap(e)))}catch(e){}}let Ip=null;const Ap=e=>t=>{if(!e.isEnabled())return;const n=function(e){const t=e.getLastBreadcrumb&&e.getLastBreadcrumb();if(Ip===t||!t)return null;if(Ip=t,!function(e){return!!e.category}(t)||["fetch","xhr","sentry.event","sentry.transaction"].includes(t.category)||t.category.startsWith("ui."))return null;if("console"===t.category)return function(e){const t=e.data&&e.data.arguments;if(!Array.isArray(t)||0===t.length)return yd(e);let n=!1;const r=t.map((e=>{if(!e)return e;if("string"==typeof e)return e.length>el?(n=!0,`${e.slice(0,el)}â¦`):e;if("object"==typeof e)try{const t=nn(e,7);return JSON.stringify(t).length>el?(n=!0,`${JSON.stringify(t,null,2).slice(0,el)}â¦`):t}catch(e){}return e}));return yd({...e,data:{...e.data,arguments:r,...n?{_meta:{warnings:["CONSOLE_ARG_TRUNCATED"]}}:{}}})}(t);return yd(t)}(t);n&&id(e,n)};function Rp(e){return!(!e||!e.on)}function kp(e){const{jsHeapSizeLimit:t,totalJSHeapSize:n,usedJSHeapSize:r}=e,o=Date.now()/1e3;return{type:"memory",name:"memory",start:o,end:o,data:{memory:{jsHeapSizeLimit:t,totalJSHeapSize:n,usedJSHeapSize:r}}}}function Cp(e){let t=!1;return(n,r)=>{if(!e.checkAndHandleExpiredSession())return void(kd&&Fe.warn("[Replay] Received replay event after session expired."));const o=r||!t;t=!0,e.clickDetector&&md(e.clickDetector,n),e.addUpdate((()=>{if("buffer"===e.recordingMode&&o&&e.setInitialState(),!Yd(e,n,o))return!0;if(!o)return!1;if(function(e,t){if(!t||!e.session||0!==e.session.segmentId)return;Yd(e,function(e){const t=e.getOptions();return{type:hu.Custom,timestamp:Date.now(),data:{tag:"options",payload:{shouldRecordCanvas:e.isRecordingCanvas(),sessionSampleRate:t.sessionSampleRate,errorSampleRate:t.errorSampleRate,useCompressionOption:t.useCompression,blockAllMedia:t.blockAllMedia,maskAllText:t.maskAllText,maskAllInputs:t.maskAllInputs,useCompression:!!e.eventBuffer&&"worker"===e.eventBuffer.type,networkDetailHasUrls:t.networkDetailAllowUrls.length>0,networkCaptureBodies:t.networkCaptureBodies,networkRequestHasHeaders:t.networkRequestHeaders.length>0,networkResponseHasHeaders:t.networkResponseHeaders.length>0}}}}(e),!1)}(e,o),e.session&&e.session.previousSessionId)return!0;if("buffer"===e.recordingMode&&e.session&&e.eventBuffer){const t=e.eventBuffer.getEarliestTimestamp();t&&(xd(`[Replay] Updating session start time to earliest event in buffer to ${new Date(t)}`,e.getOptions()._experiments.traceInternals),e.session.started=t,e.getOptions().stickySession&&qd(e.session))}return"session"===e.recordingMode&&e.flush(),!0}))}}async function xp({recordingData:e,replayId:t,segmentId:n,eventContext:r,timestamp:o,session:s}){const i=function({recordingData:e,headers:t}){let n;const r=`${JSON.stringify(t)}\n`;if("string"==typeof e)n=`${r}${e}`;else{const t=(new TextEncoder).encode(r);n=new Uint8Array(t.length+e.length),n.set(t),n.set(e,t.length)}return n}({recordingData:e,headers:{segment_id:n}}),{urls:a,errorIds:c,traceIds:l,initialTimestamp:u}=r,d=kr(),p=Cr(),h=d&&d.getTransport(),f=d&&d.getDsn();if(!(d&&h&&f&&s.sampled))return;const g={type:Kc,replay_start_timestamp:u/1e3,timestamp:o/1e3,error_ids:c,trace_ids:l,urls:a,replay_id:t,segment_id:n,replay_type:s.sampled},m=await async function({client:e,scope:t,replayId:n,event:r}){const o={event_id:n,integrations:"object"!=typeof e._integrations||null===e._integrations||Array.isArray(e._integrations)?void 0:Object.keys(e._integrations)};e.emit&&e.emit("preprocessEvent",r,o);const s=await _r(e.getOptions(),r,o,t,e,Xr());if(!s)return null;s.platform=s.platform||"javascript";const i=e.getSdkMetadata&&e.getSdkMetadata(),{name:a,version:c}=i&&i.sdk||{};return s.sdk={...s.sdk,name:a||"sentry.javascript.unknown",version:c||"0.0.0"},s}({scope:p,client:d,replayId:t,event:g});if(!m)return d.recordDroppedEvent("event_processor","replay",g),void xd("An event processor returned `null`, will not send event.");delete m.sdkProcessingMetadata;const y=function(e,t,n,r){return Gn(Xn(e,Yn(e),r,n),[[{type:"replay_event"},e],[{type:"replay_recording",length:"string"==typeof t?(new TextEncoder).encode(t).length:t.length},t]])}(m,i,f,d.getOptions().tunnel);let _;try{_=await h.send(y)}catch(e){const t=new Error(Qc);try{t.cause=e}catch(e){}throw t}if(!_)return _;if("number"==typeof _.statusCode&&(_.statusCode<200||_.statusCode>=300))throw new Op(_.statusCode);const v=er({},_);if(Zn(v,"replay"))throw new Lp(v);return _}class Op extends Error{constructor(e){super(`Transport returned status code ${e}`)}}class Lp extends Error{constructor(e){super("Rate limit hit"),this.rateLimits=e}}async function Np(e,t={count:0,interval:5e3}){const{recordingData:n,options:r}=e;if(n.length)try{return await xp(e),!0}catch(n){if(n instanceof Op||n instanceof Lp)throw n;if(Ar("Replays",{_retryCount:t.count}),kd&&r._experiments&&r._experiments.captureExceptions&&br(n),t.count>=3){const e=new Error(`${Qc} - max retries exceeded`);try{e.cause=n}catch(e){}throw e}return t.interval*=++t.count,new Promise(((n,r)=>{setTimeout((async()=>{try{await Np(e,t),n(!0)}catch(e){r(e)}}),t.interval)}))}}const Pp="__THROTTLED";function Dp(e,t,n){const r=new Map;let o=!1;return(...s)=>{const i=Math.floor(Date.now()/1e3);if((e=>{const t=e-n;r.forEach(((e,n)=>{n<t&&r.delete(n)}))})(i),[...r.values()].reduce(((e,t)=>e+t),0)>=t){const e=o;return o=!0,e?"__SKIPPED":Pp}o=!1;const a=r.get(i)||0;return r.set(i,a+1),e(...s)}}class Mp{constructor({options:e,recordingOptions:t}){Mp.prototype.__init.call(this),Mp.prototype.__init2.call(this),Mp.prototype.__init3.call(this),Mp.prototype.__init4.call(this),Mp.prototype.__init5.call(this),Mp.prototype.__init6.call(this),this.eventBuffer=null,this.performanceEntries=[],this.replayPerformanceEntries=[],this.recordingMode="session",this.timeouts={sessionIdlePause:3e5,sessionIdleExpire:9e5},this._lastActivity=Date.now(),this._isEnabled=!1,this._isPaused=!1,this._hasInitializedCoreListeners=!1,this._context={errorIds:new Set,traceIds:new Set,urls:[],initialTimestamp:Date.now(),initialUrl:""},this._recordingOptions=t,this._options=e,this._debouncedFlush=function(e,t,n){let r,o,s;const i=n&&n.maxWait?Math.max(n.maxWait,t):0;function a(){return c(),r=e(),r}function c(){void 0!==o&&clearTimeout(o),void 0!==s&&clearTimeout(s),o=s=void 0}function l(){return o&&clearTimeout(o),o=setTimeout(a,t),i&&void 0===s&&(s=setTimeout(a,i)),r}return l.cancel=c,l.flush=function(){return void 0!==o||void 0!==s?a():r},l}((()=>this._flush()),this._options.flushMinDelay,{maxWait:this._options.flushMaxDelay}),this._throttledAddEvent=Dp(((e,t)=>function(e,t,n){return Kd(e,t)?Xd(e,t,n):Promise.resolve(null)}(this,e,t)),300,5);const{slowClickTimeout:n,slowClickIgnoreSelectors:r}=this.getOptions(),o=n?{threshold:Math.min(3e3,n),timeout:n,scrollTimeout:300,ignoreSelector:r?r.join(","):""}:void 0;o&&(this.clickDetector=new hd(this,o))}getContext(){return this._context}isEnabled(){return this._isEnabled}isPaused(){return this._isPaused}isRecordingCanvas(){return Boolean(this._canvas)}getOptions(){return this._options}initializeSampling(e){const{errorSampleRate:t,sessionSampleRate:n}=this._options;t<=0&&n<=0||(this._initializeSessionForSampling(e),this.session?!1!==this.session.sampled&&(this.recordingMode="buffer"===this.session.sampled&&0===this.session.segmentId?"buffer":"session",Od(`[Replay] Starting replay in ${this.recordingMode} mode`,this._options._experiments.traceInternals),this._initializeRecording()):this._handleException(new Error("Unable to initialize and create session")))}start(){if(this._isEnabled&&"session"===this.recordingMode)throw new Error("Replay recording is already in progress");if(this._isEnabled&&"buffer"===this.recordingMode)throw new Error("Replay buffering is in progress, call `flush()` to save the replay");Od("[Replay] Starting replay in session mode",this._options._experiments.traceInternals),this._updateUserActivity();const e=zd({maxReplayDuration:this._options.maxReplayDuration,sessionIdleExpire:this.timeouts.sessionIdleExpire,traceInternals:this._options._experiments.traceInternals},{stickySession:this._options.stickySession,sessionSampleRate:1,allowBuffering:!1});this.session=e,this._initializeRecording()}startBuffering(){if(this._isEnabled)throw new Error("Replay recording is already in progress");Od("[Replay] Starting replay in buffer mode",this._options._experiments.traceInternals);const e=zd({sessionIdleExpire:this.timeouts.sessionIdleExpire,maxReplayDuration:this._options.maxReplayDuration,traceInternals:this._options._experiments.traceInternals},{stickySession:this._options.stickySession,sessionSampleRate:0,allowBuffering:!0});this.session=e,this.recordingMode="buffer",this._initializeRecording()}startRecording(){try{const e=this._canvas;this._stopRecording=nd({...this._recordingOptions,..."buffer"===this.recordingMode&&{checkoutEveryNms:6e4},emit:Cp(this),onMutation:this._onMutationHandler,...e?{recordCanvas:e.recordCanvas,getCanvasManager:e.getCanvasManager,sampling:e.sampling,dataURLOptions:e.dataURLOptions}:{}})}catch(e){this._handleException(e)}}stopRecording(){try{return this._stopRecording&&(this._stopRecording(),this._stopRecording=void 0),!0}catch(e){return this._handleException(e),!1}}async stop({forceFlush:e=!1,reason:t}={}){if(this._isEnabled){this._isEnabled=!1;try{xd("[Replay] Stopping Replay"+(t?` triggered by ${t}`:""),this._options._experiments.traceInternals),this._removeListeners(),this.stopRecording(),this._debouncedFlush.cancel(),e&&await this._flush({force:!0}),this.eventBuffer&&this.eventBuffer.destroy(),this.eventBuffer=null,jd(this)}catch(e){this._handleException(e)}}}pause(){this._isPaused||(this._isPaused=!0,this.stopRecording(),xd("[Replay] Pausing replay",this._options._experiments.traceInternals))}resume(){this._isPaused&&this._checkSession()&&(this._isPaused=!1,this.startRecording(),xd("[Replay] Resuming replay",this._options._experiments.traceInternals))}async sendBufferedReplayOrFlush({continueRecording:e=!0}={}){if("session"===this.recordingMode)return this.flushImmediate();const t=Date.now();xd("[Replay] Converting buffer to session",this._options._experiments.traceInternals),await this.flushImmediate();const n=this.stopRecording();e&&n&&"session"!==this.recordingMode&&(this.recordingMode="session",this.session&&(this._updateUserActivity(t),this._updateSessionActivity(t),this._maybeSaveSession()),this.startRecording())}addUpdate(e){const t=e();"buffer"!==this.recordingMode&&!0!==t&&this._debouncedFlush()}triggerUserActivity(){if(this._updateUserActivity(),this._stopRecording)this.checkAndHandleExpiredSession(),this._updateSessionActivity();else{if(!this._checkSession())return;this.resume()}}updateUserActivity(){this._updateUserActivity(),this._updateSessionActivity()}conditionalFlush(){return"buffer"===this.recordingMode?Promise.resolve():this.flushImmediate()}flush(){return this._debouncedFlush()}flushImmediate(){return this._debouncedFlush(),this._debouncedFlush.flush()}cancelFlush(){this._debouncedFlush.cancel()}getSessionId(){return this.session&&this.session.id}checkAndHandleExpiredSession(){if(!(this._lastActivity&&Bd(this._lastActivity,this.timeouts.sessionIdlePause)&&this.session&&"session"===this.session.sampled))return!!this._checkSession();this.pause()}setInitialState(){const e=`${Yc.location.pathname}${Yc.location.hash}${Yc.location.search}`,t=`${Yc.location.origin}${e}`;this.performanceEntries=[],this.replayPerformanceEntries=[],this._clearContext(),this._context.initialUrl=t,this._context.initialTimestamp=Date.now(),this._context.urls.push(t)}throttledAddEvent(e,t){const n=this._throttledAddEvent(e,t);if(n===Pp){const e=yd({category:"replay.throttled"});this.addUpdate((()=>!Yd(this,{type:5,timestamp:e.timestamp||0,data:{tag:"breadcrumb",payload:e,metric:!0}})))}return n}getCurrentRoute(){const e=this.lastTransaction||Cr().getTransaction(),t=(e&&mr(e).data||{})[To];if(e&&t&&["route","custom"].includes(t))return mr(e).description}_initializeRecording(){this.setInitialState(),this._updateSessionActivity(),this.eventBuffer=$d({useCompression:this._options.useCompression,workerUrl:this._options.workerUrl}),this._removeListeners(),this._addListeners(),this._isEnabled=!0,this._isPaused=!1,this.startRecording()}_handleException(e){kd&&Fe.error("[Replay]",e),kd&&this._options._experiments&&this._options._experiments.captureExceptions&&br(e)}_initializeSessionForSampling(e){const t=this._options.errorSampleRate>0,n=zd({sessionIdleExpire:this.timeouts.sessionIdleExpire,maxReplayDuration:this._options.maxReplayDuration,traceInternals:this._options._experiments.traceInternals,previousSessionId:e},{stickySession:this._options.stickySession,sessionSampleRate:this._options.sessionSampleRate,allowBuffering:t});this.session=n}_checkSession(){if(!this.session)return!1;const e=this.session;return!Jd(e,{sessionIdleExpire:this.timeouts.sessionIdleExpire,maxReplayDuration:this._options.maxReplayDuration})||(this._refreshSession(e),!1)}async _refreshSession(e){this._isEnabled&&(await this.stop({reason:"refresh session"}),this.initializeSampling(e.id))}_addListeners(){try{Yc.document.addEventListener("visibilitychange",this._handleVisibilityChange),Yc.addEventListener("blur",this._handleWindowBlur),Yc.addEventListener("focus",this._handleWindowFocus),Yc.addEventListener("keydown",this._handleKeyboardEvent),this.clickDetector&&this.clickDetector.addListeners(),this._hasInitializedCoreListeners||(!function(e){const t=Cr(),n=kr();t.addScopeListener(Ap(e)),At(Td(e)),Ht(sp(e)),Ep(e);const r=rp(e,!Rp(n));n&&n.addEventProcessor?n.addEventProcessor(r):rs(r),Rp(n)&&(n.on("beforeSendEvent",np(e)),n.on("afterSendEvent",tp(e)),n.on("createDsc",(t=>{const n=e.getSessionId();n&&e.isEnabled()&&"session"===e.recordingMode&&e.checkAndHandleExpiredSession()&&(t.replay_id=n)})),n.on("startTransaction",(t=>{e.lastTransaction=t})),n.on("finishTransaction",(t=>{e.lastTransaction=t})),n.on("beforeSendFeedback",((t,n)=>{const r=e.getSessionId();n&&n.includeReplay&&e.isEnabled()&&r&&t.contexts&&t.contexts.feedback&&(t.contexts.feedback.replay_id=r)})))}(this),this._hasInitializedCoreListeners=!0)}catch(e){this._handleException(e)}this._performanceCleanupCallback=Rd(this)}_removeListeners(){try{Yc.document.removeEventListener("visibilitychange",this._handleVisibilityChange),Yc.removeEventListener("blur",this._handleWindowBlur),Yc.removeEventListener("focus",this._handleWindowFocus),Yc.removeEventListener("keydown",this._handleKeyboardEvent),this.clickDetector&&this.clickDetector.removeListeners(),this._performanceCleanupCallback&&this._performanceCleanupCallback()}catch(e){this._handleException(e)}}__init(){this._handleVisibilityChange=()=>{"visible"===Yc.document.visibilityState?this._doChangeToForegroundTasks():this._doChangeToBackgroundTasks()}}__init2(){this._handleWindowBlur=()=>{const e=yd({category:"ui.blur"});this._doChangeToBackgroundTasks(e)}}__init3(){this._handleWindowFocus=()=>{const e=yd({category:"ui.focus"});this._doChangeToForegroundTasks(e)}}__init4(){this._handleKeyboardEvent=e=>{wd(this,e)}}_doChangeToBackgroundTasks(e){if(!this.session)return;Hd(this.session,{maxReplayDuration:this._options.maxReplayDuration,sessionIdleExpire:this.timeouts.sessionIdleExpire})||(e&&this._createCustomBreadcrumb(e),this.conditionalFlush())}_doChangeToForegroundTasks(e){if(!this.session)return;this.checkAndHandleExpiredSession()?e&&this._createCustomBreadcrumb(e):xd("[Replay] Document has become active, but session has expired")}_updateUserActivity(e=Date.now()){this._lastActivity=e}_updateSessionActivity(e=Date.now()){this.session&&(this.session.lastActivity=e,this._maybeSaveSession())}_createCustomBreadcrumb(e){this.addUpdate((()=>{this.throttledAddEvent({type:hu.Custom,timestamp:e.timestamp||0,data:{tag:"breadcrumb",payload:e}})}))}_addPerformanceEntries(){const e=(t=this.performanceEntries,t.map(Id).filter(Boolean)).concat(this.replayPerformanceEntries);var t;return this.performanceEntries=[],this.replayPerformanceEntries=[],Promise.all(op(this,e))}_clearContext(){this._context.errorIds.clear(),this._context.traceIds.clear(),this._context.urls=[]}_updateInitialTimestampFromEventBuffer(){const{session:e,eventBuffer:t}=this;if(!e||!t)return;if(e.segmentId)return;const n=t.getEarliestTimestamp();n&&n<this._context.initialTimestamp&&(this._context.initialTimestamp=n)}_popEventContext(){const e={initialTimestamp:this._context.initialTimestamp,initialUrl:this._context.initialUrl,errorIds:Array.from(this._context.errorIds),traceIds:Array.from(this._context.traceIds),urls:this._context.urls};return this._clearContext(),e}async _runFlush(){const e=this.getSessionId();if(this.session&&this.eventBuffer&&e){if(await this._addPerformanceEntries(),this.eventBuffer&&this.eventBuffer.hasEvents&&(await async function(e){try{return Promise.all(op(e,[kp(Yc.performance.memory)]))}catch(e){return[]}}(this),this.eventBuffer&&e===this.getSessionId()))try{this._updateInitialTimestampFromEventBuffer();const t=Date.now();if(t-this._context.initialTimestamp>this._options.maxReplayDuration+3e4)throw new Error("Session is too long, not sending replay");const n=this._popEventContext(),r=this.session.segmentId++;this._maybeSaveSession();const o=await this.eventBuffer.finish();await Np({replayId:e,recordingData:o,segmentId:r,eventContext:n,session:this.session,options:this.getOptions(),timestamp:t})}catch(e){this._handleException(e),this.stop({reason:"sendReplay"});const t=kr();t&&t.recordDroppedEvent("send_error","replay")}}else kd&&Fe.error("[Replay] No session or eventBuffer found to flush.")}__init5(){this._flush=async({force:e=!1}={})=>{if(!this._isEnabled&&!e)return;if(!this.checkAndHandleExpiredSession())return void(kd&&Fe.error("[Replay] Attempting to finish replay event after session expired."));if(!this.session)return;const t=this.session.started,n=Date.now()-t;this._debouncedFlush.cancel();const r=n<this._options.minReplayDuration,o=n>this._options.maxReplayDuration+5e3;if(r||o)return xd(`[Replay] Session duration (${Math.floor(n/1e3)}s) is too ${r?"short":"long"}, not sending replay.`,this._options._experiments.traceInternals),void(r&&this._debouncedFlush());const s=this.eventBuffer;if(s&&0===this.session.segmentId&&!s.hasCheckout&&xd("[Replay] Flushing initial segment without checkout.",this._options._experiments.traceInternals),!this._flushLock)return this._flushLock=this._runFlush(),await this._flushLock,void(this._flushLock=void 0);try{await this._flushLock}catch(e){kd&&Fe.error(e)}finally{this._debouncedFlush()}}}_maybeSaveSession(){this.session&&this._options.stickySession&&qd(this.session)}__init6(){this._onMutationHandler=e=>{const t=e.length,n=this._options.mutationLimit,r=n&&t>n;if(t>this._options.mutationBreadcrumbLimit||r){const e=yd({category:"replay.mutations",data:{count:t,limit:r}});this._createCustomBreadcrumb(e)}return!r||(this.stop({reason:"mutationLimit",forceFlush:"session"===this.recordingMode}),!1)}}}function Up(e,t,n,r){const o=[...e,..."string"==typeof r?r.split(","):[],...t];return void 0!==n&&("string"==typeof n&&o.push(`.${n}`),$e((()=>{console.warn("[Replay] You are using a deprecated configuration item for privacy. Read the documentation on how to use the new privacy configuration.")}))),o.join(",")}const $p='img,image,svg,video,object,picture,embed,map,audio,link[rel="icon"],link[rel="apple-touch-icon"]',Fp=["content-length","content-type","accept"];let jp=!1;class Gp{static __initStatic(){this.id="Replay"}constructor({flushMinDelay:e=5e3,flushMaxDelay:t=5500,minReplayDuration:n=4999,maxReplayDuration:r=36e5,stickySession:o=!0,useCompression:s=!0,workerUrl:i,_experiments:a={},sessionSampleRate:c,errorSampleRate:l,maskAllText:u=!0,maskAllInputs:d=!0,blockAllMedia:p=!0,mutationBreadcrumbLimit:h=750,mutationLimit:f=1e4,slowClickTimeout:g=7e3,slowClickIgnoreSelectors:m=[],networkDetailAllowUrls:y=[],networkDetailDenyUrls:_=[],networkCaptureBodies:v=!0,networkRequestHeaders:S=[],networkResponseHeaders:T=[],mask:b=[],maskAttributes:w=["title","placeholder"],unmask:E=[],block:I=[],unblock:A=[],ignore:R=[],maskFn:k,beforeAddRecordingEvent:C,beforeErrorSampling:x,blockClass:O,blockSelector:L,maskInputOptions:N,maskTextClass:P,maskTextSelector:D,ignoreClass:M}={}){this.name=Gp.id;const U=function({mask:e,unmask:t,block:n,unblock:r,ignore:o,blockClass:s,blockSelector:i,maskTextClass:a,maskTextSelector:c,ignoreClass:l}){const u={maskTextSelector:Up(e,[".sentry-mask","[data-sentry-mask]"],a,c),unmaskTextSelector:Up(t,[".sentry-unmask","[data-sentry-unmask]"]),blockSelector:Up(n,[".sentry-block","[data-sentry-block]",'base[href="/"]'],s,i),unblockSelector:Up(r,[".sentry-unblock","[data-sentry-unblock]"]),ignoreSelector:Up(o,[".sentry-ignore","[data-sentry-ignore]",'input[type="file"]'],l)};return s instanceof RegExp&&(u.blockClass=s),a instanceof RegExp&&(u.maskTextClass=a),u}({mask:b,unmask:E,block:I,unblock:A,ignore:R,blockClass:O,blockSelector:L,maskTextClass:P,maskTextSelector:D,ignoreClass:M});if(this._recordingOptions={maskAllInputs:d,maskAllText:u,maskInputOptions:{...N||{},password:!0},maskTextFn:k,maskInputFn:k,maskAttributeFn:(e,t,n)=>function({el:e,key:t,maskAttributes:n,maskAllText:r,privacyOptions:o,value:s}){return r?o.unmaskTextSelector&&e.matches(o.unmaskTextSelector)?s:n.includes(t)||"value"===t&&"INPUT"===e.tagName&&["submit","button"].includes(e.getAttribute("type")||"")?s.replace(/[\S]/g,"*"):s:s}({maskAttributes:w,maskAllText:u,privacyOptions:U,key:e,value:t,el:n}),...U,slimDOMOptions:"all",inlineStylesheet:!0,inlineImages:!1,collectFonts:!0,errorHandler:e=>{try{e.__rrweb__=!0}catch(e){}}},this._initialOptions={flushMinDelay:e,flushMaxDelay:t,minReplayDuration:Math.min(n,15e3),maxReplayDuration:Math.min(r,nl),stickySession:o,sessionSampleRate:c,errorSampleRate:l,useCompression:s,workerUrl:i,blockAllMedia:p,maskAllInputs:d,maskAllText:u,mutationBreadcrumbLimit:h,mutationLimit:f,slowClickTimeout:g,slowClickIgnoreSelectors:m,networkDetailAllowUrls:y,networkDetailDenyUrls:_,networkCaptureBodies:v,networkRequestHeaders:Vp(S),networkResponseHeaders:Vp(T),beforeAddRecordingEvent:C,beforeErrorSampling:x,_experiments:a},"number"==typeof c&&(console.warn(`[Replay] You are passing \`sessionSampleRate\` to the Replay integration.\nThis option is deprecated and will be removed soon.\nInstead, configure \`replaysSessionSampleRate\` directly in the SDK init options, e.g.:\nSentry.init({ replaysSessionSampleRate: ${c} })`),this._initialOptions.sessionSampleRate=c),"number"==typeof l&&(console.warn(`[Replay] You are passing \`errorSampleRate\` to the Replay integration.\nThis option is deprecated and will be removed soon.\nInstead, configure \`replaysOnErrorSampleRate\` directly in the SDK init options, e.g.:\nSentry.init({ replaysOnErrorSampleRate: ${l} })`),this._initialOptions.errorSampleRate=l),this._initialOptions.blockAllMedia&&(this._recordingOptions.blockSelector=this._recordingOptions.blockSelector?`${this._recordingOptions.blockSelector},${$p}`:$p),this._isInitialized&&tn())throw new Error("Multiple Sentry Session Replay instances are not supported");this._isInitialized=!0}get _isInitialized(){return jp}set _isInitialized(e){jp=e}setupOnce(){tn()&&(this._setup(),setTimeout((()=>this._initialize())))}start(){this._replay&&this._replay.start()}startBuffering(){this._replay&&this._replay.startBuffering()}stop(){return this._replay?this._replay.stop({forceFlush:"session"===this._replay.recordingMode}):Promise.resolve()}flush(e){return this._replay&&this._replay.isEnabled()?this._replay.sendBufferedReplayOrFlush(e):Promise.resolve()}getReplayId(){if(this._replay&&this._replay.isEnabled())return this._replay.getSessionId()}_initialize(){this._replay&&(this._maybeLoadFromReplayCanvasIntegration(),this._replay.initializeSampling())}_setup(){const e=function(e){const t=kr(),n=t&&t.getOptions(),r={sessionSampleRate:0,errorSampleRate:0,...Ze(e)};if(!n)return $e((()=>{console.warn("SDK client is not available.")})),r;null==e.sessionSampleRate&&null==e.errorSampleRate&&null==n.replaysSessionSampleRate&&null==n.replaysOnErrorSampleRate&&$e((()=>{console.warn("Replay is disabled because neither `replaysSessionSampleRate` nor `replaysOnErrorSampleRate` are set.")}));"number"==typeof n.replaysSessionSampleRate&&(r.sessionSampleRate=n.replaysSessionSampleRate);"number"==typeof n.replaysOnErrorSampleRate&&(r.errorSampleRate=n.replaysOnErrorSampleRate);return r}(this._initialOptions);this._replay=new Mp({options:e,recordingOptions:this._recordingOptions})}_maybeLoadFromReplayCanvasIntegration(){try{const e=kr().getIntegrationByName("ReplayCanvas");if(!e)return;this._replay._canvas=e.getOptions()}catch(e){}}}function Vp(e){return[...Fp,...e.map((e=>e.toLowerCase()))]}var qp;function Wp(e,t,n=1/0,r=0){return e?e.nodeType!==e.ELEMENT_NODE||r>n?-1:t(e)?r:Wp(e.parentNode,t,n,r+1):-1}function Bp(e,t){return n=>{const r=n;if(null===r)return!1;try{if(e)if("string"==typeof e){if(r.matches(`.${e}`))return!0}else if(function(e,t){for(let n=e.classList.length;n--;){const r=e.classList[n];if(t.test(r))return!0}return!1}(r,e))return!0;return!(!t||!r.matches(t))}catch(e){return!1}}}Gp.__initStatic(),function(e){e[e.Document=0]="Document",e[e.DocumentType=1]="DocumentType",e[e.Element=2]="Element",e[e.Text=3]="Text",e[e.CDATA=4]="CDATA",e[e.Comment=5]="Comment"}(qp||(qp={}));const Hp="Please stop import mirror directly. Instead of that,\r\nnow you can use replayer.getMirror() to access the mirror instance of a replayer,\r\nor you can use record.mirror to access the mirror instance during recording.";let Jp={map:{},getId:()=>(console.error(Hp),-1),getNode:()=>(console.error(Hp),null),removeNodeFromMap(){console.error(Hp)},has:()=>(console.error(Hp),!1),reset(){console.error(Hp)}};function zp(e,t,n,r,o=window){const s=o.Object.getOwnPropertyDescriptor(e,t);return o.Object.defineProperty(e,t,r?n:{set(e){eh((()=>{n.set.call(this,e)}),0),s&&s.set&&s.set.call(this,e)}}),()=>zp(e,t,s||{},!0)}function Yp(e,t,n){try{if(!(t in e))return()=>{};const r=e[t],o=n(r);return"function"==typeof o&&(o.prototype=o.prototype||{},Object.defineProperties(o,{__rrweb_original__:{enumerable:!1,value:r}})),e[t]=o,()=>{e[t]=r}}catch(e){return()=>{}}}function Xp(e,t,n,r,o){if(!e)return!1;const s=function(e){return e?e.nodeType===e.ELEMENT_NODE?e:e.parentElement:null}(e);if(!s)return!1;const i=Bp(t,n);if(!o){const e=r&&s.matches(r);return i(s)&&!e}const a=Wp(s,i);let c=-1;return!(a<0)&&(r&&(c=Wp(s,Bp(null,r))),a>-1&&c<0||a<c)}"undefined"!=typeof window&&window.Proxy&&window.Reflect&&(Jp=new Proxy(Jp,{get:(e,t,n)=>("map"===t&&console.error(Hp),Reflect.get(e,t,n))})),/[1-9][0-9]{12}/.test(Date.now().toString());const Kp={};function Qp(e){const t=Kp[e];if(t)return t;const n=window.document;let r=window[e];if(n&&"function"==typeof n.createElement)try{const t=n.createElement("iframe");t.hidden=!0,n.head.appendChild(t);const o=t.contentWindow;o&&o[e]&&(r=o[e]),n.head.removeChild(t)}catch(e){}return Kp[e]=r.bind(window)}function Zp(...e){return Qp("requestAnimationFrame")(...e)}function eh(...e){return Qp("setTimeout")(...e)}var th=(e=>(e[e["2D"]=0]="2D",e[e.WebGL=1]="WebGL",e[e.WebGL2=2]="WebGL2",e))(th||{});let nh;function rh(e){nh=e}const oh=e=>{if(!nh)return e;return(...t)=>{try{return e(...t)}catch(e){if(nh&&!0===nh(e))return()=>{};throw e}}};for(var sh="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ih="undefined"==typeof Uint8Array?[]:new Uint8Array(256),ah=0;ah<64;ah++)ih[sh.charCodeAt(ah)]=ah;const ch=new Map;const lh=(e,t,n)=>{if(!e||!ph(e,t)&&"object"!=typeof e)return;const r=function(e,t){let n=ch.get(e);return n||(n=new Map,ch.set(e,n)),n.has(t)||n.set(t,[]),n.get(t)}(n,e.constructor.name);let o=r.indexOf(e);return-1===o&&(o=r.length,r.push(e)),o};function uh(e,t,n){if(e instanceof Array)return e.map((e=>uh(e,t,n)));if(null===e)return e;if(e instanceof Float32Array||e instanceof Float64Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Int16Array||e instanceof Int8Array||e instanceof Uint8ClampedArray){return{rr_type:e.constructor.name,args:[Object.values(e)]}}if(e instanceof ArrayBuffer){const t=e.constructor.name,n=function(e){var t,n=new Uint8Array(e),r=n.length,o="";for(t=0;t<r;t+=3)o+=sh[n[t]>>2],o+=sh[(3&n[t])<<4|n[t+1]>>4],o+=sh[(15&n[t+1])<<2|n[t+2]>>6],o+=sh[63&n[t+2]];return r%3==2?o=o.substring(0,o.length-1)+"=":r%3==1&&(o=o.substring(0,o.length-2)+"=="),o}(e);return{rr_type:t,base64:n}}if(e instanceof DataView){return{rr_type:e.constructor.name,args:[uh(e.buffer,t,n),e.byteOffset,e.byteLength]}}if(e instanceof HTMLImageElement){const t=e.constructor.name,{src:n}=e;return{rr_type:t,src:n}}if(e instanceof HTMLCanvasElement){return{rr_type:"HTMLImageElement",src:e.toDataURL()}}if(e instanceof ImageData){return{rr_type:e.constructor.name,args:[uh(e.data,t,n),e.width,e.height]}}if(ph(e,t)||"object"==typeof e){return{rr_type:e.constructor.name,index:lh(e,t,n)}}return e}const dh=(e,t,n)=>e.map((e=>uh(e,t,n))),ph=(e,t)=>{const n=["WebGLActiveInfo","WebGLBuffer","WebGLFramebuffer","WebGLProgram","WebGLRenderbuffer","WebGLShader","WebGLShaderPrecisionFormat","WebGLTexture","WebGLUniformLocation","WebGLVertexArrayObject","WebGLVertexArrayObjectOES"].filter((e=>"function"==typeof t[e]));return Boolean(n.find((n=>e instanceof t[n])))};function hh(e,t,n,r,o){const s=[];try{const i=Yp(e.HTMLCanvasElement.prototype,"getContext",(function(e){return function(s,...i){if(!Xp(this,t,n,r,!0)){const e=function(e){return"experimental-webgl"===e?"webgl":e}(s);if("__context"in this||(this.__context=e),o&&["webgl","webgl2"].includes(e))if(i[0]&&"object"==typeof i[0]){const e=i[0];e.preserveDrawingBuffer||(e.preserveDrawingBuffer=!0)}else i.splice(0,1,{preserveDrawingBuffer:!0})}return e.apply(this,[s,...i])}}));s.push(i)}catch(e){console.error("failed to patch HTMLCanvasElement.prototype.getContext")}return()=>{s.forEach((e=>e()))}}function fh(e,t,n,r,o,s,i,a){const c=[],l=Object.getOwnPropertyNames(e);for(const i of l)if(!["isContextLost","canvas","drawingBufferWidth","drawingBufferHeight"].includes(i))try{if("function"!=typeof e[i])continue;const l=Yp(e,i,(function(e){return function(...c){const l=e.apply(this,c);if(lh(l,a,this),"tagName"in this.canvas&&!Xp(this.canvas,r,o,s,!0)){const e=dh(c,a,this),r={type:t,property:i,args:e};n(this.canvas,r)}return l}}));c.push(l)}catch(r){const o=zp(e,i,{set(e){n(this.canvas,{type:t,property:i,args:[e],setter:!0})}});c.push(o)}return c}class gh{reset(){this.pendingCanvasMutations.clear(),this.resetObservers&&this.resetObservers()}freeze(){this.frozen=!0}unfreeze(){this.frozen=!1}lock(){this.locked=!0}unlock(){this.locked=!1}constructor(e){this.pendingCanvasMutations=new Map,this.rafStamps={latestId:0,invokeId:null},this.frozen=!1,this.locked=!1,this.processMutation=(e,t)=>{!(this.rafStamps.invokeId&&this.rafStamps.latestId!==this.rafStamps.invokeId)&&this.rafStamps.invokeId||(this.rafStamps.invokeId=this.rafStamps.latestId),this.pendingCanvasMutations.has(e)||this.pendingCanvasMutations.set(e,[]),this.pendingCanvasMutations.get(e).push(t)};const{sampling:t="all",win:n,blockClass:r,blockSelector:o,unblockSelector:s,maxCanvasSize:i,recordCanvas:a,dataURLOptions:c,errorHandler:l}=e;this.mutationCb=e.mutationCb,this.mirror=e.mirror,this.options=e,l&&rh(l),e.enableManualSnapshot||oh((()=>{a&&"all"===t&&this.initCanvasMutationObserver(n,r,o,s),a&&"number"==typeof t&&this.initCanvasFPSObserver(t,n,r,o,s,i,{dataURLOptions:c})}))()}initCanvasFPSObserver(e,t,n,r,o,s,i){const a=hh(t,n,r,o,!0),c=this.takeSnapshot(!1,e,t,n,r,o,s,i.dataURLOptions);this.resetObservers=()=>{a(),cancelAnimationFrame(c)}}initCanvasMutationObserver(e,t,n,r){this.startRAFTimestamping(),this.startPendingCanvasMutationFlusher();const o=hh(e,t,n,r,!1),s=function(e,t,n,r,o){const s=[],i=Object.getOwnPropertyNames(t.CanvasRenderingContext2D.prototype);for(const a of i)try{if("function"!=typeof t.CanvasRenderingContext2D.prototype[a])continue;const i=Yp(t.CanvasRenderingContext2D.prototype,a,(function(s){return function(...i){return Xp(this.canvas,n,r,o,!0)||eh((()=>{const n=dh(i,t,this);e(this.canvas,{type:th["2D"],property:a,args:n})}),0),s.apply(this,i)}}));s.push(i)}catch(n){const r=zp(t.CanvasRenderingContext2D.prototype,a,{set(t){e(this.canvas,{type:th["2D"],property:a,args:[t],setter:!0})}});s.push(r)}return()=>{s.forEach((e=>e()))}}(this.processMutation.bind(this),e,t,n,r),i=function(e,t,n,r,o,s){const i=[];return i.push(...fh(t.WebGLRenderingContext.prototype,th.WebGL,e,n,r,o,0,t)),void 0!==t.WebGL2RenderingContext&&i.push(...fh(t.WebGL2RenderingContext.prototype,th.WebGL2,e,n,r,o,0,t)),()=>{i.forEach((e=>e()))}}(this.processMutation.bind(this),e,t,n,r,this.mirror);this.resetObservers=()=>{o(),s(),i()}}snapshot(e){const{options:t}=this,n=this.takeSnapshot(!0,"all"===t.sampling?2:t.sampling||2,t.win,t.blockClass,t.blockSelector,t.unblockSelector,t.maxCanvasSize,t.dataURLOptions,e);this.resetObservers=()=>{cancelAnimationFrame(n)}}takeSnapshot(e,t,n,r,o,s,i,a,c){const l=new Map,u=new Worker(function(){const e=new Blob(['for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t="undefined"==typeof Uint8Array?[]:new Uint8Array(256),a=0;a<64;a++)t[e.charCodeAt(a)]=a;var n=function(t){var a,n=new Uint8Array(t),r=n.length,s="";for(a=0;a<r;a+=3)s+=e[n[a]>>2],s+=e[(3&n[a])<<4|n[a+1]>>4],s+=e[(15&n[a+1])<<2|n[a+2]>>6],s+=e[63&n[a+2]];return r%3==2?s=s.substring(0,s.length-1)+"=":r%3==1&&(s=s.substring(0,s.length-2)+"=="),s};const r=new Map,s=new Map;const i=self;i.onmessage=async function(e){if(!("OffscreenCanvas"in globalThis))return i.postMessage({id:e.data.id});{const{id:t,bitmap:a,width:o,height:f,maxCanvasSize:c,dataURLOptions:g}=e.data,u=async function(e,t,a){const r=e+"-"+t;if("OffscreenCanvas"in globalThis){if(s.has(r))return s.get(r);const i=new OffscreenCanvas(e,t);i.getContext("2d");const o=await i.convertToBlob(a),f=await o.arrayBuffer(),c=n(f);return s.set(r,c),c}return""}(o,f,g),[h,d]=function(e,t,a){if(!a)return[e,t];const[n,r]=a;if(e<=n&&t<=r)return[e,t];let s=e,i=t;return s>n&&(i=Math.floor(n*t/e),s=n),i>r&&(s=Math.floor(r*e/t),i=r),[s,i]}(o,f,c),l=new OffscreenCanvas(h,d),w=l.getContext("bitmaprenderer"),p=h===o&&d===f?a:await createImageBitmap(a,{resizeWidth:h,resizeHeight:d,resizeQuality:"low"});w.transferFromImageBitmap(p),a.close();const y=await l.convertToBlob(g),v=y.type,b=await y.arrayBuffer(),m=n(b);if(p.close(),!r.has(t)&&await u===m)return r.set(t,m),i.postMessage({id:t});if(r.get(t)===m)return i.postMessage({id:t});i.postMessage({id:t,type:v,base64:m,width:o,height:f}),r.set(t,m)}};']);return URL.createObjectURL(e)}());u.onmessage=e=>{const t=e.data,{id:n}=t;if(l.set(n,!1),!("base64"in t))return;const{base64:r,type:o,width:s,height:i}=t;this.mutationCb({id:n,type:th["2D"],commands:[{property:"clearRect",args:[0,0,s,i]},{property:"drawImage",args:[{rr_type:"ImageBitmap",args:[{rr_type:"Blob",data:[{rr_type:"ArrayBuffer",base64:r}],type:o}]},0,0,s,i]}]})};const d=1e3/t;let p,h=0;const f=t=>{h&&t-h<d||(h=t,(e=>{if(e)return[e];const t=[];return n.document.querySelectorAll("canvas").forEach((e=>{Xp(e,r,o,s,!0)||t.push(e)})),t})(c).forEach((t=>{const n=this.mirror.getId(t);if(!l.get(n)&&t.width&&t.height){if(l.set(n,!0),!e&&["webgl","webgl2"].includes(t.__context)){const e=t.getContext(t.__context);!1===nr([e,"optionalAccess",e=>e.getContextAttributes,"call",e=>e(),"optionalAccess",e=>e.preserveDrawingBuffer])&&e.clear(e.COLOR_BUFFER_BIT)}createImageBitmap(t).then((e=>{u.postMessage({id:n,bitmap:e,width:t.width,height:t.height,dataURLOptions:a,maxCanvasSize:i},[e])})).catch((e=>{oh((()=>{throw e}))()}))}}))),p=Zp(f)};return p=Zp(f),p}startPendingCanvasMutationFlusher(){Zp((()=>this.flushPendingCanvasMutations()))}startRAFTimestamping(){const e=t=>{this.rafStamps.latestId=t,Zp(e)};Zp(e)}flushPendingCanvasMutations(){this.pendingCanvasMutations.forEach(((e,t)=>{const n=this.mirror.getId(t);this.flushPendingCanvasMutationFor(t,n)})),Zp((()=>this.flushPendingCanvasMutations()))}flushPendingCanvasMutationFor(e,t){if(this.frozen||this.locked)return;const n=this.pendingCanvasMutations.get(e);if(!n||-1===t)return;const r=n.map((e=>{const{type:t,...n}=e;return n})),{type:o}=n[0];this.mutationCb({id:t,type:o,commands:r}),this.pendingCanvasMutations.delete(e)}}const mh={low:{sampling:{canvas:1},dataURLOptions:{type:"image/webp",quality:.25}},medium:{sampling:{canvas:2},dataURLOptions:{type:"image/webp",quality:.4}},high:{sampling:{canvas:4},dataURLOptions:{type:"image/webp",quality:.5}}},yh="ReplayCanvas",_h=1280,vh=(e={})=>{const[t,n]=e.maxCanvasSize||[],r={quality:e.quality||"medium",enableManualSnapshot:e.enableManualSnapshot,maxCanvasSize:[t?Math.min(t,_h):_h,n?Math.min(n,_h):_h]};let o;const s=new Promise((e=>o=e));return{name:yh,setupOnce(){},getOptions(){const{quality:e,enableManualSnapshot:t,maxCanvasSize:n}=r;return{enableManualSnapshot:t,recordCanvas:!0,getCanvasManager:e=>{const r=new gh({...e,enableManualSnapshot:t,maxCanvasSize:n,errorHandler:e=>{try{"object"==typeof e&&(e.__rrweb__=!0)}catch(e){}}});return o(r),r},...mh[e||"medium"]||mh.medium}},async snapshot(e){(await s).snapshot(e)}}},Sh=zo(yh,vh),Th=Ie,bh="#ffffff",wh="inherit",Eh="rgba(108, 95, 199, 1)",Ih={fontFamily:"system-ui, 'Helvetica Neue', Arial, sans-serif",fontSize:"14px",background:bh,backgroundHover:"#f6f6f7",foreground:"#2b2233",border:"1.5px solid rgba(41, 35, 47, 0.13)",borderRadius:"25px",boxShadow:"0px 4px 24px 0px rgba(43, 34, 51, 0.12)",success:"#268d75",error:"#df3338",submitBackground:"rgba(88, 74, 192, 1)",submitBackgroundHover:Eh,submitBorder:Eh,submitOutlineFocus:"#29232f",submitForeground:bh,submitForegroundHover:bh,cancelBackground:"transparent",cancelBackgroundHover:"var(--background-hover)",cancelBorder:"var(--border)",cancelOutlineFocus:"var(--input-outline-focus)",cancelForeground:"var(--foreground)",cancelForegroundHover:"var(--foreground)",inputBackground:wh,inputForeground:wh,inputBorder:"var(--border)",inputOutlineFocus:Eh,formBorderRadius:"20px",formContentBorderRadius:"6px"},Ah=Ih,Rh={...Ih,background:"#29232f",backgroundHover:"#352f3b",foreground:"#ebe6ef",border:"1.5px solid rgba(235, 230, 239, 0.15)",success:"#2da98c",error:"#f55459"},kh="widget",Ch="api";async function xh({feedback:{message:e,email:t,name:n,source:r,url:o}},{includeReplay:s=!0}={}){const i=kr(),a=i&&i.getTransport(),c=i&&i.getDsn();if(!i||!a||!c)return;const l={contexts:{feedback:{contact_email:t,name:n,message:e,url:o,source:r}},type:"feedback"};return Rr((async e=>{e.clearBreadcrumbs(),[Ch,kh].includes(String(r))&&e.setLevel("info");const t=await async function({client:e,scope:t,event:n}){const r={};e.emit&&e.emit("preprocessEvent",n,r);const o=await _r(e.getOptions(),n,r,t,e,Xr());return null===o?(e.recordDroppedEvent("event_processor","feedback",n),null):(o.platform=o.platform||"javascript",o)}({scope:e,client:i,event:l});if(!t)return;i.emit&&i.emit("beforeSendFeedback",t,{includeReplay:Boolean(s)});const n=Fo(t,c,i.getOptions()._metadata,i.getOptions().tunnel);let o;try{o=await a.send(n)}catch(e){const t=new Error("Unable to send Feedback");try{t.cause=e}catch(e){}throw t}if(o){if("number"==typeof o.statusCode&&(o.statusCode<200||o.statusCode>=300))throw new Error("Unable to send Feedback");return o}}))}function Oh({name:e,email:t,message:n,source:r=Ch,url:o=Le()},s={}){if(!n)throw new Error("Unable to submit feedback with empty message");return xh({feedback:{name:e,email:t,message:n,url:o,source:r}},s)}const Lh="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__;function Nh(e,t){return{...e,...t,themeDark:{...e.themeDark,...t.themeDark},themeLight:{...e.themeLight,...t.themeLight}}}function Ph(e){return`\n  --background: ${e.background};\n  --background-hover: ${e.backgroundHover};\n  --foreground: ${e.foreground};\n  --error: ${e.error};\n  --success: ${e.success};\n  --border: ${e.border};\n  --border-radius: ${e.borderRadius};\n  --box-shadow: ${e.boxShadow};\n\n  --submit-background: ${e.submitBackground};\n  --submit-background-hover: ${e.submitBackgroundHover};\n  --submit-border: ${e.submitBorder};\n  --submit-outline-focus: ${e.submitOutlineFocus};\n  --submit-foreground: ${e.submitForeground};\n  --submit-foreground-hover: ${e.submitForegroundHover};\n\n  --cancel-background: ${e.cancelBackground};\n  --cancel-background-hover: ${e.cancelBackgroundHover};\n  --cancel-border: ${e.cancelBorder};\n  --cancel-outline-focus: ${e.cancelOutlineFocus};\n  --cancel-foreground: ${e.cancelForeground};\n  --cancel-foreground-hover: ${e.cancelForegroundHover};\n\n  --input-background: ${e.inputBackground};\n  --input-foreground: ${e.inputForeground};\n  --input-border: ${e.inputBorder};\n  --input-outline-focus: ${e.inputOutlineFocus};\n\n  --form-border-radius: ${e.formBorderRadius};\n  --form-content-border-radius: ${e.formContentBorderRadius};\n  `}function Dh({id:e,colorScheme:t,themeDark:n,themeLight:r}){try{const o=Th.document,s=o.createElement("div");s.id=e;const i=s.attachShadow({mode:"open"});return i.appendChild(function(e,t,n){const r=e.createElement("style");return r.textContent=`\n:host {\n  --bottom: 1rem;\n  --right: 1rem;\n  --top: auto;\n  --left: auto;\n  --z-index: 100000;\n  --font-family: ${n.light.fontFamily};\n  --font-size: ${n.light.fontSize};\n\n  position: fixed;\n  left: var(--left);\n  right: var(--right);\n  bottom: var(--bottom);\n  top: var(--top);\n  z-index: var(--z-index);\n\n  font-family: var(--font-family);\n  font-size: var(--font-size);\n\n  ${Ph("dark"===t?n.dark:n.light)}\n}\n\n${"system"===t?`\n@media (prefers-color-scheme: dark) {\n  :host {\n    ${Ph(n.dark)}\n  }\n}`:""}\n}`,r}(o,t,{dark:n,light:r})),i.appendChild(function(e){const t=e.createElement("style");return t.textContent="\n.dialog {\n  line-height: 25px;\n  background-color: rgba(0, 0, 0, 0.05);\n  border: none;\n  position: fixed;\n  inset: 0;\n  z-index: 10000;\n  width: 100vw;\n  height: 100vh;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  opacity: 1;\n  transition: opacity 0.2s ease-in-out;\n}\n\n.dialog:not([open]) {\n  opacity: 0;\n  pointer-events: none;\n  visibility: hidden;\n}\n.dialog:not([open]) .dialog__content {\n  transform: translate(0, -16px) scale(0.98);\n}\n\n.dialog__content {\n  position: fixed;\n  left: var(--left);\n  right: var(--right);\n  bottom: var(--bottom);\n  top: var(--top);\n\n  border: var(--border);\n  border-radius: var(--form-border-radius);\n  background-color: var(--background);\n  color: var(--foreground);\n\n  width: 320px;\n  max-width: 100%;\n  max-height: calc(100% - 2rem);\n  display: flex;\n  flex-direction: column;\n  box-shadow: var(--box-shadow);\n  transition: transform 0.2s ease-in-out;\n  transform: translate(0, 0) scale(1);\n}\n\n.dialog__header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  font-size: 20px;\n  font-weight: 600;\n  padding: 24px 24px 0 24px;\n  margin: 0;\n  margin-bottom: 16px;\n}\n\n.brand-link {\n  display: inline-flex;\n}\n\n.error {\n  color: var(--error);\n  margin-bottom: 16px;\n}\n\n.form {\n  display: grid;\n  overflow: auto;\n  flex-direction: column;\n  gap: 16px;\n  padding: 0 24px 24px;\n}\n\n.form__error-container {\n  color: var(--error);\n}\n\n.form__error-container--hidden {\n  display: none;\n}\n\n.form__label {\n  display: flex;\n  flex-direction: column;\n  gap: 4px;\n  margin: 0px;\n}\n\n.form__label__text {\n  display: grid;\n  gap: 4px;\n  align-items: center;\n  grid-auto-flow: column;\n  grid-auto-columns: max-content;\n}\n\n.form__label__text--required {\n  font-size: 0.85em;\n}\n\n.form__input {\n  line-height: inherit;\n  background-color: var(--input-background);\n  box-sizing: border-box;\n  border: var(--input-border);\n  border-radius: var(--form-content-border-radius);\n  color: var(--input-foreground);\n  font-family: inherit;\n  font-size: var(--font-size);\n  font-weight: 500;\n  padding: 6px 12px;\n}\n\n.form__input::placeholder {\n  color: var(--input-foreground);\n  opacity: 0.65;\n}\n\n.form__input:focus-visible {\n  outline: 1px auto var(--input-outline-focus);\n}\n\n.form__input--textarea {\n  font-family: inherit;\n  resize: vertical;\n}\n\n.btn-group {\n  display: grid;\n  gap: 8px;\n  margin-top: 8px;\n}\n\n.btn {\n  line-height: inherit;\n  border: var(--cancel-border);\n  border-radius: var(--form-content-border-radius);\n  cursor: pointer;\n  font-family: inherit;\n  font-size: var(--font-size);\n  font-weight: 600;\n  padding: 6px 16px;\n}\n.btn[disabled] {\n  opacity: 0.6;\n  pointer-events: none;\n}\n\n.btn--primary {\n  background-color: var(--submit-background);\n  border-color: var(--submit-border);\n  color: var(--submit-foreground);\n}\n.btn--primary:hover {\n  background-color: var(--submit-background-hover);\n  color: var(--submit-foreground-hover);\n}\n.btn--primary:focus-visible {\n  outline: 1px auto var(--submit-outline-focus);\n}\n\n.btn--default {\n  background-color: var(--cancel-background);\n  color: var(--cancel-foreground);\n  font-weight: 500;\n}\n.btn--default:hover {\n  background-color: var(--cancel-background-hover);\n  color: var(--cancel-foreground-hover);\n}\n.btn--default:focus-visible {\n  outline: 1px auto var(--cancel-outline-focus);\n}\n\n.success-message {\n  background-color: var(--background);\n  border: var(--border);\n  border-radius: var(--border-radius);\n  box-shadow: var(--box-shadow);\n  font-weight: 600;\n  color: var(--success);\n  padding: 12px 24px;\n  line-height: 25px;\n  display: grid;\n  align-items: center;\n  grid-auto-flow: column;\n  gap: 6px;\n  cursor: default;\n}\n\n.success-icon path {\n  fill: var(--success);\n}\n",t}(o)),{shadow:i,host:s}}catch(e){throw Fe.warn("[Feedback] Browser does not support shadow DOM API"),new Error("Browser does not support shadow DOM API.")}}async function Mh(e,t,n){if(!e)return;e.hideError();try{return await Oh({...t,source:kh},n)}catch(t){Lh&&Fe.error(t),e&&e.showError("There was a problem submitting feedback, please wait and try again.")}}function Uh(e,t){return Object.entries(t).forEach((([t,n])=>{e.setAttributeNS(null,t,n)})),e}const $h=20,Fh="http://www.w3.org/2000/svg";function jh(e,t,...n){const r=Th.document.createElement(e);t&&Object.entries(t).forEach((([e,t])=>{"className"===e&&"string"==typeof t?r.setAttribute("class",t):"boolean"==typeof t&&t?r.setAttribute(e,""):"string"==typeof t?r.setAttribute(e,t):e.startsWith("on")&&"function"==typeof t&&r.addEventListener(e.substring(2).toLowerCase(),t)}));for(const e of n)Gh(r,e);return r}function Gh(e,t){const n=Th.document;if(null!=t)if(Array.isArray(t))for(const n of t)Gh(e,n);else!1===t||("string"==typeof t?e.appendChild(n.createTextNode(t)):t instanceof Node?e.appendChild(t):e.appendChild(n.createTextNode(String(t))))}function Vh({buttonLabel:e,onClick:t}){const n=jh("button",{type:"button",className:"widget__actor","aria-label":e,"aria-hidden":"false"},function(){const e=e=>Th.document.createElementNS(Fh,e),t=Uh(e("svg"),{class:"feedback-icon",width:`${$h}`,height:`${$h}`,viewBox:`0 0 ${$h} ${$h}`,fill:"none"}),n=Uh(e("g"),{clipPath:"url(#clip0_57_80)"}),r=Uh(e("path"),{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M15.6622 15H12.3997C12.2129 14.9959 12.031 14.9396 11.8747 14.8375L8.04965 12.2H7.49956V19.1C7.4875 19.3348 7.3888 19.5568 7.22256 19.723C7.05632 19.8892 6.83435 19.9879 6.59956 20H2.04956C1.80193 19.9968 1.56535 19.8969 1.39023 19.7218C1.21511 19.5467 1.1153 19.3101 1.11206 19.0625V12.2H0.949652C0.824431 12.2017 0.700142 12.1783 0.584123 12.1311C0.468104 12.084 0.362708 12.014 0.274155 11.9255C0.185602 11.8369 0.115689 11.7315 0.0685419 11.6155C0.0213952 11.4995 -0.00202913 11.3752 -0.00034808 11.25V3.75C-0.00900498 3.62067 0.0092504 3.49095 0.0532651 3.36904C0.0972798 3.24712 0.166097 3.13566 0.255372 3.04168C0.344646 2.94771 0.452437 2.87327 0.571937 2.82307C0.691437 2.77286 0.82005 2.74798 0.949652 2.75H8.04965L11.8747 0.1625C12.031 0.0603649 12.2129 0.00407221 12.3997 0H15.6622C15.9098 0.00323746 16.1464 0.103049 16.3215 0.278167C16.4966 0.453286 16.5964 0.689866 16.5997 0.9375V3.25269C17.3969 3.42959 18.1345 3.83026 18.7211 4.41679C19.5322 5.22788 19.9878 6.32796 19.9878 7.47502C19.9878 8.62209 19.5322 9.72217 18.7211 10.5333C18.1345 11.1198 17.3969 11.5205 16.5997 11.6974V14.0125C16.6047 14.1393 16.5842 14.2659 16.5395 14.3847C16.4948 14.5035 16.4268 14.6121 16.3394 14.7042C16.252 14.7962 16.147 14.8698 16.0307 14.9206C15.9144 14.9714 15.7891 14.9984 15.6622 15ZM1.89695 10.325H1.88715V4.625H8.33715C8.52423 4.62301 8.70666 4.56654 8.86215 4.4625L12.6872 1.875H14.7247V13.125H12.6872L8.86215 10.4875C8.70666 10.3835 8.52423 10.327 8.33715 10.325H2.20217C2.15205 10.3167 2.10102 10.3125 2.04956 10.3125C1.9981 10.3125 1.94708 10.3167 1.89695 10.325ZM2.98706 12.2V18.1625H5.66206V12.2H2.98706ZM16.5997 9.93612V5.01393C16.6536 5.02355 16.7072 5.03495 16.7605 5.04814C17.1202 5.13709 17.4556 5.30487 17.7425 5.53934C18.0293 5.77381 18.2605 6.06912 18.4192 6.40389C18.578 6.73866 18.6603 7.10452 18.6603 7.47502C18.6603 7.84552 18.578 8.21139 18.4192 8.54616C18.2605 8.88093 18.0293 9.17624 17.7425 9.41071C17.4556 9.64518 17.1202 9.81296 16.7605 9.90191C16.7072 9.91509 16.6536 9.9265 16.5997 9.93612Z"});t.appendChild(n).appendChild(r);const o=e("defs"),s=Uh(e("clipPath"),{id:"clip0_57_80"}),i=Uh(e("rect"),{width:`${$h}`,height:`${$h}`,fill:"white"});return s.appendChild(i),o.appendChild(s),t.appendChild(o).appendChild(s).appendChild(i),{get el(){return t}}}().el,e?jh("span",{className:"widget__actor__text"},e):null);return n.addEventListener("click",(function(e){t&&t(e)})),{get el(){return n},show:()=>{n.classList.remove("widget__actor--hidden"),n.setAttribute("aria-hidden","false")},hide:()=>{n.classList.add("widget__actor--hidden"),n.setAttribute("aria-hidden","true")}}}function qh(e,t){const n=e.get(t);return"string"==typeof n?n.trim():""}function Wh({nameLabel:e,namePlaceholder:t,emailLabel:n,emailPlaceholder:r,messageLabel:o,messagePlaceholder:s,isRequiredLabel:i,cancelButtonLabel:a,submitButtonLabel:c,showName:l,showEmail:u,isNameRequired:d,isEmailRequired:p,defaultName:h,defaultEmail:f,onCancel:g,onSubmit:m}){const{el:y}=function({label:e}){return{el:jh("button",{type:"submit",className:"btn btn--primary","aria-label":e},e)}}({label:c});const _=jh("div",{className:"form__error-container form__error-container--hidden","aria-hidden":"true"});const v=jh("input",{id:"name",type:l?"text":"hidden","aria-hidden":l?"false":"true",name:"name",required:d,className:"form__input",placeholder:t,value:h}),S=jh("input",{id:"email",type:u?"text":"hidden","aria-hidden":u?"false":"true",name:"email",required:p,className:"form__input",placeholder:r,value:f}),T=jh("textarea",{id:"message",autoFocus:"true",rows:"5",name:"message",required:!0,className:"form__input form__input--textarea",placeholder:s}),b=jh("button",{type:"button",className:"btn btn--default","aria-label":a,onClick:e=>{g&&g(e)}},a),w=jh("form",{className:"form",onSubmit:function(e){if(e.preventDefault(),e.target instanceof HTMLFormElement)try{if(m){const t=new FormData(e.target),n={name:qh(t,"name"),email:qh(t,"email"),message:qh(t,"message")};m(n)}}catch(e){}}},[_,l&&jh("label",{htmlFor:"name",className:"form__label"},[jh("span",{className:"form__label__text"},e,d&&jh("span",{className:"form__label__text--required"},` ${i}`)),v]),!l&&v,u&&jh("label",{htmlFor:"email",className:"form__label"},[jh("span",{className:"form__label__text"},n,p&&jh("span",{className:"form__label__text--required"},` ${i}`)),S]),!u&&S,jh("label",{htmlFor:"message",className:"form__label"},[jh("span",{className:"form__label__text"},o,jh("span",{className:"form__label__text--required"},` ${i}`)),T]),jh("div",{className:"btn-group"},[y,b])]);return{get el(){return w},showError:function(e){_.textContent=e,_.classList.remove("form__error-container--hidden"),_.setAttribute("aria-hidden","false")},hideError:function(){_.textContent="",_.classList.add("form__error-container--hidden"),_.setAttribute("aria-hidden","true")}}}const Bh="http://www.w3.org/2000/svg";function Hh({formTitle:e,showBranding:t,showName:n,showEmail:r,isNameRequired:o,isEmailRequired:s,colorScheme:i,defaultName:a,defaultEmail:c,onClosed:l,onCancel:u,onSubmit:d,...p}){let h=null;function f(){h&&(h.open=!1)}const{el:g,showError:m,hideError:y}=Wh({showEmail:r,showName:n,isEmailRequired:s,isNameRequired:o,defaultName:a,defaultEmail:c,onSubmit:d,onCancel:u,...p});return h=jh("dialog",{className:"dialog",open:!0,onClick:function(){f(),l&&l()}},jh("div",{className:"dialog__content",onClick:e=>{e.stopPropagation()}},jh("h2",{className:"dialog__header"},e,t&&jh("a",{className:"brand-link",target:"_blank",href:"https://sentry.io/welcome/",title:"Powered by Sentry",rel:"noopener noreferrer"},function({colorScheme:e}){const t=e=>Th.document.createElementNS(Bh,e),n=Uh(t("svg"),{class:"sentry-logo",width:"32",height:"30",viewBox:"0 0 72 66",fill:"none"}),r=Uh(t("path"),{transform:"translate(11, 11)",d:"M29,2.26a4.67,4.67,0,0,0-8,0L14.42,13.53A32.21,32.21,0,0,1,32.17,40.19H27.55A27.68,27.68,0,0,0,12.09,17.47L6,28a15.92,15.92,0,0,1,9.23,12.17H4.62A.76.76,0,0,1,4,39.06l2.94-5a10.74,10.74,0,0,0-3.36-1.9l-2.91,5a4.54,4.54,0,0,0,1.69,6.24A4.66,4.66,0,0,0,4.62,44H19.15a19.4,19.4,0,0,0-8-17.31l2.31-4A23.87,23.87,0,0,1,23.76,44H36.07a35.88,35.88,0,0,0-16.41-31.8l4.67-8a.77.77,0,0,1,1.05-.27c.53.29,20.29,34.77,20.66,35.17a.76.76,0,0,1-.68,1.13H40.6q.09,1.91,0,3.81h4.78A4.59,4.59,0,0,0,50,39.43a4.49,4.49,0,0,0-.62-2.28Z"});n.append(r);const o=t("defs"),s=t("style");return s.textContent=`\n    path {\n      fill: ${"dark"===e?"#fff":"#362d59"};\n    }`,"system"===e&&(s.textContent+="\n    @media (prefers-color-scheme: dark) {\n      path: {\n        fill: '#fff';\n      }\n    }\n    "),o.append(s),n.append(o),{get el(){return n}}}({colorScheme:i}).el)),g)),{get el(){return h},showError:m,hideError:y,open:function(){h&&(h.open=!0)},close:f,checkIsOpen:function(){return h&&!0===h.open||!1}}}const Jh=16,zh=17,Yh="http://www.w3.org/2000/svg";function Xh({message:e,onRemove:t}){function n(){r&&(r.remove(),t&&t())}const r=jh("div",{className:"success-message",onClick:n},function(){const e=e=>Th.document.createElementNS(Yh,e),t=Uh(e("svg"),{class:"success-icon",width:`${Jh}`,height:`${zh}`,viewBox:`0 0 ${Jh} ${zh}`,fill:"none"}),n=Uh(e("g"),{clipPath:"url(#clip0_57_156)"}),r=Uh(e("path"),{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M3.55544 15.1518C4.87103 16.0308 6.41775 16.5 8 16.5C10.1217 16.5 12.1566 15.6571 13.6569 14.1569C15.1571 12.6566 16 10.6217 16 8.5C16 6.91775 15.5308 5.37103 14.6518 4.05544C13.7727 2.73985 12.5233 1.71447 11.0615 1.10897C9.59966 0.503466 7.99113 0.34504 6.43928 0.653721C4.88743 0.962403 3.46197 1.72433 2.34315 2.84315C1.22433 3.96197 0.462403 5.38743 0.153721 6.93928C-0.15496 8.49113 0.00346625 10.0997 0.608967 11.5615C1.21447 13.0233 2.23985 14.2727 3.55544 15.1518ZM4.40546 3.1204C5.46945 2.40946 6.72036 2.03 8 2.03C9.71595 2.03 11.3616 2.71166 12.575 3.92502C13.7883 5.13838 14.47 6.78405 14.47 8.5C14.47 9.77965 14.0905 11.0306 13.3796 12.0945C12.6687 13.1585 11.6582 13.9878 10.476 14.4775C9.29373 14.9672 7.99283 15.0953 6.73777 14.8457C5.48271 14.596 4.32987 13.9798 3.42502 13.075C2.52018 12.1701 1.90397 11.0173 1.65432 9.76224C1.40468 8.50718 1.5328 7.20628 2.0225 6.02404C2.5122 4.8418 3.34148 3.83133 4.40546 3.1204Z"}),o=Uh(e("path"),{d:"M6.68775 12.4297C6.78586 12.4745 6.89218 12.4984 7 12.5C7.11275 12.4955 7.22315 12.4664 7.32337 12.4145C7.4236 12.3627 7.51121 12.2894 7.58 12.2L12 5.63999C12.0848 5.47724 12.1071 5.28902 12.0625 5.11098C12.0178 4.93294 11.9095 4.77744 11.7579 4.67392C11.6064 4.57041 11.4221 4.52608 11.24 4.54931C11.0579 4.57254 10.8907 4.66173 10.77 4.79999L6.88 10.57L5.13 8.56999C5.06508 8.49566 4.98613 8.43488 4.89768 8.39111C4.80922 8.34735 4.713 8.32148 4.61453 8.31498C4.51605 8.30847 4.41727 8.32147 4.32382 8.35322C4.23038 8.38497 4.14413 8.43484 4.07 8.49999C3.92511 8.63217 3.83692 8.81523 3.82387 9.01092C3.81083 9.2066 3.87393 9.39976 4 9.54999L6.43 12.24C6.50187 12.3204 6.58964 12.385 6.68775 12.4297Z"});t.appendChild(n).append(o,r);const s=e("defs"),i=Uh(e("clipPath"),{id:"clip0_57_156"}),a=Uh(e("rect"),{width:`${Jh}`,height:`${Jh}`,fill:"white",transform:"translate(0 0.5)"});return i.appendChild(a),s.appendChild(i),t.appendChild(s).appendChild(i).appendChild(a),{get el(){return t}}}().el,e);return{el:r,remove:n}}function Kh({shadow:e,options:{shouldCreateActor:t=!0,...n},attachTo:r}){let o,s,i=!1;async function a(t){if(!s)return;const r=[];if(n.isNameRequired&&!t.name&&r.push(n.nameLabel),n.isEmailRequired&&!t.email&&r.push(n.emailLabel),t.message||r.push(n.messageLabel),r.length>0)return void s.showError(`Please enter in the following required fields: ${r.join(", ")}`);await Mh(s,t)?(h(),function(){if(e)try{const t=Xh({message:n.successMessageText,onRemove:()=>{r&&clearTimeout(r),l()}});if(!t.el)throw new Error("Unable to show success message");e.appendChild(t.el);const r=setTimeout((()=>{t&&t.remove()}),5e3)}catch(e){Fe.error(e)}}(),n.onSubmitSuccess&&n.onSubmitSuccess()):n.onSubmitError&&n.onSubmitError()}function c(){const e=kr(),t=e&&e.getIntegrationByName&&e.getIntegrationByName("Replay");t&&t.flush().catch((e=>{Lh&&Fe.error(e)}))}function l(){o&&o.show()}function u(){o&&o.hide()}function d(){try{if(s)return s.open(),i=!0,n.onFormOpen&&n.onFormOpen(),void c();const t=n.useSentryUser,r=Cr(),o=r&&r.getUser();if(s=Hh({colorScheme:n.colorScheme,showBranding:n.showBranding,showName:n.showName||n.isNameRequired,showEmail:n.showEmail||n.isEmailRequired,isNameRequired:n.isNameRequired,isEmailRequired:n.isEmailRequired,formTitle:n.formTitle,cancelButtonLabel:n.cancelButtonLabel,submitButtonLabel:n.submitButtonLabel,emailLabel:n.emailLabel,emailPlaceholder:n.emailPlaceholder,messageLabel:n.messageLabel,messagePlaceholder:n.messagePlaceholder,nameLabel:n.nameLabel,namePlaceholder:n.namePlaceholder,isRequiredLabel:n.isRequiredLabel,defaultName:t&&o&&o[t.name]||"",defaultEmail:t&&o&&o[t.email]||"",onClosed:()=>{l(),i=!1,n.onFormClose&&n.onFormClose()},onCancel:()=>{p(),l()},onSubmit:a}),!s.el)throw new Error("Unable to open Feedback dialog");e.appendChild(s.el),u(),n.onFormOpen&&n.onFormOpen(),c()}catch(e){Fe.error(e)}}function p(){s&&(s.close(),i=!1,n.onFormClose&&n.onFormClose())}function h(){if(s){p();const e=s.el;e&&e.remove(),s=void 0}}function f(){i||d(),u()}return r?r.addEventListener("click",f):t&&(o=Vh({buttonLabel:n.buttonLabel,onClick:f}),o.el&&e.appendChild(o.el)),{get actor(){return o},get dialog(){return s},showActor:l,hideActor:u,removeActor:function(){o&&o.el&&o.el.remove()},openDialog:d,closeDialog:p,removeDialog:h}}const Qh=Th.document;class Zh{static __initStatic(){this.id="Feedback"}constructor({autoInject:e=!0,id:t="sentry-feedback",isEmailRequired:n=!1,isNameRequired:r=!1,showBranding:o=!0,showEmail:s=!0,showName:i=!0,useSentryUser:a={email:"email",name:"username"},themeDark:c,themeLight:l,colorScheme:u="system",buttonLabel:d="Report a Bug",cancelButtonLabel:p="Cancel",submitButtonLabel:h="Send Bug Report",formTitle:f="Report a Bug",emailPlaceholder:g="your.email@example.org",emailLabel:m="Email",messagePlaceholder:y="What's the bug? What did you expect?",messageLabel:_="Description",namePlaceholder:v="Your Name",nameLabel:S="Name",isRequiredLabel:T="(required)",successMessageText:b="Thank you for your report!",onFormClose:w,onFormOpen:E,onSubmitError:I,onSubmitSuccess:A}={}){this.name=Zh.id,this._host=null,this._shadow=null,this._widget=null,this._widgets=new Set,this._hasInsertedActorStyles=!1,this.options={autoInject:e,showBranding:o,id:t,isEmailRequired:n,isNameRequired:r,showEmail:s,showName:i,useSentryUser:a,colorScheme:u,themeDark:{...Rh,...c},themeLight:{...Ah,...l},buttonLabel:d,cancelButtonLabel:p,submitButtonLabel:h,formTitle:f,emailLabel:m,emailPlaceholder:g,messageLabel:_,messagePlaceholder:y,nameLabel:S,namePlaceholder:v,isRequiredLabel:T,successMessageText:b,onFormClose:w,onFormOpen:E,onSubmitError:I,onSubmitSuccess:A}}setupOnce(){if(tn())try{this._cleanupWidgetIfExists();const{autoInject:e}=this.options;if(!e)return;this._createWidget(this.options)}catch(e){Lh&&Fe.error(e)}}openDialog(){this._widget||this._createWidget({...this.options,shouldCreateActor:!1}),this._widget&&this._widget.openDialog()}closeDialog(){this._widget&&this._widget.closeDialog()}attachTo(e,t){try{const n=Nh(this.options,t||{});return this._ensureShadowHost(n,(({shadow:t})=>{const r="string"==typeof e?Qh.querySelector(e):"function"==typeof e.addEventListener?e:null;if(!r)return Lh&&Fe.error("[Feedback] Unable to attach to target element"),null;const o=Kh({shadow:t,options:n,attachTo:r});return this._widgets.add(o),this._widget||(this._widget=o),o}))}catch(e){return Lh&&Fe.error(e),null}}createWidget(e){try{return this._createWidget(Nh(this.options,e||{}))}catch(e){return Lh&&Fe.error(e),null}}removeWidget(e){if(!e)return!1;try{if(this._widgets.has(e))return e.removeActor(),e.removeDialog(),this._widgets.delete(e),this._widget===e&&(this._widget=null),!0}catch(e){Lh&&Fe.error(e)}return!1}getWidget(){return this._widget}remove(){this._host&&this._host.remove(),this._initialize()}_initialize(){this._host=null,this._shadow=null,this._widget=null,this._widgets=new Set,this._hasInsertedActorStyles=!1}_cleanupWidgetIfExists(){this._host&&this.remove();const e=Qh.querySelector(`#${this.options.id}`);e&&e.remove()}_createWidget(e){return this._ensureShadowHost(e,(({shadow:t})=>{const n=Kh({shadow:t,options:e});return!this._hasInsertedActorStyles&&n.actor&&(t.appendChild(function(e){const t=e.createElement("style");return t.textContent="\n.widget__actor {\n  position: fixed;\n  left: var(--left);\n  right: var(--right);\n  bottom: var(--bottom);\n  top: var(--top);\n  z-index: var(--z-index);\n\n  line-height: 16px;\n\n  display: flex;\n  align-items: center;\n  gap: 8px;\n\n  border-radius: var(--border-radius);\n  cursor: pointer;\n  font-family: inherit;\n  font-size: var(--font-size);\n  font-weight: 600;\n  padding: 16px;\n  text-decoration: none;\n  z-index: 9000;\n\n  color: var(--foreground);\n  background-color: var(--background);\n  border: var(--border);\n  box-shadow: var(--box-shadow);\n  opacity: 1;\n  transition: opacity 0.1s ease-in-out;\n}\n\n.widget__actor:hover {\n  background-color: var(--background-hover);\n}\n\n.widget__actor svg {\n  width: 16px;\n  height: 16px;\n}\n\n.widget__actor--hidden {\n  opacity: 0;\n  pointer-events: none;\n  visibility: hidden;\n}\n\n.widget__actor__text {\n}\n\n@media (max-width: 600px) {\n  .widget__actor__text {\n    display: none;\n  }\n}\n\n.feedback-icon path {\n  fill: var(--foreground);\n}\n",t}(Qh)),this._hasInsertedActorStyles=!0),this._widgets.add(n),this._widget||(this._widget=n),n}))}_ensureShadowHost(e,t){let n=!1;if(!this._shadow||!this._host){const{id:t,colorScheme:r,themeLight:o,themeDark:s}=e,{shadow:i,host:a}=Dh({id:t,colorScheme:r,themeLight:o,themeDark:s});this._shadow=i,this._host=a,n=!0}this._host.dataset.sentryFeedbackColorscheme=e.colorScheme;const r=t({shadow:this._shadow,host:this._host});return n&&Qh.body.appendChild(this._host),r}}Zh.__initStatic();const ef="CaptureConsole",tf=(e={})=>{const t=e.levels||Me;return{name:ef,setupOnce(){},setup(e){"console"in Ie&&pt((({args:n,level:r})=>{kr()===e&&t.includes(r)&&function(e,t){const n={level:In(t),extra:{arguments:e}};Rr((r=>{if(r.addEventProcessor((e=>(e.logger="console",_t(e,{handled:!1,type:"console"}),e))),"assert"===t&&!1===e[0]){const t=`Assertion failed: ${_e(e.slice(1)," ")||"console.assert"}`;return r.setExtra("arguments",e.slice(1)),void wr(t,n)}const o=e.find((e=>e instanceof Error));if("error"===t&&o)return void br(o,n);wr(_e(e," "),n)}))}(n,r)}))}}};zo(ef,tf);const nf="Debug",rf=(e={})=>{const t={debugger:!1,stringify:!1,...e};return{name:nf,setupOnce(){},setup(e){e.on&&e.on("beforeSendEvent",((e,n)=>{t.debugger,$e((()=>{t.stringify?(console.log(JSON.stringify(e,null,2)),n&&Object.keys(n).length&&console.log(JSON.stringify(n,null,2))):(console.log(e),n&&Object.keys(n).length&&console.log(n))}))}))}}};zo(nf,rf);const of="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__,sf="Dedupe",af=()=>{let e;return{name:sf,setupOnce(){},processEvent(t){if(t.type)return t;try{if(function(e,t){if(!t)return!1;if(function(e,t){const n=e.message,r=t.message;if(!n&&!r)return!1;if(n&&!r||!n&&r)return!1;if(n!==r)return!1;if(!lf(e,t))return!1;if(!cf(e,t))return!1;return!0}(e,t))return!0;if(function(e,t){const n=uf(t),r=uf(e);if(!n||!r)return!1;if(n.type!==r.type||n.value!==r.value)return!1;if(!lf(e,t))return!1;if(!cf(e,t))return!1;return!0}(e,t))return!0;return!1}(t,e))return of&&Fe.warn("Event dropped due to being a duplicate of previously captured event."),null}catch(e){}return e=t}}};function cf(e,t){let n=df(e),r=df(t);if(!n&&!r)return!0;if(n&&!r||!n&&r)return!1;if(r.length!==n.length)return!1;for(let e=0;e<r.length;e++){const t=r[e],o=n[e];if(t.filename!==o.filename||t.lineno!==o.lineno||t.colno!==o.colno||t.function!==o.function)return!1}return!0}function lf(e,t){let n=e.fingerprint,r=t.fingerprint;if(!n&&!r)return!0;if(n&&!r||!n&&r)return!1;try{return!(n.join("")!==r.join(""))}catch(e){return!1}}function uf(e){return e.exception&&e.exception.values&&e.exception.values[0]}function df(e){const t=e.exception;if(t)try{return t.values[0].stacktrace.frames}catch(e){return}}zo(sf,af);const pf="ExtraErrorData",hf=(e={})=>{const t=e.depth||3,n=e.captureErrorCause||!1;return{name:pf,setupOnce(){},processEvent:(e,r)=>function(e,t={},n,r){if(!t.originalException||!ne(t.originalException))return e;const o=t.originalException.name||t.originalException.constructor.name,s=function(e,t){try{const n=["name","message","stack","line","column","fileName","lineNumber","columnNumber","toJSON"],r={};for(const t of Object.keys(e)){if(-1!==n.indexOf(t))continue;const o=e[t];r[t]=ne(o)?o.toString():o}if(t&&void 0!==e.cause&&(r.cause=ne(e.cause)?e.cause.toString():e.cause),"function"==typeof e.toJSON){const t=e.toJSON();for(const e of Object.keys(t)){const n=t[e];r[e]=ne(n)?n.toString():n}}return r}catch(e){of&&Fe.error("Unable to extract extra data from the Error object:",e)}return null}(t.originalException,r);if(s){const t={...e.contexts},r=nn(s,n);return le(r)&&(Je(r,"__sentry_skip_normalization__",!0),t[o]=r),{...e,contexts:t}}return e}(e,r,t,n)}};zo(pf,hf);var ff="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function gf(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var mf={exports:{}};
/*!
      localForage -- Offline Storage, Improved
      Version 1.10.0
      https://localforage.github.io/localForage
      (c) 2013-2017 Mozilla, Apache License 2.0
  */!function(e,t){e.exports=function e(t,n,r){function o(i,a){if(!n[i]){if(!t[i]){if(!a&&gf)return gf(i);if(s)return s(i,!0);var c=new Error("Cannot find module '"+i+"'");throw c.code="MODULE_NOT_FOUND",c}var l=n[i]={exports:{}};t[i][0].call(l.exports,(function(e){var n=t[i][1][e];return o(n||e)}),l,l.exports,e,t,n,r)}return n[i].exports}for(var s=gf,i=0;i<r.length;i++)o(r[i]);return o}({1:[function(e,t,n){(function(e){var n,r,o=e.MutationObserver||e.WebKitMutationObserver;if(o){var s=0,i=new o(u),a=e.document.createTextNode("");i.observe(a,{characterData:!0}),n=function(){a.data=s=++s%2}}else if(e.setImmediate||void 0===e.MessageChannel)n="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){u(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(u,0)};else{var c=new e.MessageChannel;c.port1.onmessage=u,n=function(){c.port2.postMessage(0)}}var l=[];function u(){var e,t;r=!0;for(var n=l.length;n;){for(t=l,l=[],e=-1;++e<n;)t[e]();n=l.length}r=!1}function d(e){1!==l.push(e)||r||n()}t.exports=d}).call(this,void 0!==ff?ff:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(e,t,n){var r=e(1);function o(){}var s={},i=["REJECTED"],a=["FULFILLED"],c=["PENDING"];function l(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=c,this.queue=[],this.outcome=void 0,e!==o&&h(this,e)}function u(e,t,n){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function d(e,t,n){r((function(){var r;try{r=t(n)}catch(t){return s.reject(e,t)}r===e?s.reject(e,new TypeError("Cannot resolve promise with itself")):s.resolve(e,r)}))}function p(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function h(e,t){var n=!1;function r(t){n||(n=!0,s.reject(e,t))}function o(t){n||(n=!0,s.resolve(e,t))}function i(){t(o,r)}var a=f(i);"error"===a.status&&r(a.value)}function f(e,t){var n={};try{n.value=e(t),n.status="success"}catch(e){n.status="error",n.value=e}return n}function g(e){return e instanceof this?e:s.resolve(new this(o),e)}function m(e){var t=new this(o);return s.reject(t,e)}function y(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,r=!1;if(!n)return this.resolve([]);for(var i=new Array(n),a=0,c=-1,l=new this(o);++c<n;)u(e[c],c);return l;function u(e,o){function c(e){i[o]=e,++a!==n||r||(r=!0,s.resolve(l,i))}t.resolve(e).then(c,(function(e){r||(r=!0,s.reject(l,e))}))}}function _(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,r=!1;if(!n)return this.resolve([]);for(var i=-1,a=new this(o);++i<n;)c(e[i]);return a;function c(e){t.resolve(e).then((function(e){r||(r=!0,s.resolve(a,e))}),(function(e){r||(r=!0,s.reject(a,e))}))}}t.exports=l,l.prototype.catch=function(e){return this.then(null,e)},l.prototype.then=function(e,t){if("function"!=typeof e&&this.state===a||"function"!=typeof t&&this.state===i)return this;var n=new this.constructor(o);return this.state!==c?d(n,this.state===a?e:t,this.outcome):this.queue.push(new u(n,e,t)),n},u.prototype.callFulfilled=function(e){s.resolve(this.promise,e)},u.prototype.otherCallFulfilled=function(e){d(this.promise,this.onFulfilled,e)},u.prototype.callRejected=function(e){s.reject(this.promise,e)},u.prototype.otherCallRejected=function(e){d(this.promise,this.onRejected,e)},s.resolve=function(e,t){var n=f(p,t);if("error"===n.status)return s.reject(e,n.value);var r=n.value;if(r)h(e,r);else{e.state=a,e.outcome=t;for(var o=-1,i=e.queue.length;++o<i;)e.queue[o].callFulfilled(t)}return e},s.reject=function(e,t){e.state=i,e.outcome=t;for(var n=-1,r=e.queue.length;++n<r;)e.queue[n].callRejected(t);return e},l.resolve=g,l.reject=m,l.all=y,l.race=_},{1:1}],3:[function(e,t,n){(function(t){"function"!=typeof t.Promise&&(t.Promise=e(2))}).call(this,void 0!==ff?ff:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{2:2}],4:[function(e,t,n){var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(e){return}}var i=s();function a(){try{if(!i||!i.open)return!1;var e="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),t="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!e||t)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(e){return!1}}function c(e,t){e=e||[],t=t||{};try{return new Blob(e,t)}catch(o){if("TypeError"!==o.name)throw o;for(var n=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),r=0;r<e.length;r+=1)n.append(e[r]);return n.getBlob(t.type)}}"undefined"==typeof Promise&&e(3);var l=Promise;function u(e,t){t&&e.then((function(e){t(null,e)}),(function(e){t(e)}))}function d(e,t,n){"function"==typeof t&&e.then(t),"function"==typeof n&&e.catch(n)}function p(e){return"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e)),e}function h(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}var f="local-forage-detect-blob-support",g=void 0,m={},y=Object.prototype.toString,_="readonly",v="readwrite";function S(e){for(var t=e.length,n=new ArrayBuffer(t),r=new Uint8Array(n),o=0;o<t;o++)r[o]=e.charCodeAt(o);return n}function T(e){return new l((function(t){var n=e.transaction(f,v),r=c([""]);n.objectStore(f).put(r,"key"),n.onabort=function(e){e.preventDefault(),e.stopPropagation(),t(!1)},n.oncomplete=function(){var e=navigator.userAgent.match(/Chrome\/(\d+)/),n=navigator.userAgent.match(/Edge\//);t(n||!e||parseInt(e[1],10)>=43)}})).catch((function(){return!1}))}function b(e){return"boolean"==typeof g?l.resolve(g):T(e).then((function(e){return g=e}))}function w(e){var t=m[e.name],n={};n.promise=new l((function(e,t){n.resolve=e,n.reject=t})),t.deferredOperations.push(n),t.dbReady?t.dbReady=t.dbReady.then((function(){return n.promise})):t.dbReady=n.promise}function E(e){var t=m[e.name].deferredOperations.pop();if(t)return t.resolve(),t.promise}function I(e,t){var n=m[e.name].deferredOperations.pop();if(n)return n.reject(t),n.promise}function A(e,t){return new l((function(n,r){if(m[e.name]=m[e.name]||M(),e.db){if(!t)return n(e.db);w(e),e.db.close()}var o=[e.name];t&&o.push(e.version);var s=i.open.apply(i,o);t&&(s.onupgradeneeded=function(t){var n=s.result;try{n.createObjectStore(e.storeName),t.oldVersion<=1&&n.createObjectStore(f)}catch(n){if("ConstraintError"!==n.name)throw n;console.warn('The database "'+e.name+'" has been upgraded from version '+t.oldVersion+" to version "+t.newVersion+', but the storage "'+e.storeName+'" already exists.')}}),s.onerror=function(e){e.preventDefault(),r(s.error)},s.onsuccess=function(){var t=s.result;t.onversionchange=function(e){e.target.close()},n(t),E(e)}}))}function R(e){return A(e,!1)}function k(e){return A(e,!0)}function C(e,t){if(!e.db)return!0;var n=!e.db.objectStoreNames.contains(e.storeName),r=e.version<e.db.version,o=e.version>e.db.version;if(r&&(e.version!==t&&console.warn('The database "'+e.name+"\" can't be downgraded from version "+e.db.version+" to version "+e.version+"."),e.version=e.db.version),o||n){if(n){var s=e.db.version+1;s>e.version&&(e.version=s)}return!0}return!1}function x(e){return new l((function(t,n){var r=new FileReader;r.onerror=n,r.onloadend=function(n){var r=btoa(n.target.result||"");t({__local_forage_encoded_blob:!0,data:r,type:e.type})},r.readAsBinaryString(e)}))}function O(e){return c([S(atob(e.data))],{type:e.type})}function L(e){return e&&e.__local_forage_encoded_blob}function N(e){var t=this,n=t._initReady().then((function(){var e=m[t._dbInfo.name];if(e&&e.dbReady)return e.dbReady}));return d(n,e,e),n}function P(e){w(e);for(var t=m[e.name],n=t.forages,r=0;r<n.length;r++){var o=n[r];o._dbInfo.db&&(o._dbInfo.db.close(),o._dbInfo.db=null)}return e.db=null,R(e).then((function(t){return e.db=t,C(e)?k(e):t})).then((function(r){e.db=t.db=r;for(var o=0;o<n.length;o++)n[o]._dbInfo.db=r})).catch((function(t){throw I(e,t),t}))}function D(e,t,n,r){void 0===r&&(r=1);try{var o=e.db.transaction(e.storeName,t);n(null,o)}catch(o){if(r>0&&(!e.db||"InvalidStateError"===o.name||"NotFoundError"===o.name))return l.resolve().then((function(){if(!e.db||"NotFoundError"===o.name&&!e.db.objectStoreNames.contains(e.storeName)&&e.version<=e.db.version)return e.db&&(e.version=e.db.version+1),k(e)})).then((function(){return P(e).then((function(){D(e,t,n,r-1)}))})).catch(n);n(o)}}function M(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function U(e){var t=this,n={db:null};if(e)for(var r in e)n[r]=e[r];var o=m[n.name];o||(o=M(),m[n.name]=o),o.forages.push(t),t._initReady||(t._initReady=t.ready,t.ready=N);var s=[];function i(){return l.resolve()}for(var a=0;a<o.forages.length;a++){var c=o.forages[a];c!==t&&s.push(c._initReady().catch(i))}var u=o.forages.slice(0);return l.all(s).then((function(){return n.db=o.db,R(n)})).then((function(e){return n.db=e,C(n,t._defaultConfig.version)?k(n):e})).then((function(e){n.db=o.db=e,t._dbInfo=n;for(var r=0;r<u.length;r++){var s=u[r];s!==t&&(s._dbInfo.db=n.db,s._dbInfo.version=n.version)}}))}function $(e,t){var n=this;e=p(e);var r=new l((function(t,r){n.ready().then((function(){D(n._dbInfo,_,(function(o,s){if(o)return r(o);try{var i=s.objectStore(n._dbInfo.storeName).get(e);i.onsuccess=function(){var e=i.result;void 0===e&&(e=null),L(e)&&(e=O(e)),t(e)},i.onerror=function(){r(i.error)}}catch(e){r(e)}}))})).catch(r)}));return u(r,t),r}function F(e,t){var n=this,r=new l((function(t,r){n.ready().then((function(){D(n._dbInfo,_,(function(o,s){if(o)return r(o);try{var i=s.objectStore(n._dbInfo.storeName).openCursor(),a=1;i.onsuccess=function(){var n=i.result;if(n){var r=n.value;L(r)&&(r=O(r));var o=e(r,n.key,a++);void 0!==o?t(o):n.continue()}else t()},i.onerror=function(){r(i.error)}}catch(e){r(e)}}))})).catch(r)}));return u(r,t),r}function j(e,t,n){var r=this;e=p(e);var o=new l((function(n,o){var s;r.ready().then((function(){return s=r._dbInfo,"[object Blob]"===y.call(t)?b(s.db).then((function(e){return e?t:x(t)})):t})).then((function(t){D(r._dbInfo,v,(function(s,i){if(s)return o(s);try{var a=i.objectStore(r._dbInfo.storeName);null===t&&(t=void 0);var c=a.put(t,e);i.oncomplete=function(){void 0===t&&(t=null),n(t)},i.onabort=i.onerror=function(){var e=c.error?c.error:c.transaction.error;o(e)}}catch(e){o(e)}}))})).catch(o)}));return u(o,n),o}function G(e,t){var n=this;e=p(e);var r=new l((function(t,r){n.ready().then((function(){D(n._dbInfo,v,(function(o,s){if(o)return r(o);try{var i=s.objectStore(n._dbInfo.storeName).delete(e);s.oncomplete=function(){t()},s.onerror=function(){r(i.error)},s.onabort=function(){var e=i.error?i.error:i.transaction.error;r(e)}}catch(e){r(e)}}))})).catch(r)}));return u(r,t),r}function V(e){var t=this,n=new l((function(e,n){t.ready().then((function(){D(t._dbInfo,v,(function(r,o){if(r)return n(r);try{var s=o.objectStore(t._dbInfo.storeName).clear();o.oncomplete=function(){e()},o.onabort=o.onerror=function(){var e=s.error?s.error:s.transaction.error;n(e)}}catch(e){n(e)}}))})).catch(n)}));return u(n,e),n}function q(e){var t=this,n=new l((function(e,n){t.ready().then((function(){D(t._dbInfo,_,(function(r,o){if(r)return n(r);try{var s=o.objectStore(t._dbInfo.storeName).count();s.onsuccess=function(){e(s.result)},s.onerror=function(){n(s.error)}}catch(e){n(e)}}))})).catch(n)}));return u(n,e),n}function W(e,t){var n=this,r=new l((function(t,r){e<0?t(null):n.ready().then((function(){D(n._dbInfo,_,(function(o,s){if(o)return r(o);try{var i=s.objectStore(n._dbInfo.storeName),a=!1,c=i.openKeyCursor();c.onsuccess=function(){var n=c.result;n?0===e||a?t(n.key):(a=!0,n.advance(e)):t(null)},c.onerror=function(){r(c.error)}}catch(e){r(e)}}))})).catch(r)}));return u(r,t),r}function B(e){var t=this,n=new l((function(e,n){t.ready().then((function(){D(t._dbInfo,_,(function(r,o){if(r)return n(r);try{var s=o.objectStore(t._dbInfo.storeName).openKeyCursor(),i=[];s.onsuccess=function(){var t=s.result;t?(i.push(t.key),t.continue()):e(i)},s.onerror=function(){n(s.error)}}catch(e){n(e)}}))})).catch(n)}));return u(n,e),n}function H(e,t){t=h.apply(this,arguments);var n=this.config();(e="function"!=typeof e&&e||{}).name||(e.name=e.name||n.name,e.storeName=e.storeName||n.storeName);var r,o=this;if(e.name){var s=e.name===n.name&&o._dbInfo.db?l.resolve(o._dbInfo.db):R(e).then((function(t){var n=m[e.name],r=n.forages;n.db=t;for(var o=0;o<r.length;o++)r[o]._dbInfo.db=t;return t}));r=e.storeName?s.then((function(t){if(t.objectStoreNames.contains(e.storeName)){var n=t.version+1;w(e);var r=m[e.name],o=r.forages;t.close();for(var s=0;s<o.length;s++){var a=o[s];a._dbInfo.db=null,a._dbInfo.version=n}var c=new l((function(t,r){var o=i.open(e.name,n);o.onerror=function(e){o.result.close(),r(e)},o.onupgradeneeded=function(){o.result.deleteObjectStore(e.storeName)},o.onsuccess=function(){var e=o.result;e.close(),t(e)}}));return c.then((function(e){r.db=e;for(var t=0;t<o.length;t++){var n=o[t];n._dbInfo.db=e,E(n._dbInfo)}})).catch((function(t){throw(I(e,t)||l.resolve()).catch((function(){})),t}))}})):s.then((function(t){w(e);var n=m[e.name],r=n.forages;t.close();for(var o=0;o<r.length;o++)r[o]._dbInfo.db=null;var s=new l((function(t,n){var r=i.deleteDatabase(e.name);r.onerror=function(){var e=r.result;e&&e.close(),n(r.error)},r.onblocked=function(){console.warn('dropInstance blocked for database "'+e.name+'" until all open connections are closed')},r.onsuccess=function(){var e=r.result;e&&e.close(),t(e)}}));return s.then((function(e){n.db=e;for(var t=0;t<r.length;t++)E(r[t]._dbInfo)})).catch((function(t){throw(I(e,t)||l.resolve()).catch((function(){})),t}))}))}else r=l.reject("Invalid arguments");return u(r,t),r}var J={_driver:"asyncStorage",_initStorage:U,_support:a(),iterate:F,getItem:$,setItem:j,removeItem:G,clear:V,length:q,key:W,keys:B,dropInstance:H};function z(){return"function"==typeof openDatabase}var Y="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",X="~~local_forage_type~",K=/^~~local_forage_type~([^~]+)~/,Q="__lfsc__:",Z=Q.length,ee="arbf",te="blob",ne="si08",re="ui08",oe="uic8",se="si16",ie="si32",ae="ur16",ce="ui32",le="fl32",ue="fl64",de=Z+ee.length,pe=Object.prototype.toString;function he(e){var t,n,r,o,s,i=.75*e.length,a=e.length,c=0;"="===e[e.length-1]&&(i--,"="===e[e.length-2]&&i--);var l=new ArrayBuffer(i),u=new Uint8Array(l);for(t=0;t<a;t+=4)n=Y.indexOf(e[t]),r=Y.indexOf(e[t+1]),o=Y.indexOf(e[t+2]),s=Y.indexOf(e[t+3]),u[c++]=n<<2|r>>4,u[c++]=(15&r)<<4|o>>2,u[c++]=(3&o)<<6|63&s;return l}function fe(e){var t,n=new Uint8Array(e),r="";for(t=0;t<n.length;t+=3)r+=Y[n[t]>>2],r+=Y[(3&n[t])<<4|n[t+1]>>4],r+=Y[(15&n[t+1])<<2|n[t+2]>>6],r+=Y[63&n[t+2]];return n.length%3==2?r=r.substring(0,r.length-1)+"=":n.length%3==1&&(r=r.substring(0,r.length-2)+"=="),r}function ge(e,t){var n="";if(e&&(n=pe.call(e)),e&&("[object ArrayBuffer]"===n||e.buffer&&"[object ArrayBuffer]"===pe.call(e.buffer))){var r,o=Q;e instanceof ArrayBuffer?(r=e,o+=ee):(r=e.buffer,"[object Int8Array]"===n?o+=ne:"[object Uint8Array]"===n?o+=re:"[object Uint8ClampedArray]"===n?o+=oe:"[object Int16Array]"===n?o+=se:"[object Uint16Array]"===n?o+=ae:"[object Int32Array]"===n?o+=ie:"[object Uint32Array]"===n?o+=ce:"[object Float32Array]"===n?o+=le:"[object Float64Array]"===n?o+=ue:t(new Error("Failed to get type for BinaryArray"))),t(o+fe(r))}else if("[object Blob]"===n){var s=new FileReader;s.onload=function(){var n=X+e.type+"~"+fe(this.result);t(Q+te+n)},s.readAsArrayBuffer(e)}else try{t(JSON.stringify(e))}catch(n){console.error("Couldn't convert value into a JSON string: ",e),t(null,n)}}function me(e){if(e.substring(0,Z)!==Q)return JSON.parse(e);var t,n=e.substring(de),r=e.substring(Z,de);if(r===te&&K.test(n)){var o=n.match(K);t=o[1],n=n.substring(o[0].length)}var s=he(n);switch(r){case ee:return s;case te:return c([s],{type:t});case ne:return new Int8Array(s);case re:return new Uint8Array(s);case oe:return new Uint8ClampedArray(s);case se:return new Int16Array(s);case ae:return new Uint16Array(s);case ie:return new Int32Array(s);case ce:return new Uint32Array(s);case le:return new Float32Array(s);case ue:return new Float64Array(s);default:throw new Error("Unkown type: "+r)}}var ye={serialize:ge,deserialize:me,stringToBuffer:he,bufferToString:fe};function _e(e,t,n,r){e.executeSql("CREATE TABLE IF NOT EXISTS "+t.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],n,r)}function ve(e){var t=this,n={db:null};if(e)for(var r in e)n[r]="string"!=typeof e[r]?e[r].toString():e[r];var o=new l((function(e,r){try{n.db=openDatabase(n.name,String(n.version),n.description,n.size)}catch(e){return r(e)}n.db.transaction((function(o){_e(o,n,(function(){t._dbInfo=n,e()}),(function(e,t){r(t)}))}),r)}));return n.serializer=ye,o}function Se(e,t,n,r,o,s){e.executeSql(n,r,o,(function(e,i){i.code===i.SYNTAX_ERR?e.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[t.storeName],(function(e,a){a.rows.length?s(e,i):_e(e,t,(function(){e.executeSql(n,r,o,s)}),s)}),s):s(e,i)}),s)}function Te(e,t){var n=this;e=p(e);var r=new l((function(t,r){n.ready().then((function(){var o=n._dbInfo;o.db.transaction((function(n){Se(n,o,"SELECT * FROM "+o.storeName+" WHERE key = ? LIMIT 1",[e],(function(e,n){var r=n.rows.length?n.rows.item(0).value:null;r&&(r=o.serializer.deserialize(r)),t(r)}),(function(e,t){r(t)}))}))})).catch(r)}));return u(r,t),r}function be(e,t){var n=this,r=new l((function(t,r){n.ready().then((function(){var o=n._dbInfo;o.db.transaction((function(n){Se(n,o,"SELECT * FROM "+o.storeName,[],(function(n,r){for(var s=r.rows,i=s.length,a=0;a<i;a++){var c=s.item(a),l=c.value;if(l&&(l=o.serializer.deserialize(l)),void 0!==(l=e(l,c.key,a+1)))return void t(l)}t()}),(function(e,t){r(t)}))}))})).catch(r)}));return u(r,t),r}function we(e,t,n,r){var o=this;e=p(e);var s=new l((function(s,i){o.ready().then((function(){void 0===t&&(t=null);var a=t,c=o._dbInfo;c.serializer.serialize(t,(function(t,l){l?i(l):c.db.transaction((function(n){Se(n,c,"INSERT OR REPLACE INTO "+c.storeName+" (key, value) VALUES (?, ?)",[e,t],(function(){s(a)}),(function(e,t){i(t)}))}),(function(t){if(t.code===t.QUOTA_ERR){if(r>0)return void s(we.apply(o,[e,a,n,r-1]));i(t)}}))}))})).catch(i)}));return u(s,n),s}function Ee(e,t,n){return we.apply(this,[e,t,n,1])}function Ie(e,t){var n=this;e=p(e);var r=new l((function(t,r){n.ready().then((function(){var o=n._dbInfo;o.db.transaction((function(n){Se(n,o,"DELETE FROM "+o.storeName+" WHERE key = ?",[e],(function(){t()}),(function(e,t){r(t)}))}))})).catch(r)}));return u(r,t),r}function Ae(e){var t=this,n=new l((function(e,n){t.ready().then((function(){var r=t._dbInfo;r.db.transaction((function(t){Se(t,r,"DELETE FROM "+r.storeName,[],(function(){e()}),(function(e,t){n(t)}))}))})).catch(n)}));return u(n,e),n}function Re(e){var t=this,n=new l((function(e,n){t.ready().then((function(){var r=t._dbInfo;r.db.transaction((function(t){Se(t,r,"SELECT COUNT(key) as c FROM "+r.storeName,[],(function(t,n){var r=n.rows.item(0).c;e(r)}),(function(e,t){n(t)}))}))})).catch(n)}));return u(n,e),n}function ke(e,t){var n=this,r=new l((function(t,r){n.ready().then((function(){var o=n._dbInfo;o.db.transaction((function(n){Se(n,o,"SELECT key FROM "+o.storeName+" WHERE id = ? LIMIT 1",[e+1],(function(e,n){var r=n.rows.length?n.rows.item(0).key:null;t(r)}),(function(e,t){r(t)}))}))})).catch(r)}));return u(r,t),r}function Ce(e){var t=this,n=new l((function(e,n){t.ready().then((function(){var r=t._dbInfo;r.db.transaction((function(t){Se(t,r,"SELECT key FROM "+r.storeName,[],(function(t,n){for(var r=[],o=0;o<n.rows.length;o++)r.push(n.rows.item(o).key);e(r)}),(function(e,t){n(t)}))}))})).catch(n)}));return u(n,e),n}function xe(e){return new l((function(t,n){e.transaction((function(r){r.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],(function(n,r){for(var o=[],s=0;s<r.rows.length;s++)o.push(r.rows.item(s).name);t({db:e,storeNames:o})}),(function(e,t){n(t)}))}),(function(e){n(e)}))}))}function Oe(e,t){t=h.apply(this,arguments);var n=this.config();(e="function"!=typeof e&&e||{}).name||(e.name=e.name||n.name,e.storeName=e.storeName||n.storeName);var r,o=this;return r=e.name?new l((function(t){var r;r=e.name===n.name?o._dbInfo.db:openDatabase(e.name,"","",0),e.storeName?t({db:r,storeNames:[e.storeName]}):t(xe(r))})).then((function(e){return new l((function(t,n){e.db.transaction((function(r){function o(e){return new l((function(t,n){r.executeSql("DROP TABLE IF EXISTS "+e,[],(function(){t()}),(function(e,t){n(t)}))}))}for(var s=[],i=0,a=e.storeNames.length;i<a;i++)s.push(o(e.storeNames[i]));l.all(s).then((function(){t()})).catch((function(e){n(e)}))}),(function(e){n(e)}))}))})):l.reject("Invalid arguments"),u(r,t),r}var Le={_driver:"webSQLStorage",_initStorage:ve,_support:z(),iterate:be,getItem:Te,setItem:Ee,removeItem:Ie,clear:Ae,length:Re,key:ke,keys:Ce,dropInstance:Oe};function Ne(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&!!localStorage.setItem}catch(e){return!1}}function Pe(e,t){var n=e.name+"/";return e.storeName!==t.storeName&&(n+=e.storeName+"/"),n}function De(){var e="_localforage_support_test";try{return localStorage.setItem(e,!0),localStorage.removeItem(e),!1}catch(e){return!0}}function Me(){return!De()||localStorage.length>0}function Ue(e){var t=this,n={};if(e)for(var r in e)n[r]=e[r];return n.keyPrefix=Pe(e,t._defaultConfig),Me()?(t._dbInfo=n,n.serializer=ye,l.resolve()):l.reject()}function $e(e){var t=this,n=t.ready().then((function(){for(var e=t._dbInfo.keyPrefix,n=localStorage.length-1;n>=0;n--){var r=localStorage.key(n);0===r.indexOf(e)&&localStorage.removeItem(r)}}));return u(n,e),n}function Fe(e,t){var n=this;e=p(e);var r=n.ready().then((function(){var t=n._dbInfo,r=localStorage.getItem(t.keyPrefix+e);return r&&(r=t.serializer.deserialize(r)),r}));return u(r,t),r}function je(e,t){var n=this,r=n.ready().then((function(){for(var t=n._dbInfo,r=t.keyPrefix,o=r.length,s=localStorage.length,i=1,a=0;a<s;a++){var c=localStorage.key(a);if(0===c.indexOf(r)){var l=localStorage.getItem(c);if(l&&(l=t.serializer.deserialize(l)),void 0!==(l=e(l,c.substring(o),i++)))return l}}}));return u(r,t),r}function Ge(e,t){var n=this,r=n.ready().then((function(){var t,r=n._dbInfo;try{t=localStorage.key(e)}catch(e){t=null}return t&&(t=t.substring(r.keyPrefix.length)),t}));return u(r,t),r}function Ve(e){var t=this,n=t.ready().then((function(){for(var e=t._dbInfo,n=localStorage.length,r=[],o=0;o<n;o++){var s=localStorage.key(o);0===s.indexOf(e.keyPrefix)&&r.push(s.substring(e.keyPrefix.length))}return r}));return u(n,e),n}function qe(e){var t=this.keys().then((function(e){return e.length}));return u(t,e),t}function We(e,t){var n=this;e=p(e);var r=n.ready().then((function(){var t=n._dbInfo;localStorage.removeItem(t.keyPrefix+e)}));return u(r,t),r}function Be(e,t,n){var r=this;e=p(e);var o=r.ready().then((function(){void 0===t&&(t=null);var n=t;return new l((function(o,s){var i=r._dbInfo;i.serializer.serialize(t,(function(t,r){if(r)s(r);else try{localStorage.setItem(i.keyPrefix+e,t),o(n)}catch(e){"QuotaExceededError"!==e.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==e.name||s(e),s(e)}}))}))}));return u(o,n),o}function He(e,t){if(t=h.apply(this,arguments),!(e="function"!=typeof e&&e||{}).name){var n=this.config();e.name=e.name||n.name,e.storeName=e.storeName||n.storeName}var r,o=this;return r=e.name?new l((function(t){e.storeName?t(Pe(e,o._defaultConfig)):t(e.name+"/")})).then((function(e){for(var t=localStorage.length-1;t>=0;t--){var n=localStorage.key(t);0===n.indexOf(e)&&localStorage.removeItem(n)}})):l.reject("Invalid arguments"),u(r,t),r}var Je={_driver:"localStorageWrapper",_initStorage:Ue,_support:Ne(),iterate:je,getItem:Fe,setItem:Be,removeItem:We,clear:$e,length:qe,key:Ge,keys:Ve,dropInstance:He},ze=function(e,t){return e===t||"number"==typeof e&&"number"==typeof t&&isNaN(e)&&isNaN(t)},Ye=function(e,t){for(var n=e.length,r=0;r<n;){if(ze(e[r],t))return!0;r++}return!1},Xe=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},Ke={},Qe={},Ze={INDEXEDDB:J,WEBSQL:Le,LOCALSTORAGE:Je},et=[Ze.INDEXEDDB._driver,Ze.WEBSQL._driver,Ze.LOCALSTORAGE._driver],tt=["dropInstance"],nt=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(tt),rt={description:"",driver:et.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function ot(e,t){e[t]=function(){var n=arguments;return e.ready().then((function(){return e[t].apply(e,n)}))}}function st(){for(var e=1;e<arguments.length;e++){var t=arguments[e];if(t)for(var n in t)t.hasOwnProperty(n)&&(Xe(t[n])?arguments[0][n]=t[n].slice():arguments[0][n]=t[n])}return arguments[0]}var it=function(){function e(t){for(var n in o(this,e),Ze)if(Ze.hasOwnProperty(n)){var r=Ze[n],s=r._driver;this[n]=s,Ke[s]||this.defineDriver(r)}this._defaultConfig=st({},rt),this._config=st({},this._defaultConfig,t),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch((function(){}))}return e.prototype.config=function(e){if("object"===(void 0===e?"undefined":r(e))){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var t in e){if("storeName"===t&&(e[t]=e[t].replace(/\W/g,"_")),"version"===t&&"number"!=typeof e[t])return new Error("Database version must be a number.");this._config[t]=e[t]}return!("driver"in e)||!e.driver||this.setDriver(this._config.driver)}return"string"==typeof e?this._config[e]:this._config},e.prototype.defineDriver=function(e,t,n){var r=new l((function(t,n){try{var r=e._driver,o=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!e._driver)return void n(o);for(var s=nt.concat("_initStorage"),i=0,a=s.length;i<a;i++){var c=s[i];if((!Ye(tt,c)||e[c])&&"function"!=typeof e[c])return void n(o)}var d=function(){for(var t=function(e){return function(){var t=new Error("Method "+e+" is not implemented by the current driver"),n=l.reject(t);return u(n,arguments[arguments.length-1]),n}},n=0,r=tt.length;n<r;n++){var o=tt[n];e[o]||(e[o]=t(o))}};d();var p=function(n){Ke[r]&&console.info("Redefining LocalForage driver: "+r),Ke[r]=e,Qe[r]=n,t()};"_support"in e?e._support&&"function"==typeof e._support?e._support().then(p,n):p(!!e._support):p(!0)}catch(e){n(e)}}));return d(r,t,n),r},e.prototype.driver=function(){return this._driver||null},e.prototype.getDriver=function(e,t,n){var r=Ke[e]?l.resolve(Ke[e]):l.reject(new Error("Driver not found."));return d(r,t,n),r},e.prototype.getSerializer=function(e){var t=l.resolve(ye);return d(t,e),t},e.prototype.ready=function(e){var t=this,n=t._driverSet.then((function(){return null===t._ready&&(t._ready=t._initDriver()),t._ready}));return d(n,e,e),n},e.prototype.setDriver=function(e,t,n){var r=this;Xe(e)||(e=[e]);var o=this._getSupportedDrivers(e);function s(){r._config.driver=r.driver()}function i(e){return r._extend(e),s(),r._ready=r._initStorage(r._config),r._ready}function a(e){return function(){var t=0;function n(){for(;t<e.length;){var o=e[t];return t++,r._dbInfo=null,r._ready=null,r.getDriver(o).then(i).catch(n)}s();var a=new Error("No available storage method found.");return r._driverSet=l.reject(a),r._driverSet}return n()}}var c=null!==this._driverSet?this._driverSet.catch((function(){return l.resolve()})):l.resolve();return this._driverSet=c.then((function(){var e=o[0];return r._dbInfo=null,r._ready=null,r.getDriver(e).then((function(e){r._driver=e._driver,s(),r._wrapLibraryMethodsWithReady(),r._initDriver=a(o)}))})).catch((function(){s();var e=new Error("No available storage method found.");return r._driverSet=l.reject(e),r._driverSet})),d(this._driverSet,t,n),this._driverSet},e.prototype.supports=function(e){return!!Qe[e]},e.prototype._extend=function(e){st(this,e)},e.prototype._getSupportedDrivers=function(e){for(var t=[],n=0,r=e.length;n<r;n++){var o=e[n];this.supports(o)&&t.push(o)}return t},e.prototype._wrapLibraryMethodsWithReady=function(){for(var e=0,t=nt.length;e<t;e++)ot(this,nt[e])},e.prototype.createInstance=function(t){return new e(t)},e}(),at=new it;t.exports=at},{3:3}]},{},[4])(4)}(mf);const yf=Ie;class _f{static __initStatic(){this.id="Offline"}constructor(e={}){this.name=_f.id,this.maxStoredEvents=e.maxStoredEvents||30,this.offlineEventStore=mf.exports.createInstance({name:"sentry/offlineEventStore"})}setupOnce(e,t){this.hub=t(),"addEventListener"in yf&&yf.addEventListener("online",(()=>{this._sendEvents().catch((()=>{of&&Fe.warn("could not send cached events")}))}));const n=e=>this.hub&&this.hub.getIntegration(_f)&&"navigator"in yf&&"onLine"in yf.navigator&&!yf.navigator.onLine?(of&&Fe.log("Event dropped due to being a offline - caching instead"),this._cacheEvent(e).then((e=>this._enforceMaxEvents())).catch((e=>{of&&Fe.warn("could not cache event while offline")})),null):e;n.id=this.name,e(n),"navigator"in yf&&"onLine"in yf.navigator&&yf.navigator.onLine&&this._sendEvents().catch((()=>{of&&Fe.warn("could not send cached events")}))}async _cacheEvent(e){return this.offlineEventStore.setItem(ft(),nn(e))}async _enforceMaxEvents(){const e=[];return this.offlineEventStore.iterate(((t,n,r)=>{e.push({cacheKey:n,event:t})})).then((()=>this._purgeEvents(e.sort(((e,t)=>(t.event.timestamp||0)-(e.event.timestamp||0))).slice(this.maxStoredEvents<e.length?this.maxStoredEvents:e.length).map((e=>e.cacheKey))))).catch((e=>{of&&Fe.warn("could not enforce max events")}))}async _purgeEvent(e){return this.offlineEventStore.removeItem(e)}async _purgeEvents(e){return Promise.all(e.map((e=>this._purgeEvent(e)))).then()}async _sendEvents(){return this.offlineEventStore.iterate(((e,t,n)=>{this.hub?(this.hub.captureEvent(e),this._purgeEvent(t).catch((e=>{of&&Fe.warn("could not purge event from cache")}))):of&&Fe.warn("no hub found - could not send cached event")}))}}_f.__initStatic();const vf=Ie,Sf="ReportingObserver",Tf=new WeakMap,bf=(e={})=>{const t=e.types||["crash","deprecation","intervention"];function n(e){if(Tf.has(kr()))for(const t of e)Rr((e=>{e.setExtra("url",t.url);const n=`ReportingObserver [${t.type}]`;let r="No details available";if(t.body){const n={};for(const e in t.body)n[e]=t.body[e];if(e.setExtra("body",n),"crash"===t.type){const e=t.body;r=[e.crashId||"",e.reason||""].join(" ").trim()||r}else{r=t.body.message||r}}wr(`${n}: ${r}`)}))}return{name:Sf,setupOnce(){if(!("ReportingObserver"in Ct))return;new vf.ReportingObserver(n,{buffered:!0,types:t}).observe()},setup(e){Tf.set(e,!0)}}};zo(Sf,bf);const wf="RewriteFrames",Ef=(e={})=>{const t=e.root,n=e.prefix||"app:///",r=e.iteratee||(e=>{if(!e.filename)return e;const r=/^[a-zA-Z]:\\/.test(e.filename)||e.filename.includes("\\")&&!e.filename.includes("/"),o=/^\//.test(e.filename);if(r||o){const o=r?e.filename.replace(/^[a-zA-Z]:/,"").replace(/\\/g,"/"):e.filename,s=t?function(e,t){e=an(e).slice(1),t=an(t).slice(1);const n=cn(e.split("/")),r=cn(t.split("/")),o=Math.min(n.length,r.length);let s=o;for(let e=0;e<o;e++)if(n[e]!==r[e]){s=e;break}let i=[];for(let e=s;e<n.length;e++)i.push("..");return i=i.concat(r.slice(s)),i.join("/")}(t,o):ln(o);e.filename=`${n}${s}`}return e});return{name:wf,setupOnce(){},processEvent(e){let t=e;return e.exception&&Array.isArray(e.exception.values)&&(t=function(e){try{return{...e,exception:{...e.exception,values:e.exception.values.map((e=>{return{...e,...e.stacktrace&&{stacktrace:(t=e.stacktrace,{...t,frames:t&&t.frames&&t.frames.map((e=>r(e)))})}};var t}))}}}catch(t){return e}}(t)),t}}};zo(wf,Ef);const If="SessionTiming",Af=()=>{const e=Date.now();return{name:If,setupOnce(){},processEvent(t){const n=Date.now();return{...t,extra:{...t.extra,"session:start":e,"session:duration":n-e,"session:end":n}}}}};zo(If,Af);const Rf="Transaction";function kf(e){return e.module||e.function?`${e.module||"?"}/${e.function||"?"}`:"<unknown>"}zo(Rf,(()=>({name:Rf,setupOnce(){},processEvent(e){const t=function(e){const t=e.exception&&e.exception.values&&e.exception.values[0];return t&&t.stacktrace&&t.stacktrace.frames||[]}(e);for(let n=t.length-1;n>=0;n--){const r=t[n];if(!0===r.in_app){e.transaction=kf(r);break}}return e}})));const Cf="HttpClient",xf=(e={})=>{const t={failedRequestStatusCodes:[[500,599]],failedRequestTargets:[/.*/],...e};return{name:Cf,setupOnce(){},setup(e){!function(e,t){if(!Lt())return;Nt((n=>{if(kr()!==e)return;const{response:r,args:o}=n,[s,i]=o;r&&function(e,t,n,r){if(Nf(e,n.status,n.url)){const e=function(e,t){if(!t&&e instanceof Request)return e;if(e instanceof Request&&e.bodyUsed)return e;return new Request(e,t)}(t,r);let o,s,i,a;Df()&&([{headers:o,cookies:i},{headers:s,cookies:a}]=[{cookieHeader:"Cookie",obj:e},{cookieHeader:"Set-Cookie",obj:n}].map((({cookieHeader:e,obj:t})=>{const n=function(e){const t={};return e.forEach(((e,n)=>{t[n]=e})),t}(t.headers);let r;try{const t=n[e]||n[e.toLowerCase()]||void 0;t&&(r=Lf(t))}catch(t){of&&Fe.log(`Could not extract cookies from header ${e}`)}return{headers:n,cookies:r}})));Er(Pf({url:e.url,method:e.method,status:n.status,requestHeaders:o,responseHeaders:s,requestCookies:i,responseCookies:a}))}}(t,s,r,i)}))}(e,t),function(e,t){if(!("XMLHttpRequest"in Ie))return;Xt((n=>{if(kr()!==e)return;const r=n.xhr,o=r[Yt];if(!o)return;const{method:s,request_headers:i}=o;try{!function(e,t,n,r){if(Nf(e,t.status,t.responseURL)){let e,o,s;if(Df()){try{const e=t.getResponseHeader("Set-Cookie")||t.getResponseHeader("set-cookie")||void 0;e&&(o=Lf(e))}catch(e){of&&Fe.log("Could not extract cookies from response headers")}try{s=function(e){const t=e.getAllResponseHeaders();if(!t)return{};return t.split("\r\n").reduce(((e,t)=>{const[n,r]=t.split(": ");return e[n]=r,e}),{})}(t)}catch(e){of&&Fe.log("Could not extract headers from response")}e=r}Er(Pf({url:t.responseURL,method:n,status:t.status,requestHeaders:e,responseHeaders:s,responseCookies:o}))}}(t,r,s,i)}catch(e){of&&Fe.warn("Error while extracting response event form XHR response",e)}}))}(e,t)}}};function Of(e){if(e){const t=e["Content-Length"]||e["content-length"];if(t)return parseInt(t,10)}}function Lf(e){return e.split("; ").reduce(((e,t)=>{const[n,r]=t.split("=");return e[n]=r,e}),{})}function Nf(e,t,n){return function(e,t){return e.some((e=>"number"==typeof e?e===t:t>=e[0]&&t<=e[1]))}(e.failedRequestStatusCodes,t)&&(r=e.failedRequestTargets,o=n,r.some((e=>"string"==typeof e?o.includes(e):e.test(o))))&&!ms(n,kr());var r,o}function Pf(e){const t=`HTTP Client Error with status code: ${e.status}`,n={message:t,exception:{values:[{type:"Error",value:t}]},request:{url:e.url,method:e.method,headers:e.requestHeaders,cookies:e.requestCookies},contexts:{response:{status_code:e.status,headers:e.responseHeaders,cookies:e.responseCookies,body_size:Of(e.responseHeaders)}}};return _t(n,{type:"http.client",handled:!1}),n}function Df(){const e=kr();return!!e&&Boolean(e.getOptions().sendDefaultPii)}zo(Cf,xf);const Mf=Ie,Uf="ContextLines",$f=(e={})=>{const t=null!=e.frameContextLines?e.frameContextLines:7;return{name:Uf,setupOnce(){},processEvent:e=>function(e,t){const n=Mf.document,r=Mf.location&&mn(Mf.location.href);if(!n||!r)return e;const o=e.exception&&e.exception.values;if(!o||!o.length)return e;const s=n.documentElement.innerHTML;if(!s)return e;const i=["<!DOCTYPE html>","<html>",...s.split("\n"),"</html>"];return o.forEach((e=>{const n=e.stacktrace;n&&n.frames&&(n.frames=n.frames.map((e=>function(e,t,n,r){if(e.filename!==n||!e.lineno||!t.length)return e;return function(e,t,n=5){if(void 0===t.lineno)return;const r=e.length,o=Math.max(Math.min(r-1,t.lineno-1),0);t.pre_context=e.slice(Math.max(0,o-n),o).map((e=>ye(e,0))),t.context_line=ye(e[Math.min(r-1,o)],t.colno||0),t.post_context=e.slice(Math.min(o+1,r),o+1+n).map((e=>ye(e,0)))}(t,e,r),e}(e,i,r,t))))})),e}(e,t)}};function Ff(e){return new Promise(((t,n)=>{e.oncomplete=e.onsuccess=()=>t(e.result),e.onabort=e.onerror=()=>n(e.error)}))}function jf(e){return Ff(e.getAllKeys())}function Gf(e){let t;function n(){return null==t&&(t=function(e,t){const n=indexedDB.open(e);n.onupgradeneeded=()=>n.result.createObjectStore(t);const r=Ff(n);return e=>r.then((n=>e(n.transaction(t,"readwrite").objectStore(t))))}(e.dbName||"sentry-offline",e.storeName||"queue")),t}return{insert:async t=>{try{const r=await Bn(t,e.textEncoder);await function(e,t,n){return e((e=>jf(e).then((r=>{if(!(r.length>=n))return e.put(t,Math.max(...r,0)+1),Ff(e.transaction)}))))}(n(),r,e.maxQueueSize||30)}catch(e){}},pop:async()=>{try{const t=await function(e){return e((e=>jf(e).then((t=>{if(0!==t.length)return Ff(e.get(t[0])).then((n=>(e.delete(t[0]),Ff(e.transaction).then((()=>n)))))}))))}(n());if(t)return function(e,t,n){let r="string"==typeof e?t.encode(e):e;function o(e){const t=r.subarray(0,e);return r=r.subarray(e+1),t}function s(){let e=r.indexOf(10);return e<0&&(e=r.length),JSON.parse(n.decode(o(e)))}const i=s(),a=[];for(;r.length;){const e=s(),t="number"==typeof e.length?e.length:void 0;a.push([e,t?o(t):s()])}return[i,a]}(t,e.textEncoder||new TextEncoder,e.textDecoder||new TextDecoder)}catch(e){}}}}zo(Uf,$f);const Vf=1e6,qf=String(0),Wf="main";let Bf="",Hf="",Jf="",zf=xa.navigator&&xa.navigator.userAgent||"",Yf="";const Xf=xa.navigator&&xa.navigator.language||xa.navigator&&xa.navigator.languages&&xa.navigator.languages[0]||"";const Kf=xa.navigator&&xa.navigator.userAgentData;var Qf;function Zf(e){return function(e){return!("thread_metadata"in e)}(e)?function(e){let t,n=0;const r={samples:[],stacks:[],frames:[],thread_metadata:{[qf]:{name:Wf}}};if(!e.samples.length)return r;const o=e.samples[0].timestamp,s="number"==typeof performance.timeOrigin?performance.timeOrigin:Cn||0,i=s-(Cn||s);for(let s=0;s<e.samples.length;s++){const a=e.samples[s];if(void 0===a.stackId){void 0===t&&(t=n,r.stacks[t]=[],n++),r.samples[s]={elapsed_since_start_ns:((a.timestamp+i-o)*Vf).toFixed(0),stack_id:t,thread_id:qf};continue}let c=e.stacks[a.stackId];const l=[];for(;c;){l.push(c.frameId);const t=e.frames[c.frameId];void 0===r.frames[c.frameId]&&(r.frames[c.frameId]={function:t.name,abs_path:"number"==typeof t.resourceId?e.resources[t.resourceId]:void 0,lineno:t.line,colno:t.column}),c=void 0===c.parentId?void 0:e.stacks[c.parentId]}const u={elapsed_since_start_ns:((a.timestamp+i-o)*Vf).toFixed(0),stack_id:n,thread_id:qf};r.stacks[n]=l,r.samples[s]=u,n++}return r}(e):e}function eg(e,t,n,r){if("transaction"!==r.type)throw new TypeError("Profiling events may only be attached to transactions, this should never occur.");if(null==n)throw new TypeError(`Cannot construct profiling event envelope without a valid profile. Got ${n} instead.`);const o=function(e){const t=e&&e.contexts&&e.contexts.trace&&e.contexts.trace.trace_id;return"string"==typeof t&&32!==t.length&&Pa&&Fe.log(`[Profiling] Invalid traceId: ${t} on profiled event`),"string"!=typeof t?"":t}(r),s=Zf(n),i=t||("number"==typeof r.start_timestamp?1e3*r.start_timestamp:Date.now()),a="number"==typeof r.timestamp?1e3*r.timestamp:Date.now();return{event_id:e,timestamp:new Date(i).toISOString(),platform:"javascript",version:"1",release:r.release||"",environment:r.environment||or,runtime:{name:"javascript",version:xa.navigator.userAgent},os:{name:Bf,version:Hf,build_number:zf},device:{locale:Xf,model:Yf,manufacturer:zf,architecture:Jf,is_emulator:!1},debug_meta:{images:rg(n.resources)},profile:s,transactions:[{name:r.transaction||"",id:r.event_id||ft(),trace_id:o,active_thread_id:qf,relative_start_ns:"0",relative_end_ns:(1e6*(a-i)).toFixed(0)}]}}function tg(e){return"pageload"===e.op}"object"==typeof(Qf=Kf)&&null!==Qf&&"getHighEntropyValues"in Qf&&Kf.getHighEntropyValues(["architecture","model","platform","platformVersion","fullVersionList"]).then((e=>{if(Bf=e.platform||"",Jf=e.architecture||"",Yf=e.model||"",Hf=e.platformVersion||"",e.fullVersionList&&e.fullVersionList.length>0){const t=e.fullVersionList[e.fullVersionList.length-1];zf=`${t.brand} ${t.version}`}})).catch((e=>{}));const ng=new WeakMap;function rg(e){const t=Ie._sentryDebugIds;if(!t)return[];const n=kr(),r=n&&n.getOptions(),o=r&&r.stackParser;if(!o)return[];let s;const i=ng.get(o);i?s=i:(s=new Map,ng.set(o,s));const a=Object.keys(t).reduce(((e,n)=>{let r;const i=s.get(n);i?r=i:(r=o(n),s.set(n,r));for(let o=r.length-1;o>=0;o--){const s=r[o],i=s&&s.filename;if(s&&i){e[i]=t[n];break}}return e}),{}),c=[];for(const t of e)t&&a[t]&&c.push({type:"sourcemap",code_file:t,debug_id:a[t]});return c}let og=!1;const sg=3e4;function ig(e){if(og)return Pa&&Fe.log("[Profiling] Profiling has been disabled for the duration of the current user session."),!1;if(!e.isRecording())return Pa&&Fe.log("[Profiling] Discarding profile because transaction was not sampled."),!1;const t=kr(),n=t&&t.getOptions();if(!n)return Pa&&Fe.log("[Profiling] Profiling disabled, no options found."),!1;const r=n.profilesSampleRate;if(!("number"!=typeof(o=r)&&"boolean"!=typeof o||"number"==typeof o&&isNaN(o)?(Pa&&Fe.warn(`[Profiling] Invalid sample rate. Sample rate must be a boolean or a number between 0 and 1. Got ${JSON.stringify(o)} of type ${JSON.stringify(typeof o)}.`),0):!0===o||!1===o||!(o<0||o>1)||(Pa&&Fe.warn(`[Profiling] Invalid sample rate. Sample rate must be between 0 and 1. Got ${o}.`),0)))return Pa&&Fe.warn("[Profiling] Discarding profile because of invalid sample rate."),!1;var o;if(!r)return Pa&&Fe.log("[Profiling] Discarding profile because a negative sampling decision was inherited or profileSampleRate is set to 0"),!1;return!!(!0===r||Math.random()<r)||(Pa&&Fe.log(`[Profiling] Discarding profile because it's not included in the random sample (sampling rate = ${Number(r)})`),!1)}function ag(e,t,n,r){return function(e){return e.samples.length<2?(Pa&&Fe.log("[Profiling] Discarding profile because it contains less than 2 samples"),!1):!!e.frames.length||(Pa&&Fe.log("[Profiling] Discarding profile because it contains no frames"),!1)}(n)?eg(e,t,n,r):null}const cg=new Map;function lg(e){const t=cg.get(e);return t&&cg.delete(e),t}function ug(e){let t;tg(e)&&(t=1e3*kn());const n=function(){const e=xa.Profiler;if("function"!=typeof e)return void(Pa&&Fe.log("[Profiling] Profiling is not supported by this browser, Profiler interface missing on window object."));const t=Math.floor(sg/10);try{return new e({sampleInterval:10,maxBufferSize:t})}catch(e){Pa&&(Fe.log("[Profiling] Failed to initialize the Profiling constructor, this is likely due to a missing 'Document-Policy': 'js-profiling' header."),Fe.log("[Profiling] Disabling profiling for current user session.")),og=!0}}();if(!n)return e;Pa&&Fe.log(`[Profiling] started profiling transaction: ${mr(e).description}`);const r=ft();async function o(){return e&&n?n.stop().then((t=>(s&&(xa.clearTimeout(s),s=void 0),Pa&&Fe.log(`[Profiling] stopped profiling of transaction: ${mr(e).description}`),t?(function(e,t){if(cg.set(e,t),cg.size>30){const e=cg.keys().next().value;cg.delete(e)}}(r,t),null):(Pa&&Fe.log(`[Profiling] profiler returned null profile for: ${mr(e).description}`,"this may indicate an overlapping transaction or a call to stopProfiling with a profile title that was never started"),null)))).catch((e=>(Pa&&Fe.log("[Profiling] error while stopping profiler:",e),null))):null}let s=xa.setTimeout((()=>{Pa&&Fe.log("[Profiling] max profile duration elapsed, stopping profiling for:",mr(e).description),o()}),sg);const i=e.end.bind(e);return e.end=function(){return e?(o().then((()=>{e.setContext("profile",{profile_id:r,start_timestamp:t}),i()}),(()=>{i()})),e):i()},e}const dg="BrowserProfiling",pg=()=>({name:dg,setupOnce(){},setup(e){const t=Cr().getTransaction();t&&tg(t)&&ig(t)&&ug(t),"function"==typeof e.on?(e.on("startTransaction",(e=>{ig(e)&&ug(e)})),e.on("beforeEnvelope",(e=>{if(!cg.size)return;const t=function(e){const t=[];return qn(e,((e,n)=>{if("transaction"===n)for(let n=1;n<e.length;n++){const r=e[n];r&&r.contexts&&r.contexts.profile&&r.contexts.profile.profile_id&&t.push(e[n])}})),t}(e);if(!t.length)return;const n=[];for(const e of t){const t=e&&e.contexts,r=t&&t.profile&&t.profile.profile_id,o=t&&t.profile&&t.profile.start_timestamp;if("string"!=typeof r){Pa&&Fe.log("[Profiling] cannot find profile for a transaction without a profile context");continue}if(!r){Pa&&Fe.log("[Profiling] cannot find profile for a transaction without a profile context");continue}t&&t.profile&&delete t.profile;const s=lg(r);if(!s){Pa&&Fe.log(`[Profiling] Could not retrieve profile for transaction: ${r}`);continue}const i=ag(r,o,s,e);i&&n.push(i)}!function(e,t){if(!t.length)return e;for(const n of t)e[1].push([{type:"profile"},n])}(e,n)}))):Fe.warn("[Profiling] Client does not support hooks, profiling will be disabled")}}),hg=zo(dg,pg);let fg={};xa.Sentry&&xa.Sentry.Integrations&&(fg=xa.Sentry.Integrations);const gg={...fg,...Bs,...zc};var mg=Object.freeze({__proto__:null,Integrations:gg,FunctionToString:Ms,Hub:Hr,InboundFilters:xs,ModuleMetadata:ws,SDK_VERSION:qr,SEMANTIC_ATTRIBUTE_SENTRY_OP:wo,SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN:Eo,SEMANTIC_ATTRIBUTE_SENTRY_SAMPLE_RATE:bo,SEMANTIC_ATTRIBUTE_SENTRY_SOURCE:To,Scope:Gr,addBreadcrumb:Ir,addEventProcessor:rs,addGlobalEventProcessor:ir,addIntegration:function(e){const t=kr();t&&t.addIntegration?t.addIntegration(e):rr&&Fe.warn(`Cannot add integration "${e.name}" because no SDK Client is available.`)},addTracingExtensions:Uo,captureEvent:Er,captureException:br,captureMessage:wr,captureSession:Nr,close:async function(e){const t=kr();return t?t.close(e):(rr&&Fe.warn("Cannot flush events and disable SDK. No client defined."),Promise.resolve(!1))},configureScope:function(e){Yr().configureScope(e)},continueTrace:({sentryTrace:e,baggage:t},n)=>{const r=Cr(),{traceparentData:o,dynamicSamplingContext:s,propagationContext:i}=function(e,t){const n=$n(e),r=Pn(t),{traceId:o,parentSpanId:s,parentSampled:i}=n||{};return n?{traceparentData:n,dynamicSamplingContext:r||{},propagationContext:{traceId:o||ft(),parentSpanId:s||ft().substring(16),spanId:ft().substring(16),sampled:i,dsc:r||{}}}:{traceparentData:n,dynamicSamplingContext:void 0,propagationContext:{traceId:o||ft(),spanId:ft().substring(16)}}}(e,t);r.setPropagationContext(i),rr&&o&&Fe.log(`[Tracing] Continuing trace ${o.traceId}.`);const a={...o,metadata:Ze({dynamicSamplingContext:s})};return n?Kr((()=>n(a))):a},createTransport:as,endSession:Or,extractTraceparentData:to,flush:async function(e){const t=kr();return t?t.flush(e):(rr&&Fe.warn("Cannot flush events. No client defined."),Promise.resolve(!1))},functionToStringIntegration:Ds,getActiveSpan:ho,getActiveTransaction:eo,getClient:kr,getCurrentHub:Yr,getCurrentScope:Cr,getHubFromCarrier:Qr,getSpanStatusFromHttpCode:so,inboundFiltersIntegration:Cs,isInitialized:function(){return!!kr()},lastEventId:function(){return Yr().lastEventId()},makeMain:zr,makeMultiplexedTransport:function(e,t){return n=>{const r=e(n),o=new Map;function s(t,r){const s=r?`${t}:${r}`:t;let i=o.get(s);if(!i){const a=Ve(t);if(!a)return;const c=qo(a,n.tunnel);i=r?function(e,t){return n=>{const r=e(n);return{...r,send:async e=>{const n=fs(e,["event","transaction","profile","replay_event"]);return n&&(n.release=t),r.send(e)}}}}(e,r)({...n,url:c}):e({...n,url:c}),o.set(s,i)}return[t,i]}return{send:async function(e){const n=t({envelope:e,getEvent:function(t){const n=t&&t.length?t:["event"];return fs(e,n)}}).map((e=>"string"==typeof e?s(e,void 0):s(e.dsn,e.release))).filter((e=>!!e));0===n.length&&n.push(["",r]);return(await Promise.all(n.map((([t,n])=>n.send(function(e,t){return Gn(t?{...e[0],dsn:t}:e[0],e[1])}(e,t))))))[0]},flush:async function(e){const t=[await r.flush(e)];for(const[,n]of o)t.push(await n.flush(e));return t.every((e=>e))}}}},metrics:Ws,moduleMetadataIntegration:bs,parameterize:function(e,...t){const n=new String(String.raw(e,...t));return n.__sentry_template_string__=e.join("\0").replace(/%/g,"%%").replace(/\0/g,"%s"),n.__sentry_template_values__=t,n},setContext:Ar,setCurrentClient:ss,setExtra:function(e,t){Yr().setExtra(e,t)},setExtras:function(e){Yr().setExtras(e)},setHttpStatus:ao,setMeasurement:$o,setTag:function(e,t){Yr().setTag(e,t)},setTags:function(e){Yr().setTags(e)},setUser:function(e){Yr().setUser(e)},spanStatusfromHttpCode:io,startInactiveSpan:po,startSession:xr,startSpan:uo,startSpanManual:function(e,t){const n=go(e);return Kr((()=>Rr(e.scope,(r=>{const o=Yr(),s=r.getSpan(),i=e.onlyIfParent&&!s?void 0:fo(o,{parentSpan:s,spanContext:n,forceTransaction:e.forceTransaction,scope:r});function a(){i&&i.end()}return co((()=>t(i,a)),(()=>{if(i&&i.isRecording()){const{status:e}=mr(i);e&&"ok"!==e||i.setStatus("internal_error")}}))}))))},startTransaction:function(e,t){return Yr().startTransaction({...e},t)},trace:function(e,t,n=(()=>{}),r=(()=>{})){const o=Yr(),s=Cr(),i=s.getSpan(),a=go(e),c=fo(o,{parentSpan:i,spanContext:a,forceTransaction:!1,scope:s});return s.setSpan(c),co((()=>t(c)),(e=>{c&&c.setStatus("internal_error"),n(e,c)}),(()=>{c&&c.end(),s.setSpan(i),r()}))},withActiveSpan:function(e,t){return Rr((n=>(n.setSpan(e),t(n))))},withIsolationScope:function(e){return Kr((()=>e(Xr())))},withScope:Rr,WINDOW:xa,BrowserClient:Ha,makeFetchTransport:za,makeXHRTransport:Xa,chromeStackLineParser:tc,defaultStackLineParsers:dc,defaultStackParser:pc,geckoStackLineParser:oc,opera10StackLineParser:cc,opera11StackLineParser:uc,winjsStackLineParser:ic,eventFromException:ja,eventFromMessage:Ga,exceptionFromError:Da,createUserFeedbackEnvelope:Ba,captureUserFeedback:function(e){const t=kr();t&&t.captureUserFeedback(e)},defaultIntegrations:Bc,forceLoad:function(){},getDefaultIntegrations:Hc,init:Jc,onLoad:function(e){e()},showReportDialog:(e={},t=Yr())=>{if(!xa.document)return void(Pa&&Fe.error("Global document not defined in showReportDialog call"));const{client:n,scope:r}=t.getStackTop(),o=e.dsn||n&&n.getDsn();if(!o)return void(Pa&&Fe.error("DSN not configured for showReportDialog call"));r&&(e.user={...r.getUser(),...e.user}),e.eventId||(e.eventId=t.lastEventId());const s=xa.document.createElement("script");s.async=!0,s.crossOrigin="anonymous",s.src=function(e,t){const n=We(e);if(!n)return"";const r=`${Go(n)}embed/error-page/`;let o=`dsn=${Ge(n)}`;for(const e in t)if("dsn"!==e&&"onClose"!==e)if("user"===e){const e=t.user;if(!e)continue;e.name&&(o+=`&name=${encodeURIComponent(e.name)}`),e.email&&(o+=`&email=${encodeURIComponent(e.email)}`)}else o+=`&${encodeURIComponent(e)}=${encodeURIComponent(t[e])}`;return`${r}?${o}`}(o,e),e.onLoad&&(s.onload=e.onLoad);const{onClose:i}=e;if(i){const e=t=>{if("__sentry_reportdialog_closed__"===t.data)try{i()}finally{xa.removeEventListener("message",e)}};xa.addEventListener("message",e)}const a=xa.document.head||xa.document.body;a?a.appendChild(s):Pa&&Fe.error("Not injecting report dialog. No injection point found in HTML")},wrap:function(e){return Na(e)()},Breadcrumbs:yc,breadcrumbsIntegration:mc,Dedupe:Sc,GlobalHandlers:Rc,globalHandlersIntegration:Ac,HttpContext:Nc,httpContextIntegration:Lc,LinkedErrors:Mc,linkedErrorsIntegration:Dc,TryCatch:jc,browserApiErrorsIntegration:Fc,Replay:Gp,getReplay:function(){const e=kr();return e&&e.getIntegrationByName&&e.getIntegrationByName("Replay")},replayIntegration:e=>new Gp(e),ReplayCanvas:Sh,replayCanvasIntegration:vh,Feedback:Zh,feedbackIntegration:e=>new Zh(e),sendFeedback:Oh,captureConsoleIntegration:tf,contextLinesIntegration:$f,debugIntegration:rf,dedupeIntegration:af,extraErrorDataIntegration:hf,httpClientIntegration:xf,reportingObserverIntegration:bf,rewriteFramesIntegration:Ef,sessionTimingIntegration:Af,BrowserTracing:class{constructor(e){this.name="BrowserTracing",this._hasSetTracePropagationTargets=!1,Uo(),Hs&&(this._hasSetTracePropagationTargets=!(!e||!e.tracePropagationTargets&&!e.tracingOrigins)),this.options={...Ta,...e},void 0!==this.options._experiments.enableLongTask&&(this.options.enableLongTask=this.options._experiments.enableLongTask),e&&!e.tracePropagationTargets&&e.tracingOrigins&&(this.options.tracePropagationTargets=e.tracingOrigins),this._collectWebVitals=ia(),this._interactionIdToRouteNameMapping={},this.options.enableInp&&la(this._interactionIdToRouteNameMapping,this.options.interactionsSampleRate),this.options.enableLongTask&&aa(),this.options._experiments.enableInteractions&&ca(),this._latestRoute={name:void 0,context:void 0}}setupOnce(e,t){this._getCurrentHub=t;const n=t().getClient(),r=n&&n.getOptions(),{routingInstrumentation:o,startTransactionOnLocationChange:s,startTransactionOnPageLoad:i,markBackgroundTransactions:a,traceFetch:c,traceXHR:l,shouldCreateSpanForRequest:u,enableHTTPTimings:d,_experiments:p}=this.options,h=r&&r.tracePropagationTargets,f=h||this.options.tracePropagationTargets;Hs&&this._hasSetTracePropagationTargets&&h&&Fe.warn("[Tracing] The `tracePropagationTargets` option was set in the BrowserTracing integration and top level `Sentry.init`. The top level `Sentry.init` value is being used."),o((e=>{const n=this._createRouteTransaction(e);return this.options._experiments.onStartRouteTransaction&&this.options._experiments.onStartRouteTransaction(n,e,t),n}),i,s),a&&ai(),p.enableInteractions&&this._registerInteractionListener(),this.options.enableInp&&this._registerInpInteractionListener(),ya({traceFetch:c,traceXHR:l,tracePropagationTargets:f,shouldCreateSpanForRequest:u,enableHTTPTimings:d})}_createRouteTransaction(e){if(!this._getCurrentHub)return void(Hs&&Fe.warn(`[Tracing] Did not create ${e.op} transaction because _getCurrentHub is invalid.`));const t=this._getCurrentHub(),{beforeNavigate:n,idleTimeout:r,finalTimeout:o,heartbeatInterval:s}=this.options,i="pageload"===e.op;let a;if(i){const t=i?ba("sentry-trace"):"",n=i?ba("baggage"):void 0,{traceId:r,dsc:o,parentSpanId:s,sampled:c}=Fn(t,n);a={traceId:r,parentSpanId:s,parentSampled:c,...e,metadata:{...e.metadata,dynamicSamplingContext:o},trimEnd:!0}}else a={trimEnd:!0,...e};const c="function"==typeof n?n(a):a,l=void 0===c?{...a,sampled:!1}:c;l.metadata=l.name!==a.name?{...l.metadata,source:"custom"}:l.metadata,this._latestRoute.name=l.name,this._latestRoute.context=l,!1===l.sampled&&Hs&&Fe.log(`[Tracing] Will not send ${l.op} transaction because of beforeNavigate.`),Hs&&Fe.log(`[Tracing] Starting ${l.op} transaction on scope`);const{location:u}=ii,d=Mo(t,l,r,o,!0,{location:u},s,i);return i&&ii.document&&(ii.document.addEventListener("readystatechange",(()=>{["interactive","complete"].includes(ii.document.readyState)&&d.sendAutoFinishSignal()})),["interactive","complete"].includes(ii.document.readyState)&&d.sendAutoFinishSignal()),d.registerBeforeFinishCallback((e=>{this._collectWebVitals(),da(e)})),d}_registerInteractionListener(){let e;const t=()=>{const{idleTimeout:t,finalTimeout:n,heartbeatInterval:r}=this.options,o="ui.action.click",s=eo();if(s&&s.op&&["navigation","pageload"].includes(s.op))return void(Hs&&Fe.warn(`[Tracing] Did not create ${o} transaction because a pageload or navigation transaction is in progress.`));if(e&&(e.setFinishReason("interactionInterrupted"),e.end(),e=void 0),!this._getCurrentHub)return void(Hs&&Fe.warn(`[Tracing] Did not create ${o} transaction because _getCurrentHub is invalid.`));if(!this._latestRoute.name)return void(Hs&&Fe.warn(`[Tracing] Did not create ${o} transaction because _latestRouteName is missing.`));const i=this._getCurrentHub(),{location:a}=ii,c={name:this._latestRoute.name,op:o,trimEnd:!0,data:{[To]:this._latestRoute.context?wa(this._latestRoute.context):"url"}};e=Mo(i,c,t,n,!0,{location:a},r)};["click"].forEach((e=>{ii.document&&addEventListener(e,t,{once:!1,capture:!0})}))}_registerInpInteractionListener(){const e=({entries:e})=>{const t=kr(),n=void 0!==t&&void 0!==t.getIntegrationByName?t.getIntegrationByName("Replay"):void 0,r=void 0!==n?n.getReplayId():void 0,o=eo(),s=Cr(),i=void 0!==s?s.getUser():void 0;e.forEach((e=>{if(function(e){return"duration"in e}(e)){const t=e.interactionId;if(void 0===t)return;const n=this._interactionIdToRouteNameMapping[t],s=e.duration,a=e.startTime,c=Object.keys(this._interactionIdToRouteNameMapping),l=c.length>0?c.reduce(((e,t)=>this._interactionIdToRouteNameMapping[e].duration<this._interactionIdToRouteNameMapping[t].duration?e:t)):void 0;if("first-input"===e.entryType){if(c.map((e=>this._interactionIdToRouteNameMapping[e])).some((e=>e.duration===s&&e.startTime===a)))return}if(!t)return;if(n)n.duration=Math.max(n.duration,s);else if(c.length<10||void 0===l||s>this._interactionIdToRouteNameMapping[l].duration){const e=this._latestRoute.name,n=this._latestRoute.context;e&&n&&(l&&Object.keys(this._interactionIdToRouteNameMapping).length>=10&&delete this._interactionIdToRouteNameMapping[l],this._interactionIdToRouteNameMapping[t]={routeName:e,duration:s,parentContext:n,user:i,activeTransaction:o,replayId:r,startTime:a})}}}))};Gi("event",e),Gi("first-input",e)}},browserTracingIntegration:(e={})=>{const t=!!Hs&&!(!e.tracePropagationTargets&&!e.tracingOrigins);Uo(),!e.tracePropagationTargets&&e.tracingOrigins&&(e.tracePropagationTargets=e.tracingOrigins);const n={...Ea,...e},r=ia(),o={};n.enableInp&&la(o,n.interactionsSampleRate),n.enableLongTask&&aa(),n._experiments.enableInteractions&&ca();const s={name:void 0,context:void 0};function i(e){const t=Yr(),{beforeStartSpan:o,idleTimeout:i,finalTimeout:a,heartbeatInterval:c}=n,l="pageload"===e.op;let u;if(l){const t=l?Ra("sentry-trace"):"",n=l?Ra("baggage"):void 0,{traceId:r,dsc:o,parentSpanId:s,sampled:i}=Fn(t,n);u={traceId:r,parentSpanId:s,parentSampled:i,...e,metadata:{...e.metadata,dynamicSamplingContext:o},trimEnd:!0}}else u={trimEnd:!0,...e};const d=o?o(u):u;d.metadata=d.name!==u.name?{...d.metadata,source:"custom"}:d.metadata,s.name=d.name,s.context=d,!1===d.sampled&&Hs&&Fe.log(`[Tracing] Will not send ${d.op} transaction because of beforeNavigate.`),Hs&&Fe.log(`[Tracing] Starting ${d.op} transaction on scope`);const{location:p}=ii,h=Mo(t,d,i,a,!0,{location:p},c,l);return l&&ii.document&&(ii.document.addEventListener("readystatechange",(()=>{["interactive","complete"].includes(ii.document.readyState)&&h.sendAutoFinishSignal()})),["interactive","complete"].includes(ii.document.readyState)&&h.sendAutoFinishSignal()),h.registerBeforeFinishCallback((e=>{r(),da(e)})),h}return{name:"BrowserTracing",setupOnce:()=>{},afterAllSetup(e){const r=e.getOptions(),{markBackgroundSpan:a,traceFetch:c,traceXHR:l,shouldCreateSpanForRequest:u,enableHTTPTimings:d,_experiments:p}=n,h=r&&r.tracePropagationTargets,f=h||n.tracePropagationTargets;let g;Hs&&t&&h&&Fe.warn("[Tracing] The `tracePropagationTargets` option was set in the BrowserTracing integration and top level `Sentry.init`. The top level `Sentry.init` value is being used.");let m=ii.location&&ii.location.href;if(e.on&&(e.on("startNavigationSpan",(e=>{g&&(Hs&&Fe.log(`[Tracing] Finishing current transaction with op: ${mr(g).op}`),g.end()),g=i({op:"navigation",...e})})),e.on("startPageLoadSpan",(e=>{g&&(Hs&&Fe.log(`[Tracing] Finishing current transaction with op: ${mr(g).op}`),g.end()),g=i({op:"pageload",...e})}))),n.instrumentPageLoad&&e.emit&&ii.location){const t={name:ii.location.pathname,startTimestamp:Cn?Cn/1e3:void 0,origin:"auto.pageload.browser",attributes:{[To]:"url"}};Ia(e,t)}n.instrumentNavigation&&e.emit&&ii.location&&Ht((({to:t,from:n})=>{if(void 0===n&&m&&-1!==m.indexOf(t))m=void 0;else if(n!==t){m=void 0;const t={name:ii.location.pathname,origin:"auto.navigation.browser",attributes:{[To]:"url"}};Aa(e,t)}})),a&&ai(),p.enableInteractions&&function(e,t){let n;const r=()=>{const{idleTimeout:r,finalTimeout:o,heartbeatInterval:s}=e,i="ui.action.click",a=eo();if(a&&a.op&&["navigation","pageload"].includes(a.op))return void(Hs&&Fe.warn(`[Tracing] Did not create ${i} transaction because a pageload or navigation transaction is in progress.`));if(n&&(n.setFinishReason("interactionInterrupted"),n.end(),n=void 0),!t.name)return void(Hs&&Fe.warn(`[Tracing] Did not create ${i} transaction because _latestRouteName is missing.`));const{location:c}=ii,l={name:t.name,op:i,trimEnd:!0,data:{[To]:t.context?Ca(t.context):"url"}};n=Mo(Yr(),l,r,o,!0,{location:c},s)};["click"].forEach((e=>{ii.document&&addEventListener(e,r,{once:!1,capture:!0})}))}(n,s),n.enableInp&&function(e,t){const n=({entries:n})=>{const r=kr(),o=void 0!==r&&void 0!==r.getIntegrationByName?r.getIntegrationByName("Replay"):void 0,s=void 0!==o?o.getReplayId():void 0,i=eo(),a=Cr(),c=void 0!==a?a.getUser():void 0;n.forEach((n=>{if(function(e){return"duration"in e}(n)){const r=n.interactionId;if(void 0===r)return;const o=e[r],a=n.duration,l=n.startTime,u=Object.keys(e),d=u.length>0?u.reduce(((t,n)=>e[t].duration<e[n].duration?t:n)):void 0;if("first-input"===n.entryType){if(u.map((t=>e[t])).some((e=>e.duration===a&&e.startTime===l)))return}if(!r)return;if(o)o.duration=Math.max(o.duration,a);else if(u.length<ka||void 0===d||a>e[d].duration){const n=t.name,o=t.context;n&&o&&(d&&Object.keys(e).length>=ka&&delete e[d],e[r]={routeName:n,duration:a,parentContext:o,user:c,activeTransaction:i,replayId:s,startTime:l})}}}))};Gi("event",n),Gi("first-input",n)}(o,s),ya({traceFetch:c,traceXHR:l,tracePropagationTargets:f,shouldCreateSpanForRequest:u,enableHTTPTimings:d})},options:n}},defaultRequestInstrumentationOptions:ma,instrumentOutgoingRequests:ya,startBrowserTracingNavigationSpan:Aa,startBrowserTracingPageLoadSpan:Ia,makeBrowserOfflineTransport:function(e){return function(e){return t=>e({...t,createStore:Gf})}(hs(e))},onProfilingStartRouteTransaction:function(e){return e?ig(e)?ug(e):e:(Pa&&Fe.log("[Profiling] Transaction is undefined, skipping profiling"),e)},BrowserProfilingIntegration:hg,browserProfilingIntegration:pg});const yg=()=>{let e=navigator.languages?navigator.languages[0].substr(0,2).toUpperCase():"EN";var t;e="EN"===(t=e)?"EN-GB":"PT"===t?"PT-PT":t;return s.map((e=>e.langCode)).includes(e)?e:"EN"},_g=()=>{const e={};return s.forEach((t=>{let n=t.langCode;["EN-GB","EN-US"].includes(n)&&(n="EN"),["PT-PT","PT-BR"].includes(n)&&(n="PT"),["ZH-HANT"].includes(n)&&(n="ZH"),e[n]=0})),e},vg=e=>e.substring(0,2).toUpperCase();const Sg=e=>{let t=s.find((t=>t.langCode.toUpperCase()===e.toUpperCase()));return t||(t=s.find((t=>t.langCode.substring(0,2).toUpperCase()===e.substring(0,2).toUpperCase())),t)};function Tg(e,t){const n=["EN-US","EN-GB","PT-PT","PT-BR","ZH-HANT"].includes(e?.toUpperCase());let r,o=e?.toUpperCase();return n&&(o=e?.toUpperCase().slice(0,2),r=t||function(e){const t=e.split("-");if(2===t.length)return t[0].toLowerCase()+"-"+t[1].toUpperCase();return e}(e?.toUpperCase())),{langCode:o,regionalVariant:r}}function bg(e){return s.find((t=>t.langCode===e.toUpperCase())).langCodeForIta}const wg=()=>({settingSchemeVersion:41,blacklistDomains:[],blacklistDomainsForReading:[],blacklistDomainsForWriting:[],languagesForTranslation:s.reduce(((e,t)=>({...e,[t.langCode]:c})),{}),selectedTargetLanguage:yg(),isTargetLanguageConfirmed:!1,deepLProApiKey:{IS_PROD:!0,BASE_URLS:{dapApi:"https://s.deepl.com/chrome/statistics",toolingApiPro:"https://api.deepl.com/jsonrpc?client=chrome-extension,1.28.2",toolingApi:"https://www2.deepl.com/jsonrpc?client=chrome-extension,1.28.2",toolingWriteApiPro:"https://write-pro.www.deepl.com/jsonrpc?client=chrome-extension,1.28.2",toolingWriteApi:"https://write-free.www.deepl.com/jsonrpc?client=chrome-extension,1.28.2",classicApi:"https://www2.deepl.com/jsonrpc?client=chrome-extension,1.28.2",classicApiPro:"https://api.deepl.com/jsonrpc?client=chrome-extension,1.28.2",classicApiWrite:"https://write-free.www.deepl.com/jsonrpc?client=chrome-extension,1.28.2",classicApiWritePro:"https://write-pro.www.deepl.com/jsonrpc?client=chrome-extension,1.28.2",classicApiGlossary:"https://api.deepl.com/termbases/jsonrpc?client=chrome-extension,1.28.2",login:"https://www.deepl.com/auth/login",token:"https://w.deepl.com/oidc/token",logout:"https://www.deepl.com/auth/logout",feedbackSurvey:"https://deepl.typeform.com/to/MkMfP2Y6",newFeedbackSurvey:"https://deepl.qualtrics.com/jfe/form/SV_cMvbeX0WZGvkKGi",firefoxFeedbackSurvey:"https://deepl.qualtrics.com/jfe/form/SV_eyfDZqQmXuNTFOK",uninstallSurvey:"https://deepl.qualtrics.com/jfe/form/SV_eJxAD8c7J5hqSRU",gslidesFeedbackSurvey:"https://deepl.qualtrics.com/jfe/form/SV_9XBLSAbDmLq5emO",deeplPro:"https://www.deepl.com/pro",deeplProWrite:"https://www.deepl.com/pro-write",deeplTranslator:"https://www.deepl.com/translator",deeplDoctrans:"https://www.deepl.com/translator/files",deeplTermsOfServiceFree:"https://www.deepl.com/en/pro-license?tab=free",deeplCreateAccount:"https://www.deepl.com/signup",extensionStorePage:"https://bit.ly/DeepL-Chrome",supportArticle:"https://support.deepl.com/hc/articles/4407580229522",deeplSupport:"https://support.deepl.com/hc",chromeWebstore:"https://chrome.google.com/webstore/detail/deepl-translate-reading-w/cofdbpoegempjloogbagkncekinflcnj",edgeWebstore:"https://microsoftedge.microsoft.com/addons/detail/deepl-translate-reading-/fancfknaplihpclbhbpclnmmjcjanbaf",firefoxWebstore:"https://addons.mozilla.org/en-US/firefox/addon/deepl-translate",firefoxShortcutDocs:"https://support.mozilla.org/kb/manage-extension-shortcuts-firefox",firefoxPrivacyPolicy:"https://addons.mozilla.org/en-US/firefox/addon/deepl-translate/privacy/",clientStateApi:"https://w.deepl.com/web",experimentsEndpoint:"https://experimentation.deepl.com/experiments",gmailFeedbackSurvey:"https://deepl.qualtrics.com/jfe/form/SV_db8ItFTmYBcZjYW",customerSegmentationSurveyFree:"https://deepl.qualtrics.com/jfe/form/SV_3LbBcdg4mjQuCCq?desc=TG-2071",customerSegmentationSurveyPro:"https://deepl.qualtrics.com/jfe/form/SV_3LbBcdg4mjQuCCq?desc=TG-2070",arabicSurvey:"https://deepl.qualtrics.com/jfe/form/SV_ekTrC2ePp0wn7xQ",msAddinsDeepLAds:"https://www.deepl.com/en/microsoft-365"},APP_VERSION:"1.28.2",FEATURE_FLAGS:{TRANSLATE_INPUT:!0,PAGE_TRANSLATION:!0,IMPROVE_WRITING:!0,DOCUMENT_TRANSLATION:!0,RECOMMEND_TO_A_FRIEND:!0,PRO_LOGIN:!0,WEBPAGE_CUSTOMIZER:!0,GDOCS_INTEGRATION:!0,ZENDESK_INTEGRATION:!0,GMAIL_INTEGRATION:!0,GSLIDES_INTEGRATION:!0,ON_INSTALL_ONBOARDING:!0,WHATSAPP_TRANSLATE_ALL_CHAT:!1,DEEPL_WRITE_GENERAL:!1,DEEPL_WRITE_GDOCS:!0,SHOW_CUSTOMER_SEGMENTATION_SURVEY:!1,ARABIC_SURVEY:!0,REVIEW_UI_WITH_ITA:!1,BATCH_TRANSLATE_HTML_REQUEST:!1}}.DEEPL_PRO_API_KEY,installationId:n(),enableFullPageTranslation:!0,enableInputTranslation:!0,enableInlineTranslation:!0,languagePreferenceForWriting:_g(),languagePreferenceForReading:_g(),languagePreferenceForDeeplWrite:"EN-US",blacklistedPopupWidgets:[],successfulTranslations:0,successfulArabicTranslations:0,isReviewPopupShown:!1,shouldDisplayFeedbackPopup:!1,isInputHighlighterShown:!1,isInlineHighlighterShown:!1,regionalVariant:void 0,isSurveyLinkHidden:!1,isGlossaryEnabled:!1,activeTermbaseId:null,isZendeskOnboarded:!1,isZendeskEnabled:!0,isZendeskOnboardingShown:!1,zendeskFormality:"auto",zendeskSuccessfulTranslations:0,zendeskActiveTermbase:null,isGDocsEnabled:!0,isGDocsOnboardingShown:!1,gDocsSegmentation:V.SENTENCE,gDocsWriteLang:null,isGmailEnabled:!0,wasGmailOnboardingShown:!1,successfulTranslationsGmail:0,wasGmailFeedbackPopupShown:!1,isGSlidesEnabled:!0,isGSlidesOnboardingShown:!1,wasGSlidesFeedbackPopupShown:!1,successfulTranslationsGSlides:0,isWhatsAppWebEnabled:!0,isTwitterEnabled:!0,isYoutubeEnabled:!0,customizationsActiveStates:{[k.linkedIn]:!0},hasUserSeenAccountCreationNudge:!1,hasUserSeenPostAccountCreationOnboarding:!1,hasUserSeenProCustomerSegmentationSurvey:!1,firefoxAnonPermissionGranted:!0,firefoxPersonalPermissionGranted:!1,enableItaDev:!1}),Eg={prod:"production",dev:"development",test:"testing"};function Ig(){return Eg.prod}function Ag(){return Ig()===Eg.dev}function Rg(){return Ig()===Eg.prod}function kg(){}function Cg(e){return e()}const xg=[];function Og(e,t=kg){let n;const r=new Set;function o(t){if(s=t,((o=e)!=o?s==s:o!==s||o&&"object"==typeof o||"function"==typeof o)&&(e=t,n)){const t=!xg.length;for(const t of r)t[1](),xg.push(t,e);if(t){for(let e=0;e<xg.length;e+=2)xg[e][0](xg[e+1]);xg.length=0}}var o,s}function s(t){o(t(e))}return{set:o,update:s,subscribe:function(i,a=kg){const c=[i,a];return r.add(c),1===r.size&&(n=t(o,s)||kg),i(e),()=>{r.delete(c),0===r.size&&n&&(n(),n=null)}}}}const Lg=function(){const{subscribe:e,set:t,update:n}=Og({});return chrome.storage.sync.get(null,(e=>{t(e),chrome.storage.local.get(["isLoggedIn","isProUser","translatorServiceType","writeServiceType","apiServiceType","docTranslatorServiceType","browserInstanceId","featureSet","hasTermbaseService"],(e=>{n((t=>({...t,...e})))}))})),chrome.storage.onChanged.addListener((e=>{const t=["a_t","r_t","i_t","accountId"];let r={};for(const[n,o]of Object.entries(e))!1===t.includes(n)&&(r[n]=o.newValue);if(Ag()){const e="background-color: #324054;padding: 3px; font-size:12px;color:#e1e8c3; font-weight:600";console.log(`%c${(new Date).toISOString()} UPDATE USER SETTINGS`,e,r)}return n((e=>({...e,...r}))),!0})),{subscribe:e,set:e=>chrome.storage.sync.set(e)}}(),Ng=function(){const{subscribe:e,update:t}=Og({});return chrome.runtime.onMessage.addListener((function(e,n){switch(e.action){case"newWebsiteState":e.payload&&t((t=>({...t,[n.tab.id]:{...t[n.tab.id],...e.payload,error:e.payload.error?e.payload.error:void 0}})));break;case"resetWebsiteState":e.payload&&t((t=>({...t,[n.tab.id]:{...e.payload}})))}return!0})),{subscribe:e,fetchCurrentWebsiteSettings:()=>{chrome.tabs&&chrome.tabs.query({active:!0,currentWindow:!0},(function(e){chrome.tabs.sendMessage(e[0].id,{action:"dlGetWebsiteData"},(function(n){t((t=>({...t,[e[0].id]:{...t[e[0].id],...n}})))}))}))}}}();!function(e,t,n){const r=!Array.isArray(e),o=r?[e]:e;if(!o.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const s=t.length<2;return i=(e,n)=>{let i=!1;const a=[];let c=0,l=kg;const u=()=>{if(c)return;l();const o=t(r?a[0]:a,e,n);s?e(o):l="function"==typeof o?o:kg},d=o.map(((e,t)=>function(e,...t){if(null==e){for(const e of t)e(void 0);return kg}const n=e.subscribe(...t);return n.unsubscribe?()=>n.unsubscribe():n}(e,(e=>{a[t]=e,c&=~(1<<t),i&&u()}),(()=>{c|=1<<t}))));return i=!0,u(),function(){d.forEach(Cg),l(),i=!1}},{subscribe:Og(n,i).subscribe};var i}(Ng,(async(e,t)=>{if(!chrome.tabs)return;t(e[(await chrome.tabs.query({active:!0,currentWindow:!0}))[0].id])})),function(){const{subscribe:e,set:t}=Og([]);var n;(n={action:"dlGetExperiments",payload:{forceFetch:!1}},new Promise(((e,t)=>{chrome.runtime.sendMessage(n,(function(n){n&&n.error&&t(n),e(n)}))}))).then((e=>t(e))),chrome.runtime.onMessage.addListener((function(e){if("dlExperimentsUpdated"===e.action)e.payload&&t(e.payload.experiments);return!0}))}();const Pg=(e,t)=>((e,t)=>{if(!e)throw new Error("No settings supplied to getServiceType");if(!Object.keys(P).includes(t))throw new Error("Unidentified service name supplied to getServiceType");if(!e.isLoggedIn)return D.free;switch(t){case P.TRANSLATOR:return e.translatorServiceType;case P.WRITE:return e.writeServiceType;case P.API:return e.apiServiceType;case P.DOC_TRANSLATOR:return e.docTranslatorServiceType}})(e,t)===D.pro,Dg=e=>e.isLoggedIn&&e.hasTermbaseService,Mg=e=>!![/Receiving end does not exist/,/message channel closed before a response was received/,/Extension context invalidated/].some((t=>t.test(e))),Ug={dsn:"https://f7c23f019d154c319e91e8de004727dc@errortracking.deepl.com/12",release:"deepl-browser-extension@1.28.2",environment:Ig(),tracesSampleRate:Rg()?.1:1,sampleRate:Rg()?.1:1,ignoreErrors:[/Receiving end does not exist/,/message channel closed before a response was received/,/Extension context invalidated/],beforeSend(e){const t=e.message||e.exception&&e.exception.values&&e.exception.values[0].value||"";return Mg(t)?null:e}};function $g(e,t){t.captureException(e)}const Fg={PROTOCOL_ERROR:"PROTOCOL_ERROR",NETWORK_ERROR:"NETWORK_ERROR",FULL_PAGE_SERVER_ERROR:"FULL_PAGE_SERVER_ERROR",USER_UNAUTHORIZED:"-32003",USER_BLOCKED:"429",FORBIDDEN_REQUEST:"403",QUOTA_HAS_BEEN_REACHED:"1045601",TOO_MANY_REQUESTS:"1042902"},jg={ENTRY_NOT_FOUND:"ENTRY_NOT_FOUND",SERVER_ERROR:"SERVER_ERROR"},Gg="INSTALLATION_ERROR",Vg="TRANSLATED_INPUT_NOT_SET",qg="TRANSLATOR_FREE_ACCOUNT_LIMIT_EXCEEDED",Wg="TRANSLATOR_ANONYMOUS_LIMIT_EXCEEDED",Bg="TRANSLATOR_FREE_ANON_WITH_WRITE_PRO",Hg="WRITE_ANON_OR_FREE_LIMIT_EXCEEDED",Jg="WRITE_WITH_PRO_TRANSLATOR_LIMIT_EXCEEDED";class zg extends Error{constructor(e){super(e),this.name=Fg.PROTOCOL_ERROR,this.message=e}}class Yg extends Error{constructor(e){super(e),this.name=Fg.FULL_PAGE_SERVER_ERROR,this.message=e}}class Xg extends Error{constructor(e,t){super(t),this.name=e,this.message=t}}class Kg extends Error{constructor(e,t){super(t),this.name=qg,this.limit=e,this.message=t}}class Qg extends Error{constructor(e,t){super(t),this.name=Wg,this.limit=e,this.message=t}}class Zg extends Error{constructor(e,t){super(t),this.name=Hg,this.limit=e,this.message=t}}class em extends Error{constructor(e,t){super(t),this.name=Jg,this.limit=e,this.message=t}}class tm extends Error{constructor(e,t){super(t),this.name=Bg,this.limit=e,this.message=t}}class nm extends Error{constructor(e,t){super(t),this.name=e,this.message=t}}function rm(e,t){try{$g(e,t),console.error(e)}catch(e){console.error(e)}return{error:e.name}}function om(){return{url:"https://s.deepl.com/chrome/statistics"}}function sm(e){switch(e){case l.manual:return 1;case l.automatic:return 2;case l.inline:return 3;case l.input:return 4;case l.input_alternatives:return 5;default:return 0}}function im(e){switch(e){case jg.ENTRY_NOT_FOUND:return 1;case jg.SERVER_ERROR:return 2}}function am(e){switch(e){case h.defaultPopup:return f.extensionIcon;case h.fptInjectedPopup:return f.fptAutoInject;default:return 0}}function cm(e){switch(e){case h.defaultPopup:return g.defaultPopup;case h.fptInjectedPopup:return g.injectedFptPopup;case h.inlineTooltipPopup:return g.inlinePopup;default:return 0}}function lm(e){return e===m.hintKeyboardShortcut?1:0}function um(e){switch(e){case y.inputTranslationTriggerIcon:return 1;case y.inlineTranslationTriggerIcon:return 2;case y.inlineTranslationSettingPopup:return 3;case y.inputTranslationSettingPopup:return 4;case y.settingsPageFPT:return 5;case y.settingsPageReading:return 6;case y.settingsPageWriting:return 7;case y.fptHideModal:return 8;case y.inputTranslationSettingsIcon:return 9;case y.inlineTranslationSettingsIcon:return 10;case y.inputTranslationReadMoreLink:return 11;case y.inlineTranslationReadMoreLink:return 12;case y.fptTranslationReadMoreLink:return 13;case y.extensionHubToggleSwitch:return 14;case y.hubCustomizeShortcut:return 15;case y.hubLoginButton:return 16;case y.hubUpgradeToProLink:return 17;case y.hubTryProLink:return 18;case y.settingsPageCustomizeShortcutButton:return 19;case y.hubFPTEnableCheckbox:return 20;case y.hubFPTDisableCheckbox:return 21;case y.deeplWriteIcon:return 22;case y.hubViewIntegrations:return 23;case y.hubCloseCustomizationsWidget:return 24;case y.gmailOnboardingPopup:return 25;case y.gmailOnboardingIcon:return 26;case y.gmailCharLimitLogin:return 27;case y.gmailFeedbackSurvey:return 28;case y.gslidesFeedbackSurvey:return 29;case y.gslidesCharLimitLogin:return 30;case y.zendeskTryProLink:return 31;case y.settingsPageIntegrations:return 32;case y.onboardingSignUp:return 33;case y.onboardingSkipSignUp:return 34;case y.onboardingLoginLink:return 35;case y.onboardingSeeAllIntegrations:return 36;case y.inputImproveTriggerIcon:return 37;case y.iconToggleInHubTranslator:return 38;case y.iconToggleInHubWrite:return 39;case y.manageIconSettings:return 40;case y.writeLanguageSwitchedInHub:return 41;case y.writeLanguageSwitchedInSettings:return 42;default:return 0}}function dm(e){return e===_.triggerTranslation?1:0}function pm(e){switch(e){case v.clickOnShortcutNotifiction:return 60011;case v.clickOnInlineTranslationShowAlternatives:return 60026;case v.clickOnInlineTranslationCloseIcon:return 60027;case v.clickOnLogoutMenuEntry:return 60028;default:return 0}}function hm(e){switch(e){case T.inputTranslation:return 1;case T.inlineTranslation:return 2;case T.fullPageTranslation:return 3;default:return 0}}function fm(e){switch(e){case S.disableEverywhere:return 1;case S.disablePerSite:return 2;case S.enableEverywhere:return 3;case S.enablePerSite:return 4;default:return 0}}function gm(e){switch(e){case"top":return b.top;case"right":return b.right;case"bottom":return b.bottom;case"left":return b.left;default:return 0}}function mm(e){switch(e){case X.shortcut_settings:return K.SHORTCUT_SETTINGS;case X.support_article:return K.SUPPORT_ARTICLE;case X.external.whatsapp:return K.EXTERNAL.WHATSAPP;case X.external.twitter:return K.EXTERNAL.TWITTER;case X.external.youtube:return K.EXTERNAL.YOUTUBE;case X.external.facebook:return K.EXTERNAL.FACEBOOK;case X.external.github:return K.EXTERNAL.GITHUB;case X.external.discord:return K.EXTERNAL.DISCORD;case X.external.telegram:return K.EXTERNAL.TELEGRAM;case X.external.reddit:return K.EXTERNAL.REDDIT;case X.external.gmail:return K.EXTERNAL.GMAIL;case X.external.gdocs:return K.EXTERNAL.GDOCS;case X.external.gslides:return K.EXTERNAL.GSLIDES;case X.external.msOffice:return K.EXTERNAL.MSOFFICE;default:return""}}function ym(e){switch(e){case w.openPage:return 1;case w.backButton:return 2;case w.nextButton:return 3;case w.navigation:return 4;default:return 0}}function _m(e){switch(e){case I.chrome:return E.chrome;case I.edge:return E.edge;case I.firefox:return E.firefox;case I.local:return E.local;default:return E.unspecified}}function vm(e){return A[e]||0}function Sm(e){switch(e){case k.default:return 1;case k.gdocs:return 2;case k.whatsappWeb:return 3;case k.twitter:return 4;case k.zendesk:return 5;case k.gmail:return 6;case k.gslides:return 7;case k.linkedIn:return 8;case k.youtube:return 9;default:return 0}}function Tm(e){switch(e){case W.simple:return 1;case W.business:return 2;case W.academic:return 3;case W.casual:return 4;case W.enthusiastic:return 5;case W.friendly:return 6;case W.confident:return 7;case W.diplomatic:return 8;default:return 0}}function bm(e){switch(e){case 60026:case 60027:return!0;default:return!1}}function wm(e){switch(e){case x.user:return 1;case x.extension:return 2;default:return 0}}function Em(e){switch(e){case L.translation:return 1;case L.login:return 2;default:return 0}}function Im(e){switch(e){case N.message:return 1;case N.chat:return 2;default:return 0}}function Am(e){switch(e){case D.free:return 1;case D.pro:return 2;case D.none:return 3;default:return 0}}function Rm(e){switch(e){case F.READING_VIEW_TRANSLATE:return 1;case F.COMPOSE_VIEW_TRANSLATE:return 2;case F.COMPOSE_VIEW_IMPROVE:return 3;default:return 0}}function km(e){switch(e){case j.ANONYMOUS_USER_LIMIT_EXCEEDED:return 1;case j.FREE_ACCOUNT_LIMIT_EXCEEDED:return 2;case j.WRITE_ANONYMOUS_USER_LIMIT_EXCEEDED:return 3;case j.WRITE_FREE_ACCOUNT_LIMIT_EXCEEDED:return 4;default:return 0}}function Cm(e){switch(e){case C.translate:return 1;case C.write:return 2;default:return 0}}function xm(e){switch(e){case G.LOGIN:return 1;case G.SIGNUP:return 2;case G.PRO_TRIAL:return 3;default:return 0}}function Om(e){switch(e){case V.WORD:return 1;case V.SENTENCE:return 2;default:return 0}}function Lm(e){switch(e){case q.none:return 1;case q.pro:return 2;case q.free:return 3;default:return 0}}const Nm=["accountData","domainName"],Pm=[60067,60068,60069],Dm=(e,t)=>e&&"object"==typeof e?Array.isArray(e)?e.map((e=>Dm(e,t))):Object.keys(e).reduce(((n,r)=>(t.includes(r)||(n[r]=Dm(e[r],t)),n)),{}):e,Mm=(e,t=!1,n=!1)=>e?n&&t?e:!n&&Pm.includes(e?.eventId)?null:Dm(e,Nm):null,Um=(e=!1,t=!1)=>!(!e&&!t)&&(!(!e&&t)&&(!(!e||t)||(!(!e||!t)||void 0)));async function $m(e){let t,n,r,o,s,i,a,c,l,d,p,h=!1;try{const e=await f_(["session","installationId","firefoxAnonPermissionGranted","firefoxPersonalPermissionGranted"]);n=e.session.id,t=e.installationId,d=e.firefoxAnonPermissionGranted,p=e.firefoxPersonalPermissionGranted}catch(e){console.error(`DAP: Failed to fetch settings. Error: ${e.message}`)}try{const e=await k_();h=!!e.accountId,r=Am(e.translatorServiceType),o=Am(e.apiServiceType),s=Am(e.docTranslatorServiceType),l=Am(e.writeServiceType),a=h?2===r||2===o||2===l||2===s?u.loggedInPro:u.loggedInFree:u.notLoggedIn,c=e.sessionType?Lm(e.sessionType):Lm(q.none)}catch(e){console.error(`DAP: Failed to fetch user information. Error: ${e.message}`)}try{i=await x_()}catch(e){console.error(e)}const f=z(),g=await L_();let m;try{m=await O_()}catch(e){console.error(e)}const y={eventId:void 0,extensionVersion:"1.28.2",sessionId:n,sessionType:c,installationId:t,browserInstanceId:i,originStore:_m(chrome.runtime.id),userInfos:{...m&&{accountData:{accountId:m}},userType:a,translatorServiceType:r,apiServiceType:o,docTranslatorServiceType:s,writeServiceType:l},userAgent:f.userAgent,platform:f.platform,browser:f.browser,browserVersion:f.browserVersion,browserLang:f.browserLang,clientExperiments:g};let _=e?e(y):y;if(Y()){if(!Um(d,p))return;if(_=Mm(_,d,p),!_)return}return fetch("https://s.deepl.com/chrome/statistics",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(_),credentials:"omit"}).then((e=>{e.ok||console.log(`DAP ${_.eventId} request failed: ${e}`)}))}async function Fm(e){return $m((t=>({...t,eventId:60001,translationRequestData:{extensionVersion:"1.28.2",domainName:e.domainName,userId:e.installationId,translationTrigger:sm(e.trigger),translationData:{sourceLang:e.websiteLanguage,targetLang:e.targetLanguage,sourceLength:e.characterCount},...e.translationPerformance&&{translationPerformance:e.translationPerformance},nicheIntegration:Sm(e.nicheIntegration||k.default),...e.glossaryTrackingInfo&&{isGlossaryEnabled:e.glossaryTrackingInfo.isGlossaryEnabled,isGlossaryShared:e.glossaryTrackingInfo.isGlossaryShared,didGlossaryChangeTranslation:e.glossaryTrackingInfo.didGlossaryChangeTranslation},...e.isIta&&{isIta:e.isIta}}})))}async function jm(e){return $m((t=>({...t,eventId:60002,errorData:{extensionVersion:"1.28.2",errorCode:e.errorCode,errorMessage:e.errorMessage}})))}async function Gm(e){return $m((t=>({...t,eventId:60003,translationErrorData:{errorData:{extensionVersion:"1.28.2",errorCode:e.errorCode,errorMessage:e.errorMessage},targetLang:e.targetLang,domainName:e.domainName,websiteLanguage:e.websiteLanguage,sourceLength:e.characterCount,translationTrigger:sm(e.trigger),nicheIntegration:Sm(e.nicheIntegration||k.default)}})))}async function Vm(e){return $m((t=>({...t,eventId:60004,contentScriptErrorData:{errorData:{extensionVersion:"1.28.2",errorCode:e.errorCode,errorMessage:e.errorMessage},domainName:e.domainName}})))}async function qm(e){return $m((t=>({...t,eventId:60005,inputInjectionData:{extensionVersion:"1.28.2",domainName:e.domainName}})))}async function Wm(e){return $m((t=>({...t,eventId:60007,extensionOpenedData:{extensionVersion:"1.28.2",domainName:e.domainName,pathName:e.pathName,extensionOpenedFrom:e.extensionOpenedFrom}})))}async function Bm(e){return $m((t=>({...t,eventId:60008,logoClickedData:{extensionVersion:"1.28.2",logoClickedFrom:e.logoClickedFrom}})))}async function Hm(e){return $m((t=>({...t,eventId:60009,notificationViewedData:{extensionVersion:"1.28.2",notificationType:lm(e.notificationType)}})))}async function Jm(e){return $m((t=>({...t,eventId:60010,shortcutUsedData:{shortcutType:dm(e.shortcutType),uiLocation:um(e.location),shortcut:e.shortcut,nicheIntegration:Sm(e.nicheIntegration||k.default)}})))}async function zm(e){const t={eventId:pm(e.uiAction)};return bm(t.eventId)&&(t.payload={nicheIntegration:Sm(e.nicheIntegration||k.default)}),$m((e=>({...e,...t})))}async function Ym(){return $m((e=>({...e,eventId:60012})))}async function Xm(){return $m((e=>({...e,eventId:60013})))}async function Km(e){return $m((t=>({...t,eventId:60014,inlineSettingOpenedData:{uiFunction:hm(e.uiFunction),uiLocation:um(e.uiLocation),nicheIntegration:Sm(e.nicheIntegration)}})))}async function Qm(e){return $m((t=>({...t,eventId:60015,settingChangedData:{settingType:fm(e.settingType),uiFunction:hm(e.uiFunction),uiLocation:um(e.uiLocation),domainName:e.domainName}})))}async function Zm(e){return $m((t=>({...t,eventId:60016,detectLanguageData:{domainName:e.domainName,language:e.language}})))}async function ey(e){return $m((t=>({...t,eventId:60017,rightClickData:{domainName:e.domainName,translationType:e.translationType}})))}async function ty(e){return $m((t=>({...t,eventId:60018,inlinePositionChangeData:{newPosition:gm(e.newPosition)}})))}async function ny(e){return $m((t=>({...t,eventId:60019,inlineDragStartData:{nicheIntegration:Sm(e?.nicheIntegration||k.default)}})))}async function ry(e){return $m((t=>({...t,eventId:60020,whatsAppMessageTranslatedData:{messageLang:e.messageLang,targetLang:e.targetLang,messageLength:e.messageLength,translator:Im(e.translator),numberOfLanguages:e.numberOfLanguages,numberOfMessages:e.numberOfMessages}})))}async function oy(e){return $m((t=>({...t,eventId:60021,whatsAppMessageTranslationFailedData:{errorCode:e.errorCode,domainName:e.domainName,translationConfig:{messageLength:e.messageLength,targetLang:e.targetLang,messageLang:e.messageLang,translator:Im(e.translator),numberOfLanguages:e.numberOfLanguages,numberOfMessages:e.numberOfMessages}}})))}async function sy(e){return $m((t=>({...t,eventId:60057,twitterTweetTranslationFailedData:{errorCode:e.errorCode,domainName:e.domainName,translationConfig:{messageLength:e.messageLength,targetLang:e.targetLang,messageLang:e.messageLang}}})))}async function iy(e){return $m((t=>({...t,eventId:60094,youtubeCommentTranslationFailedData:{errorCode:e.errorCode,domainName:e.domainName,translationConfig:{messageLength:e.messageLength,targetLang:e.targetLang,messageLang:e.messageLang}}})))}async function ay(e){return $m((t=>({...t,eventId:60022,fptHideData:{hideOption:e.hideOption,sourceLang:e.sourceLang,domainName:e.domainName,uiLocation:um(e.uiLocation)}})))}async function cy(e){return $m((t=>({...t,eventId:60023,inlineCopyData:{targetLang:e.targetLang,targetLength:e.targetLength,nicheIntegration:Sm(e.nicheIntegration||k.default)}})))}async function ly(e){return $m((t=>({...t,eventId:60024,inlineListenData:{targetLang:e.targetLang,targetLength:e.targetLength,actionType:e.actionType,nicheIntegration:Sm(e.nicheIntegration||k.default)}})))}async function uy(e){return $m((t=>({...t,eventId:60025,iconHoverData:{uiLocation:um(e.uiLocation),domainName:e.domainName,nicheIntegration:Sm(e.nicheIntegration||k.default)}})))}async function dy(e){return $m((t=>({...t,eventId:60029,onboardingStepChangeData:{previousStep:e.previousStep,newStep:e.newStep,trigger:ym(e.trigger),secondsOnOnboarding:e.secondsOnOnboarding,secondsOnPreviousStep:e.secondsOnPreviousStep}})))}async function py(e){return $m((t=>({...t,eventId:60030,onboardingOpenExternalPageData:{url:mm(e.url)}})))}async function hy(e){return $m((t=>({...t,eventId:60031,readMoreClickedData:{uiLocation:um(e.uiLocation)}})))}async function fy(e){return $m((t=>({...t,eventId:60032,landOnWebsiteData:{website:vm(e.website)}})))}async function gy(e){return $m((t=>({...t,eventId:60033,inlineListenData:{targetLang:e.targetLang,targetLength:e.targetLength,triggerType:e.triggerType,nicheIntegration:Sm(e.nicheIntegration||k.default)}})))}async function my(e){return $m((t=>({...t,eventId:60034,openInputHighlighterData:{domainName:e.domainName}})))}async function yy(e){return $m((t=>({...t,eventId:60035,closeInputHighlighterData:{trigger:e.trigger}})))}async function _y(e){return $m((t=>({...t,eventId:60036,gdocsReplaceTextData:{sourceLang:e.sourceLang,targetLang:e.targetLang,sourceLength:e.sourceLength,targetLength:e.targetLength}})))}async function vy(){return $m((e=>({...e,eventId:60037})))}async function Sy(e){return $m((t=>({...t,eventId:60038,openInputHighlighterData:{domainName:e.domainName}})))}async function Ty(e){return $m((t=>({...t,eventId:60039,closeInputHighlighterData:{trigger:e.trigger}})))}async function by(e){return $m((t=>({...t,eventId:60040,dictionaryStatus:{status:e.status,langPair:e.langPair}})))}async function wy(){return $m((e=>({...e,eventId:60041})))}async function Ey(){return $m((e=>({...e,eventId:60042})))}async function Iy(e){return $m((t=>({...t,eventId:60043,errorData:{lingueeError:im(e.error)}})))}async function Ay(e,t){let n;switch(e){case O.OPEN_TICKET:n=60044;break;case O.DETECT_TICKET_LANGUAGE:n=60045;break;case O.SWITCH_TICKET_LANGUAGE:n=60046;break;case O.ENABLE_AUTOTRANSLATE:n=60047;break;case O.DISABLE_AUTOTRANSLATE:n=60048;break;case O.TRANSLATE_MESSAGE:n=60049;break;case O.TRANSLATE_INPUT:n=60050;break;case O.ERROR:n=60051;break;default:return}return $m((e=>({...e,eventId:n,zendeskMetaData:{agentLanguage:t.agentLanguage,ticketLanguage:t.ticketLanguage,isTicketLanguageAutodetected:t.isTicketLanguageAutodetected,isTicketLanguageSupported:t.isTicketLanguageSupported,isAutoTranslateEnabled:t.isAutoTranslateEnabled,sourceTextLength:t.sourceTextLength,targetTextLength:t.targetTextLength,inputHasSelection:t.inputHasSelection,error:t.error}})))}async function Ry(e){let t;if(e.glossaryConfigOpenedWithoutGlossaryPermissions?t=60084:e.glossaryConfigOpenedWithNoGlossariesFound&&(t=60085),t)return $m((e=>({...e,eventId:t})))}async function ky(){return $m((e=>({...e,eventId:60054})))}async function Cy(e){const t=Math.round(await A_()/60);return $m((n=>({...n,eventId:60055,logoutData:{trigger:wm(e.trigger),minutesSinceLastLogin:t,reason:e.reason}})))}async function xy(e){return $m((t=>({...t,eventId:60052,gdocsMaxCharExceededData:{sourceLang:e.sourceLang,targetLang:e.targetLang,sourceLength:e.sourceLength}})))}async function Oy(e){return $m((t=>({...t,eventId:60053,gdocsMaxCharExceededData:{sourceLang:e.sourceLang,targetLang:e.targetLang,sourceLength:e.sourceLength}})))}async function Ly(e){return $m((t=>({...t,eventId:60056,sessionTypeData:{sessionType:e.sessionType,trigger:Em(e.trigger)}})))}async function Ny(e){let t="";try{t=await b_()}catch(e){console.log(`DAP: Failed to fetch session type. Error: ${e.message}`)}return $m((n=>({...n,eventId:60058,onboardingModalShownData:{nicheIntegration:Sm(e.nicheIntegration||k.default),sessionType:t}})))}async function Py(e){return $m((t=>({...t,eventId:60059,UILocationClickedData:{uiLocation:um(e)}})))}async function Dy(){return $m((e=>({...e,eventId:60060})))}async function My(){return $m((e=>({...e,eventId:60061})))}async function Uy(e,t){let n;switch(e){case M.TEXT_REFINEMENT_REQUEST:n=60062;break;case M.GDOCS_INSERT_COPY:n=60063;break;case M.GDOCS_DISCARD_COPY:n=60064;break;case M.GDOCS_CHAR_LIMIT_REACHED:n=60065;break;case M.ERROR:n=60066;break;case M.RESULT_ACCEPTED:n=60071;break;case M.RESULT_REVERTED:n=60072;break;case M.GET_ALTERNATIVES_FOR_INPUT:n=60088;break;default:return}return $m((e=>({...e,eventId:n,deeplWriteMetaData:{lang:t.lang,sourceLength:t.sourceLength,targetLength:t.targetLength,nicheIntegration:Sm(t.nicheIntegration||k.default),error:t.error,style:Tm(t.style)}})))}async function $y(){if(!await T_())return;const e=await O_();return $m((t=>({...t,eventId:60067,accountData:{accountUuid:e}})))}async function Fy(){const e=await O_();return $m((t=>({...t,eventId:60068,accountData:{accountUuid:e}})))}async function jy(){const e=await O_();return $m((t=>({...t,eventId:60069,accountData:{accountUuid:e}})))}async function Gy(e,t){let n;switch(e){case U.RESULT_ACCEPTED:n=60073;break;case U.RESULT_REVERTED:n=60074;break;default:return}return $m((e=>({...e,eventId:n,translationResultActionData:{sourceLang:t.sourceLang,sourceLength:t.sourceLength,targetLength:t.targetLength,nicheIntegration:Sm(t.nicheIntegration||k.default),error:t.error}})))}async function Vy(e){return $m((t=>({...t,eventId:60070,customizationOnOffData:{nicheIntegration:Sm(e.nicheIntegration||k.default),uiLocation:um(e.location),customizationEnabled:e.customizationEnabled}})))}async function qy(e){return $m((t=>({...t,eventId:60075,gmailCharLimitReachedData:{gmailActionType:Rm(e.type)}})))}async function Wy(e){return $m((t=>({...t,eventId:60076,upgradeNotificationDisplayedData:{type:km(e)}})))}async function By(e){return $m((t=>({...t,eventId:60077,upgradeNotificationClosedData:{type:km(e)}})))}async function Hy(e,t){return $m((n=>({...n,eventId:60078,upgradeNotificationActionData:{type:km(e),action:xm(t)}})))}async function Jy(e,t){let n;switch(e){case $.ALTERNATIVES_OPENED:n=60079;break;case $.SEGMENTATION_SELECTED:n=60080;break;case $.ALTERNATIVE_SELECTED:n=80081;break;default:return}return $m((e=>({...e,eventId:n,alternativesMetaData:{sourceLang:t.sourceLang,targetLang:t.targetLang,nicheIntegration:Sm(t.nicheIntegration||k.default),contentProcessingMode:Cm(t.contentProcessingMode),...t.alternativesSegmentation&&{alternativesSegmentation:Om(t.alternativesSegmentation)}}})))}async function zy(e,t){const n=e?60082:60083;return $m((e=>({...e,eventId:n,glossaryMetadata:{nicheIntegration:Sm(t.nicheIntegration||k.default)}})))}async function Yy(e){return $m((t=>({...t,eventId:60086,languageDetectionTextProcessingData:{detectedLanguageCode:e.lang,textLength:e.textLength,domainName:e.domainName,isReliable:e.isReliable,translationTrigger:sm(e.trigger),nicheIntegration:Sm(e.nicheIntegration||k.default)}})))}async function Xy(){return $m((e=>({...e,eventId:60087})))}async function Ky(e){return $m((t=>({...t,eventId:60089,alternativesMetaData:{sourceLang:e.sourceLang,targetLang:e.targetLang,numberOfAlternatives:e.numberOfAlternatives,selectedAlternativeIndex:e.selectedAlternative,nicheIntegration:Sm(e.nicheIntegration||k.default),contentProcessingMode:Cm(e.contentProcessingMode),...e.alternativesSegmentation&&{alternativesSegmentation:Om(e.alternativesSegmentation)}}})))}async function Qy(){return $m((e=>({...e,eventId:60090})))}async function Zy(e){return $m((t=>({...t,eventId:60091,errorData:{extensionVersion:"1.28.2",errorCode:e.errorCode,errorMessage:e.errorMessage}})))}async function e_(){return $m((e=>({...e,eventId:60092})))}async function t_(e){return $m((t=>({...t,eventId:60093,adsShownData:{matchedWord:e.matchedWord}})))}let n_;const r_="dlBrowserExtension",o_="dlCache",s_="dlclientstate",i_="dlexperiments";function a_(){return new Promise(((e,t)=>{let n=indexedDB.open(r_,1);n.onerror=function(){t(n.error)},n.onsuccess=function(t){n_=t.target.result,e()},n.onupgradeneeded=function(t){n_=t.target.result,n_.objectStoreNames.contains(o_)||n_.createObjectStore(o_,{keyPath:"id"}),e()}}))}async function c_(e,t,n){return n_||await a_(),new Promise(((r,o)=>{let s=n_.transaction(n,"readwrite").objectStore(n).put({id:e,data:t,meta:{createdAt:Date.now()}});s.onsuccess=function(){r()},s.onerror=function(e){o(e)}}))}async function l_(e,t){return n_||await a_(),new Promise(((n,r)=>{let o=n_.transaction(t,"readonly").objectStore(t).get(e);o.onerror=function(e){r(e)},o.onsuccess=function(){o.result?n(o.result):n(null)}}))}async function u_(e){try{await c_(s_,e,o_)}catch(e){$g(e,mg)}}async function d_(){const e=await l_(s_,o_);if(!e||!e.meta)return;return(Date.now()-e.meta.createdAt)/6e4>20?void 0:e.data}async function p_(e){try{await c_(i_,e,o_)}catch(e){$g(e,mg)}}async function h_(){const e=await l_(i_,o_);if(!e||!e.meta)return[];return(Date.now()-e.meta.createdAt)/6e4>9?[]:e.data&&0!==e.data.length?e.data:[]}async function f_(e){if(e.includes("session")){const e=await chrome.storage.sync.get(["session"]);e&&!e.session&&await g_()}return new Promise(((t,n)=>{chrome.storage.sync.get(e,(r=>{r?t(r):n(`Can not get ${e}`)}))}))}async function g_(){const e=n();await chrome.storage.sync.set({session:{id:e,timestamp:Date.now()}});try{await $y()}catch(e){console.error(e)}}async function m_(){const{session:e}=await f_(["session"]);!e||(Date.now()-e.timestamp)/6e4>30?await g_():await chrome.storage.sync.set({session:{...e,timestamp:Date.now()}})}async function y_(e,t,n){const r=o(e);return await chrome.storage.local.set({a_t:e,r_t:t,i_t:n,isLoggedIn:!(!e||!t),isProUser:!(!r||"Pro"!==r.sessionType),sessionType:r?.sessionType}),r?.sessionType}async function __(){await chrome.storage.local.remove(["a_t","r_t","i_t"]),await chrome.storage.local.set({isLoggedIn:!1,isProUser:!1,sessionType:""})}async function v_(){await chrome.storage.sync.remove(["activeTermbaseId","isGlossaryEnabled"]),await chrome.storage.sync.set({activeTermbaseId:"",isGlossaryEnabled:!1})}async function S_(){const e=await chrome.storage.local.get(["a_t","r_t","i_t"]);return{access_token:e?e.a_t:void 0,refresh_token:e?e.r_t:void 0,id_token:e?e.i_t:void 0}}async function T_(){const e=await chrome.storage.local.get(["isLoggedIn"]);return!(!e||!e.isLoggedIn)}async function b_(){const e=await chrome.storage.local.get(["sessionType"]);return e?.sessionType}async function w_(){return(await chrome.storage.sync.get(["installationId"])).installationId}async function E_(){await chrome.storage.local.set({last_login:Date.now()})}async function I_(){await chrome.storage.local.remove(["last_login"])}async function A_(){const e=await chrome.storage.local.get(["last_login"]);return e&&e.last_login?(Date.now()-e.last_login)/1e3:0}async function R_(e){const t=e.featureSet.translator.service,n=e.featureSet.write.service,r=e.featureSet.api.service,o=e.featureSet.documentTranslation.service,s=e.featureSet.glossary.termbaseService,i=e.featureSet.glossary.maxGlossaries;let a,c;e.loginState?.accountId&&(a=e.loginState.accountId),e.featureSet?.integrations?.browserExtension&&(c=e.featureSet?.integrations?.browserExtension),await chrome.storage.local.set({translatorServiceType:t,writeServiceType:n,apiServiceType:r,docTranslatorServiceType:o,accountId:a||"",featureSet:c,hasTermbaseService:s&&i>0})}async function k_(){return await chrome.storage.local.get(["isLoggedIn","isProUser","sessionType","translatorServiceType","writeServiceType","apiServiceType","docTranslatorServiceType","accountId","hasTermbaseService"])}async function C_(){await chrome.storage.local.set({browserInstanceId:n()})}async function x_(){return(await chrome.storage.local.get(["browserInstanceId"])).browserInstanceId}async function O_(){const e=await chrome.storage.local.get(["accountId","a_t","i_t"]);if(e&&e.accountId)return e.accountId;if(e&&e.a_t){const t=o(e.a_t),n=o(e.i_t);return t.sub||n.sub}}async function L_(){let e=[];try{e=await h_()}catch(e){}if(!e||0===e.length)return[];const t=e.map((e=>({id:e.id,variant:e.variant,breakout:e.breakout})));return t}async function N_(e="translatorServiceType"){const t=await k_(),n=!!t.accountId,r=t[e];return n?r===D.pro?u.loggedInPro:u.loggedInFree:u.notLoggedIn}async function P_(e="translatorServiceType"){const t=await N_(e);let n;switch(e){case"translatorServiceType":default:n=d;break;case"writeServiceType":n=p}switch(t){case u.notLoggedIn:return n.notLoggedIn;case u.loggedInFree:return n.loggedInFree;case u.loggedInPro:return;default:n.notLoggedIn}}async function D_(e){const t=await chrome.storage.local.get(["translatorServiceType","writeServiceType","apiServiceType","docTranslatorServiceType","isLoggedIn"]);return Pg(t,e)}async function M_(){return await chrome.storage.local.get(["translatorServiceType","writeServiceType","apiServiceType","docTranslatorServiceType","isLoggedIn"])}async function U_(e=!1){if(!e){let e;try{e=await h_()}catch(e){}if(e&&e.length)return e}const t=await w_();if(!t)throw new Error("Installation ID is not valid");let n=[];try{n=await h_()}catch(e){}const r=`https://experimentation.deepl.com/experiments/${t}`;let o;try{const e=await fetch(r,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:JSON.stringify(n),credentials:"omit"});return o=(await e.json()).client_experiments,o?(p_(o),o):[]}catch(e){return[]}}const $_={ACCESS_DENIED:"ACCESS_DENIED",INVALID_REQUEST:"INVALID_REQUEST",INVALID_GRANT:"INVALID_GRANT",GET_TOKEN_ERROR:"GET_TOKEN_ERROR",INVALID_NONCE:"INVALID_NONCE"};class F_ extends Error{constructor(e,t){super(e),this.name=$_.ACCESS_DENIED,this.message=e,this.httpStatusCode=t}}class j_ extends Error{constructor(e,t){super(e),this.name=$_.INVALID_REQUEST,this.message=e,this.httpStatusCode=t}}class G_ extends Error{constructor(e,t){super(e),this.name=$_.INVALID_GRANT,this.message=e,this.httpStatusCode=t}}class V_ extends Error{constructor(e,t){super(e),this.name=$_.GET_TOKEN_ERROR,this.message=e,this.httpStatusCode=t}}class q_ extends Error{constructor(e){super(e),this.name=$_.INVALID_NONCE,this.message=e}}function W_(e,t){const n=e.split("?")[1];if(n){var r=n.split("&");for(let e=0;e<r.length;e++){const n=r[e].split("=");if(decodeURIComponent(n[0])===t)return decodeURIComponent(n[1])}}}async function B_(e,t,n="https://test.deepl.com/oidc-login"){const o=r(),s=r(),i=await async function(e){const t=await crypto.subtle.digest("SHA-256",(new TextEncoder).encode(e));return btoa(String.fromCharCode(...new Uint8Array(t))).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}(s);return{url:n+"?"+new URLSearchParams([["client_id",e],["redirect_uri",t],["code_challenge",i],["code_challenge_method","S256"],["nonce",o]]),nonce:o,codeVerifier:s}}function H_(e,t){if(200!==e){if("invalid_request"===t.error)throw new j_(`dl-oidc (get tokens): invalid request - http status: ${e}`,e);if("invalid_grant"===t.error)throw new G_(`dl-oidc (get tokens): invalid grant - http status: ${e}`,e);throw new V_(`dl-oidc (get tokens): http status: ${e}`,e)}}async function J_(e,t="https://deepl.com/oidc/token"){const n=await fetch(t,{method:"POST",credentials:"omit",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({grant_type:"refresh_token",refresh_token:e})}),r=await n.json();return H_(n.status,r),r.access_token}async function z_(e,t,n=!1){let r=t.access_token;async function o(){return await fetch(e,{...t,headers:{...t.headers,Authorization:r?`Bearer ${r}`:"None"},...t.omitCookies&&{credentials:"omit"}})}n&&r&&(r=await J_(t.refresh_token,t.token_url));let s=await o();return 401!==s.status&&403!==s.status||(r=await J_(t.refresh_token,t.token_url),s=await o()),{response:s,accessToken:r}}function Y_(e,t,n){return{jsonrpc:"2.0",method:e,params:t,id:n}}async function X_(e=!1,n=!0){if(!e){const e=await d_();if(e)return e}const r=Y_("getClientState",{v:"20180814"},t()),s=await S_(),i=n||function(e){try{const t=o(e);if(t.exp&&Date.now()/1e3<t.exp-5)return!1}catch(e){console.error("Error decoding token:",e)}return!0}(s.access_token),{response:a,accessToken:c}=await z_("https://w.deepl.com/web",{method:"POST",headers:{"Content-Type":"application/json; charset=utf-8"},body:JSON.stringify(r),access_token:s.access_token,refresh_token:s.refresh_token,token_url:"https://w.deepl.com/oidc/token",credentials:"omit"},i);await y_(c,s.refresh_token,s.id_token);const l=(await a.json()).result;return l&&(u_(l),R_(l)),l}async function K_(e=!1){const t=async()=>{const t=await B_("chromeExtension",chrome.identity.getRedirectURL(),"https://www.deepl.com/auth/login");return new Promise(((n,r)=>{chrome.identity.launchWebAuthFlow({interactive:!0,url:e?`${t.url}#error_loginfailed`:t.url},(async e=>{if(!e){const e=chrome.runtime.lastError.message;return console.error("response url undefined",e),$g(`login - response url undefined. ${e}`,mg),/The user did not approve access/gm.test(e)||/User cancelled or denied access/gm.test(e)?n():r()}try{const r=await async function(e,t,n,r,s,i="https://deepl.com/oidc/token"){const a=W_(n,"code");if(!a){const e=W_(n,"error");if("access_denied"===e)throw new F_("dl-oidc (get tokens): access denied - undefined code",401);if("invalid_request"===e)throw new j_("dl-oidc (get tokens): invalid request - undefined code",400)}let c={client_id:e,code_verifier:s,grant_type:"authorization_code",redirect_uri:t};a&&(c.code=a);const l=await fetch(`${i}`,{method:"POST",credentials:"omit",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams(c)}),u=await l.json();if(H_(l.status,u),o(u.id_token).nonce!==r)throw new q_("dl-oidc (get tokens): invalid nonce");return u}("chromeExtension",chrome.identity.getRedirectURL(),e,t.nonce,t.codeVerifier,"https://w.deepl.com/oidc/token"),s=await y_(r.access_token,r.refresh_token,r.id_token);try{await X_(!0,!1),ky(),Fy(),s&&await Ly({sessionType:s,trigger:"LOGIN"})}catch(e){console.error(e)}await E_(),n()}catch(e){console.error(e);try{jm({errorCode:e.name,errorMessage:e.message})}catch(e){console.error(e)}r(e)}}))}))};try{await t()}catch(e){K_(!0)}}async function Q_(e){const t=await S_(),n=new URLSearchParams([["id_token_hint",t.id_token],["post_logout_redirect_uri",chrome.identity.getRedirectURL()]]),r=async()=>{await I_();try{await jy()}catch(e){console.error(e)}await __();try{await Cy({trigger:e.trigger,reason:e.reason})}catch(e){console.error(e)}await X_(!0),v_(),e.showAlert&&chrome.tabs.query({active:!0,currentWindow:!0},(function(t){chrome.tabs.sendMessage(t[0].id,{action:"dlShowAlert",payload:{error:e.reason}})}))};if(!t.id_token)return void await r();const o=`https://www.deepl.com/auth/logout?${n}`;chrome.identity.launchWebAuthFlow({url:o,interactive:!0},(()=>{r()}))}async function Z_(){const e=await S_();let t=e.access_token;if(t){const n=6e4;if(1e3*o(t).exp-Date.now()<n){const n="https://w.deepl.com/oidc/token";t=await J_(e.refresh_token,n),await y_(t,e.refresh_token,e.id_token)}}return t}async function ev(e,t,n,r){const o=await S_(),s=await D_(P.TRANSLATOR),i=await D_(P.WRITE);let a=o&&o.access_token&&s?"https://api.deepl.com/jsonrpc?client=chrome-extension,1.28.2":"https://www2.deepl.com/jsonrpc?client=chrome-extension,1.28.2";r&&(a=o&&o.access_token&&i?"https://write-pro.www.deepl.com/jsonrpc?client=chrome-extension,1.28.2":"https://write-free.www.deepl.com/jsonrpc?client=chrome-extension,1.28.2");try{const{response:r,accessToken:s}=await z_(a,{method:"POST",headers:{"Content-Type":t},body:e,access_token:o.access_token,refresh_token:o.refresh_token,token_url:"https://w.deepl.com/oidc/token",omitCookies:!0}),i=await y_(s,o.refresh_token,o.id_token);if(i)try{await Ly({sessionType:i,trigger:"TRANSLATION"})}catch(e){console.log(e)}try{await X_(!1,!1)}catch(e){console.error(`Failed to get the client state ${e.message}`)}let c=function(e,t,n){let r;try{r=JSON.parse(e)}catch(e){throw 200===t?new zg("JSON_RPC: Parsing of response object failed"):t>=500&&n?new Yg(`FPT failed: Http status code ${t}`):new Xg(t.toString(),403===t?`Translation failed: Http status code ${t} forbidden request. re-authenticating makes no difference.`:`Translation failed: Http status code ${t}`)}if("2.0"!==r.jsonrpc||void 0!==r.result&&200!==t||void 0===r.result&&void 0===r.error)throw new zg("JSON_RPC: missing field, wrong id, proper result without 200 status, or missing data");if(r.error){const e=r.error;if(void 0===e.code)throw new zg('JSON_RPC: Missing field "code" in error response');throw new Xg(e.code.toString(),e.message)}if(200!==t)throw new Xg(t.toString(),`Http status code ${t}`);return r}(await r.text(),r.status,n);return{data:c,status:r.status}}catch(e){throw e.name!==$_.ACCESS_DENIED&&e.name!==$_.INVALID_REQUEST&&e.name!==$_.INVALID_GRANT&&e.name!==Fg.USER_UNAUTHORIZED&&e.name!==Fg.FORBIDDEN_REQUEST||setTimeout((()=>{Q_({trigger:x.extension,reason:e.name})}),5e3),e}}async function tv(e,t,n=(e=>e),r,o,s){const i=function(e,t,n){return{jsonrpc:"2.0",method:e,params:t,id:n}}(e,t,r),a=n(JSON.stringify(i),i);return(await ev(a,"application/json; charset=utf-8",o,s)).data.result}async function nv(e){let t,n={};for(const t in e.weights)e.weights[t]>0&&(n[t]=e.weights[t]);try{t=await N_()}catch(e){t=u.notLoggedIn,console.log(e)}const r=e.nicheIntegration===k.default||e.nicheIntegration===k.gmail||e.nicheIntegration===k.gslides||!e.nicheIntegration,o=await D_(P.TRANSLATOR),s=await D_(P.WRITE);if((!o||!s)&&r){const n=e.sourceTexts.reduce(((e,t)=>e+t.length),0),r=e.isWriteRequest?"writeServiceType":"translatorServiceType",i=await P_(r);if(e.isWriteRequest){if(o&&!s&&n>i)throw new em(i,"Char limit exceeded (Translator Pro, Write Free)");if(!s&&n>i)throw new Zg(i,"Char limit exceeded (Write Free Or Anonymous)")}else{if(t===u.loggedInFree&&s&&n>i)throw new tm(i,"Char limit exceeded (Free or Anon Translator, Write Pro)");if(t===u.loggedInFree&&n>i)throw new Kg(i,"Char limit exceeded (Translator Free)");if(t===u.notLoggedIn&&n>i)throw new Qg(i,"Char limit exceeded (Translator Anon)")}}let i=e.sourceTexts;const a=["EN-US","EN-GB","PT-PT","PT-BR","ZH-HANT"].includes(e.targetLangCode?.toUpperCase());let c=e.targetLangCode?.toUpperCase();a&&(c=e.targetLangCode?.toUpperCase().slice(0,2));const l=e.isWriteRequest?e.sourceTexts.map((e=>({text:e,requestAlternatives:4}))):i.map((e=>({text:e}))),d={texts:l,...e.isHtml&&{html:"enabled"},...!e.isHtml&&{splitting:e.splitting?e.splitting:"paragraphs"},lang:{target_lang:c,source_lang_user_selected:"auto"===e.sourceLang?"auto":e.sourceLang.toUpperCase(),preference:{weight:n}},commonJobParams:{regionalVariant:e.regionalVariant&&a?e.regionalVariant:void 0,...e.isWriteRequest&&{mode:"write"},...e.formality&&{formality:e.formality}}};let p=1;const h=Date.now();i.forEach((e=>p+=(e.match(/[i]/g)||[]).length)),d.timestamp=h-h%p+p;const f=await tv("LMT_handle_texts",d,((e,t)=>e=(t.id+3)%13==0||(t.id+5)%29==0?e.replace('"method":"','"method" : "'):e.replace('"method":"','"method": "')),e.id,e.isHtml,e.isWriteRequest);return{texts:f.texts.map((e=>e.text)),sourceLang:f.lang.toUpperCase(),detectedLanguages:f.detectedLanguages}}const rv=new Map([["ZH_EN","chinese-english"],["EN_ZH","english-chinese"],["NL_EN","dutch-english"],["EN_NL","english-dutch"],["FR_EN","french-english"],["EN_FR","english-french"],["FR_DE","french-german"],["DE_FR","german-french"],["FR_PT","french-portuguese"],["PT_FR","portuguese-french"],["FR_ES","french-spanish"],["ES_FR","spanish-french"],["DE_EN","german-english"],["EN_DE","english-german"],["DE_PT","german-portuguese"],["PT_DE","portuguese-german"],["DE_ES","german-spanish"],["ES_DE","spanish-german"],["IT_EN","italian-english"],["EN_IT","english-italian"],["JA_EN","japanese-english"],["EN_JA","english-japanese"],["PL_EN","polish-english"],["EN_PL","english-polish"],["PT_EN","portuguese-english"],["EN_PT","english-portuguese"],["PT_ES","portuguese-spanish"],["ES_PT","spanish-portuguese"],["RU_EN","russian-english"],["EN_RU","english-russian"],["ES_EN","spanish-english"],["EN_ES","english-spanish"]]);async function ov(e){const t=function(e,t){const n=`${e.toUpperCase()}_${t.toUpperCase()}`;return rv.get(n)}(sv(e.sourceLang),sv(e.targetLang)),n=encodeURIComponent(e.text),r=`https://www-app.linguee.com/${t}/search?dlApp=BrowserExtension&il=${e.interfaceLang}&query=${n}`;let o=async function(e){let t;if(200!==e.status)throw 404===e.status?(console.error("Dictionary Entry not found: 404"),new nm(jg.ENTRY_NOT_FOUND)):(console.error("Dictionary Server Error"),new nm(jg.SERVER_ERROR));{try{t=await e.text()}catch(e){throw new nm(jg.SERVER_ERROR)}const n=/href=["']([^"']*)["']/g;t=t.replace(n,"")}return t}(await fetch(r));return o}function sv(e){return["EN-US","EN-GB","PT-PT","PT-BR","ZH-HANT"].includes(e)?["EN-US","EN-GB"].includes(e)?"EN":["PT-PT","PT-BR"].includes(e)?"PT":["ZH-CN","ZH-HANT"].includes(e)?"ZH":e:e}function iv(e,t){const n=1e-5;return n*Math.floor((.97*e+t)/n)}const av="PROTOCOL_ERROR",cv="FULL_PAGE_SERVER_ERROR",lv="-32003",uv="403",dv="401";class pv extends Error{constructor(e){super(e),this.name=av,this.message=e}}class hv extends Error{constructor(e,t){super(t),this.name=e,this.message=t}}class fv extends Error{constructor(e){super(e),this.name=cv,this.message=e}}function gv(){let e=new Uint32Array(1);return crypto.getRandomValues(e),e[0]}function mv(e,t){return{jsonrpc:"2.0",method:e,params:t,id:gv()}}const yv={TRANSLATE:"translate",WRITE:"write"},_v="pro",vv="LMT_split_text",Sv="LMT_handle_jobs",Tv="getTermbases";const bv=async({mode:e,texts:t,config:n,sourceLang:r="auto",queryParameter:o,textType:s,advancedMode:i})=>{const a=await Iv(n,e),c=o?`${a}&method=${vv}&${o}`:`${a}&method=${vv}`,l=mv(vv,{commonJobParams:{mode:e,...!0===i&&{advancedMode:!0}},lang:{lang_user_selected:r},texts:t,textType:s});return await Ev(c,{method:"POST",headers:{"Content-Type":"application/json"},body:Rv(l)},n)},wv=async({mode:e,jobs:t,sourceLang:n,targetLang:r,config:o,textType:s,formality:i,termbase:a,styleVariant:c,queryParameter:l,regionalVariant:u})=>{const d=await Iv(o,e),p=l?`${d}&method=${Sv}&${l}`:`${d}&method=${Sv}`,h=mv(Sv,{commonJobParams:{mode:e,...s&&{textType:s},...i&&{formality:i},...c&&{style_variant:c},...a&&{termbase:a},...c&&{style_variant:c},...u&&{regionalVariant:u}},lang:{source_lang_computed:n,target_lang:r},jobs:t,priority:1,timestamp:Av(t)});return await Ev(p,{method:"POST",headers:{"Content-Type":"application/json"},body:Rv(h)},o)},Ev=async(e,t,n)=>{const r=await n.auth.getAuthTokens(),o=r?{access_token:r.access_token,refresh_token:r.refresh_token,token_url:n.auth.tokenUrl}:{},{response:s,accessToken:i}=await z_(e,{...t,...o,omitCookies:n.omitCookies});return await n.auth.setAuthTokens(i,r.refresh_token,r.id_token),await kv({response:s,isHtml:!1})},Iv=async({auth:e,baseUrls:t,isTermbase:n},r=void 0)=>{const o=await e.getAuthTokens(),s=r===yv.WRITE?t.write:t.translate;if(n)return t.glossary;if(!o||!o.access_token)return s.free;if(!e.getServiceLevels){const e=(e=>{try{return JSON.parse(atob(e.split(".")[1]))}catch(e){return null}})(o.access_token),t=e&&"Pro"===e.sessionType;return o.access_token&&t?s.pro:s.free}{const t=await e.getServiceLevels();switch(r){case yv.WRITE:return t.write===_v?s.pro:s.free;case yv.TRANSLATE:return t.translator===_v?s.pro:s.free;default:return s.free}}},Av=e=>{const t=e.reduce(((e,t)=>[...e,...t.sentences.map((e=>e.text))]),[]);let n=1;const r=Date.now();return t.forEach((e=>n+=(e.match(/[i]/g)||[]).length)),r-r%n+n},Rv=e=>{let t=JSON.stringify(e);return t=(e.id+3)%13==0||(e.id+5)%29==0?t.replace('"method":"','"method" : "'):t.replace('"method":"','"method": "'),t},kv=async({response:e,isHtml:t})=>{let n;try{if(403===e.status)throw new hv(e.status.toString(),`Translation failed: Http status code ${e.status} forbidden request. re-authenticating makes no difference.`);if(401===e.status)throw new hv(e.status.toString(),`Translation failed: Http status code ${e.status} unauthorized request.`);n=JSON.parse(await e.text())}catch(n){throw 200===e.status?new pv("JSON_RPC: Parsing of response object failed"):e.status>=500&&t?new fv(`FPT failed: Http status code ${e.status}`):new hv(e.status.toString(),`Translation failed: Http status code ${e.status}`)}if("2.0"!==n.jsonrpc||void 0!==n.result&&200!==e.status||void 0===n.result&&void 0===n.error)throw new pv("JSON_RPC: missing field, wrong id, proper result without 200 status, or missing data");if(n.error){if(void 0===n.error.code)throw new pv('JSON_RPC: Missing field "code" in error response');throw new hv(n.error.code.toString(),n.error.message)}if(200!==e.status)throw new hv(e.status.toString(),`Http status code ${e.status}`);return n},Cv=yv;async function xv({texts:e,mode:t=yv.TRANSLATE,targetLang:n}){return Pv((async r=>await async function({texts:e,mode:t=yv.TRANSLATE,targetLang:n,config:r}){const o=await bv({mode:t,texts:e,config:r}),s=o.result.texts[0].chunks.map(((e,n,r)=>({kind:"default",preferred_num_beams:4,raw_en_context_after:n<r.length-1&&r.length>1?[r[n+1].sentences[0].text]:[],raw_en_context_before:n>0?[r[n-1].sentences[0].text]:[],sentences:[{...e.sentences[0],id:n}],...t===yv.WRITE&&{write_variant_requests:["main","variants"]}})));return await wv({mode:t,jobs:s,sourceLang:o.result.lang.detected,targetLang:t===yv.WRITE?o.result.lang.detected:n,config:r})}({texts:e,mode:t,targetLang:n,config:r})))}const Ov=async({mode:e,texts:t,sourceLang:n="auto",textType:r="plaintext",advancedMode:o})=>Pv((async s=>await bv({mode:e,texts:t,sourceLang:n,config:s,textType:r,advancedMode:o}))),Lv=async({mode:e,jobs:t,sourceLang:n,targetLang:r,textType:o,formality:s,termbase:i,styleVariant:a,regionalVariant:c})=>Pv((async l=>await wv({mode:e,jobs:t,sourceLang:n,targetLang:r,config:l,textType:o,formality:s,termbase:i,styleVariant:a,regionalVariant:c}))),Nv=async()=>Pv((async e=>await(async({config:e})=>{const t=`${await Iv({...e,isTermbase:!0})}&method=${Tv}`,n=mv(Tv,{});return await Ev(t,{method:"POST",headers:{"Content-Type":"application/json"},body:Rv(n)},e)})({config:e}))),Pv=async e=>{try{return await e(Dv())}catch(e){throw e.name!==$_.ACCESS_DENIED&&e.name!==$_.INVALID_REQUEST&&e.name!==$_.INVALID_GRANT&&e.name!==lv&&e.name!==uv&&e.name!==dv||setTimeout((()=>{Q_({trigger:x.extension,reason:e.name})}),5e3),e}},Dv=()=>({baseUrls:{translate:{free:"https://www2.deepl.com/jsonrpc?client=chrome-extension,1.28.2",pro:"https://api.deepl.com/jsonrpc?client=chrome-extension,1.28.2"},write:{free:"https://write-free.www.deepl.com/jsonrpc?client=chrome-extension,1.28.2",pro:"https://write-pro.www.deepl.com/jsonrpc?client=chrome-extension,1.28.2"},glossary:"https://api.deepl.com/termbases/jsonrpc?client=chrome-extension,1.28.2"},auth:{getAuthTokens:S_,setAuthTokens:y_,getServiceLevels:async()=>{const e=await M_();return{translator:e.translatorServiceType,write:e.writeServiceType}},tokenUrl:"https://w.deepl.com/oidc/token"},omitCookies:!0}),Mv=async e=>{let t;try{t=await N_()}catch(e){t=u.notLoggedIn,console.log(e)}const n=e.nicheIntegration===k.default||e.nicheIntegration===k.gmail||e.nicheIntegration===k.gslides||!e.nicheIntegration,r=await D_(P.TRANSLATOR),o=await D_(P.WRITE);if((!r||!o)&&n){const n=e.sourceTexts.reduce(((e,t)=>e+t.length),0),s=e.isWriteRequest?"writeServiceType":"translatorServiceType",i=await P_(s);if(e.isWriteRequest){if(r&&!o&&n>i)throw new em(i,"Char limit exceeded (Translator Pro, Write Free)");if(!o&&n>i)throw new Zg(i,"Char limit exceeded (Write Free Or Anonymous)")}else{if(t===u.loggedInFree&&o&&n>i)throw new tm(i,"Char limit exceeded (Free or Anon Translator, Write Pro)");if(t===u.loggedInFree&&n>i)throw new Kg(i,"Char limit exceeded (Translator Free)");if(t===u.notLoggedIn&&n>i)throw new Qg(i,"Char limit exceeded (Translator Anon)")}}},Uv=(e,t=[])=>{if(!e||0===t.length)return null;if(t.map((e=>e.id)).includes(e)){return t.find((t=>t.id===e))}return null},$v=e=>e.translations[0].beams.map((e=>e.sentences[0])).some((e=>e.glossary_highlights&&e.glossary_highlights.length>0)),Fv=async e=>{await Mv(e);const{activeTermbaseId:t,isLoggedIn:n,isGlossaryEnabled:r,hasTermbaseService:o}=await f_(["activeTermbaseId","isLoggedIn","isGlossaryEnabled","hasTermbaseService"]),s=Tg(e.targetLangCode,e.regionalVariant),a=[],c=[],l=e.isWriteRequest?Cv.WRITE:Cv.TRANSLATE,u=await Ov({texts:e.sourceTexts,mode:l});let d,p=u.result.lang.detected,h=!1,f=!1,g=!1;if(Dg({isLoggedIn:n,hasTermbaseService:o})&&t&&!e.isWriteRequest&&r)try{const[e]=await iS(),n=Uv(t,e);if(n)for(let e of n.termDictionaries)if(e.languagePair===`${p.substr(0,2)}>${s.langCode.substr(0,2)}`.toLowerCase()){d={id:n.id,dictionaryId:e.id},h=!0,f=n.shared;break}}catch(e){console.log({e:e,message:"fetching glossaries failed"})}for(const e of u.result.texts){const t=[];for(const n of e.chunks)for(const e of n.sentences)c.push(e),t.push(c.length-1);a.push(t)}const m=c.map(((e,t)=>({kind:"default",preferred_num_beams:4,raw_en_context_after:t<c.length-1?[c[t+1].text]:[],raw_en_context_before:t>0?[c[t-1].text]:[],sentences:[{...e,id:t+1}]})));let y;l===Cv.WRITE?"EN"===p&&s.regionalVariant&&["EN-US"].includes(s.regionalVariant.toUpperCase())&&(y=s.regionalVariant):y=s.regionalVariant;const _={mode:l,jobs:m,sourceLang:p,targetLang:e.isWriteRequest?p:s.langCode,textType:e.textType,...e.formality&&{formality:e.formality},...d&&{termbase:d},...y&&{regionalVariant:y}};let v=(await Lv(_)).result;if(g=$v(v),e.autoImproveForTranslate&&l===Cv.TRANSLATE){const t=e.targetLangCode.substring(0,2).toUpperCase(),n=4;if(v.source_lang.substring(0,2).toUpperCase()===t&&function(e){try{return e.replace(/[^\p{L}]/gu,"").length}catch(t){return e.replace(/[^a-zA-Z]/g,"").length}}(e.sourceTexts.join(""))>n&&(S=t,i.includes(S?.substr(0,2).toUpperCase()))){v=(await Lv({..._,mode:Cv.WRITE})).result}}var S;const T=v.translations.map(((e,t)=>`${c[t].prefix}${e.beams[0]?.sentences[0].text??""}`)),b=a.map((e=>e.map((e=>T[e]))));return{processedText:b,result:v,...h&&{glossaryTrackingInfo:{isGlossaryEnabled:!!d,isGlossaryShared:f,didGlossaryChangeTranslation:g}}}},jv=(e,t)=>{const n=[];let r=[],o=0;for(const s of e){const e=Gv(s);o+e>t&&r.length>0&&(n.push(r),r=[],o=0),r.push(s),o+=e}return r.length>0&&n.push(r),n},Gv=e=>(new TextEncoder).encode(e).length;async function Vv(e){const t=await f_(["selectedTargetLanguage"]);chrome.tabs.sendMessage(e,{action:"dlTranslateInline",targetLang:t.selectedTargetLanguage})}const qv=24576;async function Wv(e){await m_();const n=await f_(["selectedTargetLanguage","session","installationId","regionalVariant"]),r=new Date;jv(e.payload.texts,qv);let o=[],s=null;try{{const r={sourceLang:"auto",targetLangCode:n.selectedTargetLanguage,sessionId:n.session.id,id:t(),isHtml:!0,sourceTexts:e.payload.texts,regionalVariant:n.regionalVariant},i=await Fv(r);o=i.processedText,s=i.glossaryTrackingInfo}}catch(t){try{Gm({errorCode:t.name,errorMessage:t.message,domainName:e.payload.domainName,targetLang:n.selectedTargetLanguage,websiteLanguage:e.payload.sourceLang,trigger:e.payload.trigger,characterCount:e.payload.texts.reduce(((e,t)=>e+t.length),0)})}catch(e){console.log(e)}throw t}$S(e?.payload?.sourceLang,n?.selectedTargetLanguage);const i={isFirstTime:e.payload.isFirstTime,processingTimeInMs:(new Date).getTime()-r.getTime()};try{Fm({installationId:n.installationId,trigger:e.payload.trigger,websiteLanguage:e.payload.sourceLang,targetLanguage:n.selectedTargetLanguage,characterCount:e.payload.texts.reduce(((e,t)=>e+t.length),0),translationPerformance:i,domainName:e.payload.domainName,glossaryTrackingInfo:s})}catch(e){console.error(e)}const a=o.map((e=>e.join("")));return a}async function Bv(e){await m_();const n=await f_(["selectedTargetLanguage","session","installationId","languagePreferenceForReading","regionalVariant"]),r=e.payload.nicheIntegration||k.default,o={sourceLang:e.payload.sourceLang||"auto",targetLangCode:n.selectedTargetLanguage,sessionId:n.session.id,id:t(),sourceTexts:e.payload.requests.map((e=>e.text)),weights:n.languagePreferenceForReading,splitting:"newlines",regionalVariant:n.regionalVariant,nicheIntegration:r,isWriteRequest:e.payload.isWriteRequest};let s,i,a;try{const e=await Fv(o);s=e.result,i=e.processedText,a=e.glossaryTrackingInfo}catch(t){try{e.payload.isWriteRequest?Uy(M.ERROR,{lang:e.payload.websiteLanguage,sourceLength:e.payload.requests.reduce(((e,t)=>e+t.text.length),0),targetLength:0,nicheIntegration:r,error:t.name}):Gm({errorCode:t.name,errorMessage:t.message,domainName:e.payload.domainName,targetLang:n.selectedTargetLanguage,websiteLanguage:e.payload.websiteLanguage,trigger:e.payload.trigger,characterCount:e.payload.requests.reduce(((e,t)=>e+t.text.length),0)})}catch(e){console.log(e)}throw t}$S(s?.source_lang,n?.selectedTargetLanguage),e.payload.platformBehavior===k.gslides&&cT();try{if(s.detectedLanguages){for(const e in s.detectedLanguages)(n.languagePreferenceForReading[e]||0===n.languagePreferenceForReading[e])&&(n.languagePreferenceForReading[e]=iv(n.languagePreferenceForReading[e],s.detectedLanguages[e]));chrome.storage.sync.set({languagePreferenceForReading:n.languagePreferenceForReading})}}catch(e){console.error(e)}try{e.payload.isWriteRequest?Uy(M.TEXT_REFINEMENT_REQUEST,{lang:e.payload.sourceLang,sourceLength:e.payload.requests.reduce(((e,t)=>e+t.text.length),0),targetLength:i.flat().reduce(((e,t)=>e+t.length),0),nicheIntegration:r}):Fm({installationId:n.installationId,trigger:e.payload.trigger,websiteLanguage:s.source_lang,targetLanguage:n.selectedTargetLanguage,characterCount:e.payload.requests.reduce(((e,t)=>e+t.text.length),0),domainName:e.payload.domainName,nicheIntegration:r,glossaryTrackingInfo:a})}catch(e){console.error(e)}return i.map((e=>({text:e.join(""),detected_source_language:s.source_lang})))}async function Hv(e){await m_();const n=await f_(["targetLanguageUserInput","session","installationId","languagePreferenceForWriting","regionalVariant"]),r=e.payload.requests,o=e.payload.targetLang||n.targetLanguageUserInput,s=e.payload.platformBehavior||k.default,i={sourceLang:"auto",targetLangCode:o,sessionId:n.session.id,id:t(),sourceTexts:r.map((e=>e.text))||[],weights:n.languagePreferenceForWriting,splitting:"paragraphs",textType:"richtext",regionalVariant:n.regionalVariant,nicheIntegration:s,...e.payload.isHtml&&{isHtml:e.payload.isHtml},...e.payload.formality&&{formality:e.payload.formality},...e.payload.isWriteRequest&&{isWriteRequest:e.payload.isWriteRequest}};let a,c,u;try{const e=await Fv(i);a=e.result,c=e.processedText,u=e.glossaryTrackingInfo}catch(t){try{e.payload.isWriteRequest?Uy(M.ERROR,{lang:e.payload.source_lang,sourceLength:r.reduce(((e,t)=>e+t.text.length),0),targetLength:0,nicheIntegration:s,error:t.name}):Gm({errorCode:t.name,errorMessage:t.message,domainName:e.payload.domainName,targetLang:o,websiteLanguage:e.payload.websiteLanguage,trigger:l.input,characterCount:r.reduce(((e,t)=>e+t.text.length),0)})}catch(e){console.log(e)}throw t}$S(a?.source_lang,o),e.payload.platformBehavior===k.gmail?iT():e.payload.platformBehavior===k.gslides&&cT();try{if(a.detectedLanguages){for(const e in a.detectedLanguages)(n.languagePreferenceForWriting[e]||0===n.languagePreferenceForWriting[e])&&(n.languagePreferenceForWriting[e]=iv(n.languagePreferenceForWriting[e],a.detectedLanguages[e]));chrome.storage.sync.set({languagePreferenceForWriting:n.languagePreferenceForWriting})}}catch(e){console.error(e)}if(!0!==e.payload.skipDapReporting)try{e.payload.isWriteRequest?Uy(M.TEXT_REFINEMENT_REQUEST,{lang:e.payload.source_lang,sourceLength:r.reduce(((e,t)=>e+t.text.length),0),targetLength:c.flat().reduce(((e,t)=>e+t.length),0),nicheIntegration:s}):Fm({installationId:n.installationId,trigger:l.input,websiteLanguage:a.sourceLang,targetLanguage:o,characterCount:r.reduce(((e,t)=>e+t.text.length),0),domainName:e.payload.domainName,nicheIntegration:s,glossaryTrackingInfo:u})}catch(e){console.error(e)}return[{detected_source_language:a.source_lang,text:c.flat().join(""),texts:c.map((e=>e.join("")))}]}async function Jv(e){await m_();const t=await f_(["session","installationId","languagePreferenceForWriting","regionalVariant","zendeskActiveTermbase"]),n=e.payload.texts,r=e.payload.targetLang,o=k.zendesk,s=Cv.TRANSLATE,i=e.payload.formality;let a,c;const u=[],d=[];let p;try{const e=await Ov({texts:n,mode:s});let o;if(c=e.result.lang.detected,t.zendeskActiveTermbase&&t.zendeskActiveTermbase.termDictionaries)for(let e of t.zendeskActiveTermbase.termDictionaries)if(e.languagePair===`${c.substr(0,2)}>${r.substr(0,2)}`.toLowerCase()){o={id:t.zendeskActiveTermbase.id,dictionaryId:e.id},p=!0;break}for(const t of e.result.texts){const e=[];for(const n of t.chunks)for(const t of n.sentences)d.push(t),e.push(d.length-1);u.push(e)}const l=d.map(((e,t)=>({kind:"default",preferred_num_beams:4,raw_en_context_after:t<d.length-1?[d[t+1].text]:[],raw_en_context_before:t>0?[d[t-1].text]:[],sentences:[{...e,id:t+1}]})));a=await Lv({mode:s,jobs:l,sourceLang:c,targetLang:r.substr(0,2),textType:"richtext",...i&&{formality:i},...o&&{termbase:o}})}catch(t){try{Gm({errorCode:t.name,errorMessage:t.message,domainName:e.payload.domainName,targetLang:r,websiteLanguage:e.payload.websiteLanguage,trigger:l.input,characterCount:n.reduce(((e,t)=>e+t.text.length),0)})}catch(e){console.log(e)}throw t}const h=a.result.translations.map(((e,t)=>`${d[t].prefix}${e.beams[0].sentences[0].text}`)),f=u.map((e=>e.map((e=>h[e]))));if($S(c,r),US(),!0!==e.payload.skipDapReporting)try{Fm({installationId:t.installationId,trigger:l.input,websiteLanguage:c,targetLanguage:r,characterCount:n.reduce(((e,t)=>e+t.length),0),domainName:e.payload.domainName,nicheIntegration:o,isGlossaryEnabled:p})}catch(e){console.error(e)}return[{detected_source_language:c,text:f[0],texts:f}]}async function zv(e){await m_();const n=await f_(["targetLanguage","session","installationId","regionalVariant"]),r=e.payload.requests,o=e.payload.sourceLang,s=e.payload.targetLang||n.targetLanguage,i=k.gmail,a={sourceLang:o||"auto",targetLangCode:s,sessionId:n.session.id,id:t(),sourceTexts:r.map((e=>e.text))||[],splitting:"newlines",regionalVariant:n.regionalVariant};let c,u,d;try{const e=await Fv(a);c=e.result,u=e.processedText,d=e.glossaryTrackingInfo}catch(t){try{Gm({errorCode:t.name,errorMessage:t.message,domainName:e.payload.domainName,targetLang:s,trigger:l.input,characterCount:r.reduce(((e,t)=>e+t.text.length),0)})}catch(e){console.log(e)}throw t}$S(c?.source_lang,s),iT();try{Fm({installationId:n.installationId,trigger:l.manual,websiteLanguage:c.source_lang,targetLanguage:s,characterCount:r.reduce(((e,t)=>e+t.text.length),0),domainName:e.payload.domainName,nicheIntegration:i,glossaryTrackingInfo:d})}catch(e){console.error(e)}return[{detected_source_language:c.source_lang,text:u.flat().join(""),texts:u.map((e=>e.join("")))}]}async function Yv(e){await m_();const n=await f_(["selectedTargetLanguage","session","installationId","regionalVariant"]),r=e.payload.message,o=r.replace(/\n/g,"<br>"),s={sourceLang:"auto",targetLangCode:n.selectedTargetLanguage,sessionId:n.session.id,id:t(),textType:"richtext",sourceTexts:[o],regionalVariant:n.regionalVariant};let i;try{i=(await nv(s)).texts[0]}catch(t){try{sy({errorCode:t.name,errorMessage:t.message,domainName:e.payload.domainName,targetLang:n.selectedTargetLanguage,messageLang:e.payload.messageLang,messageLength:r.length})}catch(e){console.log(e)}throw t}$S(i?.source_lang,n?.selectedTargetLanguage);try{Fm({installationId:n.installationId,trigger:e.payload.trigger,websiteLanguage:e.payload.messageLang,targetLanguage:n.selectedTargetLanguage,characterCount:r.length,domainName:e.payload.domainName,nicheIntegration:k.twitter})}catch(e){console.error(e)}return i.replace(/<br\s*\/?>/gi,"\n")}async function Xv(e){await m_();const n=await f_(["selectedTargetLanguage","session","installationId","regionalVariant"]),r=e.payload.message,o={sourceLang:"auto",targetLangCode:n.selectedTargetLanguage,sessionId:n.session.id,id:t(),sourceTexts:[r],splitting:"paragraphs",regionalVariant:n.regionalVariant};let s,i,a;try{const e=await Fv(o);s=e.result,i=e.processedText,a=e.glossaryTrackingInfo}catch(t){try{iy({errorCode:t.name,errorMessage:t.message,domainName:e.payload.domainName,targetLang:n.selectedTargetLanguage,messageLang:e.payload.messageLang,messageLength:r.length})}catch(e){console.log(e)}throw t}$S(s?.source_lang,n?.selectedTargetLanguage);try{Fm({installationId:n.installationId,trigger:e.payload.trigger,websiteLanguage:e.payload.messageLang,targetLanguage:n.selectedTargetLanguage,characterCount:r.length,domainName:e.payload.domainName,nicheIntegration:k.youtube,glossaryTrackingInfo:a})}catch(e){console.error(e)}return i.map((e=>({text:e.join(""),detected_source_language:s.source_lang})))}async function Kv(e){await m_();const n=await f_(["selectedTargetLanguage","session","installationId","regionalVariant"]),r=e.payload.message,o={sourceLang:"auto",targetLangCode:n.selectedTargetLanguage,sessionId:n.session.id,id:t(),sourceTexts:[r],splitting:"paragraphs",regionalVariant:n.regionalVariant};let s,i,a;try{const e=await Fv(o);s=e.result,i=e.processedText,a=e.glossaryTrackingInfo}catch(t){try{Gm({errorCode:t.name,errorMessage:t.message,domainName:e.payload.domainName,targetLang:n.selectedTargetLanguage,websiteLanguage:e.payload.messageLang,characterCount:r.length,trigger:e.payload.trigger,nicheIntegration:k.linkedIn})}catch(e){console.log(e)}throw t}$S(s?.source_lang,n?.selectedTargetLanguage);try{Fm({installationId:n.installationId,trigger:e.payload.trigger,websiteLanguage:e.payload.messageLang,targetLanguage:n.selectedTargetLanguage,characterCount:r.length,domainName:e.payload.domainName,nicheIntegration:k.linkedIn,glossaryTrackingInfo:a})}catch(e){console.error(e)}return i.map((e=>({text:e.join(""),detected_source_language:s.source_lang})))}async function Qv(e){await m_();const n=await f_(["selectedTargetLanguage","session","installationId","regionalVariant"]),r=e.payload.message,o={sourceLang:"auto",targetLangCode:n.selectedTargetLanguage,sessionId:n.session.id,id:t(),sourceTexts:[r],splitting:"paragraphs",regionalVariant:n.regionalVariant};let s,i,a;try{const e=await Fv(o);s=e.result,i=e.processedText,a=e.glossaryTrackingInfo}catch(t){try{oy({errorCode:t.name,errorMessage:t.message,domainName:e.payload.domainName,targetLang:n.selectedTargetLanguage,messageLang:e.payload.messageLang,messageLength:r.length,numberOfLanguages:1,numberOfMessages:1,translator:N.message})}catch(e){console.log(e)}throw t}$S(s?.sourceLang,n?.selectedTargetLanguage);try{ry({messageLang:e.payload.messageLang,targetLang:n.selectedTargetLanguage,messageLength:r.length,numberOfLanguages:1,numberOfMessages:1,translator:N.message}),Fm({installationId:n.installationId,trigger:e.payload.trigger,websiteLanguage:e.payload.messageLang,targetLanguage:n.selectedTargetLanguage,characterCount:r.length,domainName:e.payload.domainName,nicheIntegration:k.whatsappWeb,glossaryTrackingInfo:a})}catch(e){console.error(e)}return i.map((e=>({text:e.join(""),detected_source_language:s.source_lang})))}async function Zv(e){await m_();const n=await f_(["selectedTargetLanguage","session","installationId","regionalVariant"]),r=e.payload.messages,o={sourceLang:"auto",targetLangCode:n.selectedTargetLanguage,sessionId:n.session.id,id:t(),sourceTexts:r,splitting:"paragraphs",regionalVariant:n.regionalVariant};let s;try{s=await nv(o)}catch(t){try{oy({errorCode:t.name,errorMessage:t.message,domainName:e.payload.domainName,targetLang:n.selectedTargetLanguage,messageLang:e.payload.messageLang,messageLength:r.reduce(((e,t)=>e+t.length),0),numberOfLanguages:e.payload.detectedLanguages?.length,numberOfMessages:r.length,translator:N.chat})}catch(e){console.log(e)}throw t}$S(s?.sourceLang,n?.selectedTargetLanguage);try{ry({messageLang:e.payload.messageLang,targetLang:n.selectedTargetLanguage,messageLength:r.reduce(((e,t)=>e+t.length),0),numberOfLanguages:e.payload.detectedLanguages?.length,numberOfMessages:r.length,translator:N.chat}),Fm({installationId:n.installationId,trigger:e.payload.trigger,websiteLanguage:e.payload.messageLang,targetLanguage:n.selectedTargetLanguage,characterCount:r.reduce(((e,t)=>e+t.length),0),domainName:e.payload.domainName,nicheIntegration:k.whatsappWeb})}catch(e){console.error(e)}return[{detected_source_language:s.sourceLang,texts:s.texts}]}async function eS(e){const{texts:t,mode:n}=e.payload;return await Ov({texts:t,mode:n})}async function tS(e){await m_();const t=await f_(["session","installationId","regionalVariant","activeTermbaseId","isGlossaryEnabled","isLoggedIn","hasTermbaseService"]),{mode:n,sentences:r,sourceLang:o,targetLang:s,domain:i}=e.payload,c=n===Cv.WRITE;let l;try{l=await ET({isLoggedIn:t.isLoggedIn,activeTermbaseId:t.activeTermbaseId,isGlossaryEnabled:t.isGlossaryEnabled,hasTermbaseService:t.hasTermbaseService,sourceLang:o,targetLang:s,mode:n})}catch(e){console.error(e)}let u=4,d=null,p=a.includes(o);c&&(p&&(u=1),d=o),await chrome.storage.sync.set({gdocsWriteLang:d});const h=r.map(((e,t)=>({kind:"default",preferred_num_beams:u,raw_en_context_after:t<r.length-1?[r[t+1].text]:[],raw_en_context_before:t>0?[r[t-1].text]:[],sentences:[{...e,id:t+1}],...c&&!p&&{write_variant_requests:["main"]}}))),f=new Date,g=await Lv({mode:n,jobs:h,sourceLang:o,targetLang:s,...l&&{termbase:l}});try{n===Cv.TRANSLATE&&Fm({installationId:t.installationId,trigger:e.payload.trigger,websiteLanguage:e.payload.sourceLang,targetLanguage:s,characterCount:r.map((e=>e.text)).reduce(((e,t)=>e+t.length),0),translationPerformance:{isFirstTime:!1,processingTimeInMs:new Date-f},domainName:i,nicheIntegration:k.gdocs})}catch(e){console.error(e)}return g}async function nS(e){const{mode:t,sourceLang:n,targetLang:r,sentence:o,contextBefore:s,contextAfter:i}=e.payload,a=[{kind:"default",preferred_num_beams:4,raw_en_context_after:i?[i]:[],raw_en_context_before:s?[s]:[],sentences:[{...o,partial_translation:"",id:0}],...t===Cv.WRITE&&{write_variant_requests:["main","variants"]}}];return await Lv({mode:t,jobs:a,sourceLang:n,targetLang:r})}async function rS(e){const{mode:t,sourceLang:n,targetLang:r,sentence:o,contextBefore:s,contextAfter:i,partialTranslation:a}=e.payload,c=[{kind:"alternatives_at_position",raw_en_context_after:i?[i]:[],raw_en_context_before:s?[s]:[],sentences:[{...o,partial_translation:a,id:0}],...t===Cv.WRITE&&{write_variant_requests:["main"]}}];return await Lv({mode:t,jobs:c,sourceLang:n,targetLang:r})}async function oS(e){const{mode:t,sourceLang:n,targetLang:r,sentence:o,contextBefore:s,contextAfter:i,partialTranslation:c}=e.payload,l=t===Cv.WRITE,u=a.includes(n);let d=4;l&&u&&(d=1);const p=[{kind:"default",raw_en_context_after:i?[i]:[],raw_en_context_before:s?[s]:[],preferred_num_beams:d,sentences:[{...o,partial_translation:c,id:0}],...t===Cv.WRITE&&!u&&{write_variant_requests:["main"]}}];return await Lv({mode:t,jobs:p,sourceLang:n,targetLang:r})}async function sS(e){await m_();const t=await f_(["session","installationId","regionalVariant","zendeskActiveTermbase"]),n=Cv.TRANSLATE,r=k.zendesk,{targetLang:o}=e.payload,s=[e.payload.text],i=s.map((e=>e.replaceAll("\n","<br>"))),a=[],c=[];let u,d,p,h;try{const e=await Ov({texts:i,mode:n,textType:"richtext"});if(h=e.result.lang.detected,t.zendeskActiveTermbase&&t.zendeskActiveTermbase.termDictionaries)for(let e of t.zendeskActiveTermbase.termDictionaries)if(e.languagePair===`${h.substr(0,2)}>${o.substr(0,2)}`.toLowerCase()){u={id:t.zendeskActiveTermbase.id,dictionaryId:e.id},d=!0;break}for(const t of e.result.texts){const e=[];for(const n of t.chunks)for(const t of n.sentences)c.push(t),e.push(c.length-1);a.push(e)}const r=c.map(((e,t)=>({kind:"default",preferred_num_beams:4,raw_en_context_after:t<c.length-1?[c[t+1].text]:[],raw_en_context_before:t>0?[c[t-1].text]:[],sentences:[{...e,id:t+1}]})));p=await Lv({mode:n,jobs:r,sourceLang:h,targetLang:o.substr(0,2),textType:"richtext",...u&&{termbase:u}})}catch(t){try{Gm({errorCode:t.name,errorMessage:t.message,domainName:e.payload.domainName,targetLang:o,websiteLanguage:e.payload.websiteLanguage,trigger:l.inline,characterCount:s.reduce(((e,t)=>e+t.text.length),0)})}catch(e){console.log(e)}throw t}$S(h,o),US();const f=p.result.translations.map(((e,t)=>`${c[t].prefix}${e.beams[0].sentences[0].text}`)),g=a.map((e=>e.map((e=>f[e])))),m=g[0].join("");try{Fm({installationId:t.installationId,trigger:l.input,websiteLanguage:h,targetLanguage:o,characterCount:s.reduce(((e,t)=>e+t.length),0),domainName:e.payload.domainName,nicheIntegration:r,isGlossaryEnabled:d})}catch(e){console.error(e)}return m}async function iS(){let e,t,n="";try{e=await xS()}catch(e){t=e.message}if(!e||!e.isLoggedIn||t)return[[],t];try{n=(await Nv()).result||[]}catch(e){t=e.message}return[n,t]}async function aS(e){try{Zm({language:e.payload.language,domainName:e.payload.domainName})}catch(e){console.error(e)}}async function cS(e){try{qm({domainName:e})}catch(e){console.error(e)}}async function lS(e){try{Wm({domainName:e.domainName,pathName:e.pathName,extensionOpenedFrom:am(e.extensionContext)})}catch(e){console.error(e)}}async function uS(e){try{Bm({logoClickedFrom:cm(e.extensionContext)})}catch(e){console.error(e)}}async function dS(){try{Ym()}catch(e){console.error(e)}}async function pS(){try{Xm()}catch(e){console.error(e)}}async function hS(e){try{Km({uiFunction:e.uiFunction,uiLocation:e.uiLocation,nicheIntegration:e.nicheIntegration||k.default})}catch(e){console.error(e)}}async function fS(e){try{Qm({settingType:e.settingType,newValue:e.newValue,uiFunction:e.uiFunction,uiLocation:e.uiLocation,domainName:e.domainName})}catch(e){console.error(e)}}async function gS(e){try{ey({translationType:e.translationType,domainName:e.domainName})}catch(e){console.error(e)}}async function mS(e){try{ty({newPosition:e.newPosition})}catch(e){console.error(e)}}async function yS(e){try{ny(e)}catch(e){console.error(e)}}async function _S(e){try{ay(e)}catch(e){console.error(e)}}async function vS(e){try{uy(e)}catch(e){console.error(e)}}async function SS(e){try{cy(e)}catch(e){console.error(e)}}async function TS(e){try{dy(e)}catch(e){console.error(e)}}async function bS(e){try{ly(e)}catch(e){console.error(e)}}async function wS(e){try{gy(e)}catch(e){console.error(e)}}async function ES(e){try{py(e)}catch(e){console.error(e)}}async function IS(e){try{hy(e)}catch(e){console.error(e)}}async function AS(e){try{_y(e)}catch(e){console.error(e)}}async function RS(e=!1){const t=await U_(e);return chrome.runtime.sendMessage({action:"dlExperimentsUpdated",payload:{experiments:[...t]}}),t}async function kS(){K_()}async function CS(){Q_({trigger:x.user})}async function xS(){const e=await k_();return{isLoggedIn:e.isLoggedIn,translatorServiceType:e.translatorServiceType,writeServiceType:e.writeServiceType,hasTermbaseService:e.hasTermbaseService}}async function OS(e){switch(e.type){case m.hintKeyboardShortcut:{const e=await chrome.storage.sync.get(["notificationsViewed"]);if(e.notificationsViewed&&e.notificationsViewed.hintKeyboardShortcut)return;await chrome.storage.sync.set({notificationsViewed:{...e.notificationsViewed,hintKeyboardShortcut:!0}});break}case m.showAdsForMSAddins:{const t=await chrome.storage.sync.get(["notificationsViewed"]),n=`showAdsFor${e.options.matchedWord}`;if(t.notificationsViewed&&t.notificationsViewed[n])return;try{t_({matchedWord:e.options.matchedWord})}catch(e){console.error(e)}await chrome.storage.sync.set({notificationsViewed:{...t.notificationsViewed,[n]:!0}});break}}try{Hm({notificationType:e.type})}catch(e){console.error(e)}const t=await chrome.tabs.query({active:!0,currentWindow:!0});chrome.tabs.sendMessage(t[0].id,{action:"dlShowNotification",payload:e})}async function LS(){return await chrome.commands.getAll()}async function NS(e){const t=await LS();try{Jm({shortcutType:e.shortcutType,location:e.location,shortcut:t.filter((t=>t.name===e.shortcutType))[0].shortcut,nicheIntegration:e.nicheIntegration||k.default})}catch(e){console.error(e)}}async function PS(e){zm({uiAction:e.uiAction,nicheIntegration:e.nicheIntegration||k.default})}function DS(e){chrome.tabs.query({active:!0,currentWindow:!0},(function(t){chrome.tabs.sendMessage(t[0].id,{action:"dlTranslateSelectionRightClick",payload:e})}))}async function MS(e){try{fy(e)}catch(e){console.error(e)}}async function US(){const e=(await chrome.storage.sync.get(["zendeskSuccessfulTranslations"])).zendeskSuccessfulTranslations+1;await chrome.storage.sync.set({zendeskSuccessfulTranslations:e})}async function $S(e,t){const n=await chrome.storage.sync.get(["isReviewPopupShown","successfulTranslations","hasUserSeenProCustomerSegmentationSurvey","hasUserSeenArabicSurvey","successfulArabicTranslations"]),r=await xS();Pg(r,P.TRANSLATOR);const o=n.successfulTranslations+1;n.hasUserSeenProCustomerSegmentationSurvey;let s=n.isReviewPopupShown,i=n.hasUserSeenArabicSurvey,a=n.successfulArabicTranslations;if("AR"!==e&&"AR"!==t||(a+=1),!i&&"ar"===chrome.i18n.getUILanguage()&&o>=10){const e=await chrome.tabs.query({active:!0,currentWindow:!0});return chrome.tabs.sendMessage(e[0].id,{action:"dlShowArabicSurveyPopup"}),void await chrome.storage.sync.set({hasUserSeenArabicSurvey:!0,successfulArabicTranslations:a,successfulTranslations:o})}if(!i&&a>=10){const e=await chrome.tabs.query({active:!0,currentWindow:!0});return chrome.tabs.sendMessage(e[0].id,{action:"dlShowArabicSurveyPopup"}),void await chrome.storage.sync.set({hasUserSeenArabicSurvey:!0,successfulArabicTranslations:a,successfulTranslations:o})}if(!s&&o>=R){const e=await chrome.tabs.query({active:!0,currentWindow:!0});chrome.tabs.sendMessage(e[0].id,{action:"dlShowAskForAReviewPopup"}),s=!0}await chrome.storage.sync.set({isReviewPopupShown:s,successfulArabicTranslations:a,successfulTranslations:o})}async function FS(e,t){let n=Sg(e.lang);if(Y())await function(e,t,n){const r=new SpeechSynthesisUtterance(e);r.lang=t,r.onend=function(){n()},speechSynthesis.speak(r)}(e.text,n.langCodeForSpeech,(()=>{chrome.tabs.sendMessage(t,{action:"dlVoiceOverStopped"})}));else{const r={lang:n.langCodeForSpeech,onEvent:function(e){"end"===e.type&&chrome.tabs.sendMessage(t,{action:"dlVoiceOverStopped"}),"error"==e.type&&chrome.tabs.sendMessage(t,{action:"dlVoiceOverErrorOccurred"})}};(function(){const e=navigator?.userAgentData?.platform||navigator?.platform||void 0;return e&&-1!==e?.toUpperCase().indexOf("MAC")})()&&(r.rate=.9,n.voice&&I.chrome===chrome.runtime.id&&(r.voiceName=n.voice)),await chrome.tts.speak(e.text,r)}}async function jS(){let e;return e=Y()?await new Promise(((e,t)=>{if("speechSynthesis"in window){const t=speechSynthesis.getVoices();t.length>0?e(t):speechSynthesis.onvoiceschanged=()=>{const t=speechSynthesis.getVoices();e(t)}}else t(new Error("SpeechSynthesis not supported"))})):await chrome.tts.getVoices(),e.map((e=>vg(e.lang)))}async function GS(){if(!Y())return chrome.tts.stop();speechSynthesis.cancel()}async function VS(e){try{my(e)}catch(e){console.error(e)}}async function qS(e){try{Sy(e)}catch(e){console.error(e)}}async function WS(e){try{yy(e)}catch(e){console.error(e)}}async function BS(e){try{Ty(e)}catch(e){console.error(e)}}async function HS(e){return await ov(e)}async function JS(e){try{by(e)}catch(e){console.error(e)}}async function zS(e){try{wy()}catch(e){console.error(e)}}async function YS(e){try{Ey()}catch(e){console.error(e)}}async function XS({eventType:e,zendeskMetaData:t}){try{Ay(e,t)}catch(e){console.error(e)}}async function KS(e){try{Iy(e)}catch(e){console.error(e)}}async function QS(e){try{xy(e)}catch(e){console.error(e)}}async function ZS(e){try{Oy(e)}catch(e){console.error(e)}}async function eT(e){try{Ny(e)}catch(e){console.error(e)}}async function tT(e){try{Py(e)}catch(e){console.error(e)}}async function nT({eventType:e,deeplWriteMetaData:t}){try{Uy(e,t)}catch(e){console.error(e)}}async function rT(e){try{await m_();const n=await f_(["selectedTargetLanguage","session"]),r=e.payload.requests,o={sourceLang:e.payload?.sourceLang?e.payload.sourceLang:"auto",targetLangCode:n.selectedTargetLanguage,sessionId:n.session.id,id:t(),sourceTexts:r.map((e=>e.text))||[],isWriteRequest:!0,...e.payload.isHtml&&{isHtml:!0}},s=await Fv(o),i=s.result,a=s.processedText;if(!e.payload.skipDapReporting)try{Uy(M.TEXT_REFINEMENT_REQUEST,{lang:i.source_lang,sourceLength:e.payload.requests.reduce(((e,t)=>e+t.text.length),0),targetLength:a.flat().reduce(((e,t)=>e+t.length),0),nicheIntegration:e.payload.nicheIntegration||k.default})}catch(e){console.error(e)}return[{detected_source_language:i.source_lang,text:a.flat().join(""),texts:a.map((e=>e.join("")))}]}catch(t){try{Uy(M.ERROR,{lang:e.payload.sourceLang,sourceLength:e.payload.requests.reduce(((e,t)=>e+t.text.length),0),targetLength:void 0,nicheIntegration:e.payload.nicheIntegration||k.default,error:t.name})}catch(e){console.error(e)}throw t}}async function oT({eventType:e,acceptOrRevertMetadata:t}){try{Gy(e,t)}catch(e){console.error(e)}}async function sT(e){try{Vy(e)}catch(e){console.error(e)}}async function iT(){const e=await chrome.storage.sync.get(["wasGmailFeedbackPopupShown","successfulTranslationsGmail"]),t=e.successfulTranslationsGmail+1;let n=e.wasGmailFeedbackPopupShown;if(!n&&t>=10){const e=await chrome.tabs.query({active:!0,currentWindow:!0});chrome.tabs.sendMessage(e[0].id,{action:"dlShowGmailFeedbackPopup"}),n=!0}await chrome.storage.sync.set({wasGmailFeedbackPopupShown:n,successfulTranslationsGmail:t})}async function aT(e){try{qy(e)}catch(e){console.error(e)}}async function cT(){const e=await chrome.storage.sync.get(["wasGSlidesFeedbackPopupShown","successfulTranslationsGSlides"]),t=e.successfulTranslationsGSlides+1;let n=e.wasGSlidesFeedbackPopupShown;if(!n&&t>=10){const e=await chrome.tabs.query({active:!0,currentWindow:!0});chrome.tabs.sendMessage(e[0].id,{action:"dlShowSlidesFeedbackPopup"}),n=!0}await chrome.storage.sync.set({wasGSlidesFeedbackPopupShown:n,successfulTranslationsGSlides:t})}async function lT({eventType:e,alternativesMetaData:t}){try{Jy(e,t)}catch(e){console.error(e)}}async function uT(e=!1,t=!0){let n;try{n=await X_(e,t)}catch(e){throw e.name===$_.INVALID_GRANT&&Q_({trigger:x.extension,reason:e.name,showAlert:!0}),e}return n}async function dT(){return await P_()}function pT(e){try{Wy(e)}catch(e){console.error(e)}}function hT(e){try{By(e)}catch(e){console.error(e)}}function fT(e){try{Ry(e)}catch(e){console.error(e)}}function gT(e){try{zy(!0,e)}catch(e){console.error(e)}}function mT(e){try{zy(!1,e)}catch(e){console.error(e)}}function yT(e,t){try{Hy(e,t)}catch(e){console.error(e)}}async function _T({text:e}){return await xv({texts:[e],targetLang:"EN",mode:Cv.WRITE})}function vT(e){Yy(e)}function ST(){Xy()}function TT(e){Ky(e)}async function bT(e){await m_();const t=e.payload.texts,n=Cv.TRANSLATE;let r;const o=[],s=[],i=await Ov({texts:t,mode:n});r=i.result.lang.detected;for(const e of i.result.texts){const t=[];for(const n of e.chunks)for(const e of n.sentences)s.push(e),t.push(s.length-1);o.push(t)}return{detected_source_language:r,sentences:s,textLinesComponents:o}}async function wT(e){await m_();const t=await f_(["activeTermbaseId","targetLanguageUserInput","session","installationId","languagePreferenceForWriting","regionalVariant","isLoggedIn","isGlossaryEnabled","hasTermbaseService"]),n=e.payload.texts,r=e.payload.mode?e.payload.mode:Cv.TRANSLATE,o=e.payload.targetLang,s=e.payload.writeLang,i=Tg(o,t.regionalVariant);let a;const c=[],u=[];let d,p,h=!1,f=!1,g=!1;try{const l=await Ov({texts:n,mode:r,advancedMode:!!e.payload.style});if(a=l.result.lang.detected,Dg({isLoggedIn:t.isLoggedIn,hasTermbaseService:t.hasTermbaseService})&&t.activeTermbaseId&&r!==Cv.WRITE&&t.isGlossaryEnabled)try{const[e]=await iS(),n=Uv(t.activeTermbaseId,e);if(n)for(let e of n.termDictionaries)if(e.languagePair===`${a.substr(0,2)}>${i.langCode.substr(0,2)}`.toLowerCase()){p={id:n.id,dictionaryId:e.id},h=!0,f=n.shared;break}}catch(e){console.log({e:e,message:"fetching glossaries failed"})}for(const e of l.result.texts){const t=[];for(const n of e.chunks)for(const e of n.sentences)u.push(e),t.push(u.length-1);c.push(t)}const g=u.map(((t,n)=>({kind:"default",preferred_num_beams:6,raw_en_context_after:n<u.length-1?[u[n+1].text]:[],raw_en_context_before:n>0?[u[n-1].text]:[],sentences:[{...t,id:n+1}],...e.payload.style&&{style_variant:e.payload.style,write_variant_requests:["main","variants"]},...e.payload.formality&&{formality:e.payload.formality}}))),m=i.regionalVariant&&!s;d=await Lv({mode:r,jobs:g,sourceLang:s&&r===Cv.WRITE?s.substr(0,2):a,targetLang:s&&r===Cv.WRITE?s.substr(0,2):o.substr(0,2),textType:"plaintext",styleVariant:e.payload.style,...p&&{termbase:p},...m&&{regionalVariant:i.regionalVariant}})}catch(t){throw r===Cv.WRITE?Uy(M.ERROR,{lang:a,sourceLength:n.reduce(((e,t)=>e+t.length),0),targetLength:0,nicheIntegration:k.default,error:t.name,style:e.payload.style}):Gm({errorCode:t.name,errorMessage:t.message,domainName:e.payload.domainName,targetLang:o,websiteLanguage:a,trigger:l.input_alternatives,characterCount:n.reduce(((e,t)=>e+t.length),0)}),t}g=!!h&&$v(d.result),$S(a,o);const m=d.result.translations,y=d.result.translations.map(((e,t)=>`${u[t].prefix}${e.beams[0].sentences[0].text}`)),_=function(e,t){let n=e[0].beams.length;e.forEach((e=>{e.beams.length<n&&(n=e.beams.length)}));const r=[];for(let o=0;o<n;o++){let n=[];for(let r=0;r<e.length;r++){const s=`${t[r].prefix}`;n.push(`${s}${e[r].beams[o].sentences[0].text}`)}r.push(n)}return r}(m,u),v=c.map((e=>e.map((e=>y[e])))),S=_.map((e=>c.map((t=>t.map((t=>e[t])))))),T=function(e,t){let n=e[0].beams.length;e.forEach((e=>{e.beams.length<n&&(n=e.beams.length)}));const r=[];for(let o=0;o<n;o++){let n="";for(let r=0;r<e.length;r++){n=`${n}${`${t[r].prefix}`}${e[r].beams[o].sentences[0].text}`}r.push(n)}return r}(m,u),b=S.map((e=>e.map((e=>e.join("")))));try{r===Cv.WRITE?(Uy(M.TEXT_REFINEMENT_REQUEST,{lang:a,sourceLength:n.reduce(((e,t)=>e+t.length),0),targetLength:v.flat().reduce(((e,t)=>e+t.length),0),nicheIntegration:k.default,style:e.payload.style}),Uy(M.GET_ALTERNATIVES_FOR_INPUT,{lang:a,sourceLength:n.reduce(((e,t)=>e+t.length),0),targetLength:v.flat().reduce(((e,t)=>e+t.length),0),nicheIntegration:k.default,style:e.payload.style})):Fm({installationId:t.installationId,trigger:l.input_alternatives,websiteLanguage:a,targetLanguage:o,characterCount:n.reduce(((e,t)=>e+t.length),0),domainName:e.payload.domainName,nicheIntegration:k.default,...h&&{glossaryTrackingInfo:{isGlossaryEnabled:!!p,isGlossaryShared:f,didGlossaryChangeTranslation:g}}})}catch(e){console.error(e)}return{detected_source_language:a,processedText:v[0].join(""),textLinesComponents:c,alternatives:T,alternativeComponents:b}}const ET=async e=>{if(Dg(e)&&e.activeTermbaseId&&e.isGlossaryEnabled&&e.mode!==Cv.WRITE){const[t]=await iS(),n=Uv(e.activeTermbaseId,t);if(n)for(let t of n.termDictionaries)if(t.languagePair===`${e.sourceLang.substr(0,2)}>${e.targetLang.substr(0,2)}`.toLowerCase())return{id:n.id,dictionaryId:t.id}}};function IT(){Qy()}function AT(e){Zy(e)}function RT(){e_()}function kT(e){t_(e)}class CT extends Error{constructor(e,t){const n=new.target.prototype;super(`${e}: Status code '${t}'`),this.statusCode=t,this.__proto__=n}}class xT extends Error{constructor(e="A timeout occurred."){const t=new.target.prototype;super(e),this.__proto__=t}}class OT extends Error{constructor(e="An abort occurred."){const t=new.target.prototype;super(e),this.__proto__=t}}class LT extends Error{constructor(e,t){const n=new.target.prototype;super(e),this.transport=t,this.errorType="UnsupportedTransportError",this.__proto__=n}}class NT extends Error{constructor(e,t){const n=new.target.prototype;super(e),this.transport=t,this.errorType="DisabledTransportError",this.__proto__=n}}class PT extends Error{constructor(e,t){const n=new.target.prototype;super(e),this.transport=t,this.errorType="FailedToStartTransportError",this.__proto__=n}}class DT extends Error{constructor(e){const t=new.target.prototype;super(e),this.errorType="FailedToNegotiateWithServerError",this.__proto__=t}}class MT extends Error{constructor(e,t){const n=new.target.prototype;super(e),this.innerErrors=t,this.__proto__=n}}class UT{constructor(e,t,n){this.statusCode=e,this.statusText=t,this.content=n}}class $T{get(e,t){return this.send({...t,method:"GET",url:e})}post(e,t){return this.send({...t,method:"POST",url:e})}delete(e,t){return this.send({...t,method:"DELETE",url:e})}getCookieString(e){return""}}var FT;!function(e){e[e.Trace=0]="Trace",e[e.Debug=1]="Debug",e[e.Information=2]="Information",e[e.Warning=3]="Warning",e[e.Error=4]="Error",e[e.Critical=5]="Critical",e[e.None=6]="None"}(FT||(FT={}));class jT{constructor(){}log(e,t){}}jT.instance=new jT;const GT="8.0.7";class VT{static isRequired(e,t){if(null==e)throw new Error(`The '${t}' argument is required.`)}static isNotEmpty(e,t){if(!e||e.match(/^\s*$/))throw new Error(`The '${t}' argument should not be empty.`)}static isIn(e,t,n){if(!(e in t))throw new Error(`Unknown ${n} value: ${e}.`)}}class qT{static get isBrowser(){return!qT.isNode&&"object"==typeof window&&"object"==typeof window.document}static get isWebWorker(){return!qT.isNode&&"object"==typeof self&&"importScripts"in self}static get isReactNative(){return!qT.isNode&&"object"==typeof window&&void 0===window.document}static get isNode(){return"undefined"!=typeof process&&process.release&&"node"===process.release.name}}function WT(e,t){let n="";return BT(e)?(n=`Binary data of length ${e.byteLength}`,t&&(n+=`. Content: '${function(e){const t=new Uint8Array(e);let n="";return t.forEach((e=>{n+=`0x${e<16?"0":""}${e.toString(16)} `})),n.substr(0,n.length-1)}(e)}'`)):"string"==typeof e&&(n=`String data of length ${e.length}`,t&&(n+=`. Content: '${e}'`)),n}function BT(e){return e&&"undefined"!=typeof ArrayBuffer&&(e instanceof ArrayBuffer||e.constructor&&"ArrayBuffer"===e.constructor.name)}async function HT(e,t,n,r,o,s){const i={},[a,c]=YT();i[a]=c,e.log(FT.Trace,`(${t} transport) sending data. ${WT(o,s.logMessageContent)}.`);const l=BT(o)?"arraybuffer":"text",u=await n.post(r,{content:o,headers:{...i,...s.headers},responseType:l,timeout:s.timeout,withCredentials:s.withCredentials});e.log(FT.Trace,`(${t} transport) request complete. Response status: ${u.statusCode}.`)}class JT{constructor(e,t){this._subject=e,this._observer=t}dispose(){const e=this._subject.observers.indexOf(this._observer);e>-1&&this._subject.observers.splice(e,1),0===this._subject.observers.length&&this._subject.cancelCallback&&this._subject.cancelCallback().catch((e=>{}))}}class zT{constructor(e){this._minLevel=e,this.out=console}log(e,t){if(e>=this._minLevel){const n=`[${(new Date).toISOString()}] ${FT[e]}: ${t}`;switch(e){case FT.Critical:case FT.Error:this.out.error(n);break;case FT.Warning:this.out.warn(n);break;case FT.Information:this.out.info(n);break;default:this.out.log(n)}}}}function YT(){let e="X-SignalR-User-Agent";return qT.isNode&&(e="User-Agent"),[e,XT(GT,KT(),ZT(),QT())]}function XT(e,t,n,r){let o="Microsoft SignalR/";const s=e.split(".");return o+=`${s[0]}.${s[1]}`,o+=` (${e}; `,o+=t&&""!==t?`${t}; `:"Unknown OS; ",o+=`${n}`,o+=r?`; ${r}`:"; Unknown Runtime Version",o+=")",o}function KT(){if(!qT.isNode)return"";switch(process.platform){case"win32":return"Windows NT";case"darwin":return"macOS";case"linux":return"Linux";default:return process.platform}}function QT(){if(qT.isNode)return process.versions.node}function ZT(){return qT.isNode?"NodeJS":"Browser"}function eb(e){return e.stack?e.stack:e.message?e.message:`${e}`}class tb extends $T{constructor(e){if(super(),this._logger=e,"undefined"==typeof fetch||qT.isNode){const e="function"==typeof __webpack_require__?__non_webpack_require__:require;this._jar=new(e("tough-cookie").CookieJar),"undefined"==typeof fetch?this._fetchType=e("node-fetch"):this._fetchType=fetch,this._fetchType=e("fetch-cookie")(this._fetchType,this._jar)}else this._fetchType=fetch.bind(function(){if("undefined"!=typeof globalThis)return globalThis;if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw new Error("could not find global")}());if("undefined"==typeof AbortController){const e="function"==typeof __webpack_require__?__non_webpack_require__:require;this._abortControllerType=e("abort-controller")}else this._abortControllerType=AbortController}async send(e){if(e.abortSignal&&e.abortSignal.aborted)throw new OT;if(!e.method)throw new Error("No method defined.");if(!e.url)throw new Error("No url defined.");const t=new this._abortControllerType;let n;e.abortSignal&&(e.abortSignal.onabort=()=>{t.abort(),n=new OT});let r,o=null;if(e.timeout){const r=e.timeout;o=setTimeout((()=>{t.abort(),this._logger.log(FT.Warning,"Timeout from HTTP request."),n=new xT}),r)}""===e.content&&(e.content=void 0),e.content&&(e.headers=e.headers||{},BT(e.content)?e.headers["Content-Type"]="application/octet-stream":e.headers["Content-Type"]="text/plain;charset=UTF-8");try{r=await this._fetchType(e.url,{body:e.content,cache:"no-cache",credentials:!0===e.withCredentials?"include":"same-origin",headers:{"X-Requested-With":"XMLHttpRequest",...e.headers},method:e.method,mode:"cors",redirect:"follow",signal:t.signal})}catch(e){if(n)throw n;throw this._logger.log(FT.Warning,`Error from HTTP request. ${e}.`),e}finally{o&&clearTimeout(o),e.abortSignal&&(e.abortSignal.onabort=null)}if(!r.ok){const e=await nb(r,"text");throw new CT(e||r.statusText,r.status)}const s=nb(r,e.responseType),i=await s;return new UT(r.status,r.statusText,i)}getCookieString(e){let t="";return qT.isNode&&this._jar&&this._jar.getCookies(e,((e,n)=>t=n.join("; "))),t}}function nb(e,t){let n;switch(t){case"arraybuffer":n=e.arrayBuffer();break;case"text":default:n=e.text();break;case"blob":case"document":case"json":throw new Error(`${t} is not supported.`)}return n}class rb extends $T{constructor(e){super(),this._logger=e}send(e){return e.abortSignal&&e.abortSignal.aborted?Promise.reject(new OT):e.method?e.url?new Promise(((t,n)=>{const r=new XMLHttpRequest;r.open(e.method,e.url,!0),r.withCredentials=void 0===e.withCredentials||e.withCredentials,r.setRequestHeader("X-Requested-With","XMLHttpRequest"),""===e.content&&(e.content=void 0),e.content&&(BT(e.content)?r.setRequestHeader("Content-Type","application/octet-stream"):r.setRequestHeader("Content-Type","text/plain;charset=UTF-8"));const o=e.headers;o&&Object.keys(o).forEach((e=>{r.setRequestHeader(e,o[e])})),e.responseType&&(r.responseType=e.responseType),e.abortSignal&&(e.abortSignal.onabort=()=>{r.abort(),n(new OT)}),e.timeout&&(r.timeout=e.timeout),r.onload=()=>{e.abortSignal&&(e.abortSignal.onabort=null),r.status>=200&&r.status<300?t(new UT(r.status,r.statusText,r.response||r.responseText)):n(new CT(r.response||r.responseText||r.statusText,r.status))},r.onerror=()=>{this._logger.log(FT.Warning,`Error from HTTP request. ${r.status}: ${r.statusText}.`),n(new CT(r.statusText,r.status))},r.ontimeout=()=>{this._logger.log(FT.Warning,"Timeout from HTTP request."),n(new xT)},r.send(e.content)})):Promise.reject(new Error("No url defined.")):Promise.reject(new Error("No method defined."))}}class ob extends $T{constructor(e){if(super(),"undefined"!=typeof fetch||qT.isNode)this._httpClient=new tb(e);else{if("undefined"==typeof XMLHttpRequest)throw new Error("No usable HttpClient found.");this._httpClient=new rb(e)}}send(e){return e.abortSignal&&e.abortSignal.aborted?Promise.reject(new OT):e.method?e.url?this._httpClient.send(e):Promise.reject(new Error("No url defined.")):Promise.reject(new Error("No method defined."))}getCookieString(e){return this._httpClient.getCookieString(e)}}class sb{static write(e){return`${e}${sb.RecordSeparator}`}static parse(e){if(e[e.length-1]!==sb.RecordSeparator)throw new Error("Message is incomplete.");const t=e.split(sb.RecordSeparator);return t.pop(),t}}sb.RecordSeparatorCode=30,sb.RecordSeparator=String.fromCharCode(sb.RecordSeparatorCode);class ib{writeHandshakeRequest(e){return sb.write(JSON.stringify(e))}parseHandshakeResponse(e){let t,n;if(BT(e)){const r=new Uint8Array(e),o=r.indexOf(sb.RecordSeparatorCode);if(-1===o)throw new Error("Message is incomplete.");const s=o+1;t=String.fromCharCode.apply(null,Array.prototype.slice.call(r.slice(0,s))),n=r.byteLength>s?r.slice(s).buffer:null}else{const r=e,o=r.indexOf(sb.RecordSeparator);if(-1===o)throw new Error("Message is incomplete.");const s=o+1;t=r.substring(0,s),n=r.length>s?r.substring(s):null}const r=sb.parse(t),o=JSON.parse(r[0]);if(o.type)throw new Error("Expected a handshake response from the server.");return[n,o]}}var ab;!function(e){e[e.Invocation=1]="Invocation",e[e.StreamItem=2]="StreamItem",e[e.Completion=3]="Completion",e[e.StreamInvocation=4]="StreamInvocation",e[e.CancelInvocation=5]="CancelInvocation",e[e.Ping=6]="Ping",e[e.Close=7]="Close",e[e.Ack=8]="Ack",e[e.Sequence=9]="Sequence"}(ab||(ab={}));class cb{constructor(){this.observers=[]}next(e){for(const t of this.observers)t.next(e)}error(e){for(const t of this.observers)t.error&&t.error(e)}complete(){for(const e of this.observers)e.complete&&e.complete()}subscribe(e){return this.observers.push(e),new JT(this,e)}}class lb{constructor(e,t,n){this._bufferSize=1e5,this._messages=[],this._totalMessageCount=0,this._waitForSequenceMessage=!1,this._nextReceivingSequenceId=1,this._latestReceivedSequenceId=0,this._bufferedByteCount=0,this._reconnectInProgress=!1,this._protocol=e,this._connection=t,this._bufferSize=n}async _send(e){const t=this._protocol.writeMessage(e);let n=Promise.resolve();if(this._isInvocationMessage(e)){this._totalMessageCount++;let e=()=>{},r=()=>{};BT(t)?this._bufferedByteCount+=t.byteLength:this._bufferedByteCount+=t.length,this._bufferedByteCount>=this._bufferSize&&(n=new Promise(((t,n)=>{e=t,r=n}))),this._messages.push(new ub(t,this._totalMessageCount,e,r))}try{this._reconnectInProgress||await this._connection.send(t)}catch{this._disconnected()}await n}_ack(e){let t=-1;for(let n=0;n<this._messages.length;n++){const r=this._messages[n];if(r._id<=e.sequenceId)t=n,BT(r._message)?this._bufferedByteCount-=r._message.byteLength:this._bufferedByteCount-=r._message.length,r._resolver();else{if(!(this._bufferedByteCount<this._bufferSize))break;r._resolver()}}-1!==t&&(this._messages=this._messages.slice(t+1))}_shouldProcessMessage(e){if(this._waitForSequenceMessage)return e.type===ab.Sequence&&(this._waitForSequenceMessage=!1,!0);if(!this._isInvocationMessage(e))return!0;const t=this._nextReceivingSequenceId;return this._nextReceivingSequenceId++,t<=this._latestReceivedSequenceId?(t===this._latestReceivedSequenceId&&this._ackTimer(),!1):(this._latestReceivedSequenceId=t,this._ackTimer(),!0)}_resetSequence(e){e.sequenceId>this._nextReceivingSequenceId?this._connection.stop(new Error("Sequence ID greater than amount of messages we've received.")):this._nextReceivingSequenceId=e.sequenceId}_disconnected(){this._reconnectInProgress=!0,this._waitForSequenceMessage=!0}async _resend(){const e=0!==this._messages.length?this._messages[0]._id:this._totalMessageCount+1;await this._connection.send(this._protocol.writeMessage({type:ab.Sequence,sequenceId:e}));const t=this._messages;for(const e of t)await this._connection.send(e._message);this._reconnectInProgress=!1}_dispose(e){null!=e||(e=new Error("Unable to reconnect to server."));for(const t of this._messages)t._rejector(e)}_isInvocationMessage(e){switch(e.type){case ab.Invocation:case ab.StreamItem:case ab.Completion:case ab.StreamInvocation:case ab.CancelInvocation:return!0;case ab.Close:case ab.Sequence:case ab.Ping:case ab.Ack:return!1}}_ackTimer(){void 0===this._ackTimerHandle&&(this._ackTimerHandle=setTimeout((async()=>{try{this._reconnectInProgress||await this._connection.send(this._protocol.writeMessage({type:ab.Ack,sequenceId:this._latestReceivedSequenceId}))}catch{}clearTimeout(this._ackTimerHandle),this._ackTimerHandle=void 0}),1e3))}}class ub{constructor(e,t,n,r){this._message=e,this._id=t,this._resolver=n,this._rejector=r}}var db;!function(e){e.Disconnected="Disconnected",e.Connecting="Connecting",e.Connected="Connected",e.Disconnecting="Disconnecting",e.Reconnecting="Reconnecting"}(db||(db={}));class pb{static create(e,t,n,r,o,s,i){return new pb(e,t,n,r,o,s,i)}constructor(e,t,n,r,o,s,i){this._nextKeepAlive=0,this._freezeEventListener=()=>{this._logger.log(FT.Warning,"The page is being frozen, this will likely lead to the connection being closed and messages being lost. For more information see the docs at https://learn.microsoft.com/aspnet/core/signalr/javascript-client#bsleep")},VT.isRequired(e,"connection"),VT.isRequired(t,"logger"),VT.isRequired(n,"protocol"),this.serverTimeoutInMilliseconds=null!=o?o:3e4,this.keepAliveIntervalInMilliseconds=null!=s?s:15e3,this._statefulReconnectBufferSize=null!=i?i:1e5,this._logger=t,this._protocol=n,this.connection=e,this._reconnectPolicy=r,this._handshakeProtocol=new ib,this.connection.onreceive=e=>this._processIncomingData(e),this.connection.onclose=e=>this._connectionClosed(e),this._callbacks={},this._methods={},this._closedCallbacks=[],this._reconnectingCallbacks=[],this._reconnectedCallbacks=[],this._invocationId=0,this._receivedHandshakeResponse=!1,this._connectionState=db.Disconnected,this._connectionStarted=!1,this._cachedPingMessage=this._protocol.writeMessage({type:ab.Ping})}get state(){return this._connectionState}get connectionId(){return this.connection&&this.connection.connectionId||null}get baseUrl(){return this.connection.baseUrl||""}set baseUrl(e){if(this._connectionState!==db.Disconnected&&this._connectionState!==db.Reconnecting)throw new Error("The HubConnection must be in the Disconnected or Reconnecting state to change the url.");if(!e)throw new Error("The HubConnection url must be a valid url.");this.connection.baseUrl=e}start(){return this._startPromise=this._startWithStateTransitions(),this._startPromise}async _startWithStateTransitions(){if(this._connectionState!==db.Disconnected)return Promise.reject(new Error("Cannot start a HubConnection that is not in the 'Disconnected' state."));this._connectionState=db.Connecting,this._logger.log(FT.Debug,"Starting HubConnection.");try{await this._startInternal(),qT.isBrowser&&window.document.addEventListener("freeze",this._freezeEventListener),this._connectionState=db.Connected,this._connectionStarted=!0,this._logger.log(FT.Debug,"HubConnection connected successfully.")}catch(e){return this._connectionState=db.Disconnected,this._logger.log(FT.Debug,`HubConnection failed to start successfully because of error '${e}'.`),Promise.reject(e)}}async _startInternal(){this._stopDuringStartError=void 0,this._receivedHandshakeResponse=!1;const e=new Promise(((e,t)=>{this._handshakeResolver=e,this._handshakeRejecter=t}));await this.connection.start(this._protocol.transferFormat);try{let t=this._protocol.version;this.connection.features.reconnect||(t=1);const n={protocol:this._protocol.name,version:t};if(this._logger.log(FT.Debug,"Sending handshake request."),await this._sendMessage(this._handshakeProtocol.writeHandshakeRequest(n)),this._logger.log(FT.Information,`Using HubProtocol '${this._protocol.name}'.`),this._cleanupTimeout(),this._resetTimeoutPeriod(),this._resetKeepAliveInterval(),await e,this._stopDuringStartError)throw this._stopDuringStartError;(this.connection.features.reconnect||!1)&&(this._messageBuffer=new lb(this._protocol,this.connection,this._statefulReconnectBufferSize),this.connection.features.disconnected=this._messageBuffer._disconnected.bind(this._messageBuffer),this.connection.features.resend=()=>{if(this._messageBuffer)return this._messageBuffer._resend()}),this.connection.features.inherentKeepAlive||await this._sendMessage(this._cachedPingMessage)}catch(e){throw this._logger.log(FT.Debug,`Hub handshake failed with error '${e}' during start(). Stopping HubConnection.`),this._cleanupTimeout(),this._cleanupPingTimer(),await this.connection.stop(e),e}}async stop(){const e=this._startPromise;this.connection.features.reconnect=!1,this._stopPromise=this._stopInternal(),await this._stopPromise;try{await e}catch(e){}}_stopInternal(e){if(this._connectionState===db.Disconnected)return this._logger.log(FT.Debug,`Call to HubConnection.stop(${e}) ignored because it is already in the disconnected state.`),Promise.resolve();if(this._connectionState===db.Disconnecting)return this._logger.log(FT.Debug,`Call to HttpConnection.stop(${e}) ignored because the connection is already in the disconnecting state.`),this._stopPromise;const t=this._connectionState;return this._connectionState=db.Disconnecting,this._logger.log(FT.Debug,"Stopping HubConnection."),this._reconnectDelayHandle?(this._logger.log(FT.Debug,"Connection stopped during reconnect delay. Done reconnecting."),clearTimeout(this._reconnectDelayHandle),this._reconnectDelayHandle=void 0,this._completeClose(),Promise.resolve()):(t===db.Connected&&this._sendCloseMessage(),this._cleanupTimeout(),this._cleanupPingTimer(),this._stopDuringStartError=e||new OT("The connection was stopped before the hub handshake could complete."),this.connection.stop(e))}async _sendCloseMessage(){try{await this._sendWithProtocol(this._createCloseMessage())}catch{}}stream(e,...t){const[n,r]=this._replaceStreamingParams(t),o=this._createStreamInvocation(e,t,r);let s;const i=new cb;return i.cancelCallback=()=>{const e=this._createCancelInvocation(o.invocationId);return delete this._callbacks[o.invocationId],s.then((()=>this._sendWithProtocol(e)))},this._callbacks[o.invocationId]=(e,t)=>{t?i.error(t):e&&(e.type===ab.Completion?e.error?i.error(new Error(e.error)):i.complete():i.next(e.item))},s=this._sendWithProtocol(o).catch((e=>{i.error(e),delete this._callbacks[o.invocationId]})),this._launchStreams(n,s),i}_sendMessage(e){return this._resetKeepAliveInterval(),this.connection.send(e)}_sendWithProtocol(e){return this._messageBuffer?this._messageBuffer._send(e):this._sendMessage(this._protocol.writeMessage(e))}send(e,...t){const[n,r]=this._replaceStreamingParams(t),o=this._sendWithProtocol(this._createInvocation(e,t,!0,r));return this._launchStreams(n,o),o}invoke(e,...t){const[n,r]=this._replaceStreamingParams(t),o=this._createInvocation(e,t,!1,r),s=new Promise(((e,t)=>{this._callbacks[o.invocationId]=(n,r)=>{r?t(r):n&&(n.type===ab.Completion?n.error?t(new Error(n.error)):e(n.result):t(new Error(`Unexpected message type: ${n.type}`)))};const r=this._sendWithProtocol(o).catch((e=>{t(e),delete this._callbacks[o.invocationId]}));this._launchStreams(n,r)}));return s}on(e,t){e&&t&&(e=e.toLowerCase(),this._methods[e]||(this._methods[e]=[]),-1===this._methods[e].indexOf(t)&&this._methods[e].push(t))}off(e,t){if(!e)return;e=e.toLowerCase();const n=this._methods[e];if(n)if(t){const r=n.indexOf(t);-1!==r&&(n.splice(r,1),0===n.length&&delete this._methods[e])}else delete this._methods[e]}onclose(e){e&&this._closedCallbacks.push(e)}onreconnecting(e){e&&this._reconnectingCallbacks.push(e)}onreconnected(e){e&&this._reconnectedCallbacks.push(e)}_processIncomingData(e){if(this._cleanupTimeout(),this._receivedHandshakeResponse||(e=this._processHandshakeResponse(e),this._receivedHandshakeResponse=!0),e){const t=this._protocol.parseMessages(e,this._logger);for(const e of t)if(!this._messageBuffer||this._messageBuffer._shouldProcessMessage(e))switch(e.type){case ab.Invocation:this._invokeClientMethod(e).catch((e=>{this._logger.log(FT.Error,`Invoke client method threw error: ${eb(e)}`)}));break;case ab.StreamItem:case ab.Completion:{const t=this._callbacks[e.invocationId];if(t){e.type===ab.Completion&&delete this._callbacks[e.invocationId];try{t(e)}catch(e){this._logger.log(FT.Error,`Stream callback threw error: ${eb(e)}`)}}break}case ab.Ping:break;case ab.Close:{this._logger.log(FT.Information,"Close message received from server.");const t=e.error?new Error("Server returned an error on close: "+e.error):void 0;!0===e.allowReconnect?this.connection.stop(t):this._stopPromise=this._stopInternal(t);break}case ab.Ack:this._messageBuffer&&this._messageBuffer._ack(e);break;case ab.Sequence:this._messageBuffer&&this._messageBuffer._resetSequence(e);break;default:this._logger.log(FT.Warning,`Invalid message type: ${e.type}.`)}}this._resetTimeoutPeriod()}_processHandshakeResponse(e){let t,n;try{[n,t]=this._handshakeProtocol.parseHandshakeResponse(e)}catch(e){const t="Error parsing handshake response: "+e;this._logger.log(FT.Error,t);const n=new Error(t);throw this._handshakeRejecter(n),n}if(t.error){const e="Server returned handshake error: "+t.error;this._logger.log(FT.Error,e);const n=new Error(e);throw this._handshakeRejecter(n),n}return this._logger.log(FT.Debug,"Server handshake complete."),this._handshakeResolver(),n}_resetKeepAliveInterval(){this.connection.features.inherentKeepAlive||(this._nextKeepAlive=(new Date).getTime()+this.keepAliveIntervalInMilliseconds,this._cleanupPingTimer())}_resetTimeoutPeriod(){if(!(this.connection.features&&this.connection.features.inherentKeepAlive||(this._timeoutHandle=setTimeout((()=>this.serverTimeout()),this.serverTimeoutInMilliseconds),void 0!==this._pingServerHandle))){let e=this._nextKeepAlive-(new Date).getTime();e<0&&(e=0),this._pingServerHandle=setTimeout((async()=>{if(this._connectionState===db.Connected)try{await this._sendMessage(this._cachedPingMessage)}catch{this._cleanupPingTimer()}}),e)}}serverTimeout(){this.connection.stop(new Error("Server timeout elapsed without receiving a message from the server."))}async _invokeClientMethod(e){const t=e.target.toLowerCase(),n=this._methods[t];if(!n)return this._logger.log(FT.Warning,`No client method with the name '${t}' found.`),void(e.invocationId&&(this._logger.log(FT.Warning,`No result given for '${t}' method and invocation ID '${e.invocationId}'.`),await this._sendWithProtocol(this._createCompletionMessage(e.invocationId,"Client didn't provide a result.",null))));const r=n.slice(),o=!!e.invocationId;let s,i,a;for(const n of r)try{const r=s;s=await n.apply(this,e.arguments),o&&s&&r&&(this._logger.log(FT.Error,`Multiple results provided for '${t}'. Sending error to server.`),a=this._createCompletionMessage(e.invocationId,"Client provided multiple results.",null)),i=void 0}catch(e){i=e,this._logger.log(FT.Error,`A callback for the method '${t}' threw error '${e}'.`)}a?await this._sendWithProtocol(a):o?(i?a=this._createCompletionMessage(e.invocationId,`${i}`,null):void 0!==s?a=this._createCompletionMessage(e.invocationId,null,s):(this._logger.log(FT.Warning,`No result given for '${t}' method and invocation ID '${e.invocationId}'.`),a=this._createCompletionMessage(e.invocationId,"Client didn't provide a result.",null)),await this._sendWithProtocol(a)):s&&this._logger.log(FT.Error,`Result given for '${t}' method but server is not expecting a result.`)}_connectionClosed(e){this._logger.log(FT.Debug,`HubConnection.connectionClosed(${e}) called while in state ${this._connectionState}.`),this._stopDuringStartError=this._stopDuringStartError||e||new OT("The underlying connection was closed before the hub handshake could complete."),this._handshakeResolver&&this._handshakeResolver(),this._cancelCallbacksWithError(e||new Error("Invocation canceled due to the underlying connection being closed.")),this._cleanupTimeout(),this._cleanupPingTimer(),this._connectionState===db.Disconnecting?this._completeClose(e):this._connectionState===db.Connected&&this._reconnectPolicy?this._reconnect(e):this._connectionState===db.Connected&&this._completeClose(e)}_completeClose(e){if(this._connectionStarted){this._connectionState=db.Disconnected,this._connectionStarted=!1,this._messageBuffer&&(this._messageBuffer._dispose(null!=e?e:new Error("Connection closed.")),this._messageBuffer=void 0),qT.isBrowser&&window.document.removeEventListener("freeze",this._freezeEventListener);try{this._closedCallbacks.forEach((t=>t.apply(this,[e])))}catch(t){this._logger.log(FT.Error,`An onclose callback called with error '${e}' threw error '${t}'.`)}}}async _reconnect(e){const t=Date.now();let n=0,r=void 0!==e?e:new Error("Attempting to reconnect due to a unknown error."),o=this._getNextRetryDelay(n++,0,r);if(null===o)return this._logger.log(FT.Debug,"Connection not reconnecting because the IRetryPolicy returned null on the first reconnect attempt."),void this._completeClose(e);if(this._connectionState=db.Reconnecting,e?this._logger.log(FT.Information,`Connection reconnecting because of error '${e}'.`):this._logger.log(FT.Information,"Connection reconnecting."),0!==this._reconnectingCallbacks.length){try{this._reconnectingCallbacks.forEach((t=>t.apply(this,[e])))}catch(t){this._logger.log(FT.Error,`An onreconnecting callback called with error '${e}' threw error '${t}'.`)}if(this._connectionState!==db.Reconnecting)return void this._logger.log(FT.Debug,"Connection left the reconnecting state in onreconnecting callback. Done reconnecting.")}for(;null!==o;){if(this._logger.log(FT.Information,`Reconnect attempt number ${n} will start in ${o} ms.`),await new Promise((e=>{this._reconnectDelayHandle=setTimeout(e,o)})),this._reconnectDelayHandle=void 0,this._connectionState!==db.Reconnecting)return void this._logger.log(FT.Debug,"Connection left the reconnecting state during reconnect delay. Done reconnecting.");try{if(await this._startInternal(),this._connectionState=db.Connected,this._logger.log(FT.Information,"HubConnection reconnected successfully."),0!==this._reconnectedCallbacks.length)try{this._reconnectedCallbacks.forEach((e=>e.apply(this,[this.connection.connectionId])))}catch(e){this._logger.log(FT.Error,`An onreconnected callback called with connectionId '${this.connection.connectionId}; threw error '${e}'.`)}return}catch(e){if(this._logger.log(FT.Information,`Reconnect attempt failed because of error '${e}'.`),this._connectionState!==db.Reconnecting)return this._logger.log(FT.Debug,`Connection moved to the '${this._connectionState}' from the reconnecting state during reconnect attempt. Done reconnecting.`),void(this._connectionState===db.Disconnecting&&this._completeClose());r=e instanceof Error?e:new Error(e.toString()),o=this._getNextRetryDelay(n++,Date.now()-t,r)}}this._logger.log(FT.Information,`Reconnect retries have been exhausted after ${Date.now()-t} ms and ${n} failed attempts. Connection disconnecting.`),this._completeClose()}_getNextRetryDelay(e,t,n){try{return this._reconnectPolicy.nextRetryDelayInMilliseconds({elapsedMilliseconds:t,previousRetryCount:e,retryReason:n})}catch(n){return this._logger.log(FT.Error,`IRetryPolicy.nextRetryDelayInMilliseconds(${e}, ${t}) threw error '${n}'.`),null}}_cancelCallbacksWithError(e){const t=this._callbacks;this._callbacks={},Object.keys(t).forEach((n=>{const r=t[n];try{r(null,e)}catch(t){this._logger.log(FT.Error,`Stream 'error' callback called with '${e}' threw error: ${eb(t)}`)}}))}_cleanupPingTimer(){this._pingServerHandle&&(clearTimeout(this._pingServerHandle),this._pingServerHandle=void 0)}_cleanupTimeout(){this._timeoutHandle&&clearTimeout(this._timeoutHandle)}_createInvocation(e,t,n,r){if(n)return 0!==r.length?{arguments:t,streamIds:r,target:e,type:ab.Invocation}:{arguments:t,target:e,type:ab.Invocation};{const n=this._invocationId;return this._invocationId++,0!==r.length?{arguments:t,invocationId:n.toString(),streamIds:r,target:e,type:ab.Invocation}:{arguments:t,invocationId:n.toString(),target:e,type:ab.Invocation}}}_launchStreams(e,t){if(0!==e.length){t||(t=Promise.resolve());for(const n in e)e[n].subscribe({complete:()=>{t=t.then((()=>this._sendWithProtocol(this._createCompletionMessage(n))))},error:e=>{let r;r=e instanceof Error?e.message:e&&e.toString?e.toString():"Unknown error",t=t.then((()=>this._sendWithProtocol(this._createCompletionMessage(n,r))))},next:e=>{t=t.then((()=>this._sendWithProtocol(this._createStreamItemMessage(n,e))))}})}}_replaceStreamingParams(e){const t=[],n=[];for(let r=0;r<e.length;r++){const o=e[r];if(this._isObservable(o)){const s=this._invocationId;this._invocationId++,t[s]=o,n.push(s.toString()),e.splice(r,1)}}return[t,n]}_isObservable(e){return e&&e.subscribe&&"function"==typeof e.subscribe}_createStreamInvocation(e,t,n){const r=this._invocationId;return this._invocationId++,0!==n.length?{arguments:t,invocationId:r.toString(),streamIds:n,target:e,type:ab.StreamInvocation}:{arguments:t,invocationId:r.toString(),target:e,type:ab.StreamInvocation}}_createCancelInvocation(e){return{invocationId:e,type:ab.CancelInvocation}}_createStreamItemMessage(e,t){return{invocationId:e,item:t,type:ab.StreamItem}}_createCompletionMessage(e,t,n){return t?{error:t,invocationId:e,type:ab.Completion}:{invocationId:e,result:n,type:ab.Completion}}_createCloseMessage(){return{type:ab.Close}}}const hb=[0,2e3,1e4,3e4,null];class fb{constructor(e){this._retryDelays=void 0!==e?[...e,null]:hb}nextRetryDelayInMilliseconds(e){return this._retryDelays[e.previousRetryCount]}}class gb{}gb.Authorization="Authorization",gb.Cookie="Cookie";class mb extends $T{constructor(e,t){super(),this._innerClient=e,this._accessTokenFactory=t}async send(e){let t=!0;this._accessTokenFactory&&(!this._accessToken||e.url&&e.url.indexOf("/negotiate?")>0)&&(t=!1,this._accessToken=await this._accessTokenFactory()),this._setAuthorizationHeader(e);const n=await this._innerClient.send(e);return t&&401===n.statusCode&&this._accessTokenFactory?(this._accessToken=await this._accessTokenFactory(),this._setAuthorizationHeader(e),await this._innerClient.send(e)):n}_setAuthorizationHeader(e){e.headers||(e.headers={}),this._accessToken?e.headers[gb.Authorization]=`Bearer ${this._accessToken}`:this._accessTokenFactory&&e.headers[gb.Authorization]&&delete e.headers[gb.Authorization]}getCookieString(e){return this._innerClient.getCookieString(e)}}var yb,_b;!function(e){e[e.None=0]="None",e[e.WebSockets=1]="WebSockets",e[e.ServerSentEvents=2]="ServerSentEvents",e[e.LongPolling=4]="LongPolling"}(yb||(yb={})),function(e){e[e.Text=1]="Text",e[e.Binary=2]="Binary"}(_b||(_b={}));class vb{constructor(){this._isAborted=!1,this.onabort=null}abort(){this._isAborted||(this._isAborted=!0,this.onabort&&this.onabort())}get signal(){return this}get aborted(){return this._isAborted}}class Sb{get pollAborted(){return this._pollAbort.aborted}constructor(e,t,n){this._httpClient=e,this._logger=t,this._pollAbort=new vb,this._options=n,this._running=!1,this.onreceive=null,this.onclose=null}async connect(e,t){if(VT.isRequired(e,"url"),VT.isRequired(t,"transferFormat"),VT.isIn(t,_b,"transferFormat"),this._url=e,this._logger.log(FT.Trace,"(LongPolling transport) Connecting."),t===_b.Binary&&"undefined"!=typeof XMLHttpRequest&&"string"!=typeof(new XMLHttpRequest).responseType)throw new Error("Binary protocols over XmlHttpRequest not implementing advanced features are not supported.");const[n,r]=YT(),o={[n]:r,...this._options.headers},s={abortSignal:this._pollAbort.signal,headers:o,timeout:1e5,withCredentials:this._options.withCredentials};t===_b.Binary&&(s.responseType="arraybuffer");const i=`${e}&_=${Date.now()}`;this._logger.log(FT.Trace,`(LongPolling transport) polling: ${i}.`);const a=await this._httpClient.get(i,s);200!==a.statusCode?(this._logger.log(FT.Error,`(LongPolling transport) Unexpected response code: ${a.statusCode}.`),this._closeError=new CT(a.statusText||"",a.statusCode),this._running=!1):this._running=!0,this._receiving=this._poll(this._url,s)}async _poll(e,t){try{for(;this._running;)try{const n=`${e}&_=${Date.now()}`;this._logger.log(FT.Trace,`(LongPolling transport) polling: ${n}.`);const r=await this._httpClient.get(n,t);204===r.statusCode?(this._logger.log(FT.Information,"(LongPolling transport) Poll terminated by server."),this._running=!1):200!==r.statusCode?(this._logger.log(FT.Error,`(LongPolling transport) Unexpected response code: ${r.statusCode}.`),this._closeError=new CT(r.statusText||"",r.statusCode),this._running=!1):r.content?(this._logger.log(FT.Trace,`(LongPolling transport) data received. ${WT(r.content,this._options.logMessageContent)}.`),this.onreceive&&this.onreceive(r.content)):this._logger.log(FT.Trace,"(LongPolling transport) Poll timed out, reissuing.")}catch(e){this._running?e instanceof xT?this._logger.log(FT.Trace,"(LongPolling transport) Poll timed out, reissuing."):(this._closeError=e,this._running=!1):this._logger.log(FT.Trace,`(LongPolling transport) Poll errored after shutdown: ${e.message}`)}}finally{this._logger.log(FT.Trace,"(LongPolling transport) Polling complete."),this.pollAborted||this._raiseOnClose()}}async send(e){return this._running?HT(this._logger,"LongPolling",this._httpClient,this._url,e,this._options):Promise.reject(new Error("Cannot send until the transport is connected"))}async stop(){this._logger.log(FT.Trace,"(LongPolling transport) Stopping polling."),this._running=!1,this._pollAbort.abort();try{await this._receiving,this._logger.log(FT.Trace,`(LongPolling transport) sending DELETE request to ${this._url}.`);const e={},[t,n]=YT();e[t]=n;const r={headers:{...e,...this._options.headers},timeout:this._options.timeout,withCredentials:this._options.withCredentials};let o;try{await this._httpClient.delete(this._url,r)}catch(e){o=e}o?o instanceof CT&&(404===o.statusCode?this._logger.log(FT.Trace,"(LongPolling transport) A 404 response was returned from sending a DELETE request."):this._logger.log(FT.Trace,`(LongPolling transport) Error sending a DELETE request: ${o}`)):this._logger.log(FT.Trace,"(LongPolling transport) DELETE request accepted.")}finally{this._logger.log(FT.Trace,"(LongPolling transport) Stop finished."),this._raiseOnClose()}}_raiseOnClose(){if(this.onclose){let e="(LongPolling transport) Firing onclose event.";this._closeError&&(e+=" Error: "+this._closeError),this._logger.log(FT.Trace,e),this.onclose(this._closeError)}}}class Tb{constructor(e,t,n,r){this._httpClient=e,this._accessToken=t,this._logger=n,this._options=r,this.onreceive=null,this.onclose=null}async connect(e,t){return VT.isRequired(e,"url"),VT.isRequired(t,"transferFormat"),VT.isIn(t,_b,"transferFormat"),this._logger.log(FT.Trace,"(SSE transport) Connecting."),this._url=e,this._accessToken&&(e+=(e.indexOf("?")<0?"?":"&")+`access_token=${encodeURIComponent(this._accessToken)}`),new Promise(((n,r)=>{let o,s=!1;if(t===_b.Text){if(qT.isBrowser||qT.isWebWorker)o=new this._options.EventSource(e,{withCredentials:this._options.withCredentials});else{const t=this._httpClient.getCookieString(e),n={};n.Cookie=t;const[r,s]=YT();n[r]=s,o=new this._options.EventSource(e,{withCredentials:this._options.withCredentials,headers:{...n,...this._options.headers}})}try{o.onmessage=e=>{if(this.onreceive)try{this._logger.log(FT.Trace,`(SSE transport) data received. ${WT(e.data,this._options.logMessageContent)}.`),this.onreceive(e.data)}catch(e){return void this._close(e)}},o.onerror=e=>{s?this._close():r(new Error("EventSource failed to connect. The connection could not be found on the server, either the connection ID is not present on the server, or a proxy is refusing/buffering the connection. If you have multiple servers check that sticky sessions are enabled."))},o.onopen=()=>{this._logger.log(FT.Information,`SSE connected to ${this._url}`),this._eventSource=o,s=!0,n()}}catch(e){return void r(e)}}else r(new Error("The Server-Sent Events transport only supports the 'Text' transfer format"))}))}async send(e){return this._eventSource?HT(this._logger,"SSE",this._httpClient,this._url,e,this._options):Promise.reject(new Error("Cannot send until the transport is connected"))}stop(){return this._close(),Promise.resolve()}_close(e){this._eventSource&&(this._eventSource.close(),this._eventSource=void 0,this.onclose&&this.onclose(e))}}class bb{constructor(e,t,n,r,o,s){this._logger=n,this._accessTokenFactory=t,this._logMessageContent=r,this._webSocketConstructor=o,this._httpClient=e,this.onreceive=null,this.onclose=null,this._headers=s}async connect(e,t){let n;return VT.isRequired(e,"url"),VT.isRequired(t,"transferFormat"),VT.isIn(t,_b,"transferFormat"),this._logger.log(FT.Trace,"(WebSockets transport) Connecting."),this._accessTokenFactory&&(n=await this._accessTokenFactory()),new Promise(((r,o)=>{let s;e=e.replace(/^http/,"ws");const i=this._httpClient.getCookieString(e);let a=!1;if(qT.isNode||qT.isReactNative){const t={},[r,o]=YT();t[r]=o,n&&(t[gb.Authorization]=`Bearer ${n}`),i&&(t[gb.Cookie]=i),s=new this._webSocketConstructor(e,void 0,{headers:{...t,...this._headers}})}else n&&(e+=(e.indexOf("?")<0?"?":"&")+`access_token=${encodeURIComponent(n)}`);s||(s=new this._webSocketConstructor(e)),t===_b.Binary&&(s.binaryType="arraybuffer"),s.onopen=t=>{this._logger.log(FT.Information,`WebSocket connected to ${e}.`),this._webSocket=s,a=!0,r()},s.onerror=e=>{let t=null;t="undefined"!=typeof ErrorEvent&&e instanceof ErrorEvent?e.error:"There was an error with the transport",this._logger.log(FT.Information,`(WebSockets transport) ${t}.`)},s.onmessage=e=>{if(this._logger.log(FT.Trace,`(WebSockets transport) data received. ${WT(e.data,this._logMessageContent)}.`),this.onreceive)try{this.onreceive(e.data)}catch(e){return void this._close(e)}},s.onclose=e=>{if(a)this._close(e);else{let t=null;t="undefined"!=typeof ErrorEvent&&e instanceof ErrorEvent?e.error:"WebSocket failed to connect. The connection could not be found on the server, either the endpoint may not be a SignalR endpoint, the connection ID is not present on the server, or there is a proxy blocking WebSockets. If you have multiple servers check that sticky sessions are enabled.",o(new Error(t))}}}))}send(e){return this._webSocket&&this._webSocket.readyState===this._webSocketConstructor.OPEN?(this._logger.log(FT.Trace,`(WebSockets transport) sending data. ${WT(e,this._logMessageContent)}.`),this._webSocket.send(e),Promise.resolve()):Promise.reject("WebSocket is not in the OPEN state")}stop(){return this._webSocket&&this._close(void 0),Promise.resolve()}_close(e){this._webSocket&&(this._webSocket.onclose=()=>{},this._webSocket.onmessage=()=>{},this._webSocket.onerror=()=>{},this._webSocket.close(),this._webSocket=void 0),this._logger.log(FT.Trace,"(WebSockets transport) socket closed."),this.onclose&&(!this._isCloseEvent(e)||!1!==e.wasClean&&1e3===e.code?e instanceof Error?this.onclose(e):this.onclose():this.onclose(new Error(`WebSocket closed with status code: ${e.code} (${e.reason||"no reason given"}).`)))}_isCloseEvent(e){return e&&"boolean"==typeof e.wasClean&&"number"==typeof e.code}}class wb{constructor(e,t={}){if(this._stopPromiseResolver=()=>{},this.features={},this._negotiateVersion=1,VT.isRequired(e,"url"),this._logger=function(e){return void 0===e?new zT(FT.Information):null===e?jT.instance:void 0!==e.log?e:new zT(e)}(t.logger),this.baseUrl=this._resolveUrl(e),(t=t||{}).logMessageContent=void 0!==t.logMessageContent&&t.logMessageContent,"boolean"!=typeof t.withCredentials&&void 0!==t.withCredentials)throw new Error("withCredentials option was not a 'boolean' or 'undefined' value");t.withCredentials=void 0===t.withCredentials||t.withCredentials,t.timeout=void 0===t.timeout?1e5:t.timeout;let n=null,r=null;if(qT.isNode&&"undefined"!=typeof require){const e="function"==typeof __webpack_require__?__non_webpack_require__:require;n=e("ws"),r=e("eventsource")}qT.isNode||"undefined"==typeof WebSocket||t.WebSocket?qT.isNode&&!t.WebSocket&&n&&(t.WebSocket=n):t.WebSocket=WebSocket,qT.isNode||"undefined"==typeof EventSource||t.EventSource?qT.isNode&&!t.EventSource&&void 0!==r&&(t.EventSource=r):t.EventSource=EventSource,this._httpClient=new mb(t.httpClient||new ob(this._logger),t.accessTokenFactory),this._connectionState="Disconnected",this._connectionStarted=!1,this._options=t,this.onreceive=null,this.onclose=null}async start(e){if(e=e||_b.Binary,VT.isIn(e,_b,"transferFormat"),this._logger.log(FT.Debug,`Starting connection with transfer format '${_b[e]}'.`),"Disconnected"!==this._connectionState)return Promise.reject(new Error("Cannot start an HttpConnection that is not in the 'Disconnected' state."));if(this._connectionState="Connecting",this._startInternalPromise=this._startInternal(e),await this._startInternalPromise,"Disconnecting"===this._connectionState){const e="Failed to start the HttpConnection before stop() was called.";return this._logger.log(FT.Error,e),await this._stopPromise,Promise.reject(new OT(e))}if("Connected"!==this._connectionState){const e="HttpConnection.startInternal completed gracefully but didn't enter the connection into the connected state!";return this._logger.log(FT.Error,e),Promise.reject(new OT(e))}this._connectionStarted=!0}send(e){return"Connected"!==this._connectionState?Promise.reject(new Error("Cannot send data if the connection is not in the 'Connected' State.")):(this._sendQueue||(this._sendQueue=new Eb(this.transport)),this._sendQueue.send(e))}async stop(e){return"Disconnected"===this._connectionState?(this._logger.log(FT.Debug,`Call to HttpConnection.stop(${e}) ignored because the connection is already in the disconnected state.`),Promise.resolve()):"Disconnecting"===this._connectionState?(this._logger.log(FT.Debug,`Call to HttpConnection.stop(${e}) ignored because the connection is already in the disconnecting state.`),this._stopPromise):(this._connectionState="Disconnecting",this._stopPromise=new Promise((e=>{this._stopPromiseResolver=e})),await this._stopInternal(e),void await this._stopPromise)}async _stopInternal(e){this._stopError=e;try{await this._startInternalPromise}catch(e){}if(this.transport){try{await this.transport.stop()}catch(e){this._logger.log(FT.Error,`HttpConnection.transport.stop() threw error '${e}'.`),this._stopConnection()}this.transport=void 0}else this._logger.log(FT.Debug,"HttpConnection.transport is undefined in HttpConnection.stop() because start() failed.")}async _startInternal(e){let t=this.baseUrl;this._accessTokenFactory=this._options.accessTokenFactory,this._httpClient._accessTokenFactory=this._accessTokenFactory;try{if(this._options.skipNegotiation){if(this._options.transport!==yb.WebSockets)throw new Error("Negotiation can only be skipped when using the WebSocket transport directly.");this.transport=this._constructTransport(yb.WebSockets),await this._startTransport(t,e)}else{let n=null,r=0;do{if(n=await this._getNegotiationResponse(t),"Disconnecting"===this._connectionState||"Disconnected"===this._connectionState)throw new OT("The connection was stopped during negotiation.");if(n.error)throw new Error(n.error);if(n.ProtocolVersion)throw new Error("Detected a connection attempt to an ASP.NET SignalR Server. This client only supports connecting to an ASP.NET Core SignalR Server. See https://aka.ms/signalr-core-differences for details.");if(n.url&&(t=n.url),n.accessToken){const e=n.accessToken;this._accessTokenFactory=()=>e,this._httpClient._accessToken=e,this._httpClient._accessTokenFactory=void 0}r++}while(n.url&&r<100);if(100===r&&n.url)throw new Error("Negotiate redirection limit exceeded.");await this._createTransport(t,this._options.transport,n,e)}this.transport instanceof Sb&&(this.features.inherentKeepAlive=!0),"Connecting"===this._connectionState&&(this._logger.log(FT.Debug,"The HttpConnection connected successfully."),this._connectionState="Connected")}catch(e){return this._logger.log(FT.Error,"Failed to start the connection: "+e),this._connectionState="Disconnected",this.transport=void 0,this._stopPromiseResolver(),Promise.reject(e)}}async _getNegotiationResponse(e){const t={},[n,r]=YT();t[n]=r;const o=this._resolveNegotiateUrl(e);this._logger.log(FT.Debug,`Sending negotiation request: ${o}.`);try{const e=await this._httpClient.post(o,{content:"",headers:{...t,...this._options.headers},timeout:this._options.timeout,withCredentials:this._options.withCredentials});if(200!==e.statusCode)return Promise.reject(new Error(`Unexpected status code returned from negotiate '${e.statusCode}'`));const n=JSON.parse(e.content);return(!n.negotiateVersion||n.negotiateVersion<1)&&(n.connectionToken=n.connectionId),n.useStatefulReconnect&&!0!==this._options._useStatefulReconnect?Promise.reject(new DT("Client didn't negotiate Stateful Reconnect but the server did.")):n}catch(e){let t="Failed to complete negotiation with the server: "+e;return e instanceof CT&&404===e.statusCode&&(t+=" Either this is not a SignalR endpoint or there is a proxy blocking the connection."),this._logger.log(FT.Error,t),Promise.reject(new DT(t))}}_createConnectUrl(e,t){return t?e+(-1===e.indexOf("?")?"?":"&")+`id=${t}`:e}async _createTransport(e,t,n,r){let o=this._createConnectUrl(e,n.connectionToken);if(this._isITransport(t))return this._logger.log(FT.Debug,"Connection was provided an instance of ITransport, using that directly."),this.transport=t,await this._startTransport(o,r),void(this.connectionId=n.connectionId);const s=[],i=n.availableTransports||[];let a=n;for(const n of i){const i=this._resolveTransportOrError(n,t,r,!0===(null==a?void 0:a.useStatefulReconnect));if(i instanceof Error)s.push(`${n.transport} failed:`),s.push(i);else if(this._isITransport(i)){if(this.transport=i,!a){try{a=await this._getNegotiationResponse(e)}catch(e){return Promise.reject(e)}o=this._createConnectUrl(e,a.connectionToken)}try{return await this._startTransport(o,r),void(this.connectionId=a.connectionId)}catch(e){if(this._logger.log(FT.Error,`Failed to start the transport '${n.transport}': ${e}`),a=void 0,s.push(new PT(`${n.transport} failed: ${e}`,yb[n.transport])),"Connecting"!==this._connectionState){const e="Failed to select transport before stop() was called.";return this._logger.log(FT.Debug,e),Promise.reject(new OT(e))}}}}return s.length>0?Promise.reject(new MT(`Unable to connect to the server with any of the available transports. ${s.join(" ")}`,s)):Promise.reject(new Error("None of the transports supported by the client are supported by the server."))}_constructTransport(e){switch(e){case yb.WebSockets:if(!this._options.WebSocket)throw new Error("'WebSocket' is not supported in your environment.");return new bb(this._httpClient,this._accessTokenFactory,this._logger,this._options.logMessageContent,this._options.WebSocket,this._options.headers||{});case yb.ServerSentEvents:if(!this._options.EventSource)throw new Error("'EventSource' is not supported in your environment.");return new Tb(this._httpClient,this._httpClient._accessToken,this._logger,this._options);case yb.LongPolling:return new Sb(this._httpClient,this._logger,this._options);default:throw new Error(`Unknown transport: ${e}.`)}}_startTransport(e,t){return this.transport.onreceive=this.onreceive,this.features.reconnect?this.transport.onclose=async n=>{let r=!1;if(this.features.reconnect){try{this.features.disconnected(),await this.transport.connect(e,t),await this.features.resend()}catch{r=!0}r&&this._stopConnection(n)}else this._stopConnection(n)}:this.transport.onclose=e=>this._stopConnection(e),this.transport.connect(e,t)}_resolveTransportOrError(e,t,n,r){const o=yb[e.transport];if(null==o)return this._logger.log(FT.Debug,`Skipping transport '${e.transport}' because it is not supported by this client.`),new Error(`Skipping transport '${e.transport}' because it is not supported by this client.`);if(!function(e,t){return!e||!!(t&e)}(t,o))return this._logger.log(FT.Debug,`Skipping transport '${yb[o]}' because it was disabled by the client.`),new NT(`'${yb[o]}' is disabled by the client.`,o);if(!(e.transferFormats.map((e=>_b[e])).indexOf(n)>=0))return this._logger.log(FT.Debug,`Skipping transport '${yb[o]}' because it does not support the requested transfer format '${_b[n]}'.`),new Error(`'${yb[o]}' does not support ${_b[n]}.`);if(o===yb.WebSockets&&!this._options.WebSocket||o===yb.ServerSentEvents&&!this._options.EventSource)return this._logger.log(FT.Debug,`Skipping transport '${yb[o]}' because it is not supported in your environment.'`),new LT(`'${yb[o]}' is not supported in your environment.`,o);this._logger.log(FT.Debug,`Selecting transport '${yb[o]}'.`);try{return this.features.reconnect=o===yb.WebSockets?r:void 0,this._constructTransport(o)}catch(e){return e}}_isITransport(e){return e&&"object"==typeof e&&"connect"in e}_stopConnection(e){if(this._logger.log(FT.Debug,`HttpConnection.stopConnection(${e}) called while in state ${this._connectionState}.`),this.transport=void 0,e=this._stopError||e,this._stopError=void 0,"Disconnected"!==this._connectionState){if("Connecting"===this._connectionState)throw this._logger.log(FT.Warning,`Call to HttpConnection.stopConnection(${e}) was ignored because the connection is still in the connecting state.`),new Error(`HttpConnection.stopConnection(${e}) was called while the connection is still in the connecting state.`);if("Disconnecting"===this._connectionState&&this._stopPromiseResolver(),e?this._logger.log(FT.Error,`Connection disconnected with error '${e}'.`):this._logger.log(FT.Information,"Connection disconnected."),this._sendQueue&&(this._sendQueue.stop().catch((e=>{this._logger.log(FT.Error,`TransportSendQueue.stop() threw error '${e}'.`)})),this._sendQueue=void 0),this.connectionId=void 0,this._connectionState="Disconnected",this._connectionStarted){this._connectionStarted=!1;try{this.onclose&&this.onclose(e)}catch(t){this._logger.log(FT.Error,`HttpConnection.onclose(${e}) threw error '${t}'.`)}}}else this._logger.log(FT.Debug,`Call to HttpConnection.stopConnection(${e}) was ignored because the connection is already in the disconnected state.`)}_resolveUrl(e){if(0===e.lastIndexOf("https://",0)||0===e.lastIndexOf("http://",0))return e;if(!qT.isBrowser)throw new Error(`Cannot resolve '${e}'.`);const t=window.document.createElement("a");return t.href=e,this._logger.log(FT.Information,`Normalizing '${e}' to '${t.href}'.`),t.href}_resolveNegotiateUrl(e){const t=new URL(e);t.pathname.endsWith("/")?t.pathname+="negotiate":t.pathname+="/negotiate";const n=new URLSearchParams(t.searchParams);return n.has("negotiateVersion")||n.append("negotiateVersion",this._negotiateVersion.toString()),n.has("useStatefulReconnect")?"true"===n.get("useStatefulReconnect")&&(this._options._useStatefulReconnect=!0):!0===this._options._useStatefulReconnect&&n.append("useStatefulReconnect","true"),t.search=n.toString(),t.toString()}}class Eb{constructor(e){this._transport=e,this._buffer=[],this._executing=!0,this._sendBufferedData=new Ib,this._transportResult=new Ib,this._sendLoopPromise=this._sendLoop()}send(e){return this._bufferData(e),this._transportResult||(this._transportResult=new Ib),this._transportResult.promise}stop(){return this._executing=!1,this._sendBufferedData.resolve(),this._sendLoopPromise}_bufferData(e){if(this._buffer.length&&typeof this._buffer[0]!=typeof e)throw new Error(`Expected data to be of type ${typeof this._buffer} but was of type ${typeof e}`);this._buffer.push(e),this._sendBufferedData.resolve()}async _sendLoop(){for(;;){if(await this._sendBufferedData.promise,!this._executing){this._transportResult&&this._transportResult.reject("Connection stopped.");break}this._sendBufferedData=new Ib;const e=this._transportResult;this._transportResult=void 0;const t="string"==typeof this._buffer[0]?this._buffer.join(""):Eb._concatBuffers(this._buffer);this._buffer.length=0;try{await this._transport.send(t),e.resolve()}catch(t){e.reject(t)}}}static _concatBuffers(e){const t=e.map((e=>e.byteLength)).reduce(((e,t)=>e+t)),n=new Uint8Array(t);let r=0;for(const t of e)n.set(new Uint8Array(t),r),r+=t.byteLength;return n.buffer}}class Ib{constructor(){this.promise=new Promise(((e,t)=>[this._resolver,this._rejecter]=[e,t]))}resolve(){this._resolver()}reject(e){this._rejecter(e)}}class Ab{constructor(){this.name="json",this.version=2,this.transferFormat=_b.Text}parseMessages(e,t){if("string"!=typeof e)throw new Error("Invalid input for JSON hub protocol. Expected a string.");if(!e)return[];null===t&&(t=jT.instance);const n=sb.parse(e),r=[];for(const e of n){const n=JSON.parse(e);if("number"!=typeof n.type)throw new Error("Invalid payload.");switch(n.type){case ab.Invocation:this._isInvocationMessage(n);break;case ab.StreamItem:this._isStreamItemMessage(n);break;case ab.Completion:this._isCompletionMessage(n);break;case ab.Ping:case ab.Close:break;case ab.Ack:this._isAckMessage(n);break;case ab.Sequence:this._isSequenceMessage(n);break;default:t.log(FT.Information,"Unknown message type '"+n.type+"' ignored.");continue}r.push(n)}return r}writeMessage(e){return sb.write(JSON.stringify(e))}_isInvocationMessage(e){this._assertNotEmptyString(e.target,"Invalid payload for Invocation message."),void 0!==e.invocationId&&this._assertNotEmptyString(e.invocationId,"Invalid payload for Invocation message.")}_isStreamItemMessage(e){if(this._assertNotEmptyString(e.invocationId,"Invalid payload for StreamItem message."),void 0===e.item)throw new Error("Invalid payload for StreamItem message.")}_isCompletionMessage(e){if(e.result&&e.error)throw new Error("Invalid payload for Completion message.");!e.result&&e.error&&this._assertNotEmptyString(e.error,"Invalid payload for Completion message."),this._assertNotEmptyString(e.invocationId,"Invalid payload for Completion message.")}_isAckMessage(e){if("number"!=typeof e.sequenceId)throw new Error("Invalid SequenceId for Ack message.")}_isSequenceMessage(e){if("number"!=typeof e.sequenceId)throw new Error("Invalid SequenceId for Sequence message.")}_assertNotEmptyString(e,t){if("string"!=typeof e||""===e)throw new Error(t)}}const Rb={trace:FT.Trace,debug:FT.Debug,info:FT.Information,information:FT.Information,warn:FT.Warning,warning:FT.Warning,error:FT.Error,critical:FT.Critical,none:FT.None};class kb{configureLogging(e){if(VT.isRequired(e,"logging"),function(e){return void 0!==e.log}(e))this.logger=e;else if("string"==typeof e){const t=function(e){const t=Rb[e.toLowerCase()];if(void 0!==t)return t;throw new Error(`Unknown log level: ${e}`)}(e);this.logger=new zT(t)}else this.logger=new zT(e);return this}withUrl(e,t){return VT.isRequired(e,"url"),VT.isNotEmpty(e,"url"),this.url=e,this.httpConnectionOptions="object"==typeof t?{...this.httpConnectionOptions,...t}:{...this.httpConnectionOptions,transport:t},this}withHubProtocol(e){return VT.isRequired(e,"protocol"),this.protocol=e,this}withAutomaticReconnect(e){if(this.reconnectPolicy)throw new Error("A reconnectPolicy has already been set.");return e?Array.isArray(e)?this.reconnectPolicy=new fb(e):this.reconnectPolicy=e:this.reconnectPolicy=new fb,this}withServerTimeout(e){return VT.isRequired(e,"milliseconds"),this._serverTimeoutInMilliseconds=e,this}withKeepAliveInterval(e){return VT.isRequired(e,"milliseconds"),this._keepAliveIntervalInMilliseconds=e,this}withStatefulReconnect(e){return void 0===this.httpConnectionOptions&&(this.httpConnectionOptions={}),this.httpConnectionOptions._useStatefulReconnect=!0,this._statefulReconnectBufferSize=null==e?void 0:e.bufferSize,this}build(){const e=this.httpConnectionOptions||{};if(void 0===e.logger&&(e.logger=this.logger),!this.url)throw new Error("The 'HubConnectionBuilder.withUrl' method must be called before building the connection.");const t=new wb(this.url,e);return pb.create(t,this.logger||jT.instance,this.protocol||new Ab,this.reconnectPolicy,this._serverTimeoutInMilliseconds,this._keepAliveIntervalInMilliseconds,this._statefulReconnectBufferSize)}}var Cb,xb,Ob,Lb=4294967295;function Nb(e,t,n){var r=Math.floor(n/4294967296),o=n;e.setUint32(t,r),e.setUint32(t+4,o)}function Pb(e,t){return 4294967296*e.getInt32(t)+e.getUint32(t+4)}var Db=("undefined"==typeof process||"never"!==(null===(Cb=null===process||void 0===process?void 0:process.env)||void 0===Cb?void 0:Cb.TEXT_ENCODING))&&"undefined"!=typeof TextEncoder&&"undefined"!=typeof TextDecoder;function Mb(e){for(var t=e.length,n=0,r=0;r<t;){var o=e.charCodeAt(r++);if(4294967168&o)if(4294965248&o){if(o>=55296&&o<=56319&&r<t){var s=e.charCodeAt(r);56320==(64512&s)&&(++r,o=((1023&o)<<10)+(1023&s)+65536)}n+=4294901760&o?4:3}else n+=2;else n++}return n}var Ub=Db?new TextEncoder:void 0,$b=Db?"undefined"!=typeof process&&"force"!==(null===(xb=null===process||void 0===process?void 0:process.env)||void 0===xb?void 0:xb.TEXT_ENCODING)?200:0:Lb;var Fb=(null==Ub?void 0:Ub.encodeInto)?function(e,t,n){Ub.encodeInto(e,t.subarray(n))}:function(e,t,n){t.set(Ub.encode(e),n)};function jb(e,t,n){for(var r=t,o=r+n,s=[],i="";r<o;){var a=e[r++];if(128&a)if(192==(224&a)){var c=63&e[r++];s.push((31&a)<<6|c)}else if(224==(240&a)){c=63&e[r++];var l=63&e[r++];s.push((31&a)<<12|c<<6|l)}else if(240==(248&a)){var u=(7&a)<<18|(c=63&e[r++])<<12|(l=63&e[r++])<<6|63&e[r++];u>65535&&(u-=65536,s.push(u>>>10&1023|55296),u=56320|1023&u),s.push(u)}else s.push(a);else s.push(a);s.length>=4096&&(i+=String.fromCharCode.apply(String,s),s.length=0)}return s.length>0&&(i+=String.fromCharCode.apply(String,s)),i}var Gb=Db?new TextDecoder:null,Vb=Db?"undefined"!=typeof process&&"force"!==(null===(Ob=null===process||void 0===process?void 0:process.env)||void 0===Ob?void 0:Ob.TEXT_DECODER)?200:0:Lb;var qb=function(e,t){this.type=e,this.data=t},Wb=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Bb=function(e){function t(n){var r=e.call(this,n)||this,o=Object.create(t.prototype);return Object.setPrototypeOf(r,o),Object.defineProperty(r,"name",{configurable:!0,enumerable:!1,value:t.name}),r}return Wb(t,e),t}(Error),Hb=4294967295,Jb=17179869183;var zb={type:-1,encode:function(e){var t,n,r,o;return e instanceof Date?function(e){var t,n=e.sec,r=e.nsec;if(n>=0&&r>=0&&n<=Jb){if(0===r&&n<=Hb){var o=new Uint8Array(4);return(t=new DataView(o.buffer)).setUint32(0,n),o}var s=n/4294967296,i=4294967295&n;return o=new Uint8Array(8),(t=new DataView(o.buffer)).setUint32(0,r<<2|3&s),t.setUint32(4,i),o}return o=new Uint8Array(12),(t=new DataView(o.buffer)).setUint32(0,r),Nb(t,4,n),o}((t=e.getTime(),n=Math.floor(t/1e3),r=1e6*(t-1e3*n),o=Math.floor(r/1e9),{sec:n+o,nsec:r-1e9*o})):null},decode:function(e){var t=function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);switch(e.byteLength){case 4:return{sec:t.getUint32(0),nsec:0};case 8:var n=t.getUint32(0);return{sec:4294967296*(3&n)+t.getUint32(4),nsec:n>>>2};case 12:return{sec:Pb(t,4),nsec:t.getUint32(0)};default:throw new Bb("Unrecognized data size for timestamp (expected 4, 8, or 12): ".concat(e.length))}}(e);return new Date(1e3*t.sec+t.nsec/1e6)}},Yb=function(){function e(){this.builtInEncoders=[],this.builtInDecoders=[],this.encoders=[],this.decoders=[],this.register(zb)}return e.prototype.register=function(e){var t=e.type,n=e.encode,r=e.decode;if(t>=0)this.encoders[t]=n,this.decoders[t]=r;else{var o=1+t;this.builtInEncoders[o]=n,this.builtInDecoders[o]=r}},e.prototype.tryToEncode=function(e,t){for(var n=0;n<this.builtInEncoders.length;n++){if(null!=(r=this.builtInEncoders[n]))if(null!=(o=r(e,t)))return new qb(-1-n,o)}for(n=0;n<this.encoders.length;n++){var r,o;if(null!=(r=this.encoders[n]))if(null!=(o=r(e,t)))return new qb(n,o)}return e instanceof qb?e:null},e.prototype.decode=function(e,t,n){var r=t<0?this.builtInDecoders[-1-t]:this.decoders[t];return r?r(e,t,n):new qb(t,e)},e.defaultCodec=new e,e}();function Xb(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e instanceof ArrayBuffer?new Uint8Array(e):Uint8Array.from(e)}var Kb=function(){function e(e,t,n,r,o,s,i,a){void 0===e&&(e=Yb.defaultCodec),void 0===t&&(t=void 0),void 0===n&&(n=100),void 0===r&&(r=2048),void 0===o&&(o=!1),void 0===s&&(s=!1),void 0===i&&(i=!1),void 0===a&&(a=!1),this.extensionCodec=e,this.context=t,this.maxDepth=n,this.initialBufferSize=r,this.sortKeys=o,this.forceFloat32=s,this.ignoreUndefined=i,this.forceIntegerToFloat=a,this.pos=0,this.view=new DataView(new ArrayBuffer(this.initialBufferSize)),this.bytes=new Uint8Array(this.view.buffer)}return e.prototype.reinitializeState=function(){this.pos=0},e.prototype.encodeSharedRef=function(e){return this.reinitializeState(),this.doEncode(e,1),this.bytes.subarray(0,this.pos)},e.prototype.encode=function(e){return this.reinitializeState(),this.doEncode(e,1),this.bytes.slice(0,this.pos)},e.prototype.doEncode=function(e,t){if(t>this.maxDepth)throw new Error("Too deep objects in depth ".concat(t));null==e?this.encodeNil():"boolean"==typeof e?this.encodeBoolean(e):"number"==typeof e?this.encodeNumber(e):"string"==typeof e?this.encodeString(e):this.encodeObject(e,t)},e.prototype.ensureBufferSizeToWrite=function(e){var t=this.pos+e;this.view.byteLength<t&&this.resizeBuffer(2*t)},e.prototype.resizeBuffer=function(e){var t=new ArrayBuffer(e),n=new Uint8Array(t),r=new DataView(t);n.set(this.bytes),this.view=r,this.bytes=n},e.prototype.encodeNil=function(){this.writeU8(192)},e.prototype.encodeBoolean=function(e){!1===e?this.writeU8(194):this.writeU8(195)},e.prototype.encodeNumber=function(e){Number.isSafeInteger(e)&&!this.forceIntegerToFloat?e>=0?e<128?this.writeU8(e):e<256?(this.writeU8(204),this.writeU8(e)):e<65536?(this.writeU8(205),this.writeU16(e)):e<4294967296?(this.writeU8(206),this.writeU32(e)):(this.writeU8(207),this.writeU64(e)):e>=-32?this.writeU8(224|e+32):e>=-128?(this.writeU8(208),this.writeI8(e)):e>=-32768?(this.writeU8(209),this.writeI16(e)):e>=-2147483648?(this.writeU8(210),this.writeI32(e)):(this.writeU8(211),this.writeI64(e)):this.forceFloat32?(this.writeU8(202),this.writeF32(e)):(this.writeU8(203),this.writeF64(e))},e.prototype.writeStringHeader=function(e){if(e<32)this.writeU8(160+e);else if(e<256)this.writeU8(217),this.writeU8(e);else if(e<65536)this.writeU8(218),this.writeU16(e);else{if(!(e<4294967296))throw new Error("Too long string: ".concat(e," bytes in UTF-8"));this.writeU8(219),this.writeU32(e)}},e.prototype.encodeString=function(e){if(e.length>$b){var t=Mb(e);this.ensureBufferSizeToWrite(5+t),this.writeStringHeader(t),Fb(e,this.bytes,this.pos),this.pos+=t}else{t=Mb(e);this.ensureBufferSizeToWrite(5+t),this.writeStringHeader(t),function(e,t,n){for(var r=e.length,o=n,s=0;s<r;){var i=e.charCodeAt(s++);if(4294967168&i){if(4294965248&i){if(i>=55296&&i<=56319&&s<r){var a=e.charCodeAt(s);56320==(64512&a)&&(++s,i=((1023&i)<<10)+(1023&a)+65536)}4294901760&i?(t[o++]=i>>18&7|240,t[o++]=i>>12&63|128,t[o++]=i>>6&63|128):(t[o++]=i>>12&15|224,t[o++]=i>>6&63|128)}else t[o++]=i>>6&31|192;t[o++]=63&i|128}else t[o++]=i}}(e,this.bytes,this.pos),this.pos+=t}},e.prototype.encodeObject=function(e,t){var n=this.extensionCodec.tryToEncode(e,this.context);if(null!=n)this.encodeExtension(n);else if(Array.isArray(e))this.encodeArray(e,t);else if(ArrayBuffer.isView(e))this.encodeBinary(e);else{if("object"!=typeof e)throw new Error("Unrecognized object: ".concat(Object.prototype.toString.apply(e)));this.encodeMap(e,t)}},e.prototype.encodeBinary=function(e){var t=e.byteLength;if(t<256)this.writeU8(196),this.writeU8(t);else if(t<65536)this.writeU8(197),this.writeU16(t);else{if(!(t<4294967296))throw new Error("Too large binary: ".concat(t));this.writeU8(198),this.writeU32(t)}var n=Xb(e);this.writeU8a(n)},e.prototype.encodeArray=function(e,t){var n=e.length;if(n<16)this.writeU8(144+n);else if(n<65536)this.writeU8(220),this.writeU16(n);else{if(!(n<4294967296))throw new Error("Too large array: ".concat(n));this.writeU8(221),this.writeU32(n)}for(var r=0,o=e;r<o.length;r++){var s=o[r];this.doEncode(s,t+1)}},e.prototype.countWithoutUndefined=function(e,t){for(var n=0,r=0,o=t;r<o.length;r++){void 0!==e[o[r]]&&n++}return n},e.prototype.encodeMap=function(e,t){var n=Object.keys(e);this.sortKeys&&n.sort();var r=this.ignoreUndefined?this.countWithoutUndefined(e,n):n.length;if(r<16)this.writeU8(128+r);else if(r<65536)this.writeU8(222),this.writeU16(r);else{if(!(r<4294967296))throw new Error("Too large map object: ".concat(r));this.writeU8(223),this.writeU32(r)}for(var o=0,s=n;o<s.length;o++){var i=s[o],a=e[i];this.ignoreUndefined&&void 0===a||(this.encodeString(i),this.doEncode(a,t+1))}},e.prototype.encodeExtension=function(e){var t=e.data.length;if(1===t)this.writeU8(212);else if(2===t)this.writeU8(213);else if(4===t)this.writeU8(214);else if(8===t)this.writeU8(215);else if(16===t)this.writeU8(216);else if(t<256)this.writeU8(199),this.writeU8(t);else if(t<65536)this.writeU8(200),this.writeU16(t);else{if(!(t<4294967296))throw new Error("Too large extension object: ".concat(t));this.writeU8(201),this.writeU32(t)}this.writeI8(e.type),this.writeU8a(e.data)},e.prototype.writeU8=function(e){this.ensureBufferSizeToWrite(1),this.view.setUint8(this.pos,e),this.pos++},e.prototype.writeU8a=function(e){var t=e.length;this.ensureBufferSizeToWrite(t),this.bytes.set(e,this.pos),this.pos+=t},e.prototype.writeI8=function(e){this.ensureBufferSizeToWrite(1),this.view.setInt8(this.pos,e),this.pos++},e.prototype.writeU16=function(e){this.ensureBufferSizeToWrite(2),this.view.setUint16(this.pos,e),this.pos+=2},e.prototype.writeI16=function(e){this.ensureBufferSizeToWrite(2),this.view.setInt16(this.pos,e),this.pos+=2},e.prototype.writeU32=function(e){this.ensureBufferSizeToWrite(4),this.view.setUint32(this.pos,e),this.pos+=4},e.prototype.writeI32=function(e){this.ensureBufferSizeToWrite(4),this.view.setInt32(this.pos,e),this.pos+=4},e.prototype.writeF32=function(e){this.ensureBufferSizeToWrite(4),this.view.setFloat32(this.pos,e),this.pos+=4},e.prototype.writeF64=function(e){this.ensureBufferSizeToWrite(8),this.view.setFloat64(this.pos,e),this.pos+=8},e.prototype.writeU64=function(e){this.ensureBufferSizeToWrite(8),function(e,t,n){var r=n/4294967296,o=n;e.setUint32(t,r),e.setUint32(t+4,o)}(this.view,this.pos,e),this.pos+=8},e.prototype.writeI64=function(e){this.ensureBufferSizeToWrite(8),Nb(this.view,this.pos,e),this.pos+=8},e}();function Qb(e){return"".concat(e<0?"-":"","0x").concat(Math.abs(e).toString(16).padStart(2,"0"))}var Zb=function(){function e(e,t){void 0===e&&(e=16),void 0===t&&(t=16),this.maxKeyLength=e,this.maxLengthPerKey=t,this.hit=0,this.miss=0,this.caches=[];for(var n=0;n<this.maxKeyLength;n++)this.caches.push([])}return e.prototype.canBeCached=function(e){return e>0&&e<=this.maxKeyLength},e.prototype.find=function(e,t,n){e:for(var r=0,o=this.caches[n-1];r<o.length;r++){for(var s=o[r],i=s.bytes,a=0;a<n;a++)if(i[a]!==e[t+a])continue e;return s.str}return null},e.prototype.store=function(e,t){var n=this.caches[e.length-1],r={bytes:e,str:t};n.length>=this.maxLengthPerKey?n[Math.random()*n.length|0]=r:n.push(r)},e.prototype.decode=function(e,t,n){var r=this.find(e,t,n);if(null!=r)return this.hit++,r;this.miss++;var o=jb(e,t,n),s=Uint8Array.prototype.slice.call(e,t,t+n);return this.store(s,o),o},e}(),ew=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}c((r=r.apply(e,t||[])).next())}))},tw=function(e,t){var n,r,o,s,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}},nw=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise((function(r,o){(function(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)})(r,o,(t=e[n](t)).done,t.value)}))}}},rw=function(e){return this instanceof rw?(this.v=e,this):new rw(e)},ow=function(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,o=n.apply(e,t||[]),s=[];return r={},i("next"),i("throw"),i("return"),r[Symbol.asyncIterator]=function(){return this},r;function i(e){o[e]&&(r[e]=function(t){return new Promise((function(n,r){s.push([e,t,n,r])>1||a(e,t)}))})}function a(e,t){try{!function(e){e.value instanceof rw?Promise.resolve(e.value.v).then(c,l):u(s[0][2],e)}(o[e](t))}catch(e){u(s[0][3],e)}}function c(e){a("next",e)}function l(e){a("throw",e)}function u(e,t){e(t),s.shift(),s.length&&a(s[0][0],s[0][1])}},sw=new DataView(new ArrayBuffer(0)),iw=new Uint8Array(sw.buffer),aw=function(){try{sw.getInt8(0)}catch(e){return e.constructor}throw new Error("never reached")}(),cw=new aw("Insufficient data"),lw=new Zb,uw=function(){function e(e,t,n,r,o,s,i,a){void 0===e&&(e=Yb.defaultCodec),void 0===t&&(t=void 0),void 0===n&&(n=Lb),void 0===r&&(r=Lb),void 0===o&&(o=Lb),void 0===s&&(s=Lb),void 0===i&&(i=Lb),void 0===a&&(a=lw),this.extensionCodec=e,this.context=t,this.maxStrLength=n,this.maxBinLength=r,this.maxArrayLength=o,this.maxMapLength=s,this.maxExtLength=i,this.keyDecoder=a,this.totalPos=0,this.pos=0,this.view=sw,this.bytes=iw,this.headByte=-1,this.stack=[]}return e.prototype.reinitializeState=function(){this.totalPos=0,this.headByte=-1,this.stack.length=0},e.prototype.setBuffer=function(e){this.bytes=Xb(e),this.view=function(e){if(e instanceof ArrayBuffer)return new DataView(e);var t=Xb(e);return new DataView(t.buffer,t.byteOffset,t.byteLength)}(this.bytes),this.pos=0},e.prototype.appendBuffer=function(e){if(-1!==this.headByte||this.hasRemaining(1)){var t=this.bytes.subarray(this.pos),n=Xb(e),r=new Uint8Array(t.length+n.length);r.set(t),r.set(n,t.length),this.setBuffer(r)}else this.setBuffer(e)},e.prototype.hasRemaining=function(e){return this.view.byteLength-this.pos>=e},e.prototype.createExtraByteError=function(e){var t=this.view,n=this.pos;return new RangeError("Extra ".concat(t.byteLength-n," of ").concat(t.byteLength," byte(s) found at buffer[").concat(e,"]"))},e.prototype.decode=function(e){this.reinitializeState(),this.setBuffer(e);var t=this.doDecodeSync();if(this.hasRemaining(1))throw this.createExtraByteError(this.pos);return t},e.prototype.decodeMulti=function(e){return tw(this,(function(t){switch(t.label){case 0:this.reinitializeState(),this.setBuffer(e),t.label=1;case 1:return this.hasRemaining(1)?[4,this.doDecodeSync()]:[3,3];case 2:return t.sent(),[3,1];case 3:return[2]}}))},e.prototype.decodeAsync=function(e){var t,n,r,o;return ew(this,void 0,void 0,(function(){var s,i,a,c,l,u,d,p;return tw(this,(function(h){switch(h.label){case 0:s=!1,h.label=1;case 1:h.trys.push([1,6,7,12]),t=nw(e),h.label=2;case 2:return[4,t.next()];case 3:if((n=h.sent()).done)return[3,5];if(a=n.value,s)throw this.createExtraByteError(this.totalPos);this.appendBuffer(a);try{i=this.doDecodeSync(),s=!0}catch(e){if(!(e instanceof aw))throw e}this.totalPos+=this.pos,h.label=4;case 4:return[3,2];case 5:return[3,12];case 6:return c=h.sent(),r={error:c},[3,12];case 7:return h.trys.push([7,,10,11]),n&&!n.done&&(o=t.return)?[4,o.call(t)]:[3,9];case 8:h.sent(),h.label=9;case 9:return[3,11];case 10:if(r)throw r.error;return[7];case 11:return[7];case 12:if(s){if(this.hasRemaining(1))throw this.createExtraByteError(this.totalPos);return[2,i]}throw u=(l=this).headByte,d=l.pos,p=l.totalPos,new RangeError("Insufficient data in parsing ".concat(Qb(u)," at ").concat(p," (").concat(d," in the current buffer)"))}}))}))},e.prototype.decodeArrayStream=function(e){return this.decodeMultiAsync(e,!0)},e.prototype.decodeStream=function(e){return this.decodeMultiAsync(e,!1)},e.prototype.decodeMultiAsync=function(e,t){return ow(this,arguments,(function(){var n,r,o,s,i,a,c,l,u;return tw(this,(function(d){switch(d.label){case 0:n=t,r=-1,d.label=1;case 1:d.trys.push([1,13,14,19]),o=nw(e),d.label=2;case 2:return[4,rw(o.next())];case 3:if((s=d.sent()).done)return[3,12];if(i=s.value,t&&0===r)throw this.createExtraByteError(this.totalPos);this.appendBuffer(i),n&&(r=this.readArraySize(),n=!1,this.complete()),d.label=4;case 4:d.trys.push([4,9,,10]),d.label=5;case 5:return[4,rw(this.doDecodeSync())];case 6:return[4,d.sent()];case 7:return d.sent(),0==--r?[3,8]:[3,5];case 8:return[3,10];case 9:if(!((a=d.sent())instanceof aw))throw a;return[3,10];case 10:this.totalPos+=this.pos,d.label=11;case 11:return[3,2];case 12:return[3,19];case 13:return c=d.sent(),l={error:c},[3,19];case 14:return d.trys.push([14,,17,18]),s&&!s.done&&(u=o.return)?[4,rw(u.call(o))]:[3,16];case 15:d.sent(),d.label=16;case 16:return[3,18];case 17:if(l)throw l.error;return[7];case 18:return[7];case 19:return[2]}}))}))},e.prototype.doDecodeSync=function(){e:for(;;){var e=this.readHeadByte(),t=void 0;if(e>=224)t=e-256;else if(e<192)if(e<128)t=e;else if(e<144){if(0!==(r=e-128)){this.pushMapState(r),this.complete();continue e}t={}}else if(e<160){if(0!==(r=e-144)){this.pushArrayState(r),this.complete();continue e}t=[]}else{var n=e-160;t=this.decodeUtf8String(n,0)}else if(192===e)t=null;else if(194===e)t=!1;else if(195===e)t=!0;else if(202===e)t=this.readF32();else if(203===e)t=this.readF64();else if(204===e)t=this.readU8();else if(205===e)t=this.readU16();else if(206===e)t=this.readU32();else if(207===e)t=this.readU64();else if(208===e)t=this.readI8();else if(209===e)t=this.readI16();else if(210===e)t=this.readI32();else if(211===e)t=this.readI64();else if(217===e){n=this.lookU8();t=this.decodeUtf8String(n,1)}else if(218===e){n=this.lookU16();t=this.decodeUtf8String(n,2)}else if(219===e){n=this.lookU32();t=this.decodeUtf8String(n,4)}else if(220===e){if(0!==(r=this.readU16())){this.pushArrayState(r),this.complete();continue e}t=[]}else if(221===e){if(0!==(r=this.readU32())){this.pushArrayState(r),this.complete();continue e}t=[]}else if(222===e){if(0!==(r=this.readU16())){this.pushMapState(r),this.complete();continue e}t={}}else if(223===e){if(0!==(r=this.readU32())){this.pushMapState(r),this.complete();continue e}t={}}else if(196===e){var r=this.lookU8();t=this.decodeBinary(r,1)}else if(197===e){r=this.lookU16();t=this.decodeBinary(r,2)}else if(198===e){r=this.lookU32();t=this.decodeBinary(r,4)}else if(212===e)t=this.decodeExtension(1,0);else if(213===e)t=this.decodeExtension(2,0);else if(214===e)t=this.decodeExtension(4,0);else if(215===e)t=this.decodeExtension(8,0);else if(216===e)t=this.decodeExtension(16,0);else if(199===e){r=this.lookU8();t=this.decodeExtension(r,1)}else if(200===e){r=this.lookU16();t=this.decodeExtension(r,2)}else{if(201!==e)throw new Bb("Unrecognized type byte: ".concat(Qb(e)));r=this.lookU32();t=this.decodeExtension(r,4)}this.complete();for(var o=this.stack;o.length>0;){var s=o[o.length-1];if(0===s.type){if(s.array[s.position]=t,s.position++,s.position!==s.size)continue e;o.pop(),t=s.array}else{if(1===s.type){if(i=void 0,"string"!==(i=typeof t)&&"number"!==i)throw new Bb("The type of key must be string or number but "+typeof t);if("__proto__"===t)throw new Bb("The key __proto__ is not allowed");s.key=t,s.type=2;continue e}if(s.map[s.key]=t,s.readCount++,s.readCount!==s.size){s.key=null,s.type=1;continue e}o.pop(),t=s.map}}return t}var i},e.prototype.readHeadByte=function(){return-1===this.headByte&&(this.headByte=this.readU8()),this.headByte},e.prototype.complete=function(){this.headByte=-1},e.prototype.readArraySize=function(){var e=this.readHeadByte();switch(e){case 220:return this.readU16();case 221:return this.readU32();default:if(e<160)return e-144;throw new Bb("Unrecognized array type byte: ".concat(Qb(e)))}},e.prototype.pushMapState=function(e){if(e>this.maxMapLength)throw new Bb("Max length exceeded: map length (".concat(e,") > maxMapLengthLength (").concat(this.maxMapLength,")"));this.stack.push({type:1,size:e,key:null,readCount:0,map:{}})},e.prototype.pushArrayState=function(e){if(e>this.maxArrayLength)throw new Bb("Max length exceeded: array length (".concat(e,") > maxArrayLength (").concat(this.maxArrayLength,")"));this.stack.push({type:0,size:e,array:new Array(e),position:0})},e.prototype.decodeUtf8String=function(e,t){var n;if(e>this.maxStrLength)throw new Bb("Max length exceeded: UTF-8 byte length (".concat(e,") > maxStrLength (").concat(this.maxStrLength,")"));if(this.bytes.byteLength<this.pos+t+e)throw cw;var r,o=this.pos+t;return r=this.stateIsMapKey()&&(null===(n=this.keyDecoder)||void 0===n?void 0:n.canBeCached(e))?this.keyDecoder.decode(this.bytes,o,e):e>Vb?function(e,t,n){var r=e.subarray(t,t+n);return Gb.decode(r)}(this.bytes,o,e):jb(this.bytes,o,e),this.pos+=t+e,r},e.prototype.stateIsMapKey=function(){return this.stack.length>0&&1===this.stack[this.stack.length-1].type},e.prototype.decodeBinary=function(e,t){if(e>this.maxBinLength)throw new Bb("Max length exceeded: bin length (".concat(e,") > maxBinLength (").concat(this.maxBinLength,")"));if(!this.hasRemaining(e+t))throw cw;var n=this.pos+t,r=this.bytes.subarray(n,n+e);return this.pos+=t+e,r},e.prototype.decodeExtension=function(e,t){if(e>this.maxExtLength)throw new Bb("Max length exceeded: ext length (".concat(e,") > maxExtLength (").concat(this.maxExtLength,")"));var n=this.view.getInt8(this.pos+t),r=this.decodeBinary(e,t+1);return this.extensionCodec.decode(r,n,this.context)},e.prototype.lookU8=function(){return this.view.getUint8(this.pos)},e.prototype.lookU16=function(){return this.view.getUint16(this.pos)},e.prototype.lookU32=function(){return this.view.getUint32(this.pos)},e.prototype.readU8=function(){var e=this.view.getUint8(this.pos);return this.pos++,e},e.prototype.readI8=function(){var e=this.view.getInt8(this.pos);return this.pos++,e},e.prototype.readU16=function(){var e=this.view.getUint16(this.pos);return this.pos+=2,e},e.prototype.readI16=function(){var e=this.view.getInt16(this.pos);return this.pos+=2,e},e.prototype.readU32=function(){var e=this.view.getUint32(this.pos);return this.pos+=4,e},e.prototype.readI32=function(){var e=this.view.getInt32(this.pos);return this.pos+=4,e},e.prototype.readU64=function(){var e,t,n=(e=this.view,t=this.pos,4294967296*e.getUint32(t)+e.getUint32(t+4));return this.pos+=8,n},e.prototype.readI64=function(){var e=Pb(this.view,this.pos);return this.pos+=8,e},e.prototype.readF32=function(){var e=this.view.getFloat32(this.pos);return this.pos+=4,e},e.prototype.readF64=function(){var e=this.view.getFloat64(this.pos);return this.pos+=8,e},e}();class dw{static write(e){let t=e.byteLength||e.length;const n=[];do{let e=127&t;t>>=7,t>0&&(e|=128),n.push(e)}while(t>0);t=e.byteLength||e.length;const r=new Uint8Array(n.length+t);return r.set(n,0),r.set(e,n.length),r.buffer}static parse(e){const t=[],n=new Uint8Array(e),r=[0,7,14,21,28];for(let o=0;o<e.byteLength;){let s,i=0,a=0;do{s=n[o+i],a|=(127&s)<<r[i],i++}while(i<Math.min(5,e.byteLength-o)&&128&s);if(128&s&&i<5)throw new Error("Cannot read message size.");if(5===i&&s>7)throw new Error("Messages bigger than 2GB are not supported.");if(!(n.byteLength>=o+i+a))throw new Error("Incomplete message.");t.push(n.slice?n.slice(o+i,o+i+a):n.subarray(o+i,o+i+a)),o=o+i+a}return t}}const pw=new Uint8Array([145,ab.Ping]);class hw{constructor(e){this.name="messagepack",this.version=2,this.transferFormat=_b.Binary,this._errorResult=1,this._voidResult=2,this._nonVoidResult=3,e=e||{},this._encoder=new Kb(e.extensionCodec,e.context,e.maxDepth,e.initialBufferSize,e.sortKeys,e.forceFloat32,e.ignoreUndefined,e.forceIntegerToFloat),this._decoder=new uw(e.extensionCodec,e.context,e.maxStrLength,e.maxBinLength,e.maxArrayLength,e.maxMapLength,e.maxExtLength)}parseMessages(e,t){if(!(n=e)||"undefined"==typeof ArrayBuffer||!(n instanceof ArrayBuffer||n.constructor&&"ArrayBuffer"===n.constructor.name))throw new Error("Invalid input for MessagePack hub protocol. Expected an ArrayBuffer.");var n;null===t&&(t=jT.instance);const r=dw.parse(e),o=[];for(const e of r){const n=this._parseMessage(e,t);n&&o.push(n)}return o}writeMessage(e){switch(e.type){case ab.Invocation:return this._writeInvocation(e);case ab.StreamInvocation:return this._writeStreamInvocation(e);case ab.StreamItem:return this._writeStreamItem(e);case ab.Completion:return this._writeCompletion(e);case ab.Ping:return dw.write(pw);case ab.CancelInvocation:return this._writeCancelInvocation(e);case ab.Close:return this._writeClose();case ab.Ack:return this._writeAck(e);case ab.Sequence:return this._writeSequence(e);default:throw new Error("Invalid message type.")}}_parseMessage(e,t){if(0===e.length)throw new Error("Invalid payload.");const n=this._decoder.decode(e);if(0===n.length||!(n instanceof Array))throw new Error("Invalid payload.");const r=n[0];switch(r){case ab.Invocation:return this._createInvocationMessage(this._readHeaders(n),n);case ab.StreamItem:return this._createStreamItemMessage(this._readHeaders(n),n);case ab.Completion:return this._createCompletionMessage(this._readHeaders(n),n);case ab.Ping:return this._createPingMessage(n);case ab.Close:return this._createCloseMessage(n);case ab.Ack:return this._createAckMessage(n);case ab.Sequence:return this._createSequenceMessage(n);default:return t.log(FT.Information,"Unknown message type '"+r+"' ignored."),null}}_createCloseMessage(e){if(e.length<2)throw new Error("Invalid payload for Close message.");return{allowReconnect:e.length>=3?e[2]:void 0,error:e[1],type:ab.Close}}_createPingMessage(e){if(e.length<1)throw new Error("Invalid payload for Ping message.");return{type:ab.Ping}}_createInvocationMessage(e,t){if(t.length<5)throw new Error("Invalid payload for Invocation message.");const n=t[2];return n?{arguments:t[4],headers:e,invocationId:n,streamIds:[],target:t[3],type:ab.Invocation}:{arguments:t[4],headers:e,streamIds:[],target:t[3],type:ab.Invocation}}_createStreamItemMessage(e,t){if(t.length<4)throw new Error("Invalid payload for StreamItem message.");return{headers:e,invocationId:t[2],item:t[3],type:ab.StreamItem}}_createCompletionMessage(e,t){if(t.length<4)throw new Error("Invalid payload for Completion message.");const n=t[3];if(n!==this._voidResult&&t.length<5)throw new Error("Invalid payload for Completion message.");let r,o;switch(n){case this._errorResult:r=t[4];break;case this._nonVoidResult:o=t[4]}return{error:r,headers:e,invocationId:t[2],result:o,type:ab.Completion}}_createAckMessage(e){if(e.length<1)throw new Error("Invalid payload for Ack message.");return{sequenceId:e[1],type:ab.Ack}}_createSequenceMessage(e){if(e.length<1)throw new Error("Invalid payload for Sequence message.");return{sequenceId:e[1],type:ab.Sequence}}_writeInvocation(e){let t;return t=e.streamIds?this._encoder.encode([ab.Invocation,e.headers||{},e.invocationId||null,e.target,e.arguments,e.streamIds]):this._encoder.encode([ab.Invocation,e.headers||{},e.invocationId||null,e.target,e.arguments]),dw.write(t.slice())}_writeStreamInvocation(e){let t;return t=e.streamIds?this._encoder.encode([ab.StreamInvocation,e.headers||{},e.invocationId,e.target,e.arguments,e.streamIds]):this._encoder.encode([ab.StreamInvocation,e.headers||{},e.invocationId,e.target,e.arguments]),dw.write(t.slice())}_writeStreamItem(e){const t=this._encoder.encode([ab.StreamItem,e.headers||{},e.invocationId,e.item]);return dw.write(t.slice())}_writeCompletion(e){const t=e.error?this._errorResult:void 0!==e.result?this._nonVoidResult:this._voidResult;let n;switch(t){case this._errorResult:n=this._encoder.encode([ab.Completion,e.headers||{},e.invocationId,t,e.error]);break;case this._voidResult:n=this._encoder.encode([ab.Completion,e.headers||{},e.invocationId,t]);break;case this._nonVoidResult:n=this._encoder.encode([ab.Completion,e.headers||{},e.invocationId,t,e.result])}return dw.write(n.slice())}_writeCancelInvocation(e){const t=this._encoder.encode([ab.CancelInvocation,e.headers||{},e.invocationId]);return dw.write(t.slice())}_writeClose(){const e=this._encoder.encode([ab.Close,null]);return dw.write(e.slice())}_writeAck(e){const t=this._encoder.encode([ab.Ack,e.sequenceId]);return dw.write(t.slice())}_writeSequence(e){const t=this._encoder.encode([ab.Sequence,e.sequenceId]);return dw.write(t.slice())}_readHeaders(e){const t=e[1];if("object"!=typeof t)throw new Error("Invalid headers.");return t}}var fw=function(e,t){return fw=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},fw(e,t)};function gw(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}fw(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function mw(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}c((r=r.apply(e,t||[])).next())}))}function yw(e,t){var n,r,o,s,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}function _w(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function vw(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,s=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(r=s.next()).done;)i.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=s.return)&&n.call(s)}finally{if(o)throw o.error}}return i}function Sw(e,t,n){if(n||2===arguments.length)for(var r,o=0,s=t.length;o<s;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))}function Tw(e){return this instanceof Tw?(this.v=e,this):new Tw(e)}function bw(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,o=n.apply(e,t||[]),s=[];return r={},i("next"),i("throw"),i("return"),r[Symbol.asyncIterator]=function(){return this},r;function i(e){o[e]&&(r[e]=function(t){return new Promise((function(n,r){s.push([e,t,n,r])>1||a(e,t)}))})}function a(e,t){try{!function(e){e.value instanceof Tw?Promise.resolve(e.value.v).then(c,l):u(s[0][2],e)}(o[e](t))}catch(e){u(s[0][3],e)}}function c(e){a("next",e)}function l(e){a("throw",e)}function u(e,t){e(t),s.shift(),s.length&&a(s[0][0],s[0][1])}}function ww(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=_w(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise((function(r,o){(function(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)})(r,o,(t=e[n](t)).done,t.value)}))}}}function Ew(e){return"function"==typeof e}function Iw(e){var t=e((function(e){Error.call(e),e.stack=(new Error).stack}));return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}"function"==typeof SuppressedError&&SuppressedError;var Aw=Iw((function(e){return function(t){e(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t}}));function Rw(e,t){if(e){var n=e.indexOf(t);0<=n&&e.splice(n,1)}}var kw=function(){function e(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}var t;return e.prototype.unsubscribe=function(){var e,t,n,r,o;if(!this.closed){this.closed=!0;var s=this._parentage;if(s)if(this._parentage=null,Array.isArray(s))try{for(var i=_w(s),a=i.next();!a.done;a=i.next()){a.value.remove(this)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}else s.remove(this);var c=this.initialTeardown;if(Ew(c))try{c()}catch(e){o=e instanceof Aw?e.errors:[e]}var l=this._finalizers;if(l){this._finalizers=null;try{for(var u=_w(l),d=u.next();!d.done;d=u.next()){var p=d.value;try{Ow(p)}catch(e){o=null!=o?o:[],e instanceof Aw?o=Sw(Sw([],vw(o)),vw(e.errors)):o.push(e)}}}catch(e){n={error:e}}finally{try{d&&!d.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}}if(o)throw new Aw(o)}},e.prototype.add=function(t){var n;if(t&&t!==this)if(this.closed)Ow(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(n=this._finalizers)&&void 0!==n?n:[]).push(t)}},e.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},e.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},e.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&Rw(t,e)},e.prototype.remove=function(t){var n=this._finalizers;n&&Rw(n,t),t instanceof e&&t._removeParent(this)},e.EMPTY=((t=new e).closed=!0,t),e}(),Cw=kw.EMPTY;function xw(e){return e instanceof kw||e&&"closed"in e&&Ew(e.remove)&&Ew(e.add)&&Ew(e.unsubscribe)}function Ow(e){Ew(e)?e():e.unsubscribe()}var Lw={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},Nw={setTimeout:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return setTimeout.apply(void 0,Sw([e,t],vw(n)))},clearTimeout:function(e){return clearTimeout(e)},delegate:void 0};function Pw(e){Nw.setTimeout((function(){throw e}))}function Dw(){}function Mw(e){e()}var Uw=function(e){function t(t){var n=e.call(this)||this;return n.isStopped=!1,t?(n.destination=t,xw(t)&&t.add(n)):n.destination=qw,n}return gw(t,e),t.create=function(e,t,n){return new Gw(e,t,n)},t.prototype.next=function(e){this.isStopped||this._next(e)},t.prototype.error=function(e){this.isStopped||(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){try{this.destination.error(e)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(kw),$w=Function.prototype.bind;function Fw(e,t){return $w.call(e,t)}var jw=function(){function e(e){this.partialObserver=e}return e.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(e){Vw(e)}},e.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(e){Vw(e)}else Vw(e)},e.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(e){Vw(e)}},e}(),Gw=function(e){function t(t,n,r){var o,s,i=e.call(this)||this;Ew(t)||!t?o={next:null!=t?t:void 0,error:null!=n?n:void 0,complete:null!=r?r:void 0}:i&&Lw.useDeprecatedNextContext?((s=Object.create(t)).unsubscribe=function(){return i.unsubscribe()},o={next:t.next&&Fw(t.next,s),error:t.error&&Fw(t.error,s),complete:t.complete&&Fw(t.complete,s)}):o=t;return i.destination=new jw(o),i}return gw(t,e),t}(Uw);function Vw(e){Pw(e)}var qw={closed:!0,next:Dw,error:function(e){throw e},complete:Dw},Ww="function"==typeof Symbol&&Symbol.observable||"@@observable";function Bw(e){return e}var Hw=function(){function e(e){e&&(this._subscribe=e)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(e,t,n){var r,o=this,s=(r=e)&&r instanceof Uw||function(e){return e&&Ew(e.next)&&Ew(e.error)&&Ew(e.complete)}(r)&&xw(r)?e:new Gw(e,t,n);return Mw((function(){var e=o,t=e.operator,n=e.source;s.add(t?t.call(s,n):n?o._subscribe(s):o._trySubscribe(s))})),s},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},e.prototype.forEach=function(e,t){var n=this;return new(t=Jw(t))((function(t,r){var o=new Gw({next:function(t){try{e(t)}catch(e){r(e),o.unsubscribe()}},error:r,complete:t});n.subscribe(o)}))},e.prototype._subscribe=function(e){var t;return null===(t=this.source)||void 0===t?void 0:t.subscribe(e)},e.prototype[Ww]=function(){return this},e.prototype.pipe=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return(0===(e=t).length?Bw:1===e.length?e[0]:function(t){return e.reduce((function(e,t){return t(e)}),t)})(this)},e.prototype.toPromise=function(e){var t=this;return new(e=Jw(e))((function(e,n){var r;t.subscribe((function(e){return r=e}),(function(e){return n(e)}),(function(){return e(r)}))}))},e.create=function(t){return new e(t)},e}();function Jw(e){var t;return null!==(t=null!=e?e:Lw.Promise)&&void 0!==t?t:Promise}function zw(e){return Ew(null==e?void 0:e.lift)}function Yw(e){return function(t){if(zw(t))return t.lift((function(t){try{return e(t,this)}catch(e){this.error(e)}}));throw new TypeError("Unable to lift unknown Observable type")}}function Xw(e,t,n,r,o){return new Kw(e,t,n,r,o)}var Kw=function(e){function t(t,n,r,o,s,i){var a=e.call(this,t)||this;return a.onFinalize=s,a.shouldUnsubscribe=i,a._next=n?function(e){try{n(e)}catch(e){t.error(e)}}:e.prototype._next,a._error=o?function(e){try{o(e)}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._error,a._complete=r?function(){try{r()}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._complete,a}return gw(t,e),t.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var n=this.closed;e.prototype.unsubscribe.call(this),!n&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}},t}(Uw);!function(e){function t(t,n){var r=e.call(this)||this;return r.source=t,r.subjectFactory=n,r._subject=null,r._refCount=0,r._connection=null,zw(t)&&(r.lift=t.lift),r}gw(t,e),t.prototype._subscribe=function(e){return this.getSubject().subscribe(e)},t.prototype.getSubject=function(){var e=this._subject;return e&&!e.isStopped||(this._subject=this.subjectFactory()),this._subject},t.prototype._teardown=function(){this._refCount=0;var e=this._connection;this._subject=this._connection=null,null==e||e.unsubscribe()},t.prototype.connect=function(){var e=this,t=this._connection;if(!t){t=this._connection=new kw;var n=this.getSubject();t.add(this.source.subscribe(Xw(n,void 0,(function(){e._teardown(),n.complete()}),(function(t){e._teardown(),n.error(t)}),(function(){return e._teardown()})))),t.closed&&(this._connection=null,t=kw.EMPTY)}return t},t.prototype.refCount=function(){return Yw((function(e,t){var n=null;e._refCount++;var r=Xw(t,void 0,void 0,void 0,(function(){if(!e||e._refCount<=0||0<--e._refCount)n=null;else{var r=e._connection,o=n;n=null,!r||o&&r!==o||r.unsubscribe(),t.unsubscribe()}}));e.subscribe(r),r.closed||(n=e.connect())}))(this)}}(Hw);var Qw,Zw={now:function(){return(Zw.delegate||performance).now()},delegate:void 0},eE={schedule:function(e){var t=requestAnimationFrame,n=cancelAnimationFrame,r=t((function(t){n=void 0,e(t)}));return new kw((function(){return null==n?void 0:n(r)}))},requestAnimationFrame:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=eE.delegate;return((null==n?void 0:n.requestAnimationFrame)||requestAnimationFrame).apply(void 0,Sw([],vw(e)))},cancelAnimationFrame:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return cancelAnimationFrame.apply(void 0,Sw([],vw(e)))},delegate:void 0};new Hw((function(e){var t=Qw||Zw,n=t.now(),r=0,o=function(){e.closed||(r=eE.requestAnimationFrame((function(s){r=0;var i=t.now();e.next({timestamp:Qw?i:s,elapsed:i-n}),o()})))};return o(),function(){r&&eE.cancelAnimationFrame(r)}}));var tE=Iw((function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}})),nE=function(e){function t(){var t=e.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return gw(t,e),t.prototype.lift=function(e){var t=new rE(this,this);return t.operator=e,t},t.prototype._throwIfClosed=function(){if(this.closed)throw new tE},t.prototype.next=function(e){var t=this;Mw((function(){var n,r;if(t._throwIfClosed(),!t.isStopped){t.currentObservers||(t.currentObservers=Array.from(t.observers));try{for(var o=_w(t.currentObservers),s=o.next();!s.done;s=o.next()){s.value.next(e)}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}}}))},t.prototype.error=function(e){var t=this;Mw((function(){if(t._throwIfClosed(),!t.isStopped){t.hasError=t.isStopped=!0,t.thrownError=e;for(var n=t.observers;n.length;)n.shift().error(e)}}))},t.prototype.complete=function(){var e=this;Mw((function(){if(e._throwIfClosed(),!e.isStopped){e.isStopped=!0;for(var t=e.observers;t.length;)t.shift().complete()}}))},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(t){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)},t.prototype._innerSubscribe=function(e){var t=this,n=this,r=n.hasError,o=n.isStopped,s=n.observers;return r||o?Cw:(this.currentObservers=null,s.push(e),new kw((function(){t.currentObservers=null,Rw(s,e)})))},t.prototype._checkFinalizedStatuses=function(e){var t=this,n=t.hasError,r=t.thrownError,o=t.isStopped;n?e.error(r):o&&e.complete()},t.prototype.asObservable=function(){var e=new Hw;return e.source=this,e},t.create=function(e,t){return new rE(e,t)},t}(Hw),rE=function(e){function t(t,n){var r=e.call(this)||this;return r.destination=t,r.source=n,r}return gw(t,e),t.prototype.next=function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===n||n.call(t,e)},t.prototype.error=function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===n||n.call(t,e)},t.prototype.complete=function(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)},t.prototype._subscribe=function(e){var t,n;return null!==(n=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==n?n:Cw},t}(nE),oE=function(e){function t(t){var n=e.call(this)||this;return n._value=t,n}return gw(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),t.prototype._subscribe=function(t){var n=e.prototype._subscribe.call(this,t);return!n.closed&&t.next(this._value),n},t.prototype.getValue=function(){var e=this,t=e.hasError,n=e.thrownError,r=e._value;if(t)throw n;return this._throwIfClosed(),r},t.prototype.next=function(t){e.prototype.next.call(this,this._value=t)},t}(nE),sE={now:function(){return(sE.delegate||Date).now()},delegate:void 0},iE=function(e){function t(t,n,r){void 0===t&&(t=1/0),void 0===n&&(n=1/0),void 0===r&&(r=sE);var o=e.call(this)||this;return o._bufferSize=t,o._windowTime=n,o._timestampProvider=r,o._buffer=[],o._infiniteTimeWindow=!0,o._infiniteTimeWindow=n===1/0,o._bufferSize=Math.max(1,t),o._windowTime=Math.max(1,n),o}return gw(t,e),t.prototype.next=function(t){var n=this,r=n.isStopped,o=n._buffer,s=n._infiniteTimeWindow,i=n._timestampProvider,a=n._windowTime;r||(o.push(t),!s&&o.push(i.now()+a)),this._trimBuffer(),e.prototype.next.call(this,t)},t.prototype._subscribe=function(e){this._throwIfClosed(),this._trimBuffer();for(var t=this._innerSubscribe(e),n=this._infiniteTimeWindow,r=this._buffer.slice(),o=0;o<r.length&&!e.closed;o+=n?1:2)e.next(r[o]);return this._checkFinalizedStatuses(e),t},t.prototype._trimBuffer=function(){var e=this,t=e._bufferSize,n=e._timestampProvider,r=e._buffer,o=e._infiniteTimeWindow,s=(o?1:2)*t;if(t<1/0&&s<r.length&&r.splice(0,r.length-s),!o){for(var i=n.now(),a=0,c=1;c<r.length&&r[c]<=i;c+=2)a=c;a&&r.splice(0,a+1)}},t}(nE);!function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._value=null,t._hasValue=!1,t._isComplete=!1,t}gw(t,e),t.prototype._checkFinalizedStatuses=function(e){var t=this,n=t.hasError,r=t._hasValue,o=t._value,s=t.thrownError,i=t.isStopped,a=t._isComplete;n?e.error(s):(i||a)&&(r&&e.next(o),e.complete())},t.prototype.next=function(e){this.isStopped||(this._value=e,this._hasValue=!0)},t.prototype.complete=function(){var t=this,n=t._hasValue,r=t._value;t._isComplete||(this._isComplete=!0,n&&e.prototype.next.call(this,r),e.prototype.complete.call(this))}}(nE);var aE,cE=function(e){function t(t,n){return e.call(this)||this}return gw(t,e),t.prototype.schedule=function(e,t){return this},t}(kw),lE=function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return setInterval.apply(void 0,Sw([e,t],vw(n)))},uE=function(e){return clearInterval(e)},dE=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r.pending=!1,r}return gw(t,e),t.prototype.schedule=function(e,t){var n;if(void 0===t&&(t=0),this.closed)return this;this.state=e;var r=this.id,o=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(o,r,t)),this.pending=!0,this.delay=t,this.id=null!==(n=this.id)&&void 0!==n?n:this.requestAsyncId(o,this.id,t),this},t.prototype.requestAsyncId=function(e,t,n){return void 0===n&&(n=0),lE(e.flush.bind(e,this),n)},t.prototype.recycleAsyncId=function(e,t,n){if(void 0===n&&(n=0),null!=n&&this.delay===n&&!1===this.pending)return t;null!=t&&uE(t)},t.prototype.execute=function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(e,t){var n,r=!1;try{this.work(e)}catch(e){r=!0,n=e||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),n},t.prototype.unsubscribe=function(){if(!this.closed){var t=this.id,n=this.scheduler,r=n.actions;this.work=this.state=this.scheduler=null,this.pending=!1,Rw(r,this),null!=t&&(this.id=this.recycleAsyncId(n,t,null)),this.delay=null,e.prototype.unsubscribe.call(this)}},t}(cE),pE=1,hE={};function fE(e){return e in hE&&(delete hE[e],!0)}var gE=function(e){var t=pE++;return hE[t]=!0,aE||(aE=Promise.resolve()),aE.then((function(){return fE(t)&&e()})),t},mE=function(e){fE(e)},yE={setImmediate:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=yE.delegate;return((null==n?void 0:n.setImmediate)||gE).apply(void 0,Sw([],vw(e)))},clearImmediate:function(e){return mE(e)},delegate:void 0},_E=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r}return gw(t,e),t.prototype.requestAsyncId=function(t,n,r){return void 0===r&&(r=0),null!==r&&r>0?e.prototype.requestAsyncId.call(this,t,n,r):(t.actions.push(this),t._scheduled||(t._scheduled=yE.setImmediate(t.flush.bind(t,void 0))))},t.prototype.recycleAsyncId=function(t,n,r){var o;if(void 0===r&&(r=0),null!=r?r>0:this.delay>0)return e.prototype.recycleAsyncId.call(this,t,n,r);var s=t.actions;null!=n&&(null===(o=s[s.length-1])||void 0===o?void 0:o.id)!==n&&(yE.clearImmediate(n),t._scheduled===n&&(t._scheduled=void 0))},t}(dE),vE=function(){function e(t,n){void 0===n&&(n=e.now),this.schedulerActionCtor=t,this.now=n}return e.prototype.schedule=function(e,t,n){return void 0===t&&(t=0),new this.schedulerActionCtor(this,e).schedule(n,t)},e.now=sE.now,e}(),SE=function(e){function t(t,n){void 0===n&&(n=vE.now);var r=e.call(this,t,n)||this;return r.actions=[],r._active=!1,r}return gw(t,e),t.prototype.flush=function(e){var t=this.actions;if(this._active)t.push(e);else{var n;this._active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}},t}(vE),TE=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return gw(t,e),t.prototype.flush=function(e){this._active=!0;var t=this._scheduled;this._scheduled=void 0;var n,r=this.actions;e=e||r.shift();do{if(n=e.execute(e.state,e.delay))break}while((e=r[0])&&e.id===t&&r.shift());if(this._active=!1,n){for(;(e=r[0])&&e.id===t&&r.shift();)e.unsubscribe();throw n}},t}(SE);new TE(_E),new SE(dE);var bE=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r}return gw(t,e),t.prototype.schedule=function(t,n){return void 0===n&&(n=0),n>0?e.prototype.schedule.call(this,t,n):(this.delay=n,this.state=t,this.scheduler.flush(this),this)},t.prototype.execute=function(t,n){return n>0||this.closed?e.prototype.execute.call(this,t,n):this._execute(t,n)},t.prototype.requestAsyncId=function(t,n,r){return void 0===r&&(r=0),null!=r&&r>0||null==r&&this.delay>0?e.prototype.requestAsyncId.call(this,t,n,r):(t.flush(this),0)},t}(dE),wE=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return gw(t,e),t}(SE);new wE(bE);var EE=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r}return gw(t,e),t.prototype.requestAsyncId=function(t,n,r){return void 0===r&&(r=0),null!==r&&r>0?e.prototype.requestAsyncId.call(this,t,n,r):(t.actions.push(this),t._scheduled||(t._scheduled=eE.requestAnimationFrame((function(){return t.flush(void 0)}))))},t.prototype.recycleAsyncId=function(t,n,r){var o;if(void 0===r&&(r=0),null!=r?r>0:this.delay>0)return e.prototype.recycleAsyncId.call(this,t,n,r);var s=t.actions;null!=n&&(null===(o=s[s.length-1])||void 0===o?void 0:o.id)!==n&&(eE.cancelAnimationFrame(n),t._scheduled=void 0)},t}(dE),IE=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return gw(t,e),t.prototype.flush=function(e){this._active=!0;var t=this._scheduled;this._scheduled=void 0;var n,r=this.actions;e=e||r.shift();do{if(n=e.execute(e.state,e.delay))break}while((e=r[0])&&e.id===t&&r.shift());if(this._active=!1,n){for(;(e=r[0])&&e.id===t&&r.shift();)e.unsubscribe();throw n}},t}(SE);new IE(EE),function(e){function t(t,n){void 0===t&&(t=AE),void 0===n&&(n=1/0);var r=e.call(this,t,(function(){return r.frame}))||this;return r.maxFrames=n,r.frame=0,r.index=-1,r}gw(t,e),t.prototype.flush=function(){for(var e,t,n=this.actions,r=this.maxFrames;(t=n[0])&&t.delay<=r&&(n.shift(),this.frame=t.delay,!(e=t.execute(t.state,t.delay))););if(e){for(;t=n.shift();)t.unsubscribe();throw e}},t.frameTimeFactor=10}(SE);var AE=function(e){function t(t,n,r){void 0===r&&(r=t.index+=1);var o=e.call(this,t,n)||this;return o.scheduler=t,o.work=n,o.index=r,o.active=!0,o.index=t.index=r,o}return gw(t,e),t.prototype.schedule=function(n,r){if(void 0===r&&(r=0),Number.isFinite(r)){if(!this.id)return e.prototype.schedule.call(this,n,r);this.active=!1;var o=new t(this.scheduler,this.work);return this.add(o),o.schedule(n,r)}return kw.EMPTY},t.prototype.requestAsyncId=function(e,n,r){void 0===r&&(r=0),this.delay=e.frame+r;var o=e.actions;return o.push(this),o.sort(t.sortActions),1},t.prototype.recycleAsyncId=function(e,t,n){},t.prototype._execute=function(t,n){if(!0===this.active)return e.prototype._execute.call(this,t,n)},t.sortActions=function(e,t){return e.delay===t.delay?e.index===t.index?0:e.index>t.index?1:-1:e.delay>t.delay?1:-1},t}(dE),RE=new Hw((function(e){return e.complete()}));function kE(e){return e[e.length-1]}function CE(e){return(t=kE(e))&&Ew(t.schedule)?e.pop():void 0;var t}var xE=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e};function OE(e){return Ew(null==e?void 0:e.then)}function LE(e){return Ew(e[Ww])}function NE(e){return Symbol.asyncIterator&&Ew(null==e?void 0:e[Symbol.asyncIterator])}function PE(e){return new TypeError("You provided "+(null!==e&&"object"==typeof e?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}var DE,ME="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator";function UE(e){return Ew(null==e?void 0:e[ME])}function $E(e){return bw(this,arguments,(function(){var t,n,r;return yw(this,(function(o){switch(o.label){case 0:t=e.getReader(),o.label=1;case 1:o.trys.push([1,,9,10]),o.label=2;case 2:return[4,Tw(t.read())];case 3:return n=o.sent(),r=n.value,n.done?[4,Tw(void 0)]:[3,5];case 4:return[2,o.sent()];case 5:return[4,Tw(r)];case 6:return[4,o.sent()];case 7:return o.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}}))}))}function FE(e){return Ew(null==e?void 0:e.getReader)}function jE(e){if(e instanceof Hw)return e;if(null!=e){if(LE(e))return o=e,new Hw((function(e){var t=o[Ww]();if(Ew(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")}));if(xE(e))return r=e,new Hw((function(e){for(var t=0;t<r.length&&!e.closed;t++)e.next(r[t]);e.complete()}));if(OE(e))return n=e,new Hw((function(e){n.then((function(t){e.closed||(e.next(t),e.complete())}),(function(t){return e.error(t)})).then(null,Pw)}));if(NE(e))return GE(e);if(UE(e))return t=e,new Hw((function(e){var n,r;try{for(var o=_w(t),s=o.next();!s.done;s=o.next()){var i=s.value;if(e.next(i),e.closed)return}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}e.complete()}));if(FE(e))return GE($E(e))}var t,n,r,o;throw PE(e)}function GE(e){return new Hw((function(t){(function(e,t){var n,r,o,s;return mw(this,void 0,void 0,(function(){var i,a;return yw(this,(function(c){switch(c.label){case 0:c.trys.push([0,5,6,11]),n=ww(e),c.label=1;case 1:return[4,n.next()];case 2:if((r=c.sent()).done)return[3,4];if(i=r.value,t.next(i),t.closed)return[2];c.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return a=c.sent(),o={error:a},[3,11];case 6:return c.trys.push([6,,9,10]),r&&!r.done&&(s=n.return)?[4,s.call(n)]:[3,8];case 7:c.sent(),c.label=8;case 8:return[3,10];case 9:if(o)throw o.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}}))}))})(e,t).catch((function(e){return t.error(e)}))}))}function VE(e,t,n,r,o){void 0===r&&(r=0),void 0===o&&(o=!1);var s=t.schedule((function(){n(),o?e.add(this.schedule(null,r)):this.unsubscribe()}),r);if(e.add(s),!o)return s}function qE(e,t){return void 0===t&&(t=0),Yw((function(n,r){n.subscribe(Xw(r,(function(n){return VE(r,e,(function(){return r.next(n)}),t)}),(function(){return VE(r,e,(function(){return r.complete()}),t)}),(function(n){return VE(r,e,(function(){return r.error(n)}),t)})))}))}function WE(e,t){return void 0===t&&(t=0),Yw((function(n,r){r.add(e.schedule((function(){return n.subscribe(r)}),t))}))}function BE(e,t){if(!e)throw new Error("Iterable cannot be null");return new Hw((function(n){VE(n,t,(function(){var r=e[Symbol.asyncIterator]();VE(n,t,(function(){r.next().then((function(e){e.done?n.complete():n.next(e.value)}))}),0,!0)}))}))}function HE(e,t){if(null!=e){if(LE(e))return function(e,t){return jE(e).pipe(WE(t),qE(t))}(e,t);if(xE(e))return function(e,t){return new Hw((function(n){var r=0;return t.schedule((function(){r===e.length?n.complete():(n.next(e[r++]),n.closed||this.schedule())}))}))}(e,t);if(OE(e))return function(e,t){return jE(e).pipe(WE(t),qE(t))}(e,t);if(NE(e))return BE(e,t);if(UE(e))return function(e,t){return new Hw((function(n){var r;return VE(n,t,(function(){r=e[ME](),VE(n,t,(function(){var e,t,o;try{t=(e=r.next()).value,o=e.done}catch(e){return void n.error(e)}o?n.complete():n.next(t)}),0,!0)})),function(){return Ew(null==r?void 0:r.return)&&r.return()}}))}(e,t);if(FE(e))return function(e,t){return BE($E(e),t)}(e,t)}throw PE(e)}function JE(e,t){return t?HE(e,t):jE(e)}function zE(e,t){return Yw((function(n,r){var o=0;n.subscribe(Xw(r,(function(n){r.next(e.call(t,n,o++))})))}))}!function(e){e.NEXT="N",e.ERROR="E",e.COMPLETE="C"}(DE||(DE={})),Iw((function(e){return function(){e(this),this.name="EmptyError",this.message="no elements in sequence"}})),Iw((function(e){return function(){e(this),this.name="ArgumentOutOfRangeError",this.message="argument out of range"}})),Iw((function(e){return function(t){e(this),this.name="NotFoundError",this.message=t}})),Iw((function(e){return function(t){e(this),this.name="SequenceError",this.message=t}})),Iw((function(e){return function(t){void 0===t&&(t=null),e(this),this.message="Timeout has occurred",this.name="TimeoutError",this.info=t}}));var YE=Array.isArray;function XE(e){return zE((function(t){return function(e,t){return YE(t)?e.apply(void 0,Sw([],vw(t))):e(t)}(e,t)}))}var KE=Array.isArray,QE=Object.getPrototypeOf,ZE=Object.prototype,eI=Object.keys;function tI(e){if(1===e.length){var t=e[0];if(KE(t))return{args:t,keys:null};if((r=t)&&"object"==typeof r&&QE(r)===ZE){var n=eI(t);return{args:n.map((function(e){return t[e]})),keys:n}}}var r;return{args:e,keys:null}}function nI(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=CE(e),r=function(e){return Ew(kE(e))?e.pop():void 0}(e),o=tI(e),s=o.args,i=o.keys;if(0===s.length)return JE([],n);var a=new Hw(function(e,t,n){void 0===n&&(n=Bw);return function(r){rI(t,(function(){for(var o=e.length,s=new Array(o),i=o,a=o,c=function(o){rI(t,(function(){var c=JE(e[o],t),l=!1;c.subscribe(Xw(r,(function(e){s[o]=e,l||(l=!0,a--),a||r.next(n(s.slice()))}),(function(){--i||r.complete()})))}),r)},l=0;l<o;l++)c(l)}),r)}}(s,n,i?function(e){return function(e,t){return e.reduce((function(e,n,r){return e[n]=t[r],e}),{})}(i,e)}:Bw));return r?a.pipe(XE(r)):a}function rI(e,t,n){e?VE(n,e,t):t()}function oI(e,t,n){return void 0===n&&(n=1/0),Ew(t)?oI((function(n,r){return zE((function(e,o){return t(n,e,r,o)}))(jE(e(n,r)))}),n):("number"==typeof t&&(n=t),Yw((function(t,r){return function(e,t,n,r,o,s,i,a){var c=[],l=0,u=0,d=!1,p=function(){!d||c.length||l||t.complete()},h=function(e){return l<r?f(e):c.push(e)},f=function(e){s&&t.next(e),l++;var a=!1;jE(n(e,u++)).subscribe(Xw(t,(function(e){null==o||o(e),s?h(e):t.next(e)}),(function(){a=!0}),void 0,(function(){if(a)try{l--;for(var e=function(){var e=c.shift();i?VE(t,i,(function(){return f(e)})):f(e)};c.length&&l<r;)e();p()}catch(e){t.error(e)}})))};return e.subscribe(Xw(t,h,(function(){d=!0,p()}))),function(){null==a||a()}}(t,r,e,n)})))}function sI(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=CE(e),r=function(e,t){return"number"==typeof kE(e)?e.pop():t}(e,1/0),o=e;return o.length?1===o.length?jE(o[0]):function(e){return void 0===e&&(e=1/0),oI(Bw,e)}(r)(JE(o,n)):RE}function iI(e,t){return Yw((function(n,r){var o=0;n.subscribe(Xw(r,(function(n){return e.call(t,n,o++)&&r.next(n)})))}))}function aI(e,t){return Yw(function(e,t,n,r,o){return function(s,i){var a=n,c=t,l=0;s.subscribe(Xw(i,(function(t){var n=l++;c=a?e(c,t,n):(a=!0,t),r&&i.next(c)}),o&&function(){a&&i.next(c),i.complete()}))}}(e,t,arguments.length>=2,!0))}function cI(e){void 0===e&&(e={});var t=e.connector,n=void 0===t?function(){return new nE}:t,r=e.resetOnError,o=void 0===r||r,s=e.resetOnComplete,i=void 0===s||s,a=e.resetOnRefCountZero,c=void 0===a||a;return function(e){var t,r,s,a=0,l=!1,u=!1,d=function(){null==r||r.unsubscribe(),r=void 0},p=function(){d(),t=s=void 0,l=u=!1},h=function(){var e=t;p(),null==e||e.unsubscribe()};return Yw((function(e,f){a++,u||l||d();var g=s=null!=s?s:n();f.add((function(){0!==--a||u||l||(r=lI(h,c))})),g.subscribe(f),!t&&a>0&&(t=new Gw({next:function(e){return g.next(e)},error:function(e){u=!0,d(),r=lI(p,o,e),g.error(e)},complete:function(){l=!0,d(),r=lI(p,i),g.complete()}}),jE(e).subscribe(t))}))(e)}}function lI(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!0!==t){if(!1!==t){var o=new Gw({next:function(){o.unsubscribe(),e()}});return jE(t.apply(void 0,Sw([],vw(n)))).subscribe(o)}}else e()}function uI(){let e=0,t=0;for(let n=0;n<28;n+=7){let r=this.buf[this.pos++];if(e|=(127&r)<<n,!(128&r))return this.assertBounds(),[e,t]}let n=this.buf[this.pos++];if(e|=(15&n)<<28,t=(112&n)>>4,!(128&n))return this.assertBounds(),[e,t];for(let n=3;n<=31;n+=7){let r=this.buf[this.pos++];if(t|=(127&r)<<n,!(128&r))return this.assertBounds(),[e,t]}throw new Error("invalid varint")}function dI(e,t,n){for(let r=0;r<28;r+=7){const o=e>>>r,s=!(o>>>7==0&&0==t),i=255&(s?128|o:o);if(n.push(i),!s)return}const r=e>>>28&15|(7&t)<<4,o=!!(t>>3);if(n.push(255&(o?128|r:r)),o){for(let e=3;e<31;e+=7){const r=t>>>e,o=!(r>>>7==0),s=255&(o?128|r:r);if(n.push(s),!o)return}n.push(t>>>31&1)}}new Hw(Dw);const pI=4294967296;function hI(e){const t="-"===e[0];t&&(e=e.slice(1));const n=1e6;let r=0,o=0;function s(t,s){const i=Number(e.slice(t,s));o*=n,r=r*n+i,r>=pI&&(o+=r/pI|0,r%=pI)}return s(-24,-18),s(-18,-12),s(-12,-6),s(-6),t?mI(r,o):gI(r,o)}function fI(e,t){if(({lo:e,hi:t}=function(e,t){return{lo:e>>>0,hi:t>>>0}}(e,t)),t<=2097151)return String(pI*t+e);const n=16777215&(e>>>24|t<<8),r=t>>16&65535;let o=(16777215&e)+6777216*n+6710656*r,s=n+8147497*r,i=2*r;const a=1e7;return o>=a&&(s+=Math.floor(o/a),o%=a),s>=a&&(i+=Math.floor(s/a),s%=a),i.toString()+yI(s)+yI(o)}function gI(e,t){return{lo:0|e,hi:0|t}}function mI(e,t){return t=~t,e?e=1+~e:t+=1,gI(e,t)}const yI=e=>{const t=String(e);return"0000000".slice(t.length)+t};function _I(e,t){if(e>=0){for(;e>127;)t.push(127&e|128),e>>>=7;t.push(e)}else{for(let n=0;n<9;n++)t.push(127&e|128),e>>=7;t.push(1)}}function vI(){let e=this.buf[this.pos++],t=127&e;if(!(128&e))return this.assertBounds(),t;if(e=this.buf[this.pos++],t|=(127&e)<<7,!(128&e))return this.assertBounds(),t;if(e=this.buf[this.pos++],t|=(127&e)<<14,!(128&e))return this.assertBounds(),t;if(e=this.buf[this.pos++],t|=(127&e)<<21,!(128&e))return this.assertBounds(),t;e=this.buf[this.pos++],t|=(15&e)<<28;for(let t=5;128&e&&t<10;t++)e=this.buf[this.pos++];if(128&e)throw new Error("invalid varint");return this.assertBounds(),t>>>0}const SI=TI();function TI(){const e=new DataView(new ArrayBuffer(8));if("function"==typeof BigInt&&"function"==typeof e.getBigInt64&&"function"==typeof e.getBigUint64&&"function"==typeof e.setBigInt64&&"function"==typeof e.setBigUint64&&("object"!=typeof process||"object"!=typeof process.env||"1"!==process.env.BUF_BIGINT_DISABLE)){const t=BigInt("-9223372036854775808"),n=BigInt("9223372036854775807"),r=BigInt("0"),o=BigInt("18446744073709551615");return{zero:BigInt(0),supported:!0,parse(e){const r="bigint"==typeof e?e:BigInt(e);if(r>n||r<t)throw new Error(`invalid int64: ${e}`);return r},uParse(e){const t="bigint"==typeof e?e:BigInt(e);if(t>o||t<r)throw new Error(`invalid uint64: ${e}`);return t},enc(t){return e.setBigInt64(0,this.parse(t),!0),{lo:e.getInt32(0,!0),hi:e.getInt32(4,!0)}},uEnc(t){return e.setBigInt64(0,this.uParse(t),!0),{lo:e.getInt32(0,!0),hi:e.getInt32(4,!0)}},dec:(t,n)=>(e.setInt32(0,t,!0),e.setInt32(4,n,!0),e.getBigInt64(0,!0)),uDec:(t,n)=>(e.setInt32(0,t,!0),e.setInt32(4,n,!0),e.getBigUint64(0,!0))}}return{zero:"0",supported:!1,parse:e=>("string"!=typeof e&&(e=e.toString()),bI(e),e),uParse:e=>("string"!=typeof e&&(e=e.toString()),wI(e),e),enc:e=>("string"!=typeof e&&(e=e.toString()),bI(e),hI(e)),uEnc:e=>("string"!=typeof e&&(e=e.toString()),wI(e),hI(e)),dec:(e,t)=>function(e,t){let n=gI(e,t);const r=2147483648&n.hi;r&&(n=mI(n.lo,n.hi));const o=fI(n.lo,n.hi);return r?"-"+o:o}(e,t),uDec:(e,t)=>fI(e,t)}}function bI(e){if(!/^-?[0-9]+$/.test(e))throw new Error("invalid int64: "+e)}function wI(e){if(!/^[0-9]+$/.test(e))throw new Error("invalid uint64: "+e)}const EI=Symbol.for("@bufbuild/protobuf/text-encoding");function II(){if(null==globalThis[EI]){const e=new globalThis.TextEncoder,t=new globalThis.TextDecoder;globalThis[EI]={encodeUtf8:t=>e.encode(t),decodeUtf8:e=>t.decode(e),checkUtf8(e){try{return encodeURIComponent(e),!0}catch(e){return!1}}}}return globalThis[EI]}var AI;!function(e){e[e.Varint=0]="Varint",e[e.Bit64=1]="Bit64",e[e.LengthDelimited=2]="LengthDelimited",e[e.StartGroup=3]="StartGroup",e[e.EndGroup=4]="EndGroup",e[e.Bit32=5]="Bit32"}(AI||(AI={}));const RI=34028234663852886e22,kI=-34028234663852886e22;class CI{constructor(e=II().encodeUtf8){this.encodeUtf8=e,this.stack=[],this.chunks=[],this.buf=[]}finish(){this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]);let e=0;for(let t=0;t<this.chunks.length;t++)e+=this.chunks[t].length;let t=new Uint8Array(e),n=0;for(let e=0;e<this.chunks.length;e++)t.set(this.chunks[e],n),n+=this.chunks[e].length;return this.chunks=[],t}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let e=this.finish(),t=this.stack.pop();if(!t)throw new Error("invalid state, fork stack empty");return this.chunks=t.chunks,this.buf=t.buf,this.uint32(e.byteLength),this.raw(e)}tag(e,t){return this.uint32((e<<3|t)>>>0)}raw(e){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(e),this}uint32(e){for(LI(e);e>127;)this.buf.push(127&e|128),e>>>=7;return this.buf.push(e),this}int32(e){return OI(e),_I(e,this.buf),this}bool(e){return this.buf.push(e?1:0),this}bytes(e){return this.uint32(e.byteLength),this.raw(e)}string(e){let t=this.encodeUtf8(e);return this.uint32(t.byteLength),this.raw(t)}float(e){!function(e){if("string"==typeof e){const t=e;if(e=Number(e),isNaN(e)&&"NaN"!==t)throw new Error("invalid float32: "+t)}else if("number"!=typeof e)throw new Error("invalid float32: "+typeof e);if(Number.isFinite(e)&&(e>RI||e<kI))throw new Error("invalid float32: "+e)}(e);let t=new Uint8Array(4);return new DataView(t.buffer).setFloat32(0,e,!0),this.raw(t)}double(e){let t=new Uint8Array(8);return new DataView(t.buffer).setFloat64(0,e,!0),this.raw(t)}fixed32(e){LI(e);let t=new Uint8Array(4);return new DataView(t.buffer).setUint32(0,e,!0),this.raw(t)}sfixed32(e){OI(e);let t=new Uint8Array(4);return new DataView(t.buffer).setInt32(0,e,!0),this.raw(t)}sint32(e){return OI(e),_I(e=(e<<1^e>>31)>>>0,this.buf),this}sfixed64(e){let t=new Uint8Array(8),n=new DataView(t.buffer),r=SI.enc(e);return n.setInt32(0,r.lo,!0),n.setInt32(4,r.hi,!0),this.raw(t)}fixed64(e){let t=new Uint8Array(8),n=new DataView(t.buffer),r=SI.uEnc(e);return n.setInt32(0,r.lo,!0),n.setInt32(4,r.hi,!0),this.raw(t)}int64(e){let t=SI.enc(e);return dI(t.lo,t.hi,this.buf),this}sint64(e){let t=SI.enc(e),n=t.hi>>31;return dI(t.lo<<1^n,(t.hi<<1|t.lo>>>31)^n,this.buf),this}uint64(e){let t=SI.uEnc(e);return dI(t.lo,t.hi,this.buf),this}}class xI{constructor(e,t=II().decodeUtf8){this.decodeUtf8=t,this.varint64=uI,this.uint32=vI,this.buf=e,this.len=e.length,this.pos=0,this.view=new DataView(e.buffer,e.byteOffset,e.byteLength)}tag(){let e=this.uint32(),t=e>>>3,n=7&e;if(t<=0||n<0||n>5)throw new Error("illegal tag: field no "+t+" wire type "+n);return[t,n]}skip(e,t){let n=this.pos;switch(e){case AI.Varint:for(;128&this.buf[this.pos++];);break;case AI.Bit64:this.pos+=4;case AI.Bit32:this.pos+=4;break;case AI.LengthDelimited:let n=this.uint32();this.pos+=n;break;case AI.StartGroup:for(;;){const[e,n]=this.tag();if(n===AI.EndGroup){if(void 0!==t&&e!==t)throw new Error("invalid end group tag");break}this.skip(n,e)}break;default:throw new Error("cant skip wire type "+e)}return this.assertBounds(),this.buf.subarray(n,this.pos)}assertBounds(){if(this.pos>this.len)throw new RangeError("premature EOF")}int32(){return 0|this.uint32()}sint32(){let e=this.uint32();return e>>>1^-(1&e)}int64(){return SI.dec(...this.varint64())}uint64(){return SI.uDec(...this.varint64())}sint64(){let[e,t]=this.varint64(),n=-(1&e);return e=(e>>>1|(1&t)<<31)^n,t=t>>>1^n,SI.dec(e,t)}bool(){let[e,t]=this.varint64();return 0!==e||0!==t}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return SI.uDec(this.sfixed32(),this.sfixed32())}sfixed64(){return SI.dec(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let e=this.uint32(),t=this.pos;return this.pos+=e,this.assertBounds(),this.buf.subarray(t,t+e)}string(){return this.decodeUtf8(this.bytes())}}function OI(e){if("string"==typeof e)e=Number(e);else if("number"!=typeof e)throw new Error("invalid int32: "+typeof e);if(!Number.isInteger(e)||e>2147483647||e<-2147483648)throw new Error("invalid int32: "+e)}function LI(e){if("string"==typeof e)e=Number(e);else if("number"!=typeof e)throw new Error("invalid uint32: "+typeof e);if(!Number.isInteger(e)||e>4294967295||e<0)throw new Error("invalid uint32: "+e)}var NI;!function(e){e[e.DOUBLE=1]="DOUBLE",e[e.FLOAT=2]="FLOAT",e[e.INT64=3]="INT64",e[e.UINT64=4]="UINT64",e[e.INT32=5]="INT32",e[e.FIXED64=6]="FIXED64",e[e.FIXED32=7]="FIXED32",e[e.BOOL=8]="BOOL",e[e.STRING=9]="STRING",e[e.BYTES=12]="BYTES",e[e.UINT32=13]="UINT32",e[e.SFIXED32=15]="SFIXED32",e[e.SFIXED64=16]="SFIXED64",e[e.SINT32=17]="SINT32",e[e.SINT64=18]="SINT64"}(NI||(NI={}));var PI,DI;function MI(e){switch(e){case 0:case"STATUS_CODE_UNSPECIFIED":return DI.UNSPECIFIED;case 1:case"STATUS_CODE_CANCELLED":return DI.CANCELLED;case 2:case"STATUS_CODE_UNKNOWN":return DI.UNKNOWN;case 3:case"STATUS_CODE_INVALID_ARGUMENT":return DI.INVALID_ARGUMENT;case 4:case"STATUS_CODE_DEADLINE_EXCEEDED":return DI.DEADLINE_EXCEEDED;case 5:case"STATUS_CODE_NOT_FOUND":return DI.NOT_FOUND;case 6:case"STATUS_CODE_ALREADY_EXISTS":return DI.ALREADY_EXISTS;case 7:case"STATUS_CODE_PERMISSION_DENIED":return DI.PERMISSION_DENIED;case 8:case"STATUS_CODE_RESOURCE_EXHAUSTED":return DI.RESOURCE_EXHAUSTED;case 9:case"STATUS_CODE_FAILED_PRECONDITION":return DI.FAILED_PRECONDITION;case 10:case"STATUS_CODE_ABORTED":return DI.ABORTED;case 11:case"STATUS_CODE_OUT_OF_RANGE":return DI.OUT_OF_RANGE;case 12:case"STATUS_CODE_UNIMPLEMENTED":return DI.UNIMPLEMENTED;case 13:case"STATUS_CODE_INTERNAL":return DI.INTERNAL;case 14:case"STATUS_CODE_UNAVAILABLE":return DI.UNAVAILABLE;case 15:case"STATUS_CODE_DATA_LOSS":return DI.DATA_LOSS;case 16:case"STATUS_CODE_UNAUTHENTICATED":return DI.UNAUTHENTICATED;default:throw new globalThis.Error("Unrecognized enum value "+e+" for enum StatusCode")}}!function(e){e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.START_SESSION_REQUEST=1]="START_SESSION_REQUEST",e[e.START_SESSION_RESPONSE=2]="START_SESSION_RESPONSE",e[e.EVENT_VERSION=3]="EVENT_VERSION",e[e.PARTICIPANT_REQUEST=4]="PARTICIPANT_REQUEST",e[e.PARTICIPANT_RESPONSE=5]="PARTICIPANT_RESPONSE",e[e.CLIENT_ERROR_INFO=6]="CLIENT_ERROR_INFO"}(PI||(PI={})),function(e){e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.CANCELLED=1]="CANCELLED",e[e.UNKNOWN=2]="UNKNOWN",e[e.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",e[e.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",e[e.NOT_FOUND=5]="NOT_FOUND",e[e.ALREADY_EXISTS=6]="ALREADY_EXISTS",e[e.PERMISSION_DENIED=7]="PERMISSION_DENIED",e[e.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",e[e.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",e[e.ABORTED=10]="ABORTED",e[e.OUT_OF_RANGE=11]="OUT_OF_RANGE",e[e.UNIMPLEMENTED=12]="UNIMPLEMENTED",e[e.INTERNAL=13]="INTERNAL",e[e.UNAVAILABLE=14]="UNAVAILABLE",e[e.DATA_LOSS=15]="DATA_LOSS",e[e.UNAUTHENTICATED=16]="UNAUTHENTICATED"}(DI||(DI={}));const UI={$type:"deepl.pb.interactive_text_api.signalr.DetailCode",encode:(e,t=new CI)=>(""!==e.value&&t.uint32(10).string(e.value),t),decode(e,t){const n=e instanceof xI?e:new xI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.signalr.DetailCode",value:""};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.value=n.string();continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:UI.$type,value:FI(e.value)?globalThis.String(e.value):""}),toJSON(e){const t={};return""!==e.value&&(t.value=e.value),t}};const $I={$type:"deepl.pb.interactive_text_api.signalr.ClientErrorInfo",encode(e,t=new CI){0!==e.statusCode&&t.uint32(8).int32(e.statusCode),void 0!==e.detailCode&&UI.encode(e.detailCode,t.uint32(18).fork()).join();for(const n of e.fallbackDetailCodes)UI.encode(n,t.uint32(26).fork()).join();return t},decode(e,t){const n=e instanceof xI?e:new xI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.signalr.ClientErrorInfo",statusCode:0,detailCode:void 0,fallbackDetailCodes:[]};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(8!==e)break;o.statusCode=n.int32();continue;case 2:if(18!==e)break;o.detailCode=UI.decode(n,n.uint32());continue;case 3:if(26!==e)break;o.fallbackDetailCodes.push(UI.decode(n,n.uint32()));continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:$I.$type,statusCode:FI(e.statusCode)?MI(e.statusCode):0,detailCode:FI(e.detailCode)?UI.fromJSON(e.detailCode):void 0,fallbackDetailCodes:globalThis.Array.isArray(null==e?void 0:e.fallbackDetailCodes)?e.fallbackDetailCodes.map((e=>UI.fromJSON(e))):[]}),toJSON(e){var t;const n={};return 0!==e.statusCode&&(n.statusCode=function(e){switch(e){case DI.UNSPECIFIED:return"STATUS_CODE_UNSPECIFIED";case DI.CANCELLED:return"STATUS_CODE_CANCELLED";case DI.UNKNOWN:return"STATUS_CODE_UNKNOWN";case DI.INVALID_ARGUMENT:return"STATUS_CODE_INVALID_ARGUMENT";case DI.DEADLINE_EXCEEDED:return"STATUS_CODE_DEADLINE_EXCEEDED";case DI.NOT_FOUND:return"STATUS_CODE_NOT_FOUND";case DI.ALREADY_EXISTS:return"STATUS_CODE_ALREADY_EXISTS";case DI.PERMISSION_DENIED:return"STATUS_CODE_PERMISSION_DENIED";case DI.RESOURCE_EXHAUSTED:return"STATUS_CODE_RESOURCE_EXHAUSTED";case DI.FAILED_PRECONDITION:return"STATUS_CODE_FAILED_PRECONDITION";case DI.ABORTED:return"STATUS_CODE_ABORTED";case DI.OUT_OF_RANGE:return"STATUS_CODE_OUT_OF_RANGE";case DI.UNIMPLEMENTED:return"STATUS_CODE_UNIMPLEMENTED";case DI.INTERNAL:return"STATUS_CODE_INTERNAL";case DI.UNAVAILABLE:return"STATUS_CODE_UNAVAILABLE";case DI.DATA_LOSS:return"STATUS_CODE_DATA_LOSS";case DI.UNAUTHENTICATED:return"STATUS_CODE_UNAUTHENTICATED";default:throw new globalThis.Error("Unrecognized enum value "+e+" for enum StatusCode")}}(e.statusCode)),void 0!==e.detailCode&&(n.detailCode=UI.toJSON(e.detailCode)),(null===(t=e.fallbackDetailCodes)||void 0===t?void 0:t.length)&&(n.fallbackDetailCodes=e.fallbackDetailCodes.map((e=>UI.toJSON(e)))),n}};function FI(e){return null!=e}const jI={$type:"google.protobuf.Timestamp",encode:(e,t=new CI)=>(0!==e.seconds&&t.uint32(8).int64(e.seconds),0!==e.nanos&&t.uint32(16).int32(e.nanos),t),decode(e,t){const n=e instanceof xI?e:new xI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"google.protobuf.Timestamp",seconds:0,nanos:0};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(8!==e)break;o.seconds=GI(n.int64());continue;case 2:if(16!==e)break;o.nanos=n.int32();continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:jI.$type,seconds:VI(e.seconds)?globalThis.Number(e.seconds):0,nanos:VI(e.nanos)?globalThis.Number(e.nanos):0}),toJSON(e){const t={};return 0!==e.seconds&&(t.seconds=Math.round(e.seconds)),0!==e.nanos&&(t.nanos=Math.round(e.nanos)),t}};function GI(e){const t=globalThis.Number(e.toString());if(t>globalThis.Number.MAX_SAFE_INTEGER)throw new globalThis.Error("Value is larger than Number.MAX_SAFE_INTEGER");if(t<globalThis.Number.MIN_SAFE_INTEGER)throw new globalThis.Error("Value is smaller than Number.MIN_SAFE_INTEGER");return t}function VI(e){return null!=e}const qI={$type:"google.protobuf.Int32Value",encode:(e,t=new CI)=>(0!==e.value&&t.uint32(8).int32(e.value),t),decode(e,t){const n=e instanceof xI?e:new xI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"google.protobuf.Int32Value",value:0};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(8!==e)break;o.value=n.int32();continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON(e){return{$type:qI.$type,value:(t=e.value,null!=t?globalThis.Number(e.value):0)};var t},toJSON(e){const t={};return 0!==e.value&&(t.value=Math.round(e.value)),t}};const WI={$type:"deepl.pb.interactive_text_api.TextRange",encode:(e,t=new CI)=>(0!==e.start&&t.uint32(8).int32(e.start),0!==e.end&&t.uint32(16).int32(e.end),t),decode(e,t){const n=e instanceof xI?e:new xI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.TextRange",start:0,end:0};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(8!==e)break;o.start=n.int32();continue;case 2:if(16!==e)break;o.end=n.int32();continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:WI.$type,start:BI(e.start)?globalThis.Number(e.start):0,end:BI(e.end)?globalThis.Number(e.end):0}),toJSON(e){const t={};return 0!==e.start&&(t.start=Math.round(e.start)),0!==e.end&&(t.end=Math.round(e.end)),t}};function BI(e){return null!=e}var HI,JI;function zI(e){switch(e){case 0:case"CALCULATED_LANGUAGE_ORIGIN_UNSPECIFIED":return HI.UNSPECIFIED;case 1:case"CALCULATED_LANGUAGE_ORIGIN_REQUESTED_LANGUAGE":return HI.REQUESTED_LANGUAGE;case 2:case"CALCULATED_LANGUAGE_ORIGIN_LANGUAGE_DETECTION":return HI.LANGUAGE_DETECTION;default:throw new globalThis.Error("Unrecognized enum value "+e+" for enum CalculatedLanguageOrigin")}}function YI(e){switch(e){case HI.UNSPECIFIED:return"CALCULATED_LANGUAGE_ORIGIN_UNSPECIFIED";case HI.REQUESTED_LANGUAGE:return"CALCULATED_LANGUAGE_ORIGIN_REQUESTED_LANGUAGE";case HI.LANGUAGE_DETECTION:return"CALCULATED_LANGUAGE_ORIGIN_LANGUAGE_DETECTION";default:throw new globalThis.Error("Unrecognized enum value "+e+" for enum CalculatedLanguageOrigin")}}function XI(e){switch(e){case 0:case"TEXT_DIRECTION_UNSPECIFIED":return JI.UNSPECIFIED;case 1:case"TEXT_DIRECTION_LEFT_TO_RIGHT":return JI.LEFT_TO_RIGHT;case 2:case"TEXT_DIRECTION_RIGHT_TO_LEFT":return JI.RIGHT_TO_LEFT;default:throw new globalThis.Error("Unrecognized enum value "+e+" for enum TextDirection")}}!function(e){e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.REQUESTED_LANGUAGE=1]="REQUESTED_LANGUAGE",e[e.LANGUAGE_DETECTION=2]="LANGUAGE_DETECTION"}(HI||(HI={})),function(e){e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.LEFT_TO_RIGHT=1]="LEFT_TO_RIGHT",e[e.RIGHT_TO_LEFT=2]="RIGHT_TO_LEFT"}(JI||(JI={}));const KI={$type:"deepl.pb.interactive_text_api.translator.TextUnitAnnotationPayload",encode:(e,t=new CI)=>(void 0!==e.textUnitId&&PA.encode(e.textUnitId,t.uint32(10).fork()).join(),t),decode(e,t){const n=e instanceof xI?e:new xI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.TextUnitAnnotationPayload",textUnitId:void 0};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.textUnitId=PA.decode(n,n.uint32());continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:KI.$type,textUnitId:GA(e.textUnitId)?PA.fromJSON(e.textUnitId):void 0}),toJSON(e){const t={};return void 0!==e.textUnitId&&(t.textUnitId=PA.toJSON(e.textUnitId)),t}};const QI={$type:"deepl.pb.interactive_text_api.translator.RequestWordAlternativesAnnotationPayload",encode:(e,t=new CI)=>(void 0!==e.flowId&&MA.encode(e.flowId,t.uint32(10).fork()).join(),t),decode(e,t){const n=e instanceof xI?e:new xI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.RequestWordAlternativesAnnotationPayload",flowId:void 0};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.flowId=MA.decode(n,n.uint32());continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:QI.$type,flowId:GA(e.flowId)?MA.fromJSON(e.flowId):void 0}),toJSON(e){const t={};return void 0!==e.flowId&&(t.flowId=MA.toJSON(e.flowId)),t}};const ZI={$type:"deepl.pb.interactive_text_api.translator.ProvidedWordAlternativesAnnotationPayload",encode(e,t=new CI){void 0!==e.flowId&&MA.encode(e.flowId,t.uint32(10).fork()).join();for(const n of e.alternatives)DA.encode(n,t.uint32(18).fork()).join();return t},decode(e,t){const n=e instanceof xI?e:new xI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.ProvidedWordAlternativesAnnotationPayload",flowId:void 0,alternatives:[]};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.flowId=MA.decode(n,n.uint32());continue;case 2:if(18!==e)break;o.alternatives.push(DA.decode(n,n.uint32()));continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:ZI.$type,flowId:GA(e.flowId)?MA.fromJSON(e.flowId):void 0,alternatives:globalThis.Array.isArray(null==e?void 0:e.alternatives)?e.alternatives.map((e=>DA.fromJSON(e))):[]}),toJSON(e){var t;const n={};return void 0!==e.flowId&&(n.flowId=MA.toJSON(e.flowId)),(null===(t=e.alternatives)||void 0===t?void 0:t.length)&&(n.alternatives=e.alternatives.map((e=>DA.toJSON(e)))),n}};const eA={$type:"deepl.pb.interactive_text_api.translator.SelectWordAlternativeAnnotationPayload",encode:(e,t=new CI)=>(void 0!==e.flowId&&MA.encode(e.flowId,t.uint32(10).fork()).join(),""!==e.selection&&t.uint32(18).string(e.selection),t),decode(e,t){const n=e instanceof xI?e:new xI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.SelectWordAlternativeAnnotationPayload",flowId:void 0,selection:""};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.flowId=MA.decode(n,n.uint32());continue;case 2:if(18!==e)break;o.selection=n.string();continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:eA.$type,flowId:GA(e.flowId)?MA.fromJSON(e.flowId):void 0,selection:GA(e.selection)?globalThis.String(e.selection):""}),toJSON(e){const t={};return void 0!==e.flowId&&(t.flowId=MA.toJSON(e.flowId)),""!==e.selection&&(t.selection=e.selection),t}};const tA={$type:"deepl.pb.interactive_text_api.translator.RequestTextUnitAlternativesAnnotationPayload",encode:(e,t=new CI)=>(void 0!==e.flowId&&FA.encode(e.flowId,t.uint32(10).fork()).join(),t),decode(e,t){const n=e instanceof xI?e:new xI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.RequestTextUnitAlternativesAnnotationPayload",flowId:void 0};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.flowId=FA.decode(n,n.uint32());continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:tA.$type,flowId:GA(e.flowId)?FA.fromJSON(e.flowId):void 0}),toJSON(e){const t={};return void 0!==e.flowId&&(t.flowId=FA.toJSON(e.flowId)),t}};const nA={$type:"deepl.pb.interactive_text_api.translator.ProvidedTextUnitAlternativesAnnotationPayload",encode(e,t=new CI){void 0!==e.flowId&&FA.encode(e.flowId,t.uint32(10).fork()).join();for(const n of e.alternatives)UA.encode(n,t.uint32(18).fork()).join();return t},decode(e,t){const n=e instanceof xI?e:new xI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.ProvidedTextUnitAlternativesAnnotationPayload",flowId:void 0,alternatives:[]};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.flowId=FA.decode(n,n.uint32());continue;case 2:if(18!==e)break;o.alternatives.push(UA.decode(n,n.uint32()));continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:nA.$type,flowId:GA(e.flowId)?FA.fromJSON(e.flowId):void 0,alternatives:globalThis.Array.isArray(null==e?void 0:e.alternatives)?e.alternatives.map((e=>UA.fromJSON(e))):[]}),toJSON(e){var t;const n={};return void 0!==e.flowId&&(n.flowId=FA.toJSON(e.flowId)),(null===(t=e.alternatives)||void 0===t?void 0:t.length)&&(n.alternatives=e.alternatives.map((e=>UA.toJSON(e)))),n}};const rA={$type:"deepl.pb.interactive_text_api.translator.SelectTextUnitAlternativeAnnotationPayload",encode:(e,t=new CI)=>(void 0!==e.flowId&&FA.encode(e.flowId,t.uint32(10).fork()).join(),""!==e.selection&&t.uint32(18).string(e.selection),t),decode(e,t){const n=e instanceof xI?e:new xI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.SelectTextUnitAlternativeAnnotationPayload",flowId:void 0,selection:""};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.flowId=FA.decode(n,n.uint32());continue;case 2:if(18!==e)break;o.selection=n.string();continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:rA.$type,flowId:GA(e.flowId)?FA.fromJSON(e.flowId):void 0,selection:GA(e.selection)?globalThis.String(e.selection):""}),toJSON(e){const t={};return void 0!==e.flowId&&(t.flowId=FA.toJSON(e.flowId)),""!==e.selection&&(t.selection=e.selection),t}};const oA={$type:"deepl.pb.interactive_text_api.translator.RequestAutocompletionAnnotationPayload",encode:(e,t=new CI)=>(void 0!==e.flowId&&jA.encode(e.flowId,t.uint32(10).fork()).join(),t),decode(e,t){const n=e instanceof xI?e:new xI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.RequestAutocompletionAnnotationPayload",flowId:void 0};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.flowId=jA.decode(n,n.uint32());continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:oA.$type,flowId:GA(e.flowId)?jA.fromJSON(e.flowId):void 0}),toJSON(e){const t={};return void 0!==e.flowId&&(t.flowId=jA.toJSON(e.flowId)),t}};const sA={$type:"deepl.pb.interactive_text_api.translator.ProvidedAutocompletionAnnotationPayload",encode(e,t=new CI){void 0!==e.flowId&&jA.encode(e.flowId,t.uint32(10).fork()).join();for(const n of e.autocompletions)UA.encode(n,t.uint32(18).fork()).join();return t},decode(e,t){const n=e instanceof xI?e:new xI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.ProvidedAutocompletionAnnotationPayload",flowId:void 0,autocompletions:[]};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.flowId=jA.decode(n,n.uint32());continue;case 2:if(18!==e)break;o.autocompletions.push(UA.decode(n,n.uint32()));continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:sA.$type,flowId:GA(e.flowId)?jA.fromJSON(e.flowId):void 0,autocompletions:globalThis.Array.isArray(null==e?void 0:e.autocompletions)?e.autocompletions.map((e=>UA.fromJSON(e))):[]}),toJSON(e){var t;const n={};return void 0!==e.flowId&&(n.flowId=jA.toJSON(e.flowId)),(null===(t=e.autocompletions)||void 0===t?void 0:t.length)&&(n.autocompletions=e.autocompletions.map((e=>UA.toJSON(e)))),n}};const iA={$type:"deepl.pb.interactive_text_api.translator.SelectAutocompletionAnnotationPayload",encode:(e,t=new CI)=>(void 0!==e.flowId&&jA.encode(e.flowId,t.uint32(10).fork()).join(),""!==e.selection&&t.uint32(18).string(e.selection),t),decode(e,t){const n=e instanceof xI?e:new xI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.SelectAutocompletionAnnotationPayload",flowId:void 0,selection:""};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.flowId=jA.decode(n,n.uint32());continue;case 2:if(18!==e)break;o.selection=n.string();continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:iA.$type,flowId:GA(e.flowId)?jA.fromJSON(e.flowId):void 0,selection:GA(e.selection)?globalThis.String(e.selection):""}),toJSON(e){const t={};return void 0!==e.flowId&&(t.flowId=jA.toJSON(e.flowId)),""!==e.selection&&(t.selection=e.selection),t}};const aA={$type:"deepl.pb.interactive_text_api.translator.ProvidedAutomaticTextUnitAlternativesAnnotationPayload",encode(e,t=new CI){for(const n of e.alternatives)UA.encode(n,t.uint32(10).fork()).join();return t},decode(e,t){const n=e instanceof xI?e:new xI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.ProvidedAutomaticTextUnitAlternativesAnnotationPayload",alternatives:[]};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.alternatives.push(UA.decode(n,n.uint32()));continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:aA.$type,alternatives:globalThis.Array.isArray(null==e?void 0:e.alternatives)?e.alternatives.map((e=>UA.fromJSON(e))):[]}),toJSON(e){var t;const n={};return(null===(t=e.alternatives)||void 0===t?void 0:t.length)&&(n.alternatives=e.alternatives.map((e=>UA.toJSON(e)))),n}};const cA={$type:"deepl.pb.interactive_text_api.translator.SelectAutomaticTextUnitAlternativeAnnotationPayload",encode:(e,t=new CI)=>(""!==e.selection&&t.uint32(10).string(e.selection),t),decode(e,t){const n=e instanceof xI?e:new xI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.SelectAutomaticTextUnitAlternativeAnnotationPayload",selection:""};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.selection=n.string();continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:cA.$type,selection:GA(e.selection)?globalThis.String(e.selection):""}),toJSON(e){const t={};return""!==e.selection&&(t.selection=e.selection),t}};const lA={$type:"deepl.pb.interactive_text_api.translator.GlossaryReplacementAnnotationPayload",encode:(e,t=new CI)=>(void 0!==e.replacement&&xA.encode(e.replacement,t.uint32(10).fork()).join(),t),decode(e,t){const n=e instanceof xI?e:new xI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.GlossaryReplacementAnnotationPayload",replacement:void 0};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.replacement=xA.decode(n,n.uint32());continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:lA.$type,replacement:GA(e.replacement)?xA.fromJSON(e.replacement):void 0}),toJSON(e){const t={};return void 0!==e.replacement&&(t.replacement=xA.toJSON(e.replacement)),t}};const uA={$type:"deepl.pb.interactive_text_api.translator.SourceLanguagesPropertyValue",encode(e,t=new CI){for(const n of e.sourceLanguages)LA.encode(n,t.uint32(10).fork()).join();return t},decode(e,t){const n=e instanceof xI?e:new xI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.SourceLanguagesPropertyValue",sourceLanguages:[]};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.sourceLanguages.push(LA.decode(n,n.uint32()));continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:uA.$type,sourceLanguages:globalThis.Array.isArray(null==e?void 0:e.sourceLanguages)?e.sourceLanguages.map((e=>LA.fromJSON(e))):[]}),toJSON(e){var t;const n={};return(null===(t=e.sourceLanguages)||void 0===t?void 0:t.length)&&(n.sourceLanguages=e.sourceLanguages.map((e=>LA.toJSON(e)))),n}};const dA={$type:"deepl.pb.interactive_text_api.translator.TargetLanguagesPropertyValue",encode(e,t=new CI){for(const n of e.targetLanguages)NA.encode(n,t.uint32(10).fork()).join();return t},decode(e,t){const n=e instanceof xI?e:new xI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.TargetLanguagesPropertyValue",targetLanguages:[]};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.targetLanguages.push(NA.decode(n,n.uint32()));continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:dA.$type,targetLanguages:globalThis.Array.isArray(null==e?void 0:e.targetLanguages)?e.targetLanguages.map((e=>NA.fromJSON(e))):[]}),toJSON(e){var t;const n={};return(null===(t=e.targetLanguages)||void 0===t?void 0:t.length)&&(n.targetLanguages=e.targetLanguages.map((e=>NA.toJSON(e)))),n}};const pA={$type:"deepl.pb.interactive_text_api.translator.RequestedSourceLanguagePropertyValue",encode:(e,t=new CI)=>(void 0!==e.sourceLanguage&&LA.encode(e.sourceLanguage,t.uint32(10).fork()).join(),t),decode(e,t){const n=e instanceof xI?e:new xI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.RequestedSourceLanguagePropertyValue",sourceLanguage:void 0};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.sourceLanguage=LA.decode(n,n.uint32());continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:pA.$type,sourceLanguage:GA(e.sourceLanguage)?LA.fromJSON(e.sourceLanguage):void 0}),toJSON(e){const t={};return void 0!==e.sourceLanguage&&(t.sourceLanguage=LA.toJSON(e.sourceLanguage)),t}};const hA={$type:"deepl.pb.interactive_text_api.translator.CalculatedSourceLanguagePropertyValue",encode:(e,t=new CI)=>(void 0!==e.sourceLanguage&&LA.encode(e.sourceLanguage,t.uint32(10).fork()).join(),0!==e.origin&&t.uint32(16).int32(e.origin),t),decode(e,t){const n=e instanceof xI?e:new xI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.CalculatedSourceLanguagePropertyValue",sourceLanguage:void 0,origin:0};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.sourceLanguage=LA.decode(n,n.uint32());continue;case 2:if(16!==e)break;o.origin=n.int32();continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:hA.$type,sourceLanguage:GA(e.sourceLanguage)?LA.fromJSON(e.sourceLanguage):void 0,origin:GA(e.origin)?zI(e.origin):0}),toJSON(e){const t={};return void 0!==e.sourceLanguage&&(t.sourceLanguage=LA.toJSON(e.sourceLanguage)),0!==e.origin&&(t.origin=YI(e.origin)),t}};const fA={$type:"deepl.pb.interactive_text_api.translator.RequestedTargetLanguagePropertyValue",encode:(e,t=new CI)=>(void 0!==e.targetLanguage&&NA.encode(e.targetLanguage,t.uint32(10).fork()).join(),t),decode(e,t){const n=e instanceof xI?e:new xI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.RequestedTargetLanguagePropertyValue",targetLanguage:void 0};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.targetLanguage=NA.decode(n,n.uint32());continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:fA.$type,targetLanguage:GA(e.targetLanguage)?NA.fromJSON(e.targetLanguage):void 0}),toJSON(e){const t={};return void 0!==e.targetLanguage&&(t.targetLanguage=NA.toJSON(e.targetLanguage)),t}};const gA={$type:"deepl.pb.interactive_text_api.translator.CalculatedTargetLanguagePropertyValue",encode:(e,t=new CI)=>(void 0!==e.targetLanguage&&NA.encode(e.targetLanguage,t.uint32(10).fork()).join(),t),decode(e,t){const n=e instanceof xI?e:new xI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.CalculatedTargetLanguagePropertyValue",targetLanguage:void 0};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.targetLanguage=NA.decode(n,n.uint32());continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:gA.$type,targetLanguage:GA(e.targetLanguage)?NA.fromJSON(e.targetLanguage):void 0}),toJSON(e){const t={};return void 0!==e.targetLanguage&&(t.targetLanguage=NA.toJSON(e.targetLanguage)),t}};const mA={$type:"deepl.pb.interactive_text_api.translator.TaskMetaInfo",encode:(e,t=new CI)=>(0!==e.progressInPercent&&t.uint32(8).int32(e.progressInPercent),t),decode(e,t){const n=e instanceof xI?e:new xI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.TaskMetaInfo",progressInPercent:0};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(8!==e)break;o.progressInPercent=n.int32();continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:mA.$type,progressInPercent:GA(e.progressInPercent)?globalThis.Number(e.progressInPercent):0}),toJSON(e){const t={};return 0!==e.progressInPercent&&(t.progressInPercent=Math.round(e.progressInPercent)),t}};const yA={$type:"deepl.pb.interactive_text_api.translator.FormalityModesPropertyValue",encode(e,t=new CI){for(const n of e.formalityModes)RA.encode(n,t.uint32(10).fork()).join();return t},decode(e,t){const n=e instanceof xI?e:new xI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.FormalityModesPropertyValue",formalityModes:[]};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.formalityModes.push(RA.decode(n,n.uint32()));continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:yA.$type,formalityModes:globalThis.Array.isArray(null==e?void 0:e.formalityModes)?e.formalityModes.map((e=>RA.fromJSON(e))):[]}),toJSON(e){var t;const n={};return(null===(t=e.formalityModes)||void 0===t?void 0:t.length)&&(n.formalityModes=e.formalityModes.map((e=>RA.toJSON(e)))),n}};const _A={$type:"deepl.pb.interactive_text_api.translator.FormalityModePropertyValue",encode:(e,t=new CI)=>(void 0!==e.formalityMode&&RA.encode(e.formalityMode,t.uint32(10).fork()).join(),t),decode(e,t){const n=e instanceof xI?e:new xI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.FormalityModePropertyValue",formalityMode:void 0};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.formalityMode=RA.decode(n,n.uint32());continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:_A.$type,formalityMode:GA(e.formalityMode)?RA.fromJSON(e.formalityMode):void 0}),toJSON(e){const t={};return void 0!==e.formalityMode&&(t.formalityMode=RA.toJSON(e.formalityMode)),t}};const vA={$type:"deepl.pb.interactive_text_api.translator.LanguageModelsPropertyValue",encode(e,t=new CI){for(const n of e.languageModels)kA.encode(n,t.uint32(10).fork()).join();return t},decode(e,t){const n=e instanceof xI?e:new xI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.LanguageModelsPropertyValue",languageModels:[]};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.languageModels.push(kA.decode(n,n.uint32()));continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:vA.$type,languageModels:globalThis.Array.isArray(null==e?void 0:e.languageModels)?e.languageModels.map((e=>kA.fromJSON(e))):[]}),toJSON(e){var t;const n={};return(null===(t=e.languageModels)||void 0===t?void 0:t.length)&&(n.languageModels=e.languageModels.map((e=>kA.toJSON(e)))),n}};const SA={$type:"deepl.pb.interactive_text_api.translator.LanguageModelPropertyValue",encode:(e,t=new CI)=>(void 0!==e.languageModel&&kA.encode(e.languageModel,t.uint32(10).fork()).join(),t),decode(e,t){const n=e instanceof xI?e:new xI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.LanguageModelPropertyValue",languageModel:void 0};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.languageModel=kA.decode(n,n.uint32());continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:SA.$type,languageModel:GA(e.languageModel)?kA.fromJSON(e.languageModel):void 0}),toJSON(e){const t={};return void 0!==e.languageModel&&(t.languageModel=kA.toJSON(e.languageModel)),t}};const TA={$type:"deepl.pb.interactive_text_api.translator.GlossarySupportPropertyValue",encode:(e,t=new CI)=>t,decode(e,t){const n=e instanceof xI?e:new xI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.GlossarySupportPropertyValue"};for(;n.pos<r;){const e=n.uint32();if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:TA.$type}),toJSON:e=>({})};const bA={$type:"deepl.pb.interactive_text_api.translator.GlossaryIdPropertyValue",encode:(e,t=new CI)=>(void 0!==e.glossaryId&&CA.encode(e.glossaryId,t.uint32(10).fork()).join(),t),decode(e,t){const n=e instanceof xI?e:new xI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.GlossaryIdPropertyValue",glossaryId:void 0};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.glossaryId=CA.decode(n,n.uint32());continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:bA.$type,glossaryId:GA(e.glossaryId)?CA.fromJSON(e.glossaryId):void 0}),toJSON(e){const t={};return void 0!==e.glossaryId&&(t.glossaryId=CA.toJSON(e.glossaryId)),t}};const wA={$type:"deepl.pb.interactive_text_api.translator.TextDirectionPropertyValue",encode:(e,t=new CI)=>(0!==e.textDirection&&t.uint32(8).int32(e.textDirection),t),decode(e,t){const n=e instanceof xI?e:new xI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.TextDirectionPropertyValue",textDirection:0};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(8!==e)break;o.textDirection=n.int32();continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:wA.$type,textDirection:GA(e.textDirection)?XI(e.textDirection):0}),toJSON(e){const t={};return 0!==e.textDirection&&(t.textDirection=function(e){switch(e){case JI.UNSPECIFIED:return"TEXT_DIRECTION_UNSPECIFIED";case JI.LEFT_TO_RIGHT:return"TEXT_DIRECTION_LEFT_TO_RIGHT";case JI.RIGHT_TO_LEFT:return"TEXT_DIRECTION_RIGHT_TO_LEFT";default:throw new globalThis.Error("Unrecognized enum value "+e+" for enum TextDirection")}}(e.textDirection)),t}};const EA={$type:"deepl.pb.interactive_text_api.translator.MaximumTextLengthPropertyValue",encode:(e,t=new CI)=>(0!==e.max&&t.uint32(8).int32(e.max),t),decode(e,t){const n=e instanceof xI?e:new xI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.MaximumTextLengthPropertyValue",max:0};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(8!==e)break;o.max=n.int32();continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:EA.$type,max:GA(e.max)?globalThis.Number(e.max):0}),toJSON(e){const t={};return 0!==e.max&&(t.max=Math.round(e.max)),t}};const IA={$type:"deepl.pb.interactive_text_api.translator.UnsupportedLanguagePropertyValue",encode:(e,t=new CI)=>t,decode(e,t){const n=e instanceof xI?e:new xI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.UnsupportedLanguagePropertyValue"};for(;n.pos<r;){const e=n.uint32();if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:IA.$type}),toJSON:e=>({})};const AA={$type:"deepl.pb.interactive_text_api.translator.SessionOptions",encode:(e,t=new CI)=>(!1!==e.enableTranscription&&t.uint32(8).bool(e.enableTranscription),t),decode(e,t){const n=e instanceof xI?e:new xI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.SessionOptions",enableTranscription:!1};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(8!==e)break;o.enableTranscription=n.bool();continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:AA.$type,enableTranscription:!!GA(e.enableTranscription)&&globalThis.Boolean(e.enableTranscription)}),toJSON(e){const t={};return!1!==e.enableTranscription&&(t.enableTranscription=e.enableTranscription),t}};const RA={$type:"deepl.pb.interactive_text_api.translator.FormalityMode",encode:(e,t=new CI)=>(""!==e.value&&t.uint32(10).string(e.value),t),decode(e,t){const n=e instanceof xI?e:new xI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.FormalityMode",value:""};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.value=n.string();continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:RA.$type,value:GA(e.value)?globalThis.String(e.value):""}),toJSON(e){const t={};return""!==e.value&&(t.value=e.value),t}};const kA={$type:"deepl.pb.interactive_text_api.translator.LanguageModel",encode:(e,t=new CI)=>(""!==e.value&&t.uint32(10).string(e.value),t),decode(e,t){const n=e instanceof xI?e:new xI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.LanguageModel",value:""};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.value=n.string();continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:kA.$type,value:GA(e.value)?globalThis.String(e.value):""}),toJSON(e){const t={};return""!==e.value&&(t.value=e.value),t}};const CA={$type:"deepl.pb.interactive_text_api.translator.GlossaryId",encode:(e,t=new CI)=>(""!==e.id&&t.uint32(10).string(e.id),t),decode(e,t){const n=e instanceof xI?e:new xI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.GlossaryId",id:""};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.id=n.string();continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:CA.$type,id:GA(e.id)?globalThis.String(e.id):""}),toJSON(e){const t={};return""!==e.id&&(t.id=e.id),t}};const xA={$type:"deepl.pb.interactive_text_api.translator.GlossaryEntry",encode:(e,t=new CI)=>(""!==e.source&&t.uint32(10).string(e.source),""!==e.target&&t.uint32(18).string(e.target),t),decode(e,t){const n=e instanceof xI?e:new xI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.GlossaryEntry",source:"",target:""};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.source=n.string();continue;case 2:if(18!==e)break;o.target=n.string();continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:xA.$type,source:GA(e.source)?globalThis.String(e.source):"",target:GA(e.target)?globalThis.String(e.target):""}),toJSON(e){const t={};return""!==e.source&&(t.source=e.source),""!==e.target&&(t.target=e.target),t}};const OA={$type:"deepl.pb.interactive_text_api.translator.GlossaryList",encode(e,t=new CI){for(const n of e.glossaryEntries)xA.encode(n,t.uint32(10).fork()).join();return t},decode(e,t){const n=e instanceof xI?e:new xI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.GlossaryList",glossaryEntries:[]};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.glossaryEntries.push(xA.decode(n,n.uint32()));continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:OA.$type,glossaryEntries:globalThis.Array.isArray(null==e?void 0:e.glossaryEntries)?e.glossaryEntries.map((e=>xA.fromJSON(e))):[]}),toJSON(e){var t;const n={};return(null===(t=e.glossaryEntries)||void 0===t?void 0:t.length)&&(n.glossaryEntries=e.glossaryEntries.map((e=>xA.toJSON(e)))),n}};const LA={$type:"deepl.pb.interactive_text_api.translator.SourceLanguage",encode:(e,t=new CI)=>(""!==e.code&&t.uint32(10).string(e.code),t),decode(e,t){const n=e instanceof xI?e:new xI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.SourceLanguage",code:""};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.code=n.string();continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:LA.$type,code:GA(e.code)?globalThis.String(e.code):""}),toJSON(e){const t={};return""!==e.code&&(t.code=e.code),t}};const NA={$type:"deepl.pb.interactive_text_api.translator.TargetLanguage",encode:(e,t=new CI)=>(""!==e.code&&t.uint32(10).string(e.code),t),decode(e,t){const n=e instanceof xI?e:new xI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.TargetLanguage",code:""};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.code=n.string();continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:NA.$type,code:GA(e.code)?globalThis.String(e.code):""}),toJSON(e){const t={};return""!==e.code&&(t.code=e.code),t}};const PA={$type:"deepl.pb.interactive_text_api.translator.TextUnitId",encode:(e,t=new CI)=>(""!==e.value&&t.uint32(10).string(e.value),t),decode(e,t){const n=e instanceof xI?e:new xI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.TextUnitId",value:""};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.value=n.string();continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:PA.$type,value:GA(e.value)?globalThis.String(e.value):""}),toJSON(e){const t={};return""!==e.value&&(t.value=e.value),t}};const DA={$type:"deepl.pb.interactive_text_api.translator.WordAlternative",encode:(e,t=new CI)=>(""!==e.text&&t.uint32(10).string(e.text),t),decode(e,t){const n=e instanceof xI?e:new xI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.WordAlternative",text:""};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.text=n.string();continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:DA.$type,text:GA(e.text)?globalThis.String(e.text):""}),toJSON(e){const t={};return""!==e.text&&(t.text=e.text),t}};const MA={$type:"deepl.pb.interactive_text_api.translator.WordAlternativesFlowId",encode:(e,t=new CI)=>(""!==e.value&&t.uint32(10).string(e.value),t),decode(e,t){const n=e instanceof xI?e:new xI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.WordAlternativesFlowId",value:""};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.value=n.string();continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:MA.$type,value:GA(e.value)?globalThis.String(e.value):""}),toJSON(e){const t={};return""!==e.value&&(t.value=e.value),t}};const UA={$type:"deepl.pb.interactive_text_api.translator.TextUnitAlternative",encode(e,t=new CI){""!==e.text&&t.uint32(10).string(e.text);for(const n of e.glossaryHighlights)$A.encode(n,t.uint32(18).fork()).join();return""!==e.transcription&&t.uint32(26).string(e.transcription),t},decode(e,t){const n=e instanceof xI?e:new xI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.TextUnitAlternative",text:"",glossaryHighlights:[],transcription:""};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.text=n.string();continue;case 2:if(18!==e)break;o.glossaryHighlights.push($A.decode(n,n.uint32()));continue;case 3:if(26!==e)break;o.transcription=n.string();continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:UA.$type,text:GA(e.text)?globalThis.String(e.text):"",glossaryHighlights:globalThis.Array.isArray(null==e?void 0:e.glossaryHighlights)?e.glossaryHighlights.map((e=>$A.fromJSON(e))):[],transcription:GA(e.transcription)?globalThis.String(e.transcription):""}),toJSON(e){var t;const n={};return""!==e.text&&(n.text=e.text),(null===(t=e.glossaryHighlights)||void 0===t?void 0:t.length)&&(n.glossaryHighlights=e.glossaryHighlights.map((e=>$A.toJSON(e)))),""!==e.transcription&&(n.transcription=e.transcription),n}};const $A={$type:"deepl.pb.interactive_text_api.translator.GlossaryHighlight",encode(e,t=new CI){void 0!==e.entry&&xA.encode(e.entry,t.uint32(10).fork()).join();for(const n of e.ranges)WI.encode(n,t.uint32(18).fork()).join();return t},decode(e,t){const n=e instanceof xI?e:new xI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.GlossaryHighlight",entry:void 0,ranges:[]};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.entry=xA.decode(n,n.uint32());continue;case 2:if(18!==e)break;o.ranges.push(WI.decode(n,n.uint32()));continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:$A.$type,entry:GA(e.entry)?xA.fromJSON(e.entry):void 0,ranges:globalThis.Array.isArray(null==e?void 0:e.ranges)?e.ranges.map((e=>WI.fromJSON(e))):[]}),toJSON(e){var t;const n={};return void 0!==e.entry&&(n.entry=xA.toJSON(e.entry)),(null===(t=e.ranges)||void 0===t?void 0:t.length)&&(n.ranges=e.ranges.map((e=>WI.toJSON(e)))),n}};const FA={$type:"deepl.pb.interactive_text_api.translator.TextUnitAlternativesFlowId",encode:(e,t=new CI)=>(""!==e.value&&t.uint32(10).string(e.value),t),decode(e,t){const n=e instanceof xI?e:new xI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.TextUnitAlternativesFlowId",value:""};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.value=n.string();continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:FA.$type,value:GA(e.value)?globalThis.String(e.value):""}),toJSON(e){const t={};return""!==e.value&&(t.value=e.value),t}};const jA={$type:"deepl.pb.interactive_text_api.translator.AutocompletionFlowId",encode:(e,t=new CI)=>(""!==e.value&&t.uint32(10).string(e.value),t),decode(e,t){const n=e instanceof xI?e:new xI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.AutocompletionFlowId",value:""};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.value=n.string();continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:jA.$type,value:GA(e.value)?globalThis.String(e.value):""}),toJSON(e){const t={};return""!==e.value&&(t.value=e.value),t}};function GA(e){return null!=e}const VA={$type:"deepl.pb.interactive_text_api.write.LanguagesPropertyValue",encode(e,t=new CI){for(const n of e.languages)JA.encode(n,t.uint32(10).fork()).join();return t},decode(e,t){const n=e instanceof xI?e:new xI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.write.LanguagesPropertyValue",languages:[]};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.languages.push(JA.decode(n,n.uint32()));continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:VA.$type,languages:globalThis.Array.isArray(null==e?void 0:e.languages)?e.languages.map((e=>JA.fromJSON(e))):[]}),toJSON(e){var t;const n={};return(null===(t=e.languages)||void 0===t?void 0:t.length)&&(n.languages=e.languages.map((e=>JA.toJSON(e)))),n}};const qA={$type:"deepl.pb.interactive_text_api.write.RequestedLanguagePropertyValue",encode:(e,t=new CI)=>(void 0!==e.language&&JA.encode(e.language,t.uint32(10).fork()).join(),t),decode(e,t){const n=e instanceof xI?e:new xI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.write.RequestedLanguagePropertyValue",language:void 0};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.language=JA.decode(n,n.uint32());continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:qA.$type,language:YA(e.language)?JA.fromJSON(e.language):void 0}),toJSON(e){const t={};return void 0!==e.language&&(t.language=JA.toJSON(e.language)),t}};const WA={$type:"deepl.pb.interactive_text_api.write.CalculatedLanguagePropertyValue",encode:(e,t=new CI)=>(void 0!==e.language&&JA.encode(e.language,t.uint32(10).fork()).join(),0!==e.origin&&t.uint32(16).int32(e.origin),t),decode(e,t){const n=e instanceof xI?e:new xI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.write.CalculatedLanguagePropertyValue",language:void 0,origin:0};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.language=JA.decode(n,n.uint32());continue;case 2:if(16!==e)break;o.origin=n.int32();continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:WA.$type,language:YA(e.language)?JA.fromJSON(e.language):void 0,origin:YA(e.origin)?zI(e.origin):0}),toJSON(e){const t={};return void 0!==e.language&&(t.language=JA.toJSON(e.language)),0!==e.origin&&(t.origin=YI(e.origin)),t}};const BA={$type:"deepl.pb.interactive_text_api.write.StyleVariantsPropertyValue",encode(e,t=new CI){for(const n of e.styleVariants)zA.encode(n,t.uint32(10).fork()).join();return t},decode(e,t){const n=e instanceof xI?e:new xI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.write.StyleVariantsPropertyValue",styleVariants:[]};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.styleVariants.push(zA.decode(n,n.uint32()));continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:BA.$type,styleVariants:globalThis.Array.isArray(null==e?void 0:e.styleVariants)?e.styleVariants.map((e=>zA.fromJSON(e))):[]}),toJSON(e){var t;const n={};return(null===(t=e.styleVariants)||void 0===t?void 0:t.length)&&(n.styleVariants=e.styleVariants.map((e=>zA.toJSON(e)))),n}};const HA={$type:"deepl.pb.interactive_text_api.write.StyleVariantPropertyValue",encode:(e,t=new CI)=>(void 0!==e.styleVariant&&zA.encode(e.styleVariant,t.uint32(10).fork()).join(),t),decode(e,t){const n=e instanceof xI?e:new xI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.write.StyleVariantPropertyValue",styleVariant:void 0};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.styleVariant=zA.decode(n,n.uint32());continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:HA.$type,styleVariant:YA(e.styleVariant)?zA.fromJSON(e.styleVariant):void 0}),toJSON(e){const t={};return void 0!==e.styleVariant&&(t.styleVariant=zA.toJSON(e.styleVariant)),t}};const JA={$type:"deepl.pb.interactive_text_api.write.Language",encode:(e,t=new CI)=>(""!==e.code&&t.uint32(10).string(e.code),t),decode(e,t){const n=e instanceof xI?e:new xI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.write.Language",code:""};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.code=n.string();continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:JA.$type,code:YA(e.code)?globalThis.String(e.code):""}),toJSON(e){const t={};return""!==e.code&&(t.code=e.code),t}};const zA={$type:"deepl.pb.interactive_text_api.write.StyleVariant",encode:(e,t=new CI)=>(""!==e.value&&t.uint32(10).string(e.value),t),decode(e,t){const n=e instanceof xI?e:new xI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.write.StyleVariant",value:""};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.value=n.string();continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:zA.$type,value:YA(e.value)?globalThis.String(e.value):""}),toJSON(e){const t={};return""!==e.value&&(t.value=e.value),t}};function YA(e){return null!=e}var XA,KA,QA;function ZA(e){switch(e){case 0:case"FIELD_NAME_UNSPECIFIED":return XA.UNSPECIFIED;case 1:case"FIELD_NAME_TRANSLATOR_SOURCE_TEXT":return XA.TRANSLATOR_SOURCE_TEXT;case 2:case"FIELD_NAME_TRANSLATOR_TARGET_TEXT":return XA.TRANSLATOR_TARGET_TEXT;case 4:case"FIELD_NAME_TRANSLATOR_TARGET_TRANSCRIPTION_TEXT":return XA.TRANSLATOR_TARGET_TRANSCRIPTION_TEXT;case 5:case"FIELD_NAME_WRITE_SOURCE_TEXT":return XA.WRITE_SOURCE_TEXT;case 6:case"FIELD_NAME_WRITE_TARGET_TEXT":return XA.WRITE_TARGET_TEXT;default:throw new globalThis.Error("Unrecognized enum value "+e+" for enum FieldName")}}function eR(e){switch(e){case XA.UNSPECIFIED:return"FIELD_NAME_UNSPECIFIED";case XA.TRANSLATOR_SOURCE_TEXT:return"FIELD_NAME_TRANSLATOR_SOURCE_TEXT";case XA.TRANSLATOR_TARGET_TEXT:return"FIELD_NAME_TRANSLATOR_TARGET_TEXT";case XA.TRANSLATOR_TARGET_TRANSCRIPTION_TEXT:return"FIELD_NAME_TRANSLATOR_TARGET_TRANSCRIPTION_TEXT";case XA.WRITE_SOURCE_TEXT:return"FIELD_NAME_WRITE_SOURCE_TEXT";case XA.WRITE_TARGET_TEXT:return"FIELD_NAME_WRITE_TARGET_TEXT";default:throw new globalThis.Error("Unrecognized enum value "+e+" for enum FieldName")}}function tR(e){switch(e){case 0:case"PROPERTY_NAME_UNSPECIFIED":return KA.UNSPECIFIED;case 1:case"PROPERTY_NAME_TRANSLATOR_SOURCE_LANGUAGES":return KA.TRANSLATOR_SOURCE_LANGUAGES;case 2:case"PROPERTY_NAME_TRANSLATOR_TARGET_LANGUAGES":return KA.TRANSLATOR_TARGET_LANGUAGES;case 3:case"PROPERTY_NAME_TRANSLATOR_REQUESTED_SOURCE_LANGUAGE":return KA.TRANSLATOR_REQUESTED_SOURCE_LANGUAGE;case 4:case"PROPERTY_NAME_TRANSLATOR_CALCULATED_SOURCE_LANGUAGE":return KA.TRANSLATOR_CALCULATED_SOURCE_LANGUAGE;case 5:case"PROPERTY_NAME_TRANSLATOR_REQUESTED_TARGET_LANGUAGE":return KA.TRANSLATOR_REQUESTED_TARGET_LANGUAGE;case 7:case"PROPERTY_NAME_TRANSLATOR_FORMALITY_MODES":return KA.TRANSLATOR_FORMALITY_MODES;case 8:case"PROPERTY_NAME_TRANSLATOR_FORMALITY_MODE":return KA.TRANSLATOR_FORMALITY_MODE;case 9:case"PROPERTY_NAME_TRANSLATOR_GLOSSARY_SUPPORT":return KA.TRANSLATOR_GLOSSARY_SUPPORT;case 10:case"PROPERTY_NAME_TRANSLATOR_GLOSSARY_LIST":return KA.TRANSLATOR_GLOSSARY_LIST;case 12:case"PROPERTY_NAME_TRANSLATOR_TEXT_DIRECTION":return KA.TRANSLATOR_TEXT_DIRECTION;case 13:case"PROPERTY_NAME_TRANSLATOR_GLOSSARY_SUGGESTIONS":return KA.TRANSLATOR_GLOSSARY_SUGGESTIONS;case 14:case"PROPERTY_NAME_MAXIMUM_TEXT_LENGTH":return KA.MAXIMUM_TEXT_LENGTH;case 15:case"PROPERTY_NAME_TRANSLATOR_LANGUAGE_MODELS":return KA.TRANSLATOR_LANGUAGE_MODELS;case 16:case"PROPERTY_NAME_TRANSLATOR_LANGUAGE_MODEL":return KA.TRANSLATOR_LANGUAGE_MODEL;case 17:case"PROPERTY_NAME_TRANSLATOR_GLOSSARY_ID":return KA.TRANSLATOR_GLOSSARY_ID;case 18:case"PROPERTY_NAME_TRANSLATOR_CALCULATED_TARGET_LANGUAGE":return KA.TRANSLATOR_CALCULATED_TARGET_LANGUAGE;case 19:case"PROPERTY_NAME_TRANSLATOR_UNSUPPORTED_LANGUAGE":return KA.TRANSLATOR_UNSUPPORTED_LANGUAGE;case 20:case"PROPERTY_NAME_WRITE_LANGUAGES":return KA.WRITE_LANGUAGES;case 21:case"PROPERTY_NAME_WRITE_REQUESTED_LANGUAGE":return KA.WRITE_REQUESTED_LANGUAGE;case 22:case"PROPERTY_NAME_WRITE_CALCULATED_LANGUAGE":return KA.WRITE_CALCULATED_LANGUAGE;case 23:case"PROPERTY_NAME_WRITE_STYLE_VARIANTS":return KA.WRITE_STYLE_VARIANTS;case 24:case"PROPERTY_NAME_WRITE_STYLE_VARIANT":return KA.WRITE_STYLE_VARIANT;default:throw new globalThis.Error("Unrecognized enum value "+e+" for enum PropertyName")}}function nR(e){switch(e){case 0:case"SESSION_MODE_UNSPECIFIED":return QA.UNSPECIFIED;case 1:case"SESSION_MODE_TRANSLATOR":return QA.TRANSLATOR;case 2:case"SESSION_MODE_WRITE":return QA.WRITE;default:throw new globalThis.Error("Unrecognized enum value "+e+" for enum SessionMode")}}!function(e){e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.TRANSLATOR_SOURCE_TEXT=1]="TRANSLATOR_SOURCE_TEXT",e[e.TRANSLATOR_TARGET_TEXT=2]="TRANSLATOR_TARGET_TEXT",e[e.TRANSLATOR_TARGET_TRANSCRIPTION_TEXT=4]="TRANSLATOR_TARGET_TRANSCRIPTION_TEXT",e[e.WRITE_SOURCE_TEXT=5]="WRITE_SOURCE_TEXT",e[e.WRITE_TARGET_TEXT=6]="WRITE_TARGET_TEXT"}(XA||(XA={})),function(e){e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.TRANSLATOR_SOURCE_LANGUAGES=1]="TRANSLATOR_SOURCE_LANGUAGES",e[e.TRANSLATOR_TARGET_LANGUAGES=2]="TRANSLATOR_TARGET_LANGUAGES",e[e.TRANSLATOR_REQUESTED_SOURCE_LANGUAGE=3]="TRANSLATOR_REQUESTED_SOURCE_LANGUAGE",e[e.TRANSLATOR_CALCULATED_SOURCE_LANGUAGE=4]="TRANSLATOR_CALCULATED_SOURCE_LANGUAGE",e[e.TRANSLATOR_REQUESTED_TARGET_LANGUAGE=5]="TRANSLATOR_REQUESTED_TARGET_LANGUAGE",e[e.TRANSLATOR_FORMALITY_MODES=7]="TRANSLATOR_FORMALITY_MODES",e[e.TRANSLATOR_FORMALITY_MODE=8]="TRANSLATOR_FORMALITY_MODE",e[e.TRANSLATOR_GLOSSARY_SUPPORT=9]="TRANSLATOR_GLOSSARY_SUPPORT",e[e.TRANSLATOR_GLOSSARY_LIST=10]="TRANSLATOR_GLOSSARY_LIST",e[e.TRANSLATOR_TEXT_DIRECTION=12]="TRANSLATOR_TEXT_DIRECTION",e[e.TRANSLATOR_GLOSSARY_SUGGESTIONS=13]="TRANSLATOR_GLOSSARY_SUGGESTIONS",e[e.MAXIMUM_TEXT_LENGTH=14]="MAXIMUM_TEXT_LENGTH",e[e.TRANSLATOR_LANGUAGE_MODELS=15]="TRANSLATOR_LANGUAGE_MODELS",e[e.TRANSLATOR_LANGUAGE_MODEL=16]="TRANSLATOR_LANGUAGE_MODEL",e[e.TRANSLATOR_GLOSSARY_ID=17]="TRANSLATOR_GLOSSARY_ID",e[e.TRANSLATOR_CALCULATED_TARGET_LANGUAGE=18]="TRANSLATOR_CALCULATED_TARGET_LANGUAGE",e[e.TRANSLATOR_UNSUPPORTED_LANGUAGE=19]="TRANSLATOR_UNSUPPORTED_LANGUAGE",e[e.WRITE_LANGUAGES=20]="WRITE_LANGUAGES",e[e.WRITE_REQUESTED_LANGUAGE=21]="WRITE_REQUESTED_LANGUAGE",e[e.WRITE_CALCULATED_LANGUAGE=22]="WRITE_CALCULATED_LANGUAGE",e[e.WRITE_STYLE_VARIANTS=23]="WRITE_STYLE_VARIANTS",e[e.WRITE_STYLE_VARIANT=24]="WRITE_STYLE_VARIANT"}(KA||(KA={})),function(e){e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.TRANSLATOR=1]="TRANSLATOR",e[e.WRITE=2]="WRITE"}(QA||(QA={}));const rR={$type:"deepl.pb.interactive_text_api.TextChangeOperation",encode:(e,t=new CI)=>(void 0!==e.range&&WI.encode(e.range,t.uint32(10).fork()).join(),""!==e.text&&t.uint32(18).string(e.text),t),decode(e,t){const n=e instanceof xI?e:new xI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.TextChangeOperation",range:void 0,text:""};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.range=WI.decode(n,n.uint32());continue;case 2:if(18!==e)break;o.text=n.string();continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:rR.$type,range:RR(e.range)?WI.fromJSON(e.range):void 0,text:RR(e.text)?globalThis.String(e.text):""}),toJSON(e){const t={};return void 0!==e.range&&(t.range=WI.toJSON(e.range)),""!==e.text&&(t.text=e.text),t}};const oR={$type:"deepl.pb.interactive_text_api.CreateAnnotationOperation",encode:(e,t=new CI)=>(void 0!==e.annotationId&&bR.encode(e.annotationId,t.uint32(10).fork()).join(),void 0!==e.range&&WI.encode(e.range,t.uint32(18).fork()).join(),void 0!==e.translatorTextUnitPayload&&KI.encode(e.translatorTextUnitPayload,t.uint32(26).fork()).join(),void 0!==e.translatorRequestWordAlternativesPayload&&QI.encode(e.translatorRequestWordAlternativesPayload,t.uint32(34).fork()).join(),void 0!==e.translatorProvidedWordAlternativesPayload&&ZI.encode(e.translatorProvidedWordAlternativesPayload,t.uint32(42).fork()).join(),void 0!==e.translatorSelectWordAlternativePayload&&eA.encode(e.translatorSelectWordAlternativePayload,t.uint32(50).fork()).join(),void 0!==e.translatorGlossaryReplacementPayload&&lA.encode(e.translatorGlossaryReplacementPayload,t.uint32(58).fork()).join(),void 0!==e.translatorRequestTextUnitAlternativesPayload&&tA.encode(e.translatorRequestTextUnitAlternativesPayload,t.uint32(66).fork()).join(),void 0!==e.translatorProvidedTextUnitAlternativesPayload&&nA.encode(e.translatorProvidedTextUnitAlternativesPayload,t.uint32(74).fork()).join(),void 0!==e.translatorSelectTextUnitAlternativePayload&&rA.encode(e.translatorSelectTextUnitAlternativePayload,t.uint32(82).fork()).join(),void 0!==e.translatorRequestAutocompletionPayload&&oA.encode(e.translatorRequestAutocompletionPayload,t.uint32(90).fork()).join(),void 0!==e.translatorProvidedAutocompletionPayload&&sA.encode(e.translatorProvidedAutocompletionPayload,t.uint32(98).fork()).join(),void 0!==e.translatorSelectAutocompletionPayload&&iA.encode(e.translatorSelectAutocompletionPayload,t.uint32(106).fork()).join(),void 0!==e.translatorProvidedAutomaticTextUnitAlternativesPayload&&aA.encode(e.translatorProvidedAutomaticTextUnitAlternativesPayload,t.uint32(114).fork()).join(),void 0!==e.translatorSelectAutomaticTextUnitAlternativePayload&&cA.encode(e.translatorSelectAutomaticTextUnitAlternativePayload,t.uint32(122).fork()).join(),t),decode(e,t){const n=e instanceof xI?e:new xI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.CreateAnnotationOperation",annotationId:void 0,range:void 0,translatorTextUnitPayload:void 0,translatorRequestWordAlternativesPayload:void 0,translatorProvidedWordAlternativesPayload:void 0,translatorSelectWordAlternativePayload:void 0,translatorGlossaryReplacementPayload:void 0,translatorRequestTextUnitAlternativesPayload:void 0,translatorProvidedTextUnitAlternativesPayload:void 0,translatorSelectTextUnitAlternativePayload:void 0,translatorRequestAutocompletionPayload:void 0,translatorProvidedAutocompletionPayload:void 0,translatorSelectAutocompletionPayload:void 0,translatorProvidedAutomaticTextUnitAlternativesPayload:void 0,translatorSelectAutomaticTextUnitAlternativePayload:void 0};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.annotationId=bR.decode(n,n.uint32());continue;case 2:if(18!==e)break;o.range=WI.decode(n,n.uint32());continue;case 3:if(26!==e)break;o.translatorTextUnitPayload=KI.decode(n,n.uint32());continue;case 4:if(34!==e)break;o.translatorRequestWordAlternativesPayload=QI.decode(n,n.uint32());continue;case 5:if(42!==e)break;o.translatorProvidedWordAlternativesPayload=ZI.decode(n,n.uint32());continue;case 6:if(50!==e)break;o.translatorSelectWordAlternativePayload=eA.decode(n,n.uint32());continue;case 7:if(58!==e)break;o.translatorGlossaryReplacementPayload=lA.decode(n,n.uint32());continue;case 8:if(66!==e)break;o.translatorRequestTextUnitAlternativesPayload=tA.decode(n,n.uint32());continue;case 9:if(74!==e)break;o.translatorProvidedTextUnitAlternativesPayload=nA.decode(n,n.uint32());continue;case 10:if(82!==e)break;o.translatorSelectTextUnitAlternativePayload=rA.decode(n,n.uint32());continue;case 11:if(90!==e)break;o.translatorRequestAutocompletionPayload=oA.decode(n,n.uint32());continue;case 12:if(98!==e)break;o.translatorProvidedAutocompletionPayload=sA.decode(n,n.uint32());continue;case 13:if(106!==e)break;o.translatorSelectAutocompletionPayload=iA.decode(n,n.uint32());continue;case 14:if(114!==e)break;o.translatorProvidedAutomaticTextUnitAlternativesPayload=aA.decode(n,n.uint32());continue;case 15:if(122!==e)break;o.translatorSelectAutomaticTextUnitAlternativePayload=cA.decode(n,n.uint32());continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:oR.$type,annotationId:RR(e.annotationId)?bR.fromJSON(e.annotationId):void 0,range:RR(e.range)?WI.fromJSON(e.range):void 0,translatorTextUnitPayload:RR(e.translatorTextUnitPayload)?KI.fromJSON(e.translatorTextUnitPayload):void 0,translatorRequestWordAlternativesPayload:RR(e.translatorRequestWordAlternativesPayload)?QI.fromJSON(e.translatorRequestWordAlternativesPayload):void 0,translatorProvidedWordAlternativesPayload:RR(e.translatorProvidedWordAlternativesPayload)?ZI.fromJSON(e.translatorProvidedWordAlternativesPayload):void 0,translatorSelectWordAlternativePayload:RR(e.translatorSelectWordAlternativePayload)?eA.fromJSON(e.translatorSelectWordAlternativePayload):void 0,translatorGlossaryReplacementPayload:RR(e.translatorGlossaryReplacementPayload)?lA.fromJSON(e.translatorGlossaryReplacementPayload):void 0,translatorRequestTextUnitAlternativesPayload:RR(e.translatorRequestTextUnitAlternativesPayload)?tA.fromJSON(e.translatorRequestTextUnitAlternativesPayload):void 0,translatorProvidedTextUnitAlternativesPayload:RR(e.translatorProvidedTextUnitAlternativesPayload)?nA.fromJSON(e.translatorProvidedTextUnitAlternativesPayload):void 0,translatorSelectTextUnitAlternativePayload:RR(e.translatorSelectTextUnitAlternativePayload)?rA.fromJSON(e.translatorSelectTextUnitAlternativePayload):void 0,translatorRequestAutocompletionPayload:RR(e.translatorRequestAutocompletionPayload)?oA.fromJSON(e.translatorRequestAutocompletionPayload):void 0,translatorProvidedAutocompletionPayload:RR(e.translatorProvidedAutocompletionPayload)?sA.fromJSON(e.translatorProvidedAutocompletionPayload):void 0,translatorSelectAutocompletionPayload:RR(e.translatorSelectAutocompletionPayload)?iA.fromJSON(e.translatorSelectAutocompletionPayload):void 0,translatorProvidedAutomaticTextUnitAlternativesPayload:RR(e.translatorProvidedAutomaticTextUnitAlternativesPayload)?aA.fromJSON(e.translatorProvidedAutomaticTextUnitAlternativesPayload):void 0,translatorSelectAutomaticTextUnitAlternativePayload:RR(e.translatorSelectAutomaticTextUnitAlternativePayload)?cA.fromJSON(e.translatorSelectAutomaticTextUnitAlternativePayload):void 0}),toJSON(e){const t={};return void 0!==e.annotationId&&(t.annotationId=bR.toJSON(e.annotationId)),void 0!==e.range&&(t.range=WI.toJSON(e.range)),void 0!==e.translatorTextUnitPayload&&(t.translatorTextUnitPayload=KI.toJSON(e.translatorTextUnitPayload)),void 0!==e.translatorRequestWordAlternativesPayload&&(t.translatorRequestWordAlternativesPayload=QI.toJSON(e.translatorRequestWordAlternativesPayload)),void 0!==e.translatorProvidedWordAlternativesPayload&&(t.translatorProvidedWordAlternativesPayload=ZI.toJSON(e.translatorProvidedWordAlternativesPayload)),void 0!==e.translatorSelectWordAlternativePayload&&(t.translatorSelectWordAlternativePayload=eA.toJSON(e.translatorSelectWordAlternativePayload)),void 0!==e.translatorGlossaryReplacementPayload&&(t.translatorGlossaryReplacementPayload=lA.toJSON(e.translatorGlossaryReplacementPayload)),void 0!==e.translatorRequestTextUnitAlternativesPayload&&(t.translatorRequestTextUnitAlternativesPayload=tA.toJSON(e.translatorRequestTextUnitAlternativesPayload)),void 0!==e.translatorProvidedTextUnitAlternativesPayload&&(t.translatorProvidedTextUnitAlternativesPayload=nA.toJSON(e.translatorProvidedTextUnitAlternativesPayload)),void 0!==e.translatorSelectTextUnitAlternativePayload&&(t.translatorSelectTextUnitAlternativePayload=rA.toJSON(e.translatorSelectTextUnitAlternativePayload)),void 0!==e.translatorRequestAutocompletionPayload&&(t.translatorRequestAutocompletionPayload=oA.toJSON(e.translatorRequestAutocompletionPayload)),void 0!==e.translatorProvidedAutocompletionPayload&&(t.translatorProvidedAutocompletionPayload=sA.toJSON(e.translatorProvidedAutocompletionPayload)),void 0!==e.translatorSelectAutocompletionPayload&&(t.translatorSelectAutocompletionPayload=iA.toJSON(e.translatorSelectAutocompletionPayload)),void 0!==e.translatorProvidedAutomaticTextUnitAlternativesPayload&&(t.translatorProvidedAutomaticTextUnitAlternativesPayload=aA.toJSON(e.translatorProvidedAutomaticTextUnitAlternativesPayload)),void 0!==e.translatorSelectAutomaticTextUnitAlternativePayload&&(t.translatorSelectAutomaticTextUnitAlternativePayload=cA.toJSON(e.translatorSelectAutomaticTextUnitAlternativePayload)),t}};const sR={$type:"deepl.pb.interactive_text_api.RemoveAnnotationOperation",encode:(e,t=new CI)=>(void 0!==e.annotationId&&bR.encode(e.annotationId,t.uint32(10).fork()).join(),t),decode(e,t){const n=e instanceof xI?e:new xI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.RemoveAnnotationOperation",annotationId:void 0};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.annotationId=bR.decode(n,n.uint32());continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:sR.$type,annotationId:RR(e.annotationId)?bR.fromJSON(e.annotationId):void 0}),toJSON(e){const t={};return void 0!==e.annotationId&&(t.annotationId=bR.toJSON(e.annotationId)),t}};const iR={$type:"deepl.pb.interactive_text_api.SetPropertyOperation",encode:(e,t=new CI)=>(0!==e.propertyName&&t.uint32(8).int32(e.propertyName),void 0!==e.translatorSourceLanguagesValue&&uA.encode(e.translatorSourceLanguagesValue,t.uint32(18).fork()).join(),void 0!==e.translatorTargetLanguagesValue&&dA.encode(e.translatorTargetLanguagesValue,t.uint32(26).fork()).join(),void 0!==e.translatorRequestedSourceLanguageValue&&pA.encode(e.translatorRequestedSourceLanguageValue,t.uint32(34).fork()).join(),void 0!==e.translatorRequestedTargetLanguageValue&&fA.encode(e.translatorRequestedTargetLanguageValue,t.uint32(42).fork()).join(),void 0!==e.translatorFormalityModesValue&&yA.encode(e.translatorFormalityModesValue,t.uint32(58).fork()).join(),void 0!==e.translatorFormalityModeValue&&_A.encode(e.translatorFormalityModeValue,t.uint32(66).fork()).join(),void 0!==e.translatorGlossarySupportValue&&TA.encode(e.translatorGlossarySupportValue,t.uint32(74).fork()).join(),void 0!==e.translatorGlossaryListValue&&OA.encode(e.translatorGlossaryListValue,t.uint32(82).fork()).join(),void 0!==e.textDirectionValue&&wA.encode(e.textDirectionValue,t.uint32(98).fork()).join(),void 0!==e.translatorCalculatedSourceLanguageValue&&hA.encode(e.translatorCalculatedSourceLanguageValue,t.uint32(106).fork()).join(),void 0!==e.maximumTextLengthValue&&EA.encode(e.maximumTextLengthValue,t.uint32(114).fork()).join(),void 0!==e.translatorLanguageModelsValue&&vA.encode(e.translatorLanguageModelsValue,t.uint32(122).fork()).join(),void 0!==e.translatorLanguageModelValue&&SA.encode(e.translatorLanguageModelValue,t.uint32(130).fork()).join(),void 0!==e.translatorGlossaryIdValue&&bA.encode(e.translatorGlossaryIdValue,t.uint32(138).fork()).join(),void 0!==e.translatorCalculatedTargetLanguageValue&&gA.encode(e.translatorCalculatedTargetLanguageValue,t.uint32(146).fork()).join(),void 0!==e.translatorUnsupportedSourceLanguageValue&&IA.encode(e.translatorUnsupportedSourceLanguageValue,t.uint32(154).fork()).join(),void 0!==e.writeLanguagesValue&&VA.encode(e.writeLanguagesValue,t.uint32(162).fork()).join(),void 0!==e.writeRequestedLanguageValue&&qA.encode(e.writeRequestedLanguageValue,t.uint32(170).fork()).join(),void 0!==e.writeCalculatedLanguageValue&&WA.encode(e.writeCalculatedLanguageValue,t.uint32(178).fork()).join(),void 0!==e.writeStyleVariantsValue&&BA.encode(e.writeStyleVariantsValue,t.uint32(186).fork()).join(),void 0!==e.writeStyleVariantValue&&HA.encode(e.writeStyleVariantValue,t.uint32(194).fork()).join(),t),decode(e,t){const n=e instanceof xI?e:new xI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.SetPropertyOperation",propertyName:0,translatorSourceLanguagesValue:void 0,translatorTargetLanguagesValue:void 0,translatorRequestedSourceLanguageValue:void 0,translatorRequestedTargetLanguageValue:void 0,translatorFormalityModesValue:void 0,translatorFormalityModeValue:void 0,translatorGlossarySupportValue:void 0,translatorGlossaryListValue:void 0,textDirectionValue:void 0,translatorCalculatedSourceLanguageValue:void 0,maximumTextLengthValue:void 0,translatorLanguageModelsValue:void 0,translatorLanguageModelValue:void 0,translatorGlossaryIdValue:void 0,translatorCalculatedTargetLanguageValue:void 0,translatorUnsupportedSourceLanguageValue:void 0,writeLanguagesValue:void 0,writeRequestedLanguageValue:void 0,writeCalculatedLanguageValue:void 0,writeStyleVariantsValue:void 0,writeStyleVariantValue:void 0};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(8!==e)break;o.propertyName=n.int32();continue;case 2:if(18!==e)break;o.translatorSourceLanguagesValue=uA.decode(n,n.uint32());continue;case 3:if(26!==e)break;o.translatorTargetLanguagesValue=dA.decode(n,n.uint32());continue;case 4:if(34!==e)break;o.translatorRequestedSourceLanguageValue=pA.decode(n,n.uint32());continue;case 5:if(42!==e)break;o.translatorRequestedTargetLanguageValue=fA.decode(n,n.uint32());continue;case 7:if(58!==e)break;o.translatorFormalityModesValue=yA.decode(n,n.uint32());continue;case 8:if(66!==e)break;o.translatorFormalityModeValue=_A.decode(n,n.uint32());continue;case 9:if(74!==e)break;o.translatorGlossarySupportValue=TA.decode(n,n.uint32());continue;case 10:if(82!==e)break;o.translatorGlossaryListValue=OA.decode(n,n.uint32());continue;case 12:if(98!==e)break;o.textDirectionValue=wA.decode(n,n.uint32());continue;case 13:if(106!==e)break;o.translatorCalculatedSourceLanguageValue=hA.decode(n,n.uint32());continue;case 14:if(114!==e)break;o.maximumTextLengthValue=EA.decode(n,n.uint32());continue;case 15:if(122!==e)break;o.translatorLanguageModelsValue=vA.decode(n,n.uint32());continue;case 16:if(130!==e)break;o.translatorLanguageModelValue=SA.decode(n,n.uint32());continue;case 17:if(138!==e)break;o.translatorGlossaryIdValue=bA.decode(n,n.uint32());continue;case 18:if(146!==e)break;o.translatorCalculatedTargetLanguageValue=gA.decode(n,n.uint32());continue;case 19:if(154!==e)break;o.translatorUnsupportedSourceLanguageValue=IA.decode(n,n.uint32());continue;case 20:if(162!==e)break;o.writeLanguagesValue=VA.decode(n,n.uint32());continue;case 21:if(170!==e)break;o.writeRequestedLanguageValue=qA.decode(n,n.uint32());continue;case 22:if(178!==e)break;o.writeCalculatedLanguageValue=WA.decode(n,n.uint32());continue;case 23:if(186!==e)break;o.writeStyleVariantsValue=BA.decode(n,n.uint32());continue;case 24:if(194!==e)break;o.writeStyleVariantValue=HA.decode(n,n.uint32());continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:iR.$type,propertyName:RR(e.propertyName)?tR(e.propertyName):0,translatorSourceLanguagesValue:RR(e.translatorSourceLanguagesValue)?uA.fromJSON(e.translatorSourceLanguagesValue):void 0,translatorTargetLanguagesValue:RR(e.translatorTargetLanguagesValue)?dA.fromJSON(e.translatorTargetLanguagesValue):void 0,translatorRequestedSourceLanguageValue:RR(e.translatorRequestedSourceLanguageValue)?pA.fromJSON(e.translatorRequestedSourceLanguageValue):void 0,translatorRequestedTargetLanguageValue:RR(e.translatorRequestedTargetLanguageValue)?fA.fromJSON(e.translatorRequestedTargetLanguageValue):void 0,translatorFormalityModesValue:RR(e.translatorFormalityModesValue)?yA.fromJSON(e.translatorFormalityModesValue):void 0,translatorFormalityModeValue:RR(e.translatorFormalityModeValue)?_A.fromJSON(e.translatorFormalityModeValue):void 0,translatorGlossarySupportValue:RR(e.translatorGlossarySupportValue)?TA.fromJSON(e.translatorGlossarySupportValue):void 0,translatorGlossaryListValue:RR(e.translatorGlossaryListValue)?OA.fromJSON(e.translatorGlossaryListValue):void 0,textDirectionValue:RR(e.textDirectionValue)?wA.fromJSON(e.textDirectionValue):void 0,translatorCalculatedSourceLanguageValue:RR(e.translatorCalculatedSourceLanguageValue)?hA.fromJSON(e.translatorCalculatedSourceLanguageValue):void 0,maximumTextLengthValue:RR(e.maximumTextLengthValue)?EA.fromJSON(e.maximumTextLengthValue):void 0,translatorLanguageModelsValue:RR(e.translatorLanguageModelsValue)?vA.fromJSON(e.translatorLanguageModelsValue):void 0,translatorLanguageModelValue:RR(e.translatorLanguageModelValue)?SA.fromJSON(e.translatorLanguageModelValue):void 0,translatorGlossaryIdValue:RR(e.translatorGlossaryIdValue)?bA.fromJSON(e.translatorGlossaryIdValue):void 0,translatorCalculatedTargetLanguageValue:RR(e.translatorCalculatedTargetLanguageValue)?gA.fromJSON(e.translatorCalculatedTargetLanguageValue):void 0,translatorUnsupportedSourceLanguageValue:RR(e.translatorUnsupportedSourceLanguageValue)?IA.fromJSON(e.translatorUnsupportedSourceLanguageValue):void 0,writeLanguagesValue:RR(e.writeLanguagesValue)?VA.fromJSON(e.writeLanguagesValue):void 0,writeRequestedLanguageValue:RR(e.writeRequestedLanguageValue)?qA.fromJSON(e.writeRequestedLanguageValue):void 0,writeCalculatedLanguageValue:RR(e.writeCalculatedLanguageValue)?WA.fromJSON(e.writeCalculatedLanguageValue):void 0,writeStyleVariantsValue:RR(e.writeStyleVariantsValue)?BA.fromJSON(e.writeStyleVariantsValue):void 0,writeStyleVariantValue:RR(e.writeStyleVariantValue)?HA.fromJSON(e.writeStyleVariantValue):void 0}),toJSON(e){const t={};return 0!==e.propertyName&&(t.propertyName=function(e){switch(e){case KA.UNSPECIFIED:return"PROPERTY_NAME_UNSPECIFIED";case KA.TRANSLATOR_SOURCE_LANGUAGES:return"PROPERTY_NAME_TRANSLATOR_SOURCE_LANGUAGES";case KA.TRANSLATOR_TARGET_LANGUAGES:return"PROPERTY_NAME_TRANSLATOR_TARGET_LANGUAGES";case KA.TRANSLATOR_REQUESTED_SOURCE_LANGUAGE:return"PROPERTY_NAME_TRANSLATOR_REQUESTED_SOURCE_LANGUAGE";case KA.TRANSLATOR_CALCULATED_SOURCE_LANGUAGE:return"PROPERTY_NAME_TRANSLATOR_CALCULATED_SOURCE_LANGUAGE";case KA.TRANSLATOR_REQUESTED_TARGET_LANGUAGE:return"PROPERTY_NAME_TRANSLATOR_REQUESTED_TARGET_LANGUAGE";case KA.TRANSLATOR_FORMALITY_MODES:return"PROPERTY_NAME_TRANSLATOR_FORMALITY_MODES";case KA.TRANSLATOR_FORMALITY_MODE:return"PROPERTY_NAME_TRANSLATOR_FORMALITY_MODE";case KA.TRANSLATOR_GLOSSARY_SUPPORT:return"PROPERTY_NAME_TRANSLATOR_GLOSSARY_SUPPORT";case KA.TRANSLATOR_GLOSSARY_LIST:return"PROPERTY_NAME_TRANSLATOR_GLOSSARY_LIST";case KA.TRANSLATOR_TEXT_DIRECTION:return"PROPERTY_NAME_TRANSLATOR_TEXT_DIRECTION";case KA.TRANSLATOR_GLOSSARY_SUGGESTIONS:return"PROPERTY_NAME_TRANSLATOR_GLOSSARY_SUGGESTIONS";case KA.MAXIMUM_TEXT_LENGTH:return"PROPERTY_NAME_MAXIMUM_TEXT_LENGTH";case KA.TRANSLATOR_LANGUAGE_MODELS:return"PROPERTY_NAME_TRANSLATOR_LANGUAGE_MODELS";case KA.TRANSLATOR_LANGUAGE_MODEL:return"PROPERTY_NAME_TRANSLATOR_LANGUAGE_MODEL";case KA.TRANSLATOR_GLOSSARY_ID:return"PROPERTY_NAME_TRANSLATOR_GLOSSARY_ID";case KA.TRANSLATOR_CALCULATED_TARGET_LANGUAGE:return"PROPERTY_NAME_TRANSLATOR_CALCULATED_TARGET_LANGUAGE";case KA.TRANSLATOR_UNSUPPORTED_LANGUAGE:return"PROPERTY_NAME_TRANSLATOR_UNSUPPORTED_LANGUAGE";case KA.WRITE_LANGUAGES:return"PROPERTY_NAME_WRITE_LANGUAGES";case KA.WRITE_REQUESTED_LANGUAGE:return"PROPERTY_NAME_WRITE_REQUESTED_LANGUAGE";case KA.WRITE_CALCULATED_LANGUAGE:return"PROPERTY_NAME_WRITE_CALCULATED_LANGUAGE";case KA.WRITE_STYLE_VARIANTS:return"PROPERTY_NAME_WRITE_STYLE_VARIANTS";case KA.WRITE_STYLE_VARIANT:return"PROPERTY_NAME_WRITE_STYLE_VARIANT";default:throw new globalThis.Error("Unrecognized enum value "+e+" for enum PropertyName")}}(e.propertyName)),void 0!==e.translatorSourceLanguagesValue&&(t.translatorSourceLanguagesValue=uA.toJSON(e.translatorSourceLanguagesValue)),void 0!==e.translatorTargetLanguagesValue&&(t.translatorTargetLanguagesValue=dA.toJSON(e.translatorTargetLanguagesValue)),void 0!==e.translatorRequestedSourceLanguageValue&&(t.translatorRequestedSourceLanguageValue=pA.toJSON(e.translatorRequestedSourceLanguageValue)),void 0!==e.translatorRequestedTargetLanguageValue&&(t.translatorRequestedTargetLanguageValue=fA.toJSON(e.translatorRequestedTargetLanguageValue)),void 0!==e.translatorFormalityModesValue&&(t.translatorFormalityModesValue=yA.toJSON(e.translatorFormalityModesValue)),void 0!==e.translatorFormalityModeValue&&(t.translatorFormalityModeValue=_A.toJSON(e.translatorFormalityModeValue)),void 0!==e.translatorGlossarySupportValue&&(t.translatorGlossarySupportValue=TA.toJSON(e.translatorGlossarySupportValue)),void 0!==e.translatorGlossaryListValue&&(t.translatorGlossaryListValue=OA.toJSON(e.translatorGlossaryListValue)),void 0!==e.textDirectionValue&&(t.textDirectionValue=wA.toJSON(e.textDirectionValue)),void 0!==e.translatorCalculatedSourceLanguageValue&&(t.translatorCalculatedSourceLanguageValue=hA.toJSON(e.translatorCalculatedSourceLanguageValue)),void 0!==e.maximumTextLengthValue&&(t.maximumTextLengthValue=EA.toJSON(e.maximumTextLengthValue)),void 0!==e.translatorLanguageModelsValue&&(t.translatorLanguageModelsValue=vA.toJSON(e.translatorLanguageModelsValue)),void 0!==e.translatorLanguageModelValue&&(t.translatorLanguageModelValue=SA.toJSON(e.translatorLanguageModelValue)),void 0!==e.translatorGlossaryIdValue&&(t.translatorGlossaryIdValue=bA.toJSON(e.translatorGlossaryIdValue)),void 0!==e.translatorCalculatedTargetLanguageValue&&(t.translatorCalculatedTargetLanguageValue=gA.toJSON(e.translatorCalculatedTargetLanguageValue)),void 0!==e.translatorUnsupportedSourceLanguageValue&&(t.translatorUnsupportedSourceLanguageValue=IA.toJSON(e.translatorUnsupportedSourceLanguageValue)),void 0!==e.writeLanguagesValue&&(t.writeLanguagesValue=VA.toJSON(e.writeLanguagesValue)),void 0!==e.writeRequestedLanguageValue&&(t.writeRequestedLanguageValue=qA.toJSON(e.writeRequestedLanguageValue)),void 0!==e.writeCalculatedLanguageValue&&(t.writeCalculatedLanguageValue=WA.toJSON(e.writeCalculatedLanguageValue)),void 0!==e.writeStyleVariantsValue&&(t.writeStyleVariantsValue=BA.toJSON(e.writeStyleVariantsValue)),void 0!==e.writeStyleVariantValue&&(t.writeStyleVariantValue=HA.toJSON(e.writeStyleVariantValue)),t}};const aR={$type:"deepl.pb.interactive_text_api.StartSessionRequest",encode:(e,t=new CI)=>(0!==e.sessionMode&&t.uint32(8).int32(e.sessionMode),void 0!==e.baseDocument&&wR.encode(e.baseDocument,t.uint32(18).fork()).join(),void 0!==e.translatorSessionOptions&&AA.encode(e.translatorSessionOptions,t.uint32(26).fork()).join(),t),decode(e,t){const n=e instanceof xI?e:new xI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.StartSessionRequest",sessionMode:0,baseDocument:void 0,translatorSessionOptions:void 0};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(8!==e)break;o.sessionMode=n.int32();continue;case 2:if(18!==e)break;o.baseDocument=wR.decode(n,n.uint32());continue;case 3:if(26!==e)break;o.translatorSessionOptions=AA.decode(n,n.uint32());continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:aR.$type,sessionMode:RR(e.sessionMode)?nR(e.sessionMode):0,baseDocument:RR(e.baseDocument)?wR.fromJSON(e.baseDocument):void 0,translatorSessionOptions:RR(e.translatorSessionOptions)?AA.fromJSON(e.translatorSessionOptions):void 0}),toJSON(e){const t={};return 0!==e.sessionMode&&(t.sessionMode=function(e){switch(e){case QA.UNSPECIFIED:return"SESSION_MODE_UNSPECIFIED";case QA.TRANSLATOR:return"SESSION_MODE_TRANSLATOR";case QA.WRITE:return"SESSION_MODE_WRITE";default:throw new globalThis.Error("Unrecognized enum value "+e+" for enum SessionMode")}}(e.sessionMode)),void 0!==e.baseDocument&&(t.baseDocument=wR.toJSON(e.baseDocument)),void 0!==e.translatorSessionOptions&&(t.translatorSessionOptions=AA.toJSON(e.translatorSessionOptions)),t}};const cR={$type:"deepl.pb.interactive_text_api.StartSessionResponse",encode:(e,t=new CI)=>(void 0!==e.sessionId&&_R.encode(e.sessionId,t.uint32(10).fork()).join(),void 0!==e.participantId&&TR.encode(e.participantId,t.uint32(18).fork()).join(),""!==e.sessionToken&&t.uint32(26).string(e.sessionToken),void 0!==e.versionRemovedAt&&jI.encode(function(e){const t=Math.trunc(e.getTime()/1e3),n=e.getTime()%1e3*1e6;return{$type:"google.protobuf.Timestamp",seconds:t,nanos:n}}(e.versionRemovedAt),t.uint32(34).fork()).join(),t),decode(e,t){const n=e instanceof xI?e:new xI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.StartSessionResponse",sessionId:void 0,participantId:void 0,sessionToken:"",versionRemovedAt:void 0};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.sessionId=_R.decode(n,n.uint32());continue;case 2:if(18!==e)break;o.participantId=TR.decode(n,n.uint32());continue;case 3:if(26!==e)break;o.sessionToken=n.string();continue;case 4:if(34!==e)break;o.versionRemovedAt=IR(jI.decode(n,n.uint32()));continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:cR.$type,sessionId:RR(e.sessionId)?_R.fromJSON(e.sessionId):void 0,participantId:RR(e.participantId)?TR.fromJSON(e.participantId):void 0,sessionToken:RR(e.sessionToken)?globalThis.String(e.sessionToken):"",versionRemovedAt:RR(e.versionRemovedAt)?AR(e.versionRemovedAt):void 0}),toJSON(e){const t={};return void 0!==e.sessionId&&(t.sessionId=_R.toJSON(e.sessionId)),void 0!==e.participantId&&(t.participantId=TR.toJSON(e.participantId)),""!==e.sessionToken&&(t.sessionToken=e.sessionToken),void 0!==e.versionRemovedAt&&(t.versionRemovedAt=e.versionRemovedAt.toISOString()),t}};const lR={$type:"deepl.pb.interactive_text_api.ParticipantRequest",encode:(e,t=new CI)=>(void 0!==e.appendMessage&&mR.encode(e.appendMessage,t.uint32(10).fork()).join(),void 0!==e.updateAuthenticationTokenMessage&&yR.encode(e.updateAuthenticationTokenMessage,t.uint32(18).fork()).join(),t),decode(e,t){const n=e instanceof xI?e:new xI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.ParticipantRequest",appendMessage:void 0,updateAuthenticationTokenMessage:void 0};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.appendMessage=mR.decode(n,n.uint32());continue;case 2:if(18!==e)break;o.updateAuthenticationTokenMessage=yR.decode(n,n.uint32());continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:lR.$type,appendMessage:RR(e.appendMessage)?mR.fromJSON(e.appendMessage):void 0,updateAuthenticationTokenMessage:RR(e.updateAuthenticationTokenMessage)?yR.fromJSON(e.updateAuthenticationTokenMessage):void 0}),toJSON(e){const t={};return void 0!==e.appendMessage&&(t.appendMessage=mR.toJSON(e.appendMessage)),void 0!==e.updateAuthenticationTokenMessage&&(t.updateAuthenticationTokenMessage=yR.toJSON(e.updateAuthenticationTokenMessage)),t}};const uR={$type:"deepl.pb.interactive_text_api.ParticipantResponse",encode:(e,t=new CI)=>(void 0!==e.confirmedMessage&&dR.encode(e.confirmedMessage,t.uint32(10).fork()).join(),void 0!==e.initializedMessage&&pR.encode(e.initializedMessage,t.uint32(18).fork()).join(),void 0!==e.publishedMessage&&hR.encode(e.publishedMessage,t.uint32(26).fork()).join(),void 0!==e.metaInfoMessage&&fR.encode(e.metaInfoMessage,t.uint32(34).fork()).join(),t),decode(e,t){const n=e instanceof xI?e:new xI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.ParticipantResponse",confirmedMessage:void 0,initializedMessage:void 0,publishedMessage:void 0,metaInfoMessage:void 0};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.confirmedMessage=dR.decode(n,n.uint32());continue;case 2:if(18!==e)break;o.initializedMessage=pR.decode(n,n.uint32());continue;case 3:if(26!==e)break;o.publishedMessage=hR.decode(n,n.uint32());continue;case 4:if(34!==e)break;o.metaInfoMessage=fR.decode(n,n.uint32());continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:uR.$type,confirmedMessage:RR(e.confirmedMessage)?dR.fromJSON(e.confirmedMessage):void 0,initializedMessage:RR(e.initializedMessage)?pR.fromJSON(e.initializedMessage):void 0,publishedMessage:RR(e.publishedMessage)?hR.fromJSON(e.publishedMessage):void 0,metaInfoMessage:RR(e.metaInfoMessage)?fR.fromJSON(e.metaInfoMessage):void 0}),toJSON(e){const t={};return void 0!==e.confirmedMessage&&(t.confirmedMessage=dR.toJSON(e.confirmedMessage)),void 0!==e.initializedMessage&&(t.initializedMessage=pR.toJSON(e.initializedMessage)),void 0!==e.publishedMessage&&(t.publishedMessage=hR.toJSON(e.publishedMessage)),void 0!==e.metaInfoMessage&&(t.metaInfoMessage=fR.toJSON(e.metaInfoMessage)),t}};const dR={$type:"deepl.pb.interactive_text_api.ConfirmedMessage",encode:(e,t=new CI)=>(void 0!==e.currentVersion&&vR.encode(e.currentVersion,t.uint32(10).fork()).join(),t),decode(e,t){const n=e instanceof xI?e:new xI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.ConfirmedMessage",currentVersion:void 0};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.currentVersion=vR.decode(n,n.uint32());continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:dR.$type,currentVersion:RR(e.currentVersion)?vR.fromJSON(e.currentVersion):void 0}),toJSON(e){const t={};return void 0!==e.currentVersion&&(t.currentVersion=vR.toJSON(e.currentVersion)),t}};const pR={$type:"deepl.pb.interactive_text_api.InitializedMessage",encode:(e,t=new CI)=>t,decode(e,t){const n=e instanceof xI?e:new xI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.InitializedMessage"};for(;n.pos<r;){const e=n.uint32();if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:pR.$type}),toJSON:e=>({})};const hR={$type:"deepl.pb.interactive_text_api.PublishedMessage",encode(e,t=new CI){for(const n of e.events)SR.encode(n,t.uint32(10).fork()).join();return void 0!==e.currentVersion&&vR.encode(e.currentVersion,t.uint32(18).fork()).join(),t},decode(e,t){const n=e instanceof xI?e:new xI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.PublishedMessage",events:[],currentVersion:void 0};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.events.push(SR.decode(n,n.uint32()));continue;case 2:if(18!==e)break;o.currentVersion=vR.decode(n,n.uint32());continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:hR.$type,events:globalThis.Array.isArray(null==e?void 0:e.events)?e.events.map((e=>SR.fromJSON(e))):[],currentVersion:RR(e.currentVersion)?vR.fromJSON(e.currentVersion):void 0}),toJSON(e){var t;const n={};return(null===(t=e.events)||void 0===t?void 0:t.length)&&(n.events=e.events.map((e=>SR.toJSON(e)))),void 0!==e.currentVersion&&(n.currentVersion=vR.toJSON(e.currentVersion)),n}};const fR={$type:"deepl.pb.interactive_text_api.MetaInfoMessage",encode:(e,t=new CI)=>(void 0!==e.idle&&gR.encode(e.idle,t.uint32(10).fork()).join(),void 0!==e.translatorTaskMetaInfo&&mA.encode(e.translatorTaskMetaInfo,t.uint32(18).fork()).join(),t),decode(e,t){const n=e instanceof xI?e:new xI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.MetaInfoMessage",idle:void 0,translatorTaskMetaInfo:void 0};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.idle=gR.decode(n,n.uint32());continue;case 2:if(18!==e)break;o.translatorTaskMetaInfo=mA.decode(n,n.uint32());continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:fR.$type,idle:RR(e.idle)?gR.fromJSON(e.idle):void 0,translatorTaskMetaInfo:RR(e.translatorTaskMetaInfo)?mA.fromJSON(e.translatorTaskMetaInfo):void 0}),toJSON(e){const t={};return void 0!==e.idle&&(t.idle=gR.toJSON(e.idle)),void 0!==e.translatorTaskMetaInfo&&(t.translatorTaskMetaInfo=mA.toJSON(e.translatorTaskMetaInfo)),t}};const gR={$type:"deepl.pb.interactive_text_api.Idle",encode:(e,t=new CI)=>(void 0!==e.eventVersion&&vR.encode(e.eventVersion,t.uint32(10).fork()).join(),t),decode(e,t){const n=e instanceof xI?e:new xI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.Idle",eventVersion:void 0};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.eventVersion=vR.decode(n,n.uint32());continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:gR.$type,eventVersion:RR(e.eventVersion)?vR.fromJSON(e.eventVersion):void 0}),toJSON(e){const t={};return void 0!==e.eventVersion&&(t.eventVersion=vR.toJSON(e.eventVersion)),t}};const mR={$type:"deepl.pb.interactive_text_api.AppendMessage",encode(e,t=new CI){for(const n of e.events)SR.encode(n,t.uint32(10).fork()).join();return void 0!==e.baseVersion&&vR.encode(e.baseVersion,t.uint32(18).fork()).join(),t},decode(e,t){const n=e instanceof xI?e:new xI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.AppendMessage",events:[],baseVersion:void 0};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.events.push(SR.decode(n,n.uint32()));continue;case 2:if(18!==e)break;o.baseVersion=vR.decode(n,n.uint32());continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:mR.$type,events:globalThis.Array.isArray(null==e?void 0:e.events)?e.events.map((e=>SR.fromJSON(e))):[],baseVersion:RR(e.baseVersion)?vR.fromJSON(e.baseVersion):void 0}),toJSON(e){var t;const n={};return(null===(t=e.events)||void 0===t?void 0:t.length)&&(n.events=e.events.map((e=>SR.toJSON(e)))),void 0!==e.baseVersion&&(n.baseVersion=vR.toJSON(e.baseVersion)),n}};const yR={$type:"deepl.pb.interactive_text_api.UpdateAuthenticationTokenMessage",encode:(e,t=new CI)=>(""!==e.token&&t.uint32(10).string(e.token),t),decode(e,t){const n=e instanceof xI?e:new xI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.UpdateAuthenticationTokenMessage",token:""};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.token=n.string();continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:yR.$type,token:RR(e.token)?globalThis.String(e.token):""}),toJSON(e){const t={};return""!==e.token&&(t.token=e.token),t}};const _R={$type:"deepl.pb.interactive_text_api.SessionId",encode:(e,t=new CI)=>(""!==e.value&&t.uint32(10).string(e.value),t),decode(e,t){const n=e instanceof xI?e:new xI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.SessionId",value:""};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.value=n.string();continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:_R.$type,value:RR(e.value)?globalThis.String(e.value):""}),toJSON(e){const t={};return""!==e.value&&(t.value=e.value),t}};const vR={$type:"deepl.pb.interactive_text_api.EventVersion",encode:(e,t=new CI)=>(void 0!==e.version&&qI.encode({$type:"google.protobuf.Int32Value",value:e.version},t.uint32(10).fork()).join(),t),decode(e,t){const n=e instanceof xI?e:new xI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.EventVersion",version:void 0};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.version=qI.decode(n,n.uint32()).value;continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:vR.$type,version:RR(e.version)?Number(e.version):void 0}),toJSON(e){const t={};return void 0!==e.version&&(t.version=e.version),t}};const SR={$type:"deepl.pb.interactive_text_api.FieldEvent",encode:(e,t=new CI)=>(0!==e.fieldName&&t.uint32(8).int32(e.fieldName),void 0!==e.textChangeOperation&&rR.encode(e.textChangeOperation,t.uint32(18).fork()).join(),void 0!==e.createAnnotationOperation&&oR.encode(e.createAnnotationOperation,t.uint32(26).fork()).join(),void 0!==e.removeAnnotationOperation&&sR.encode(e.removeAnnotationOperation,t.uint32(34).fork()).join(),void 0!==e.setPropertyOperation&&iR.encode(e.setPropertyOperation,t.uint32(42).fork()).join(),void 0!==e.participantId&&TR.encode(e.participantId,t.uint32(50).fork()).join(),t),decode(e,t){const n=e instanceof xI?e:new xI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.FieldEvent",fieldName:0,textChangeOperation:void 0,createAnnotationOperation:void 0,removeAnnotationOperation:void 0,setPropertyOperation:void 0,participantId:void 0};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(8!==e)break;o.fieldName=n.int32();continue;case 2:if(18!==e)break;o.textChangeOperation=rR.decode(n,n.uint32());continue;case 3:if(26!==e)break;o.createAnnotationOperation=oR.decode(n,n.uint32());continue;case 4:if(34!==e)break;o.removeAnnotationOperation=sR.decode(n,n.uint32());continue;case 5:if(42!==e)break;o.setPropertyOperation=iR.decode(n,n.uint32());continue;case 6:if(50!==e)break;o.participantId=TR.decode(n,n.uint32());continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:SR.$type,fieldName:RR(e.fieldName)?ZA(e.fieldName):0,textChangeOperation:RR(e.textChangeOperation)?rR.fromJSON(e.textChangeOperation):void 0,createAnnotationOperation:RR(e.createAnnotationOperation)?oR.fromJSON(e.createAnnotationOperation):void 0,removeAnnotationOperation:RR(e.removeAnnotationOperation)?sR.fromJSON(e.removeAnnotationOperation):void 0,setPropertyOperation:RR(e.setPropertyOperation)?iR.fromJSON(e.setPropertyOperation):void 0,participantId:RR(e.participantId)?TR.fromJSON(e.participantId):void 0}),toJSON(e){const t={};return 0!==e.fieldName&&(t.fieldName=eR(e.fieldName)),void 0!==e.textChangeOperation&&(t.textChangeOperation=rR.toJSON(e.textChangeOperation)),void 0!==e.createAnnotationOperation&&(t.createAnnotationOperation=oR.toJSON(e.createAnnotationOperation)),void 0!==e.removeAnnotationOperation&&(t.removeAnnotationOperation=sR.toJSON(e.removeAnnotationOperation)),void 0!==e.setPropertyOperation&&(t.setPropertyOperation=iR.toJSON(e.setPropertyOperation)),void 0!==e.participantId&&(t.participantId=TR.toJSON(e.participantId)),t}};const TR={$type:"deepl.pb.interactive_text_api.ParticipantId",encode:(e,t=new CI)=>(0!==e.value&&t.uint32(8).int32(e.value),t),decode(e,t){const n=e instanceof xI?e:new xI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.ParticipantId",value:0};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(8!==e)break;o.value=n.int32();continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:TR.$type,value:RR(e.value)?globalThis.Number(e.value):0}),toJSON(e){const t={};return 0!==e.value&&(t.value=Math.round(e.value)),t}};const bR={$type:"deepl.pb.interactive_text_api.AnnotationId",encode:(e,t=new CI)=>(""!==e.value&&t.uint32(10).string(e.value),t),decode(e,t){const n=e instanceof xI?e:new xI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.AnnotationId",value:""};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.value=n.string();continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:bR.$type,value:RR(e.value)?globalThis.String(e.value):""}),toJSON(e){const t={};return""!==e.value&&(t.value=e.value),t}};const wR={$type:"deepl.pb.interactive_text_api.BaseDocument",encode(e,t=new CI){for(const n of e.fields)ER.encode(n,t.uint32(10).fork()).join();return t},decode(e,t){const n=e instanceof xI?e:new xI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.BaseDocument",fields:[]};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.fields.push(ER.decode(n,n.uint32()));continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:wR.$type,fields:globalThis.Array.isArray(null==e?void 0:e.fields)?e.fields.map((e=>ER.fromJSON(e))):[]}),toJSON(e){var t;const n={};return(null===(t=e.fields)||void 0===t?void 0:t.length)&&(n.fields=e.fields.map((e=>ER.toJSON(e)))),n}};const ER={$type:"deepl.pb.interactive_text_api.Field",encode(e,t=new CI){0!==e.fieldName&&t.uint32(8).int32(e.fieldName),""!==e.text&&t.uint32(18).string(e.text);for(const n of e.annotations)oR.encode(n,t.uint32(26).fork()).join();for(const n of e.properties)iR.encode(n,t.uint32(34).fork()).join();return t},decode(e,t){const n=e instanceof xI?e:new xI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.Field",fieldName:0,text:"",annotations:[],properties:[]};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(8!==e)break;o.fieldName=n.int32();continue;case 2:if(18!==e)break;o.text=n.string();continue;case 3:if(26!==e)break;o.annotations.push(oR.decode(n,n.uint32()));continue;case 4:if(34!==e)break;o.properties.push(iR.decode(n,n.uint32()));continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:ER.$type,fieldName:RR(e.fieldName)?ZA(e.fieldName):0,text:RR(e.text)?globalThis.String(e.text):"",annotations:globalThis.Array.isArray(null==e?void 0:e.annotations)?e.annotations.map((e=>oR.fromJSON(e))):[],properties:globalThis.Array.isArray(null==e?void 0:e.properties)?e.properties.map((e=>iR.fromJSON(e))):[]}),toJSON(e){var t,n;const r={};return 0!==e.fieldName&&(r.fieldName=eR(e.fieldName)),""!==e.text&&(r.text=e.text),(null===(t=e.annotations)||void 0===t?void 0:t.length)&&(r.annotations=e.annotations.map((e=>oR.toJSON(e)))),(null===(n=e.properties)||void 0===n?void 0:n.length)&&(r.properties=e.properties.map((e=>iR.toJSON(e)))),r}};function IR(e){let t=1e3*(e.seconds||0);return t+=(e.nanos||0)/1e6,new globalThis.Date(t)}function AR(e){return e instanceof globalThis.Date?e:"string"==typeof e?new globalThis.Date(e):IR(jI.fromJSON(e))}function RR(e){return null!=e}function kR(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}function CR(){const e=new Yb;return e.register({type:PI.START_SESSION_REQUEST,encode:e=>kR(e)&&"sessionMode"in e?aR.encode(e).finish():null,decode:e=>aR.decode(e)}),e.register({type:PI.START_SESSION_RESPONSE,encode:e=>kR(e)&&"sessionId"in e&&"participantId"in e&&"sessionToken"in e?cR.encode(e).finish():null,decode:e=>cR.decode(e)}),e.register({type:PI.EVENT_VERSION,encode:e=>kR(e)&&"version"in e?vR.encode(e).finish():null,decode:e=>vR.decode(e)}),e.register({type:PI.PARTICIPANT_REQUEST,encode:e=>kR(e)&&("appendMessage"in e||"updateAuthenticationTokenMessage"in e)?lR.encode(e).finish():null,decode:e=>lR.decode(e)}),e.register({type:PI.PARTICIPANT_RESPONSE,encode:e=>kR(e)&&"confirmedMessage"in e&&"initializedMessage"in e&&"publishedMessage"in e?uR.encode(e).finish():null,decode:e=>uR.decode(e)}),e.register({type:PI.CLIENT_ERROR_INFO,encode:e=>kR(e)&&"statusCode"in e&&"detailCode"in e&&"fallbackDetailCodes"in e?$I.encode(e).finish():null,decode:e=>$I.decode(e)}),e}function xR(e){return e.$type===rR.$type}function OR(e){return e.$type===oR.$type}function LR(e){return e.$type===sR.$type}function NR(e){return e.$type===iR.$type}function PR(e){if(e.textChangeOperation)return e.textChangeOperation;if(e.createAnnotationOperation)return e.createAnnotationOperation;if(e.removeAnnotationOperation)return e.removeAnnotationOperation;if(e.setPropertyOperation)return e.setPropertyOperation;throw new Error("FieldEvent does not contain an operation")}function DR(e,t,n){const r={fieldName:t,participantId:n,$type:SR.$type};switch(e.$type){case rR.$type:return Object.assign(Object.assign({},r),{textChangeOperation:e});case oR.$type:return Object.assign(Object.assign({},r),{createAnnotationOperation:e});case sR.$type:return Object.assign(Object.assign({},r),{removeAnnotationOperation:e});case iR.$type:return Object.assign(Object.assign({},r),{setPropertyOperation:e})}}function MR(e,t,n){return{$type:rR.$type,range:{$type:WI.$type,start:e,end:t},text:n}}function UR(e,t,n,r){return function(e,t){switch(t.$type){case KI.$type:return Object.assign(Object.assign({},e),{translatorTextUnitPayload:t});case QI.$type:return Object.assign(Object.assign({},e),{translatorRequestWordAlternativesPayload:t});case ZI.$type:return Object.assign(Object.assign({},e),{translatorProvidedWordAlternativesPayload:t});case eA.$type:return Object.assign(Object.assign({},e),{translatorSelectWordAlternativePayload:t});case lA.$type:return Object.assign(Object.assign({},e),{translatorGlossaryReplacementPayload:t});case tA.$type:return Object.assign(Object.assign({},e),{translatorRequestTextUnitAlternativesPayload:t});case nA.$type:return Object.assign(Object.assign({},e),{translatorProvidedTextUnitAlternativesPayload:t});case rA.$type:return Object.assign(Object.assign({},e),{translatorSelectTextUnitAlternativePayload:t});case oA.$type:return Object.assign(Object.assign({},e),{translatorRequestAutocompletionPayload:t});case sA.$type:return Object.assign(Object.assign({},e),{translatorProvidedAutocompletionPayload:t});case iA.$type:return Object.assign(Object.assign({},e),{translatorSelectAutocompletionPayload:t});case aA.$type:return Object.assign(Object.assign({},e),{translatorProvidedAutomaticTextUnitAlternativesPayload:t});case cA.$type:return Object.assign(Object.assign({},e),{translatorSelectAutomaticTextUnitAlternativePayload:t})}}({$type:oR.$type,annotationId:e,range:{$type:WI.$type,start:t,end:n}},r)}function $R(e,t){const n={$type:iR.$type,propertyName:e};return void 0===t?n:function(e,t){switch(t.$type){case uA.$type:return Object.assign(Object.assign({},e),{translatorSourceLanguagesValue:t});case pA.$type:return Object.assign(Object.assign({},e),{translatorRequestedSourceLanguageValue:t});case hA.$type:return Object.assign(Object.assign({},e),{translatorCalculatedSourceLanguageValue:t});case dA.$type:return Object.assign(Object.assign({},e),{translatorTargetLanguagesValue:t});case fA.$type:return Object.assign(Object.assign({},e),{translatorRequestedTargetLanguageValue:t});case gA.$type:return Object.assign(Object.assign({},e),{translatorCalculatedTargetLanguageValue:t});case yA.$type:return Object.assign(Object.assign({},e),{translatorFormalityModesValue:t});case _A.$type:return Object.assign(Object.assign({},e),{translatorFormalityModeValue:t});case TA.$type:return Object.assign(Object.assign({},e),{translatorGlossarySupportValue:t});case OA.$type:return Object.assign(Object.assign({},e),{translatorGlossaryListValue:t});case bA.$type:return Object.assign(Object.assign({},e),{translatorGlossaryIdValue:t});case vA.$type:return Object.assign(Object.assign({},e),{translatorLanguageModelsValue:t});case SA.$type:return Object.assign(Object.assign({},e),{translatorLanguageModelValue:t});case wA.$type:return Object.assign(Object.assign({},e),{textDirectionValue:t});case EA.$type:return Object.assign(Object.assign({},e),{maximumTextLengthValue:t});case IA.$type:return Object.assign(Object.assign({},e),{translatorUnsupportedSourceLanguageValue:t});case VA.$type:return Object.assign(Object.assign({},e),{writeLanguagesValue:t});case qA.$type:return Object.assign(Object.assign({},e),{writeRequestedLanguageValue:t});case WA.$type:return Object.assign(Object.assign({},e),{writeCalculatedLanguageValue:t});case BA.$type:return Object.assign(Object.assign({},e),{writeStyleVariantsValue:t});case HA.$type:return Object.assign(Object.assign({},e),{writeStyleVariantValue:t})}}(n,t)}class FR{constructor(e,t,n){this.name=e,this.sessionMode=t,this.document=n,this.bufferedInitialEvents=[]}addChangeHandler(e){this.onChange=e,this.onChange(this.bufferedInitialEvents),this.bufferedInitialEvents=[]}applyFieldEvent(e){this.document.applyItaEvent(e)}publishChange(e,t){const n=t.map((t=>DR(t,e)));this.publishEvents(n)}publishChanges(e){const t=e.flatMap((([e,t])=>t.map((t=>DR(t,e)))));this.publishEvents(t)}publishEvents(e){this.onChange?this.onChange(e):this.bufferedInitialEvents=[...this.bufferedInitialEvents,...e]}}function jR(){}function GR(e,t,n,r,o){for(var s,i=[];t;)i.push(t),s=t.previousComponent,delete t.previousComponent,t=s;i.reverse();for(var a=0,c=i.length,l=0,u=0;a<c;a++){var d=i[a];if(d.removed){if(d.value=e.join(r.slice(u,u+d.count)),u+=d.count,a&&i[a-1].added){var p=i[a-1];i[a-1]=i[a],i[a]=p}}else{if(!d.added&&o){var h=n.slice(l,l+d.count);h=h.map((function(e,t){var n=r[u+t];return n.length>e.length?n:e})),d.value=e.join(h)}else d.value=e.join(n.slice(l,l+d.count));l+=d.count,d.added||(u+=d.count)}}var f=i[c-1];return c>1&&"string"==typeof f.value&&(f.added||f.removed)&&e.equals("",f.value)&&(i[c-2].value+=f.value,i.pop()),i}jR.prototype={diff:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=r.callback;"function"==typeof r&&(o=r,r={}),this.options=r;var s=this;function i(e){return o?(setTimeout((function(){o(void 0,e)}),0),!0):e}e=this.castInput(e),t=this.castInput(t),e=this.removeEmpty(this.tokenize(e));var a=(t=this.removeEmpty(this.tokenize(t))).length,c=e.length,l=1,u=a+c;r.maxEditLength&&(u=Math.min(u,r.maxEditLength));var d=null!==(n=r.timeout)&&void 0!==n?n:1/0,p=Date.now()+d,h=[{oldPos:-1,lastComponent:void 0}],f=this.extractCommon(h[0],t,e,0);if(h[0].oldPos+1>=c&&f+1>=a)return i([{value:this.join(t),count:t.length}]);var g=-1/0,m=1/0;function y(){for(var n=Math.max(g,-l);n<=Math.min(m,l);n+=2){var r=void 0,o=h[n-1],u=h[n+1];o&&(h[n-1]=void 0);var d=!1;if(u){var p=u.oldPos-n;d=u&&0<=p&&p<a}var y=o&&o.oldPos+1<c;if(d||y){if(r=!y||d&&o.oldPos+1<u.oldPos?s.addToPath(u,!0,void 0,0):s.addToPath(o,void 0,!0,1),f=s.extractCommon(r,t,e,n),r.oldPos+1>=c&&f+1>=a)return i(GR(s,r.lastComponent,t,e,s.useLongestToken));h[n]=r,r.oldPos+1>=c&&(m=Math.min(m,n-1)),f+1>=a&&(g=Math.max(g,n+1))}else h[n]=void 0}l++}if(o)!function e(){setTimeout((function(){if(l>u||Date.now()>p)return o();y()||e()}),0)}();else for(;l<=u&&Date.now()<=p;){var _=y();if(_)return _}},addToPath:function(e,t,n,r){var o=e.lastComponent;return o&&o.added===t&&o.removed===n?{oldPos:e.oldPos+r,lastComponent:{count:o.count+1,added:t,removed:n,previousComponent:o.previousComponent}}:{oldPos:e.oldPos+r,lastComponent:{count:1,added:t,removed:n,previousComponent:o}}},extractCommon:function(e,t,n,r){for(var o=t.length,s=n.length,i=e.oldPos,a=i-r,c=0;a+1<o&&i+1<s&&this.equals(t[a+1],n[i+1]);)a++,i++,c++;return c&&(e.lastComponent={count:c,previousComponent:e.lastComponent}),e.oldPos=i,a},equals:function(e,t){return this.options.comparator?this.options.comparator(e,t):e===t||this.options.ignoreCase&&e.toLowerCase()===t.toLowerCase()},removeEmpty:function(e){for(var t=[],n=0;n<e.length;n++)e[n]&&t.push(e[n]);return t},castInput:function(e){return e},tokenize:function(e){return e.split("")},join:function(e){return e.join("")}};var VR=new jR;var qR=/^[A-Za-z\xC0-\u02C6\u02C8-\u02D7\u02DE-\u02FF\u1E00-\u1EFF]+$/,WR=/\S/,BR=new jR;BR.equals=function(e,t){return this.options.ignoreCase&&(e=e.toLowerCase(),t=t.toLowerCase()),e===t||this.options.ignoreWhitespace&&!WR.test(e)&&!WR.test(t)},BR.tokenize=function(e){for(var t=e.split(/([^\S\r\n]+|[()[\]{}'"\r\n]|\b)/),n=0;n<t.length-1;n++)!t[n+1]&&t[n+2]&&qR.test(t[n])&&qR.test(t[n+2])&&(t[n]+=t[n+2],t.splice(n+1,2),n--);return t};var HR=new jR;function JR(e){return JR="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},JR(e)}HR.tokenize=function(e){this.options.stripTrailingCr&&(e=e.replace(/\r\n/g,"\n"));var t=[],n=e.split(/(\n|\r\n)/);n[n.length-1]||n.pop();for(var r=0;r<n.length;r++){var o=n[r];r%2&&!this.options.newlineIsToken?t[t.length-1]+=o:(this.options.ignoreWhitespace&&(o=o.trim()),t.push(o))}return t},(new jR).tokenize=function(e){return e.split(/(\S.+?[.!?])(?=\s+|$)/)},(new jR).tokenize=function(e){return e.split(/([{}:;,]|\s+)/)};var zR=Object.prototype.toString,YR=new jR;function XR(e,t,n,r,o){var s,i;for(t=t||[],n=n||[],r&&(e=r(o,e)),s=0;s<t.length;s+=1)if(t[s]===e)return n[s];if("[object Array]"===zR.call(e)){for(t.push(e),i=new Array(e.length),n.push(i),s=0;s<e.length;s+=1)i[s]=XR(e[s],t,n,r,o);return t.pop(),n.pop(),i}if(e&&e.toJSON&&(e=e.toJSON()),"object"===JR(e)&&null!==e){t.push(e),i={},n.push(i);var a,c=[];for(a in e)e.hasOwnProperty(a)&&c.push(a);for(c.sort(),s=0;s<c.length;s+=1)i[a=c[s]]=XR(e[a],t,n,r,a);t.pop(),n.pop()}else i=e;return i}YR.useLongestToken=!0,YR.tokenize=HR.tokenize,YR.castInput=function(e){var t=this.options,n=t.undefinedReplacement,r=t.stringifyReplacer,o=void 0===r?function(e,t){return void 0===t?n:t}:r;return"string"==typeof e?e:JSON.stringify(XR(e,null,null,o),o,"  ")},YR.equals=function(e,t){return jR.prototype.equals.call(YR,e.replace(/,([\r\n])/g,"$1"),t.replace(/,([\r\n])/g,"$1"))};var KR=new jR;function QR(e,t){const n=(r=e,o=t,s={ignoreCase:!1},VR.diff(r,o,s));var r,o,s;let i=0;const a=[];return n.forEach((e=>{e.added?(a.push(MR(i,i,e.value)),i+=e.value.length):e.removed?a.push(MR(i,i+e.value.length,"")):i+=e.value.length})),a}function ZR(e){return e.$type===mR.$type?{$type:lR.$type,appendMessage:e}:{$type:lR.$type,updateAuthenticationTokenMessage:e}}KR.tokenize=function(e){return e.slice()},KR.join=KR.removeEmpty=function(e){return e};const ek=(e,t)=>e.split("-")[0]===t.split("-")[0];class tk{constructor(){this.fields=[]}registerField(e){return this.fields.push(e),e}applyItaEvent(e){const t=this.fields.find((t=>t.name===e.fieldName));t&&t.applyOperation(PR(e))}serialize(){return{$type:wR.$type,fields:this.fields.map((e=>e.serialize()))}}prettyPrint(){return{fields:this.fields.map((e=>e.prettyPrint()))}}reset(){this.fields.forEach((e=>e.reset()))}}const nk="autodetect",rk="en-US",ok={requiresTransformation:!1};class sk{constructor(e,t){this.payloadType=e,this.annotations=new oE([]),this.payloads=this.annotations.pipe(zE((e=>e.map((e=>e.specificPayload))))),this.config=Object.assign(Object.assign({},ok),t)}applyCreateAnnotationOperation(e){if(!e.operation.range||!e.operation.annotationId)return;const t=[...this.annotations.value,e];this.annotations.next(t)}applyRemoveAnnotationOperation(e){const t=this.annotations.value.filter((t=>{var n,r;return(null===(n=t.operation.annotationId)||void 0===n?void 0:n.value)!==(null===(r=e.annotationId)||void 0===r?void 0:r.value)}));this.annotations.next(t)}add(e,t,n){const r=UR({$type:bR.$type,value:crypto.randomUUID()},e,t,n);return this.annotations.next([...this.annotations.value,{operation:r,specificPayload:n}]),[r]}set(e){this.annotations.next(e)}removeAnnotation(e){const t=this.annotations.value.filter((t=>{var n;return(null===(n=t.operation.annotationId)||void 0===n?void 0:n.value)===(null==e?void 0:e.value)})).map((e=>function(e){return{$type:sR.$type,annotationId:e}}(e.operation.annotationId))),n=this.annotations.value.filter((t=>{var n;return(null===(n=t.operation.annotationId)||void 0===n?void 0:n.value)!==(null==e?void 0:e.value)}));return this.annotations.next(n),t}serialize(){return this.annotations.value.map((e=>e.operation))}prettyPrint(){return this.annotations.value.map((e=>{var t;return{id:null===(t=e.operation.annotationId)||void 0===t?void 0:t.value,range:e.operation.range,annotationPayload:e.specificPayload}}))}reset(){this.annotations.next([])}}var ik;function ak(e,t){return{$type:WI.$type,start:e,end:t}}!function(e){e[e.BaseThenNew=0]="BaseThenNew",e[e.NewThenBase=1]="NewThenBase"}(ik||(ik={}));const ck=(e,t,n=ik.BaseThenNew)=>{var r,o;if(LR(t)||LR(e)||OR(e)||xR(e)&&(null===(r=e.range)||void 0===r?void 0:r.start)===(null===(o=e.range)||void 0===o?void 0:o.end)&&0===e.text.length)return t;if(NR(e)&&NR(t))return((e,t,n)=>e.propertyName!==t.propertyName||n===ik.BaseThenNew?t:e)(e,t,n);if(NR(e)||NR(t))return t;if(xR(e)&&xR(t))return((e,t,n)=>{const r=e.range,o=t.range;if(r.start>o.end)return t;const s=e.text.length+r.start-r.end;if(r.end<o.start)return Object.assign(Object.assign({},t),{range:ak(o.start+s,o.end+s)});const i=r.start<o.start||r.start===o.start&&n===ik.BaseThenNew,a=r.end<o.end;if(i){const n=r.start+e.text.length;return a?Object.assign(Object.assign({},t),{range:ak(n,o.end+s)}):Object.assign(Object.assign({},t),{range:ak(n,n)})}return a?Object.assign(Object.assign({},t),{range:ak(o.start,o.end+s),text:t.text+e.text}):Object.assign(Object.assign({},t),{range:ak(o.start,r.start)})})(e,t,n);if(xR(e)&&OR(t))return((e,t)=>{const n=e.range,r=t.range;if(n.start>r.end)return t;const o=e.text.length+n.start-n.end;if(n.end<r.start)return Object.assign(Object.assign({},t),{range:ak(r.start+o,r.end+o)});const s=n.start<r.start,i=n.end<r.end,a=n.start+e.text.length;return s?i?Object.assign(Object.assign({},t),{range:ak(a,r.end+o)}):n.end===r.end?Object.assign(Object.assign({},t),{range:ak(a,a)}):Object.assign(Object.assign({},t),{range:ak(n.start,n.start)}):i?n.start===r.start?Object.assign(Object.assign({},t),{range:ak(a,r.end+o)}):Object.assign(Object.assign({},t),{range:ak(r.start,r.end+o)}):Object.assign(Object.assign({},t),{range:ak(r.start,a)})})(e,t);throw new Error(`Operational transform for operations of type [${null==e?void 0:e.$type}, ${null==t?void 0:t.$type}] not implemented.`)},lk=(e,t)=>[ck(t,e,ik.NewThenBase),ck(e,t,ik.BaseThenNew)],uk=(e,t)=>{let n=[...e];const r=t.map((e=>{let t=e;return n=n.map((e=>{const[n,r]=lk(e,t);return t=r,n})),t}));return[n,r]},dk=(e,t)=>{let n=[...t];return{transformedIncomingEvents:e.map((e=>{let t=PR(e);return n=n.map((n=>{if(e.fieldName!==n.fieldName)return n;const[r,o]=lk(PR(e),PR(n));return t=r,"participantId"in n?DR(o,n.fieldName,n.participantId):DR(o,n.fieldName)})),DR(t,e.fieldName,e.participantId)})),transformedExistingEvents:n}};class pk{constructor(e){this.name=e,this.content=new oE(""),this.annotations=[],this.annotationsRequiringTransformation=[],this.changeNotifier=new nE,this.wasChanged=this.changeNotifier.asObservable(),this.properties=new Map}registerAnnotation(e){return e.config.requiresTransformation&&this.annotationsRequiringTransformation.push(e),this.annotations.push(e),e}registerProperty(e){return this.properties.set(e.propertyName,e),e}applyOperation(e){xR(e)?this.applyTextChangeOperation(e):OR(e)?this.applyCreateAnnotationOperation(e):LR(e)?this.applyRemoveAnnotationOperation(e):NR(e)&&this.applySetPropertyOperation(e)}applyTextChangeOperation(e){const t=((e,t)=>{if(void 0===t.range||t.range.start>e.length||t.range.start<0||t.range.end>e.length||t.range.end<0||t.range.start>t.range.end)throw new Error("Tried to apply out of range operation to string");return e.slice(0,t.range.start)+t.text+e.slice(t.range.end)})(this.content.value,e);this.content.next(t),this.changeNotifier.next();for(const t of this.annotationsRequiringTransformation){const n=t.annotations.value.map((t=>Object.assign(Object.assign({},t),{operation:ck(e,t.operation)})));t.set(n)}}applyCreateAnnotationOperation(e){const t=function(e){if(e.translatorTextUnitPayload)return e.translatorTextUnitPayload;if(e.translatorRequestWordAlternativesPayload)return e.translatorRequestWordAlternativesPayload;if(e.translatorProvidedWordAlternativesPayload)return e.translatorProvidedWordAlternativesPayload;if(e.translatorSelectWordAlternativePayload)return e.translatorSelectWordAlternativePayload;if(e.translatorGlossaryReplacementPayload)return e.translatorGlossaryReplacementPayload;if(e.translatorRequestTextUnitAlternativesPayload)return e.translatorRequestTextUnitAlternativesPayload;if(e.translatorProvidedTextUnitAlternativesPayload)return e.translatorProvidedTextUnitAlternativesPayload;if(e.translatorSelectTextUnitAlternativePayload)return e.translatorSelectTextUnitAlternativePayload;if(e.translatorRequestAutocompletionPayload)return e.translatorRequestAutocompletionPayload;if(e.translatorProvidedAutocompletionPayload)return e.translatorProvidedAutocompletionPayload;if(e.translatorSelectAutocompletionPayload)return e.translatorSelectAutocompletionPayload;if(e.translatorProvidedAutomaticTextUnitAlternativesPayload)return e.translatorProvidedAutomaticTextUnitAlternativesPayload;if(e.translatorSelectAutomaticTextUnitAlternativePayload)return e.translatorSelectAutomaticTextUnitAlternativePayload;throw new Error("CreateAnnotationOperation does not contain a known payload")}(e),n=this.annotations.find((e=>e.payloadType===t.$type));n&&(n.applyCreateAnnotationOperation({operation:e,specificPayload:t}),this.changeNotifier.next())}applyRemoveAnnotationOperation(e){this.annotations.forEach((t=>t.applyRemoveAnnotationOperation(e))),this.changeNotifier.next()}applySetPropertyOperation(e){const{propertyName:t}=e,n=this.properties.get(t);n&&(n.applySetPropertyOperation(e),this.changeNotifier.next())}update(e){const t=QR(this.content.value,e);this.content.next(e),this.changeNotifier.next();for(const e of this.annotationsRequiringTransformation){const n=e.annotations.value,[r,o]=uk(t,n.map((e=>e.operation)));e.set(o.map(((e,t)=>Object.assign(Object.assign({},n[t]),{operation:e}))))}return t}serialize(){return{$type:ER.$type,fieldName:this.name,text:this.content.value,annotations:this.annotations.flatMap((e=>e.serialize())),properties:Array.from(this.properties.values()).map((e=>e.serialize()))}}prettyPrint(){return{fieldName:XA[this.name],text:this.content.value,annotations:this.annotations.flatMap((e=>e.prettyPrint())),properties:Array.from(this.properties.values()).map((e=>e.prettyPrint()))}}reset(){this.content.next(""),this.annotations.forEach((e=>e.reset())),this.properties.forEach((e=>e.reset())),this.changeNotifier.next()}}class hk{constructor(e,t){this.propertyName=e,this.propertyType=t,this.value=new oE(void 0)}applySetPropertyOperation(e){const t=function(e){return e.translatorSourceLanguagesValue?e.translatorSourceLanguagesValue:e.translatorTargetLanguagesValue?e.translatorTargetLanguagesValue:e.translatorRequestedSourceLanguageValue?e.translatorRequestedSourceLanguageValue:e.translatorCalculatedSourceLanguageValue?e.translatorCalculatedSourceLanguageValue:e.translatorRequestedTargetLanguageValue?e.translatorRequestedTargetLanguageValue:e.translatorCalculatedTargetLanguageValue?e.translatorCalculatedTargetLanguageValue:e.translatorFormalityModesValue?e.translatorFormalityModesValue:e.translatorFormalityModeValue?e.translatorFormalityModeValue:e.translatorGlossarySupportValue?e.translatorGlossarySupportValue:e.translatorGlossaryListValue?e.translatorGlossaryListValue:e.translatorGlossaryIdValue?e.translatorGlossaryIdValue:e.translatorLanguageModelsValue?e.translatorLanguageModelsValue:e.translatorLanguageModelValue?e.translatorLanguageModelValue:e.textDirectionValue?e.textDirectionValue:e.maximumTextLengthValue?e.maximumTextLengthValue:e.translatorUnsupportedSourceLanguageValue?e.translatorUnsupportedSourceLanguageValue:e.writeLanguagesValue?e.writeLanguagesValue:e.writeRequestedLanguageValue?e.writeRequestedLanguageValue:e.writeCalculatedLanguageValue?e.writeCalculatedLanguageValue:e.writeStyleVariantsValue?e.writeStyleVariantsValue:e.writeStyleVariantValue?e.writeStyleVariantValue:void 0}(e);if(void 0===t)return this.reset();if(t.$type!==this.propertyType)throw new Error(`PropertyValue has type ${t.$type}, but ${this.propertyType} expected`);this.value.next(t)}set(e){return this.value.next(e),[this.serialize()]}reset(){this.value.next(void 0)}serialize(){return $R(this.propertyName,this.value.value)}prettyPrint(){return{propertyName:KA[this.propertyName],propertyValue:this.value.value}}}class fk extends hk{constructor(){super(KA.TRANSLATOR_TEXT_DIRECTION,wA.$type),this.isRightToLeft=this.value.pipe(zE((e=>(null==e?void 0:e.textDirection)===JI.RIGHT_TO_LEFT)))}}const gk=e=>!!e;class mk extends hk{constructor(){super(KA.MAXIMUM_TEXT_LENGTH,EA.$type),this.max=this.value.pipe(iI(gk),zE((e=>e.max)))}}class yk extends hk{constructor(){super(KA.TRANSLATOR_UNSUPPORTED_LANGUAGE,IA.$type),this.unsupported=this.value.pipe(zE((e=>!!e)))}}class _k extends hk{constructor(){super(KA.TRANSLATOR_CALCULATED_SOURCE_LANGUAGE,hA.$type),this.language=this.value.pipe(iI((e=>!!e)),zE((e=>{var t;return null===(t=e.sourceLanguage)||void 0===t?void 0:t.code}))),this.isAutoDetected=this.value.pipe(iI((e=>!!e)),zE((e=>e.origin===HI.LANGUAGE_DETECTION)))}updateLanguage(e){return super.set({$type:hA.$type,sourceLanguage:{$type:LA.$type,code:e},origin:HI.REQUESTED_LANGUAGE})}getCurrent(){var e,t;return null===(t=null===(e=this.value.value)||void 0===e?void 0:e.sourceLanguage)||void 0===t?void 0:t.code}}class vk extends hk{constructor(){super(KA.TRANSLATOR_REQUESTED_SOURCE_LANGUAGE,pA.$type),this.language=this.value.pipe(iI((e=>!!e)),zE((e=>{var t,n;return null!==(n=null===(t=null==e?void 0:e.sourceLanguage)||void 0===t?void 0:t.code)&&void 0!==n?n:nk})))}updateLanguage(e){if("autodetect"===e){return super.set(void 0)}return super.set({$type:pA.$type,sourceLanguage:{$type:LA.$type,code:e}})}}class Sk extends hk{constructor(){super(KA.TRANSLATOR_SOURCE_LANGUAGES,uA.$type),this.sourceLanguages=this.value.pipe(zE((e=>{var t;return null!==(t=null==e?void 0:e.sourceLanguages.map((e=>e.code)))&&void 0!==t?t:[]})))}}class Tk extends pk{constructor(){super(...arguments),this.calculatedSourceLanguageProperty=this.registerProperty(new _k),this.requestedSourceLanguageProperty=this.registerProperty(new vk),this.sourceLanguagesProperty=this.registerProperty(new Sk),this.maximumTextLengthProperty=this.registerProperty(new mk),this.unsupportedLanguageProperty=this.registerProperty(new yk),this.sourceTextUnitAnnotations=this.registerAnnotation(new sk(KI.$type,{requiresTransformation:!0})),this.textDirection=this.registerProperty(new fk)}}class bk extends hk{constructor(){super(KA.TRANSLATOR_TARGET_LANGUAGES,dA.$type),this.targetLanguages=this.value.pipe(zE((e=>{var t;return null!==(t=null==e?void 0:e.targetLanguages.map((e=>e.code)))&&void 0!==t?t:[]})))}}class wk extends hk{constructor(){super(KA.TRANSLATOR_CALCULATED_TARGET_LANGUAGE,gA.$type),this.language=this.value.pipe(iI((e=>!!e)),zE((e=>{var t;return null===(t=e.targetLanguage)||void 0===t?void 0:t.code})))}updateLanguage(e){return super.set({$type:gA.$type,targetLanguage:{$type:NA.$type,code:e}})}}class Ek extends hk{constructor(){super(KA.TRANSLATOR_REQUESTED_TARGET_LANGUAGE,fA.$type)}updateLanguage(e){return super.set({$type:fA.$type,targetLanguage:{$type:NA.$type,code:e}})}getCurrent(){var e,t;return null===(t=null===(e=this.value.value)||void 0===e?void 0:e.targetLanguage)||void 0===t?void 0:t.code}}class Ik extends hk{constructor(){super(KA.TRANSLATOR_GLOSSARY_SUPPORT,TA.$type),this.supported=this.value.pipe(zE((e=>!!e)))}}class Ak extends hk{constructor(){super(KA.TRANSLATOR_GLOSSARY_LIST,OA.$type),this.entries=this.value.pipe(zE((e=>{var t;return null!==(t=null==e?void 0:e.glossaryEntries)&&void 0!==t?t:[]})))}updateGlossaryList(e){return super.set(void 0===e?void 0:{$type:OA.$type,glossaryEntries:e})}}class Rk extends hk{constructor(){super(KA.TRANSLATOR_GLOSSARY_SUGGESTIONS,OA.$type)}}class kk extends hk{constructor(){super(KA.TRANSLATOR_FORMALITY_MODES,yA.$type)}}class Ck extends hk{constructor(){super(KA.TRANSLATOR_FORMALITY_MODE,_A.$type)}update(e){return super.set(void 0===e?void 0:{$type:_A.$type,formalityMode:e})}}class xk extends hk{constructor(){super(KA.TRANSLATOR_LANGUAGE_MODELS,vA.$type)}}class Ok extends hk{constructor(){super(KA.TRANSLATOR_LANGUAGE_MODEL,SA.$type)}update(e){return super.set(void 0===e?void 0:{$type:SA.$type,languageModel:e})}}class Lk extends hk{constructor(){super(KA.TRANSLATOR_GLOSSARY_ID,bA.$type)}update(e){return super.set(void 0===e?void 0:{$type:bA.$type,glossaryId:e})}}class Nk extends pk{constructor(){super(...arguments),this.requestedTargetLanguageProperty=this.registerProperty(new Ek),this.calculatedTargetLanguageProperty=this.registerProperty(new wk),this.targetLanguagesProperty=this.registerProperty(new bk),this.requestWordAlternativesAnnotations=this.registerAnnotation(new sk(QI.$type)),this.providedWordAlternativesAnnotations=this.registerAnnotation(new sk(ZI.$type)),this.selectWordAlternativeAnnotations=this.registerAnnotation(new sk(eA.$type)),this.requestTextUnitAlternativesAnnotations=this.registerAnnotation(new sk(tA.$type)),this.providedTextUnitAlternativesAnnotations=this.registerAnnotation(new sk(nA.$type)),this.selectTextUnitAlternativeAnnotations=this.registerAnnotation(new sk(rA.$type)),this.requestAutocompletionAnnotations=this.registerAnnotation(new sk(oA.$type)),this.providedAutocompletionAnnotations=this.registerAnnotation(new sk(sA.$type)),this.selectAutocompletionAnnotations=this.registerAnnotation(new sk(iA.$type)),this.providedAutomaticTextUnitAlternativesAnnotations=this.registerAnnotation(new sk(aA.$type)),this.selectAutomaticTextUnitAlternativeAnnotations=this.registerAnnotation(new sk(cA.$type)),this.targetTextUnitAnnotations=this.registerAnnotation(new sk(KI.$type,{requiresTransformation:!0})),this.glossaryReplacementAnnotations=this.registerAnnotation(new sk(lA.$type,{requiresTransformation:!0})),this.glossarySupport=this.registerProperty(new Ik),this.glossaryListProperty=this.registerProperty(new Ak),this.glossarySuggestions=this.registerProperty(new Rk),this.formalityModes=this.registerProperty(new kk),this.formalityMode=this.registerProperty(new Ck),this.languageModels=this.registerProperty(new xk),this.languageModel=this.registerProperty(new Ok),this.textDirection=this.registerProperty(new fk),this.glossaryId=this.registerProperty(new Lk),this.maximumTextLengthProperty=this.registerProperty(new mk)}}class Pk extends pk{constructor(){super(...arguments),this.targetTranscriptionTextUnitAnnotations=this.registerAnnotation(new sk(KI.$type,{requiresTransformation:!0}))}}class Dk extends tk{constructor(){super(...arguments),this.sourceTextField=this.registerField(new Tk(XA.TRANSLATOR_SOURCE_TEXT)),this.targetTextField=this.registerField(new Nk(XA.TRANSLATOR_TARGET_TEXT)),this.targetTranscriptionTextField=this.registerField(new Pk(XA.TRANSLATOR_TARGET_TRANSCRIPTION_TEXT)),this.textUnitAnnotations=nI([this.sourceTextField.sourceTextUnitAnnotations.annotations,this.targetTextField.targetTextUnitAnnotations.annotations,this.targetTranscriptionTextField.targetTranscriptionTextUnitAnnotations.annotations]).pipe(zE((e=>{const t=e[0],n=e[1],r=e[2];return t.sort(((e,t)=>e.operation.range.start-t.operation.range.start)).map((e=>{var t,o,s,i;const a=e.operation.range,c=null!==(o=null===(t=n.find((t=>{var n,r;return(null===(n=e.specificPayload.textUnitId)||void 0===n?void 0:n.value)===(null===(r=t.specificPayload.textUnitId)||void 0===r?void 0:r.value)})))||void 0===t?void 0:t.operation.range)&&void 0!==o?o:WI.fromJSON({}),l=null!==(i=null===(s=r.find((t=>{var n,r;return(null===(n=e.specificPayload.textUnitId)||void 0===n?void 0:n.value)===(null===(r=t.specificPayload.textUnitId)||void 0===r?void 0:r.value)})))||void 0===s?void 0:s.operation.range)&&void 0!==i?i:WI.fromJSON({});return{sourceStart:a.start,sourceEnd:a.end,sourceLength:a.end-a.start,targetStart:c.start,targetEnd:c.end,targetLength:c.end-c.start,targetTranscriptionStart:l.start,targetTranscriptionEnd:l.end,targetTranscriptionLength:l.end-l.start}}))})))}}class Mk extends FR{constructor(e={preventSameLanguages:{enabled:!1}}){super("Translator",QA.TRANSLATOR,new Dk),this.config=e,this.targetLanguage=this.document.targetTextField.requestedTargetLanguageProperty.value.pipe(zE((e=>{var t,n;return null!==(n=null===(t=null==e?void 0:e.targetLanguage)||void 0===t?void 0:t.code)&&void 0!==n?n:rk}))),this.config.preventSameLanguages.enabled&&this.document.sourceTextField.calculatedSourceLanguageProperty.language.pipe(iI((e=>!!e))).subscribe((e=>{const t=this.document.targetTextField.requestedTargetLanguageProperty.getCurrent();t&&this.config.preventSameLanguages.enabled&&ek(e,t)&&this.updateRequestedTargetLanguage(this.config.preventSameLanguages.getAlternativeTargetLanguage(t))}))}applyFieldEvent(e){if(e.fieldName===XA.TRANSLATOR_TARGET_TEXT&&e.textChangeOperation){const e=[];e.push(...this.cancelTextUnitAlternativesFlows()),e.push(...this.cancelWordAlternativesFlows()),e.push(...this.cancelAutocompletionFlows()),this.publishChange(XA.TRANSLATOR_TARGET_TEXT,e)}this.document.applyItaEvent(e)}updateSourceText(e){const t=this.document.sourceTextField.update(e);this.publishChange(XA.TRANSLATOR_SOURCE_TEXT,t)}updateTargetText(e){const t=[];t.push(...this.cancelTextUnitAlternativesFlows()),t.push(...this.cancelWordAlternativesFlows()),t.push(...this.cancelAutocompletionFlows()),t.push(...this.document.targetTextField.update(e)),this.publishChange(XA.TRANSLATOR_TARGET_TEXT,t)}updateRequestedTargetLanguage(e){var t;if(this.config.preventSameLanguages.enabled&&ek(e,null!==(t=this.document.sourceTextField.calculatedSourceLanguageProperty.getCurrent())&&void 0!==t?t:""))return;const n=this.document.targetTextField.requestedTargetLanguageProperty.updateLanguage(e);this.publishChange(XA.TRANSLATOR_TARGET_TEXT,n)}updateRequestedSourceLanguage(e){const t=this.document.sourceTextField.requestedSourceLanguageProperty.updateLanguage(e);this.publishChange(XA.TRANSLATOR_SOURCE_TEXT,t)}switchLanguages(e){var t,n,r,o,s,i,a,c,l,u,d;const{sourceTextField:p,targetTextField:h}=this.document,f=null!==(t=p.calculatedSourceLanguageProperty.getCurrent())&&void 0!==t?t:null===(r=null===(n=p.requestedSourceLanguageProperty.value.value)||void 0===n?void 0:n.sourceLanguage)||void 0===r?void 0:r.code,g=null!==(i=null===(s=null===(o=h.calculatedTargetLanguageProperty.value.value)||void 0===o?void 0:o.targetLanguage)||void 0===s?void 0:s.code)&&void 0!==i?i:null===(c=null===(a=h.requestedTargetLanguageProperty.value.value)||void 0===a?void 0:a.targetLanguage)||void 0===c?void 0:c.code,m=h.content.value;if(!f||!g)return;const y=null!==(u=null===(l=p.maximumTextLengthProperty.value.value)||void 0===l?void 0:l.max)&&void 0!==u?u:3e5,_=m.slice(0,y),v=g.split("-")[0],S=null!==(d=e[f])&&void 0!==d?d:f;this.publishChanges([[XA.TRANSLATOR_TARGET_TEXT,[...h.update("")]],[XA.TRANSLATOR_SOURCE_TEXT,[...p.update("")]],[XA.TRANSLATOR_TARGET_TEXT,[...h.requestedTargetLanguageProperty.updateLanguage(S)]],[XA.TRANSLATOR_SOURCE_TEXT,[...p.requestedSourceLanguageProperty.updateLanguage(v),...p.update(_)]]]),p.calculatedSourceLanguageProperty.updateLanguage(v)}cancelWordAlternativesFlows(){return this.document.targetTextField.requestWordAlternativesAnnotations.annotations.value.flatMap((e=>this.document.targetTextField.requestWordAlternativesAnnotations.removeAnnotation(e.operation.annotationId)))}cancelTextUnitAlternativesFlows(){return this.document.targetTextField.requestTextUnitAlternativesAnnotations.annotations.value.flatMap((e=>this.document.targetTextField.requestTextUnitAlternativesAnnotations.removeAnnotation(e.operation.annotationId)))}cancelAutocompletionFlows(){return this.document.targetTextField.requestAutocompletionAnnotations.annotations.value.flatMap((e=>this.document.targetTextField.requestAutocompletionAnnotations.removeAnnotation(e.operation.annotationId)))}requestWordAlternatives(e){const t=[];t.push(...this.cancelWordAlternativesFlows());const n=this.document.targetTextField.requestWordAlternativesAnnotations.add(e,e,{$type:QI.$type,flowId:{$type:MA.$type,value:crypto.randomUUID()}})[0];t.push(n),this.publishChange(XA.TRANSLATOR_TARGET_TEXT,t)}requestTextUnitAlternatives(e){const t=[];t.push(...this.cancelTextUnitAlternativesFlows());const n=this.document.targetTextField.requestTextUnitAlternativesAnnotations.add(e,e,{$type:tA.$type,flowId:{$type:FA.$type,value:crypto.randomUUID()}})[0];t.push(n),this.publishChange(XA.TRANSLATOR_TARGET_TEXT,t)}requestAutocompletion(e){const t=[];t.push(...this.cancelAutocompletionFlows());const n=this.document.targetTextField.requestAutocompletionAnnotations.add(e,e,{$type:oA.$type,flowId:{$type:jA.$type,value:crypto.randomUUID()}})[0];t.push(n),this.publishChange(XA.TRANSLATOR_TARGET_TEXT,t)}selectWordAlternative(e,t,n){const r=[];r.push(...this.cancelTextUnitAlternativesFlows()),r.push(...this.cancelAutocompletionFlows());const o=this.document.targetTextField.selectWordAlternativeAnnotations.add(e,e,{$type:eA.$type,flowId:{$type:MA.$type,value:t},selection:n});r.push(...o),this.publishChange(XA.TRANSLATOR_TARGET_TEXT,r)}selectTextUnitAlternative(e,t,n){const r=[];r.push(...this.cancelWordAlternativesFlows()),r.push(...this.cancelAutocompletionFlows());const o=this.document.targetTextField.selectTextUnitAlternativeAnnotations.add(e,e,{$type:rA.$type,flowId:{$type:FA.$type,value:t},selection:n});r.push(...o),this.publishChange(XA.TRANSLATOR_TARGET_TEXT,r)}selectAutocompletion(e,t,n){const r=[];r.push(...this.cancelWordAlternativesFlows()),r.push(...this.cancelTextUnitAlternativesFlows());const o=this.document.targetTextField.selectAutocompletionAnnotations.add(e,e,{$type:iA.$type,flowId:{$type:jA.$type,value:t},selection:n});r.push(...o),this.publishChange(XA.TRANSLATOR_TARGET_TEXT,r)}selectAutomaticTextUnitAlternative(e,t){const n=[],r=this.document.targetTextField.selectAutomaticTextUnitAlternativeAnnotations.add(e,e,{$type:cA.$type,selection:t});n.push(...r),this.publishChange(XA.TRANSLATOR_TARGET_TEXT,n)}updateGlossaryList(e){const t=this.document.targetTextField.glossaryListProperty.updateGlossaryList(e);this.publishChange(XA.TRANSLATOR_TARGET_TEXT,t)}updateFormalityMode(e){const t=this.document.targetTextField.formalityMode.update(e);this.publishChange(XA.TRANSLATOR_TARGET_TEXT,t)}updateLanguageModel(e){const t=this.document.targetTextField.languageModel.update(e);this.publishChange(XA.TRANSLATOR_TARGET_TEXT,t)}updateGlossaryId(e){const t=this.document.targetTextField.glossaryId.update(e);this.publishChange(XA.TRANSLATOR_TARGET_TEXT,t)}}function Uk(e){return e.$type===fR.$type}function $k(e){if(function(e){return e.$type===uR.$type}(e))return function(e){if(null==e?void 0:e.confirmedMessage)return e.confirmedMessage;if(null==e?void 0:e.initializedMessage)return e.initializedMessage;if(null==e?void 0:e.publishedMessage)return e.publishedMessage;if(null==e?void 0:e.metaInfoMessage)return e.metaInfoMessage;throw new Error("ParticipantResponse does not contain a message")}(e);if(function(e){return e.$type===lR.$type}(e))return function(e){if(null==e?void 0:e.appendMessage)return e.appendMessage;if(null==e?void 0:e.updateAuthenticationTokenMessage)return e.updateAuthenticationTokenMessage;throw new Error("ParticipantRequest does not contain a message")}(e);throw new Error("Extracting message failed, you need to pass a ParticipantRequest or ParticipantResponse")}class Fk{constructor(e){var t,n,r,o,s,i;this.currentVersion={$type:vR.$type,version:void 0},this.isInitialized=!1,this.pendingEvents=[],this.sentEvents=[],this.confirmedEvents=[],this.incomingEvents=e.pipe(zE((e=>$k(e))),(i=Ew(r=e=>{(function(e){return e.$type===dR.$type})(e)&&this.handleConfirmedMessage(e),function(e){return e.$type===pR.$type}(e)&&this.handleInitializedMessage()})||o||s?{next:r,error:o,complete:s}:r)?Yw((function(e,t){var n;null===(n=i.subscribe)||void 0===n||n.call(i);var r=!0;e.subscribe(Xw(t,(function(e){var n;null===(n=i.next)||void 0===n||n.call(i,e),t.next(e)}),(function(){var e;r=!1,null===(e=i.complete)||void 0===e||e.call(i),t.complete()}),(function(e){var n;r=!1,null===(n=i.error)||void 0===n||n.call(i,e),t.error(e)}),(function(){var e,t;r&&(null===(e=i.unsubscribe)||void 0===e||e.call(i)),null===(t=i.finalize)||void 0===t||t.call(i)})))})):Bw,iI((e=>function(e){return e.$type===hR.$type}(e))),zE((e=>this.handlePublished(e))),(t=e=>JE(e),Yw((function(e,r){var o=null,s=0,i=!1,a=function(){return i&&!o&&r.complete()};e.subscribe(Xw(r,(function(e){null==o||o.unsubscribe();var i=0,c=s++;jE(t(e,c)).subscribe(o=Xw(r,(function(t){return r.next(n?n(e,t,c,i++):t)}),(function(){o=null,a()})))}),(function(){i=!0,a()})))}))),cI())}addClientEvents(e){this.pendingEvents.push(...e),this.trySendPendingEvents()}handleConfirmedMessage(e){this.currentVersion=e.currentVersion,this.confirmedEvents.push(...this.sentEvents),this.sentEvents=[],this.trySendPendingEvents()}handlePublished(e){const t=e.events,{transformedIncomingEvents:n,transformedExistingEvents:r}=dk(t,this.pendingEvents);this.pendingEvents=r;const{transformedIncomingEvents:o,transformedExistingEvents:s}=dk(n,this.sentEvents);return this.sentEvents=s,this.confirmedEvents.push(...o),this.currentVersion=e.currentVersion,this.trySendPendingEvents(),o}connectToSession(e){this.sendEvents=e,this.trySendPendingEvents()}trySendPendingEvents(){0===this.pendingEvents.length||this.sentEvents.length>0||!this.isInitialized||!this.sendEvents||(this.sentEvents=this.sendEvents(this.pendingEvents.reduce(((e,t)=>{if(function(e){var t,n;return void 0!==e&&(null===(t=e.range)||void 0===t?void 0:t.start)===(null===(n=e.range)||void 0===n?void 0:n.end)&&0===e.text.length}(t.textChangeOperation))return e;if(0===e.length)return[t];const n=e.at(-1);if(n.fieldName!==t.fieldName||!t.textChangeOperation||!n.textChangeOperation)return[...e,t];const r=n.textChangeOperation,o=t.textChangeOperation,s=o.range.start-r.range.start,i=o.range.end-r.range.start,a=Math.max(0,s),c=Math.min(r.text.length,i);if(a>c)return[...e,t];const l=Math.min(0,s),u=i-s-(c-a),d=DR(MR(r.range.start+l,r.range.end+l+u,r.text.slice(0,a)+o.text+r.text.slice(c)),t.fieldName);return[...e.slice(0,-1),d]}),new Array),this.currentVersion),this.pendingEvents=[])}handleInitializedMessage(){this.sentEvents.length>0&&this.sendEvents(this.sentEvents,this.currentVersion),this.isInitialized=!0,this.trySendPendingEvents()}}var jk,Gk=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}c((r=r.apply(e,t||[])).next())}))};!function(e){e[e.Connecting=0]="Connecting",e[e.Reconnecting=1]="Reconnecting",e[e.Restoring=2]="Restoring",e[e.Connected=3]="Connected",e[e.Disconnected=4]="Disconnected"}(jk||(jk={}));class Vk extends Error{constructor(){super(...arguments),this.name="ConnectionError"}}class qk extends Error{constructor(e){super("There was an error with the session on the server. See the info property for details."),this.info=e,this.name="SessionError"}}class Wk{constructor(e,t,n,r){this.connection=e,this.config=t,this.client=n,this.metaInfo=r,this.participantResponses=new nE,this.participantRequests=new nE,this.errorInfoSubject=new nE,this.error=this.errorInfoSubject.asObservable(),this.statusSubject=new oE(jk.Disconnected),this.status=this.statusSubject.asObservable(),this.messages=sI(this.participantResponses,this.participantRequests).pipe(aI(((e,t)=>[...e,t]),[]),function(e,t,n){var r,o,s,i,a=!1;return e&&"object"==typeof e?(r=e.bufferSize,i=void 0===r?1/0:r,o=e.windowTime,t=void 0===o?1/0:o,a=void 0!==(s=e.refCount)&&s,n=e.scheduler):i=null!=e?e:1/0,cI({connector:function(){return new iE(i,t,n)},resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:a})}()),this.eventHandler=new Fk(this.participantResponses),this.client.addChangeHandler((e=>this.eventHandler.addClientEvents(e))),this.eventHandler.incomingEvents.subscribe((e=>this.client.applyFieldEvent(e))),this.participantResponses.pipe(zE($k),iI(Uk)).subscribe((e=>{var t;return null===(t=this.metaInfo)||void 0===t?void 0:t.addMetaInfoMessage(e)})),this.connection.on("OnError",(e=>{this.statusSubject.value===jk.Connected?(this.errorInfoSubject.next(new qk(e)),this.statusSubject.next(jk.Disconnected)):console.warn('Received "OnError" invocation in not connected state. Ignoring this potentially duplicate invocation.')})),this.connection.onclose((e=>{this.errorInfoSubject.next(new Vk(`The connection was closed with error: ${e}`)),this.statusSubject.next(jk.Disconnected)}))}connect(e){return Gk(this,void 0,void 0,(function*(){if(this.statusSubject.value!==jk.Disconnected)return;if(this.startSessionResponse&&!e?this.statusSubject.next(jk.Reconnecting):this.statusSubject.next(jk.Connecting),this.connection.state!==db.Connected)try{yield this.connection.start()}catch(e){throw this.statusSubject.next(jk.Disconnected),new Vk(`Error starting connection: ${e}`)}if(!this.startSessionResponse||e){const t={$type:aR.$type,sessionMode:this.client.sessionMode,baseDocument:e,translatorSessionOptions:{$type:AA.$type,enableTranscription:this.config.enableTranscription}};try{this.startSessionResponse=yield this.connection.invoke("StartSession",t)}catch(e){throw this.statusSubject.next(jk.Disconnected),new Vk(`Error starting session: ${e}`)}}const t=this.connection.stream("GetMessages",this.startSessionResponse.sessionToken,this.eventHandler.currentVersion).subscribe({next:e=>{this.statusSubject.value!==jk.Connected&&this.statusSubject.next(jk.Connected),this.participantResponses.next(e)},error:()=>{},complete:()=>{}});this.connection.on("OnError",(()=>t.dispose()));try{yield this.connection.send("AppendMessages",this.startSessionResponse.sessionToken,this.participantRequests)}catch(e){throw this.statusSubject.next(jk.Disconnected),new Vk(`Error starting 'AppendMessages': ${e}`)}var n;this.eventHandler.connectToSession(((e,t)=>{const n=e.map((e=>Object.assign(Object.assign({},e),{participantId:this.startSessionResponse.participantId}))),r=ZR(function(e,t){return{$type:mR.$type,events:e,baseVersion:t}}(n,t));return this.participantRequests.next(r),n})),this.config.accessToken.pipe((n=this.status.pipe(iI((e=>e===jk.Connected))),Yw((function(e,t){var r=!1,o=Xw(t,(function(){null==o||o.unsubscribe(),r=!0}),Dw);jE(n).subscribe(o),e.subscribe(Xw(t,(function(e){return r&&t.next(e)})))})))).subscribe((e=>this.updateAuthenticationToken(e)))}))}restore(){return Gk(this,void 0,void 0,(function*(){this.statusSubject.next(jk.Restoring),this.connection.off("OnError");const e=this.client.document.serialize();this.client.document.reset();const t=new Wk(this.connection,this.config,this.client,this.metaInfo);return yield t.connect(e),t}))}updateAuthenticationToken(e){this.participantRequests.next(ZR({$type:yR.$type,token:e}))}}class Bk extends hk{constructor(){super(KA.WRITE_LANGUAGES,VA.$type),this.languageCodes=this.value.pipe(zE((e=>{var t;return null!==(t=null==e?void 0:e.languages.map((e=>e.code)))&&void 0!==t?t:[]})))}}class Hk extends hk{constructor(){super(KA.WRITE_REQUESTED_LANGUAGE,qA.$type)}updateLanguage(e){if("autodetect"===e){return super.set(void 0)}return super.set({$type:qA.$type,language:{$type:JA.$type,code:e}})}}class Jk extends hk{constructor(){super(KA.WRITE_CALCULATED_LANGUAGE,WA.$type),this.language=this.value.pipe(iI((e=>!!e)),zE((e=>{var t;return null===(t=e.language)||void 0===t?void 0:t.code}))),this.isAutoDetected=this.value.pipe(iI((e=>!!e)),zE((e=>e.origin===HI.LANGUAGE_DETECTION)))}updateLanguage(e){return super.set({$type:WA.$type,language:{$type:JA.$type,code:e},origin:HI.REQUESTED_LANGUAGE})}}class zk extends pk{constructor(){super(...arguments),this.sourceTextUnitAnnotations=this.registerAnnotation(new sk(KI.$type,{requiresTransformation:!0})),this.languages=this.registerProperty(new Bk),this.requestedLanguage=this.registerProperty(new Hk),this.calculatedLanguage=this.registerProperty(new Jk),this.maximumTextLengthProperty=this.registerProperty(new mk),this.unsupportedLanguageProperty=this.registerProperty(new yk)}}class Yk extends hk{constructor(){super(KA.WRITE_STYLE_VARIANTS,BA.$type),this.styleVariants=this.value.pipe(zE((e=>{var t;return null!==(t=null==e?void 0:e.styleVariants.map((e=>e.value)))&&void 0!==t?t:[]})))}}class Xk extends hk{constructor(){super(KA.WRITE_STYLE_VARIANT,HA.$type),this.styleVariant=this.value.pipe(zE((e=>null==e?void 0:e.styleVariant)))}updateStyleVariant(e){return super.set({$type:HA.$type,styleVariant:{$type:zA.$type,value:e}})}}class Kk extends pk{constructor(){super(...arguments),this.targetTextUnitAnnotations=this.registerAnnotation(new sk(KI.$type,{requiresTransformation:!0})),this.styleVariantsProperty=this.registerProperty(new Yk),this.styleVariantProperty=this.registerProperty(new Xk),this.maximumTextLengthProperty=this.registerProperty(new mk)}}class Qk extends tk{constructor(){super(...arguments),this.sourceTextField=this.registerField(new zk(XA.WRITE_SOURCE_TEXT)),this.targetTextField=this.registerField(new Kk(XA.WRITE_TARGET_TEXT)),this.textUnitAnnotations=nI([this.sourceTextField.sourceTextUnitAnnotations.annotations,this.targetTextField.targetTextUnitAnnotations.annotations]).pipe(zE((e=>{const t=e[0],n=e[1];return t.sort(((e,t)=>e.operation.range.start-t.operation.range.start)).map((e=>{var t,r;const o=e.operation.range,s=null!==(r=null===(t=n.find((t=>{var n,r;return(null===(n=e.specificPayload.textUnitId)||void 0===n?void 0:n.value)===(null===(r=t.specificPayload.textUnitId)||void 0===r?void 0:r.value)})))||void 0===t?void 0:t.operation.range)&&void 0!==r?r:WI.fromJSON({});return{sourceStart:o.start,sourceEnd:o.end,sourceLength:o.end-o.start,targetStart:s.start,targetEnd:s.end,targetLength:s.end-s.start}}))})))}}class Zk extends FR{constructor(){super("Write",QA.WRITE,new Qk)}updateSourceText(e){const t=this.document.sourceTextField.update(e);this.publishChange(XA.WRITE_SOURCE_TEXT,t)}updateTargetText(e){const t=this.document.targetTextField.update(e);this.publishChange(XA.WRITE_TARGET_TEXT,t)}updateRequestedLanguage(e){const t=this.document.sourceTextField.requestedLanguage.updateLanguage(e);this.publishChange(XA.WRITE_TARGET_TEXT,t)}updateStyleVariant(e){const t=this.document.targetTextField.styleVariantProperty.updateStyleVariant(e);this.publishChange(XA.WRITE_TARGET_TEXT,t)}}class eC{constructor(e,t){this.serverUrl=e;const n=new URL(e);n.pathname+="/sessions",this.accessTokenSubject=new oE(t);const r=(new kb).withHubProtocol(new hw({extensionCodec:CR()})).configureLogging(FT.Critical);t?r.withUrl(n.toString(),{accessTokenFactory:()=>this.accessTokenSubject.value}):r.withUrl(n.toString()),this.connection=r.build()}createSession(e,t,n){const r=Object.assign(Object.assign({},{enableTranscription:!1}),n);return new Wk(this.connection,Object.assign({accessToken:this.accessTokenSubject.pipe(iI((e=>"string"==typeof e)))},r),e,t)}updateAccessToken(e){this.accessTokenSubject.next(e)}}const tC="ITA_RATE_LIMITED",nC="ITA_RATE_LIMITED_RESTRICTED",rC="800_rate_limited",oC="801_rate_limited_restricted",sC="1600_session_ended_authentication_token_expired",iC=e=>{if(e instanceof Vk)return!0;const t=e.info;return t.statusCode===DI.UNAUTHENTICATED&&t.detailCode.value===sC},aC=e=>{if(e instanceof Vk)return!1;const t=e.info;if(t.statusCode===DI.RESOURCE_EXHAUSTED)switch(t.detailCode.value){case rC:case oC:return!0;default:return!1}return!1},cC=e=>{switch(e.info.detailCode.value){case rC:return tC;case oC:return nC;default:return}},lC=e=>{if(1!==e.length)for(let t=e.length-2;t>=0;--t){const n=e[t];if("metaInfoMessage"in n&&n?.metaInfoMessage?.idle)return;if("appendMessage"in n)return n}},uC={TEXT_CHANGE:"textChange",TARGET_LANGUAGE_CHANGE:"targetLanguageChange",FORMALITY_CHANGE:"formalityChange"},dC="translatorRequestedTargetLanguageValue",pC="translatorFormalityModeValue",hC=e=>{if(e.textChangeOperation)return uC.TEXT_CHANGE;if(e.setPropertyOperation){if(dC in e.setPropertyOperation)return uC.TARGET_LANGUAGE_CHANGE;if(pC in e.setPropertyOperation)return uC.FORMALITY_CHANGE}},fC={},gC=(e,t)=>{fC[e]||(fC[e]={}),fC[e]={...fC[e],...t}},mC=e=>fC[e]??{};function yC(e){e.name in fC&&delete fC[e.name]}const _C={},vC=(e,t)=>{_C[e]||(_C[e]={}),_C[e]={..._C[e],...t}},SC=e=>_C[e]??{};function TC(e){e.name in _C&&delete _C[e.name]}const bC={ITA_REQUEST_TRANSLATION:"ITA_REQUEST_TRANSLATION",ITA_CLOSE_TRANSLATION_SESSION:"ITA_CLOSE_TRANSLATION_SESSION",ITA_REQUEST_WRITE:"ITA_REQUEST_WRITE",ITA_WRITE_UPDATE_SOURCE_TEXT:"ITA_WRITE_UPDATE_SOURCE_TEXT",ITA_RESTORE_TRANSLATE_SESSION:"ITA_RESTORE_TRANSLATE_SESSION",ITA_SOURCE_LANGUAGE:"ITA_SOURCE_LANGUAGE",ITA_SOURCE_LANGUAGE_IS_AUTO_DETECTED:"ITA_SOURCE_LANGUAGE_IS_AUTO_DETECTED",ITA_TARGET_TEXT_FIELD:"ITA_TARGET_TEXT_FIELD",ITA_WRITE_TARGET_TEXT_FIELD:"ITA_WRITE_TARGET_TEXT_FIELD",ITA_UPDATE_FORMALITY:"ITA_UPDATE_FORMALITY",ITA_UPDATE_TARGET_LANGUAGE:"ITA_UPDATE_TARGET_LANGUAGE",ERROR:"ERROR",ITA_DOCUMENT_STATE:"ITA_DOCUMENT_STATE",ITA_WRITE_DOCUMENT_STATE:"ITA_WRITE_DOCUMENT_STATE",ITA_WRITE_UPDATE_REQUESTED_LANGUAGE:"ITA_WRITE_UPDATE_REQUESTED_LANGUAGE",ITA_WRITE_UPDATE_STYLE_VARIANT:"ITA_WRITE_UPDATE_STYLE_VARIANT",ITA_RESTORE_WRITE_SESSION:"ITA_RESTORE_WRITE_SESSION",ITA_RATE_LIMITED:"ITA_RATE_LIMITED"},wC={};async function EC({sourceText:e,targetLanguage:t,port:n,itaDocumentState:r,domainName:o}){delete wC[n.name];const s=await Z_(),i=await M_(),a=Pg(i,P.TRANSLATOR)?{dapApi:"https://s.deepl.com/chrome/statistics",toolingApiPro:"https://api.deepl.com/jsonrpc?client=chrome-extension,1.28.2",toolingApi:"https://www2.deepl.com/jsonrpc?client=chrome-extension,1.28.2",toolingWriteApiPro:"https://write-pro.www.deepl.com/jsonrpc?client=chrome-extension,1.28.2",toolingWriteApi:"https://write-free.www.deepl.com/jsonrpc?client=chrome-extension,1.28.2",classicApi:"https://www2.deepl.com/jsonrpc?client=chrome-extension,1.28.2",classicApiPro:"https://api.deepl.com/jsonrpc?client=chrome-extension,1.28.2",classicApiWrite:"https://write-free.www.deepl.com/jsonrpc?client=chrome-extension,1.28.2",classicApiWritePro:"https://write-pro.www.deepl.com/jsonrpc?client=chrome-extension,1.28.2",classicApiGlossary:"https://api.deepl.com/termbases/jsonrpc?client=chrome-extension,1.28.2",login:"https://www.deepl.com/auth/login",token:"https://w.deepl.com/oidc/token",logout:"https://www.deepl.com/auth/logout",feedbackSurvey:"https://deepl.typeform.com/to/MkMfP2Y6",newFeedbackSurvey:"https://deepl.qualtrics.com/jfe/form/SV_cMvbeX0WZGvkKGi",firefoxFeedbackSurvey:"https://deepl.qualtrics.com/jfe/form/SV_eyfDZqQmXuNTFOK",uninstallSurvey:"https://deepl.qualtrics.com/jfe/form/SV_eJxAD8c7J5hqSRU",gslidesFeedbackSurvey:"https://deepl.qualtrics.com/jfe/form/SV_9XBLSAbDmLq5emO",deeplPro:"https://www.deepl.com/pro",deeplProWrite:"https://www.deepl.com/pro-write",deeplTranslator:"https://www.deepl.com/translator",deeplDoctrans:"https://www.deepl.com/translator/files",deeplTermsOfServiceFree:"https://www.deepl.com/en/pro-license?tab=free",deeplCreateAccount:"https://www.deepl.com/signup",extensionStorePage:"https://bit.ly/DeepL-Chrome",supportArticle:"https://support.deepl.com/hc/articles/4407580229522",deeplSupport:"https://support.deepl.com/hc",chromeWebstore:"https://chrome.google.com/webstore/detail/deepl-translate-reading-w/cofdbpoegempjloogbagkncekinflcnj",edgeWebstore:"https://microsoftedge.microsoft.com/addons/detail/deepl-translate-reading-/fancfknaplihpclbhbpclnmmjcjanbaf",firefoxWebstore:"https://addons.mozilla.org/en-US/firefox/addon/deepl-translate",firefoxShortcutDocs:"https://support.mozilla.org/kb/manage-extension-shortcuts-firefox",firefoxPrivacyPolicy:"https://addons.mozilla.org/en-US/firefox/addon/deepl-translate/privacy/",clientStateApi:"https://w.deepl.com/web",experimentsEndpoint:"https://experimentation.deepl.com/experiments",gmailFeedbackSurvey:"https://deepl.qualtrics.com/jfe/form/SV_db8ItFTmYBcZjYW",customerSegmentationSurveyFree:"https://deepl.qualtrics.com/jfe/form/SV_3LbBcdg4mjQuCCq?desc=TG-2071",customerSegmentationSurveyPro:"https://deepl.qualtrics.com/jfe/form/SV_3LbBcdg4mjQuCCq?desc=TG-2070",arabicSurvey:"https://deepl.qualtrics.com/jfe/form/SV_ekTrC2ePp0wn7xQ",msAddinsDeepLAds:"https://www.deepl.com/en/microsoft-365"}.interactiveTextApiPro:{dapApi:"https://s.deepl.com/chrome/statistics",toolingApiPro:"https://api.deepl.com/jsonrpc?client=chrome-extension,1.28.2",toolingApi:"https://www2.deepl.com/jsonrpc?client=chrome-extension,1.28.2",toolingWriteApiPro:"https://write-pro.www.deepl.com/jsonrpc?client=chrome-extension,1.28.2",toolingWriteApi:"https://write-free.www.deepl.com/jsonrpc?client=chrome-extension,1.28.2",classicApi:"https://www2.deepl.com/jsonrpc?client=chrome-extension,1.28.2",classicApiPro:"https://api.deepl.com/jsonrpc?client=chrome-extension,1.28.2",classicApiWrite:"https://write-free.www.deepl.com/jsonrpc?client=chrome-extension,1.28.2",classicApiWritePro:"https://write-pro.www.deepl.com/jsonrpc?client=chrome-extension,1.28.2",classicApiGlossary:"https://api.deepl.com/termbases/jsonrpc?client=chrome-extension,1.28.2",login:"https://www.deepl.com/auth/login",token:"https://w.deepl.com/oidc/token",logout:"https://www.deepl.com/auth/logout",feedbackSurvey:"https://deepl.typeform.com/to/MkMfP2Y6",newFeedbackSurvey:"https://deepl.qualtrics.com/jfe/form/SV_cMvbeX0WZGvkKGi",firefoxFeedbackSurvey:"https://deepl.qualtrics.com/jfe/form/SV_eyfDZqQmXuNTFOK",uninstallSurvey:"https://deepl.qualtrics.com/jfe/form/SV_eJxAD8c7J5hqSRU",gslidesFeedbackSurvey:"https://deepl.qualtrics.com/jfe/form/SV_9XBLSAbDmLq5emO",deeplPro:"https://www.deepl.com/pro",deeplProWrite:"https://www.deepl.com/pro-write",deeplTranslator:"https://www.deepl.com/translator",deeplDoctrans:"https://www.deepl.com/translator/files",deeplTermsOfServiceFree:"https://www.deepl.com/en/pro-license?tab=free",deeplCreateAccount:"https://www.deepl.com/signup",extensionStorePage:"https://bit.ly/DeepL-Chrome",supportArticle:"https://support.deepl.com/hc/articles/4407580229522",deeplSupport:"https://support.deepl.com/hc",chromeWebstore:"https://chrome.google.com/webstore/detail/deepl-translate-reading-w/cofdbpoegempjloogbagkncekinflcnj",edgeWebstore:"https://microsoftedge.microsoft.com/addons/detail/deepl-translate-reading-/fancfknaplihpclbhbpclnmmjcjanbaf",firefoxWebstore:"https://addons.mozilla.org/en-US/firefox/addon/deepl-translate",firefoxShortcutDocs:"https://support.mozilla.org/kb/manage-extension-shortcuts-firefox",firefoxPrivacyPolicy:"https://addons.mozilla.org/en-US/firefox/addon/deepl-translate/privacy/",clientStateApi:"https://w.deepl.com/web",experimentsEndpoint:"https://experimentation.deepl.com/experiments",gmailFeedbackSurvey:"https://deepl.qualtrics.com/jfe/form/SV_db8ItFTmYBcZjYW",customerSegmentationSurveyFree:"https://deepl.qualtrics.com/jfe/form/SV_3LbBcdg4mjQuCCq?desc=TG-2071",customerSegmentationSurveyPro:"https://deepl.qualtrics.com/jfe/form/SV_3LbBcdg4mjQuCCq?desc=TG-2070",arabicSurvey:"https://deepl.qualtrics.com/jfe/form/SV_ekTrC2ePp0wn7xQ",msAddinsDeepLAds:"https://www.deepl.com/en/microsoft-365"}.interactiveTextApiFree,c=new eC(a,s),u=new Mk,d=c.createSession(u);await d.connect(r);gC(n.name,{session:d,updateAccessToken:e=>{c.updateAccessToken(e)}}),Ag()&&console.log("ITA session ID:",d.startSessionResponse?.sessionId?.value);const p=d.client;gC(n.name,{domainName:o}),t&&p.updateRequestedTargetLanguage(bg(t)),e&&p.updateSourceText(e),function(e,t){const n=e.client,r=[];e.connection.onclose((()=>{for(const e of r)e.unsubscribe()})),r.push(e.error.subscribe((e=>{!function(e,t){wC[t.name]=e,e instanceof qk&&(Ag()&&console.log(`ITA session error, Type ${typeof e},\n        Code: ${e.info?.statusCode}; Detail Code: ${e.info?.detailCode?.value}; Fallback Codes: ${e.info?.fallbackDetailCodes.map((e=>e.value)).join(", ")}`),aC(e)&&function(e,t){const n=cC(e);if(!n)return void(Ag()&&console.error(`Received a rate limiting error, but couldn't determine the corresponding internal error: ${e}`));t.postMessage({type:bC.ITA_RATE_LIMITED,payload:{warning:n}})}(e,t),Gm({errorCode:e.name,errorMessage:e.message,domainName:mC(t.name).domainName,targetLang:mC(t.name).targetLanguage,websiteLanguage:mC(t.name).sourceLanguage,trigger:l.input,characterCount:mC(t.name)?.sourceText?.length}))}(e,t)}))),r.push(e.messages.subscribe((async e=>{const n=e[e.length-1];if(!("metaInfoMessage"in n)||!n.metaInfoMessage?.idle)return;const r=lC(e);if(!r?.appendMessage)return;const o=r.appendMessage.events[r.appendMessage.events.length-1],s=hC(o);if(s&&(s===uC.TEXT_CHANGE||s===uC.TARGET_LANGUAGE_CHANGE||s===uC.FORMALITY_CHANGE)){if(!mC(t.name).sourceLanguage)return;xC(t)}}))),r.push(n.document.targetTextField.content.subscribe((e=>{kC(n,t),t.postMessage({type:bC.ITA_TARGET_TEXT_FIELD,payload:{targetText:e}}),gC(t.name,{translatedText:e})}))),r.push(n.document.sourceTextField.content.subscribe((e=>{gC(t.name,{sourceText:e})}))),r.push(n.document.targetTextField.requestedTargetLanguageProperty.value.subscribe((e=>{gC(t.name,{targetLanguage:e?.targetLanguage?.code})}))),r.push(n.document.sourceTextField.calculatedSourceLanguageProperty.language.subscribe((e=>{const r=mC(t.name).sourceLanguage;kC(n,t),gC(t.name,{sourceLanguage:e}),t.postMessage({type:bC.ITA_SOURCE_LANGUAGE,payload:{language:e}}),r!==e&&xC(t)}))),r.push(n.document.sourceTextField.calculatedSourceLanguageProperty.isAutoDetected.subscribe((e=>{kC(n,t),gC(t.name,{isSourceLanguageAutoDetected:e}),t.postMessage({type:bC.ITA_SOURCE_LANGUAGE_IS_AUTO_DETECTED,payload:{isAutoDetected:e}})})))}(d,n)}async function IC(e){if(e.name in wC){const t=wC[e.name];Ag()&&console.log("Detected error for session so will attempt to restore",t);const n={...mC(e.name)};delete wC[e.name];const r=async()=>{try{return await async function(e,t){Ag()&&console.log(`Attempting to recreate an ITA session for port ${t.name}`);await e.session.connection.stop(),await EC({...e,itaDocumentState:e.session.client.document.serialize(),port:t,sourceText:void 0})}(n,e),mC(e.name).session.client??null}catch(e){return console.error(`Unable to recreate ITA session, Error: ${e}`),null}};if(iC(t))return await r();try{await async function(e,t){Ag()&&console.log(`Attempting to restore ITA session for port ${t.name}`);const n=await e.restore();await n.connect(),gC(t.name,{session:n})}(n.session,e)}catch(e){return console.error(`Unable to restore ITA session, Error: ${e}. Attempting to recreate session instead`),await r()}}const t=await Z_();return mC(e.name).updateAccessToken(t),mC(e.name).session.client??null}async function AC({port:e,language:t}){const n=await IC(e);n&&(n.updateRequestedTargetLanguage(bg(t)),gC(e.name,{targetLanguage:t}))}async function RC(e,t){const n=await IC(e);if(!n)return;const r={value:t,$type:"deepl.pb.interactive_text_api.translator.FormalityMode"};n.updateFormalityMode(r)}function kC(e,t){t.postMessage({type:bC.ITA_DOCUMENT_STATE,payload:{itaDocumentState:e.document.serialize()}})}async function CC(e){const t=mC(e.name).session;await t.connection.stop(),delete wC[e.name],yC(e),Ag()&&console.log(`Disposed translate session for port ${e.name}`)}const xC=async e=>{const t=mC(e.name);t.sourceLanguage&&await Promise.allSettled([Fm({installationId:await f_(["installationId"]),trigger:l.input,websiteLanguage:t.sourceLanguage,targetLanguage:t.targetLanguage,characterCount:t.sourceText?.length,domainName:t.domainName,isIta:!0}),$S(t.sourceLanguage,t.targetLanguage)])},OC=e=>{TC(e),yC(e)},LC={};async function NC({sourceText:e,requestedLanguage:t,port:n,itaDocumentState:r,domainName:o}){const s=await Z_(),i=await M_(),a=Pg(i,P.WRITE)?{dapApi:"https://s.deepl.com/chrome/statistics",toolingApiPro:"https://api.deepl.com/jsonrpc?client=chrome-extension,1.28.2",toolingApi:"https://www2.deepl.com/jsonrpc?client=chrome-extension,1.28.2",toolingWriteApiPro:"https://write-pro.www.deepl.com/jsonrpc?client=chrome-extension,1.28.2",toolingWriteApi:"https://write-free.www.deepl.com/jsonrpc?client=chrome-extension,1.28.2",classicApi:"https://www2.deepl.com/jsonrpc?client=chrome-extension,1.28.2",classicApiPro:"https://api.deepl.com/jsonrpc?client=chrome-extension,1.28.2",classicApiWrite:"https://write-free.www.deepl.com/jsonrpc?client=chrome-extension,1.28.2",classicApiWritePro:"https://write-pro.www.deepl.com/jsonrpc?client=chrome-extension,1.28.2",classicApiGlossary:"https://api.deepl.com/termbases/jsonrpc?client=chrome-extension,1.28.2",login:"https://www.deepl.com/auth/login",token:"https://w.deepl.com/oidc/token",logout:"https://www.deepl.com/auth/logout",feedbackSurvey:"https://deepl.typeform.com/to/MkMfP2Y6",newFeedbackSurvey:"https://deepl.qualtrics.com/jfe/form/SV_cMvbeX0WZGvkKGi",firefoxFeedbackSurvey:"https://deepl.qualtrics.com/jfe/form/SV_eyfDZqQmXuNTFOK",uninstallSurvey:"https://deepl.qualtrics.com/jfe/form/SV_eJxAD8c7J5hqSRU",gslidesFeedbackSurvey:"https://deepl.qualtrics.com/jfe/form/SV_9XBLSAbDmLq5emO",deeplPro:"https://www.deepl.com/pro",deeplProWrite:"https://www.deepl.com/pro-write",deeplTranslator:"https://www.deepl.com/translator",deeplDoctrans:"https://www.deepl.com/translator/files",deeplTermsOfServiceFree:"https://www.deepl.com/en/pro-license?tab=free",deeplCreateAccount:"https://www.deepl.com/signup",extensionStorePage:"https://bit.ly/DeepL-Chrome",supportArticle:"https://support.deepl.com/hc/articles/4407580229522",deeplSupport:"https://support.deepl.com/hc",chromeWebstore:"https://chrome.google.com/webstore/detail/deepl-translate-reading-w/cofdbpoegempjloogbagkncekinflcnj",edgeWebstore:"https://microsoftedge.microsoft.com/addons/detail/deepl-translate-reading-/fancfknaplihpclbhbpclnmmjcjanbaf",firefoxWebstore:"https://addons.mozilla.org/en-US/firefox/addon/deepl-translate",firefoxShortcutDocs:"https://support.mozilla.org/kb/manage-extension-shortcuts-firefox",firefoxPrivacyPolicy:"https://addons.mozilla.org/en-US/firefox/addon/deepl-translate/privacy/",clientStateApi:"https://w.deepl.com/web",experimentsEndpoint:"https://experimentation.deepl.com/experiments",gmailFeedbackSurvey:"https://deepl.qualtrics.com/jfe/form/SV_db8ItFTmYBcZjYW",customerSegmentationSurveyFree:"https://deepl.qualtrics.com/jfe/form/SV_3LbBcdg4mjQuCCq?desc=TG-2071",customerSegmentationSurveyPro:"https://deepl.qualtrics.com/jfe/form/SV_3LbBcdg4mjQuCCq?desc=TG-2070",arabicSurvey:"https://deepl.qualtrics.com/jfe/form/SV_ekTrC2ePp0wn7xQ",msAddinsDeepLAds:"https://www.deepl.com/en/microsoft-365"}.interactiveTextApiPro:{dapApi:"https://s.deepl.com/chrome/statistics",toolingApiPro:"https://api.deepl.com/jsonrpc?client=chrome-extension,1.28.2",toolingApi:"https://www2.deepl.com/jsonrpc?client=chrome-extension,1.28.2",toolingWriteApiPro:"https://write-pro.www.deepl.com/jsonrpc?client=chrome-extension,1.28.2",toolingWriteApi:"https://write-free.www.deepl.com/jsonrpc?client=chrome-extension,1.28.2",classicApi:"https://www2.deepl.com/jsonrpc?client=chrome-extension,1.28.2",classicApiPro:"https://api.deepl.com/jsonrpc?client=chrome-extension,1.28.2",classicApiWrite:"https://write-free.www.deepl.com/jsonrpc?client=chrome-extension,1.28.2",classicApiWritePro:"https://write-pro.www.deepl.com/jsonrpc?client=chrome-extension,1.28.2",classicApiGlossary:"https://api.deepl.com/termbases/jsonrpc?client=chrome-extension,1.28.2",login:"https://www.deepl.com/auth/login",token:"https://w.deepl.com/oidc/token",logout:"https://www.deepl.com/auth/logout",feedbackSurvey:"https://deepl.typeform.com/to/MkMfP2Y6",newFeedbackSurvey:"https://deepl.qualtrics.com/jfe/form/SV_cMvbeX0WZGvkKGi",firefoxFeedbackSurvey:"https://deepl.qualtrics.com/jfe/form/SV_eyfDZqQmXuNTFOK",uninstallSurvey:"https://deepl.qualtrics.com/jfe/form/SV_eJxAD8c7J5hqSRU",gslidesFeedbackSurvey:"https://deepl.qualtrics.com/jfe/form/SV_9XBLSAbDmLq5emO",deeplPro:"https://www.deepl.com/pro",deeplProWrite:"https://www.deepl.com/pro-write",deeplTranslator:"https://www.deepl.com/translator",deeplDoctrans:"https://www.deepl.com/translator/files",deeplTermsOfServiceFree:"https://www.deepl.com/en/pro-license?tab=free",deeplCreateAccount:"https://www.deepl.com/signup",extensionStorePage:"https://bit.ly/DeepL-Chrome",supportArticle:"https://support.deepl.com/hc/articles/4407580229522",deeplSupport:"https://support.deepl.com/hc",chromeWebstore:"https://chrome.google.com/webstore/detail/deepl-translate-reading-w/cofdbpoegempjloogbagkncekinflcnj",edgeWebstore:"https://microsoftedge.microsoft.com/addons/detail/deepl-translate-reading-/fancfknaplihpclbhbpclnmmjcjanbaf",firefoxWebstore:"https://addons.mozilla.org/en-US/firefox/addon/deepl-translate",firefoxShortcutDocs:"https://support.mozilla.org/kb/manage-extension-shortcuts-firefox",firefoxPrivacyPolicy:"https://addons.mozilla.org/en-US/firefox/addon/deepl-translate/privacy/",clientStateApi:"https://w.deepl.com/web",experimentsEndpoint:"https://experimentation.deepl.com/experiments",gmailFeedbackSurvey:"https://deepl.qualtrics.com/jfe/form/SV_db8ItFTmYBcZjYW",customerSegmentationSurveyFree:"https://deepl.qualtrics.com/jfe/form/SV_3LbBcdg4mjQuCCq?desc=TG-2071",customerSegmentationSurveyPro:"https://deepl.qualtrics.com/jfe/form/SV_3LbBcdg4mjQuCCq?desc=TG-2070",arabicSurvey:"https://deepl.qualtrics.com/jfe/form/SV_ekTrC2ePp0wn7xQ",msAddinsDeepLAds:"https://www.deepl.com/en/microsoft-365"}.interactiveTextApiFree,c=new eC(a,s),l=new Zk,u=c.createSession(l);await u.connect(r);vC(n.name,{session:u,updateAccessToken:e=>{c.updateAccessToken(e)}}),Ag()&&console.log("ITA session ID:",u.startSessionResponse?.sessionId?.value),u.error.subscribe((e=>{!function(e,t){LC[t.name]=e,e instanceof qk&&Ag()&&console.log(`ITA session error, Type ${typeof e},\n        Code: ${e.info?.statusCode}; Detail Code: ${e.info?.detailCode?.value}; Fallback Codes: ${e.info?.fallbackDetailCodes.map((e=>e.value)).join(", ")}`)}(e,n)}));const d=u.client;vC(n.name,{domainName:o}),t&&d.updateRequestedLanguage(bg(t)),e&&d.updateSourceText(e),function(e,t){e.document.targetTextField.content.subscribe((async n=>{!function(e,t){t.postMessage({type:bC.ITA_WRITE_DOCUMENT_STATE,payload:{itaDocumentState:e.document.serialize()}})}(e,t),t.postMessage({type:bC.ITA_WRITE_TARGET_TEXT_FIELD,payload:{targetText:n}}),vC(t.name,{translatedText:n})})),e.document.sourceTextField.content.subscribe((e=>{vC(t.name,{sourceText:e})}))}(d,n)}async function PC(e){if(e.name in LC){Ag()&&console.log("Detected error for session so will attempt to restore",LC[e.name]),delete LC[e.name];try{await async function(e,t){try{Ag()&&console.log(`Attempting to restore ITA session for port ${t.name}`);const n=await e.restore();await n.connect(),vC(t.name,{session:n})}catch(e){console.error(`Unable to restore ITA session, Error: ${e}`)}}(SC(e.name).session,e)}catch(e){console.error(`Unable to restore ITA session, Error: ${e}`)}}const t=await Z_();return SC(e.name).updateAccessToken?.(t),SC(e.name).session.client??null}async function DC({port:e,language:t}){(await PC(e)).updateRequestedLanguage(bg(t)),vC(e.name,{targetLanguage:t})}async function MC(e,t){(await PC(e)).updateStyleVariant(t)}async function UC(e,t){(await PC(e)).updateSourceText(t)}const $C={syncExperiments:"sync_experiments",syncClientState:"sync_client_state"};function FC(e){let t;try{t=new URL(e)}catch(e){return!1}return"http:"===t.protocol||"https:"===t.protocol}const jC={developer_tools:"DEVELOPER_TOOLS",settings_page:"SETTINGS_PAGE",settings_writing:"SETTINGS_WRITING",settings_reading:"SETTINGS_READING",settings_customizations:"SETTINGS_CUSTOMIZATIONS",settings_glossary:"SETTINGS_GLOSSARY",onboarding:"ONBOARDING",onboarding_after_successful_login:"ONBOARDING_AFTER_SUCCESSFUL_LOGIN",firefox_first_run:"FIREFOX_FIRST_RUN",privacy_policy:"PRIVACY_POLICY",create_account:"CREATE_ACCOUNT"},GC={DEVELOPER_TOOLS:"dev-page.html",SETTINGS_PAGE:"settings.html",SETTINGS_READING:"settings.html#translator",SETTINGS_WRITING:"settings.html#write",SETTINGS_CUSTOMIZATIONS:"settings.html#customizations",SETTINGS_GLOSSARY:"settings.html#glossary",ONBOARDING:"onboarding.html",ONBOARDING_FIREFOX:"onboarding-firefox.html",ONBOARDING_AFTER_SUCCESSFUL_LOGIN:"onboarding.html#successful_login",FIREFOX_FIRST_RUN:"firefox-first-run.html",PRIVACY_POLICY:"privacy-policy.html",CREATE_ACCOUNT:"create-account.html"};function VC({payload:e}){const{destination:t,openInSameTab:n}=e;if(void 0===t)return;let r="";switch(t){case jC.developer_tools:r=qC(GC.DEVELOPER_TOOLS);break;case jC.settings_page:r=qC(GC.SETTINGS_PAGE);break;case jC.settings_writing:r=qC(GC.SETTINGS_WRITING);break;case jC.settings_reading:r=qC(GC.SETTINGS_READING);break;case jC.settings_customizations:r=qC(GC.SETTINGS_CUSTOMIZATIONS);break;case jC.settings_glossary:r=qC(GC.SETTINGS_GLOSSARY);break;case jC.onboarding:r=Y()?qC(GC.ONBOARDING_FIREFOX):qC(GC.ONBOARDING);break;case jC.onboarding_after_successful_login:r=qC(GC.ONBOARDING_AFTER_SUCCESSFUL_LOGIN);break;case jC.firefox_first_run:r=qC(GC.FIREFOX_FIRST_RUN);break;case jC.privacy_policy:r=qC(GC.PRIVACY_POLICY);break;case jC.create_account:r=qC(GC.CREATE_ACCOUNT)}r&&(n?chrome.tabs.query({active:!0,currentWindow:!0},(function(e){const t=e[0];chrome.tabs.update(t.id,{url:r})})):chrome.tabs.create({url:r,active:!0}))}function qC(e){const t=new URL(chrome.runtime.getURL(e));return t.searchParams.append("dl_brex_internal_page","true"),t.toString()}async function WC({request:e,port:t}){try{const n={nicheIntegration:e.nicheIntegration||k.default,sourceTexts:[e.sourceText],isWriteRequest:!1};await Mv(n),await EC({sourceText:e.sourceText,targetLanguage:e.targetLanguage,domainName:e.domainName,port:t}),Ag()&&console.log(`ITA Translator session created for sender: ${t.sender?.tab?.url}, tab ID: ${t.sender?.tab?.id}}`)}catch(n){throw Ag()&&console.error(`Error creating ITA Translator session for sender: ${t.sender?.tab?.url}, tab ID: ${t.sender?.tab?.id}}`,n),Gm({errorCode:n.name,errorMessage:n.message,domainName:e.domainName,targetLang:e.targetLanguage,websiteLanguage:e.websiteLanguage,trigger:e.trigger,characterCount:e.sourceText.length}),n}}async function BC({request:e,port:t}){try{const n={nicheIntegration:e.nicheIntegration||k.default,sourceTexts:[e.sourceText],isWriteRequest:!0};await Mv(n),await NC({sourceText:e.sourceText,requestedLanguage:e.requestedLanguage,domainName:e.domainName,port:t}),Ag()&&console.log(`ITA Write session created for sender: ${t.sender?.tab?.url}, tab ID: ${t.sender?.tab?.id}}`)}catch(e){throw Ag()&&console.error(`Error creating ITA Write session for sender: ${t.sender?.tab?.url}, tab ID: ${t.sender?.tab?.id}}`,e),e}}function HC(e,t,n){switch(Ag()&&!{IS_PROD:!0,BASE_URLS:{dapApi:"https://s.deepl.com/chrome/statistics",toolingApiPro:"https://api.deepl.com/jsonrpc?client=chrome-extension,1.28.2",toolingApi:"https://www2.deepl.com/jsonrpc?client=chrome-extension,1.28.2",toolingWriteApiPro:"https://write-pro.www.deepl.com/jsonrpc?client=chrome-extension,1.28.2",toolingWriteApi:"https://write-free.www.deepl.com/jsonrpc?client=chrome-extension,1.28.2",classicApi:"https://www2.deepl.com/jsonrpc?client=chrome-extension,1.28.2",classicApiPro:"https://api.deepl.com/jsonrpc?client=chrome-extension,1.28.2",classicApiWrite:"https://write-free.www.deepl.com/jsonrpc?client=chrome-extension,1.28.2",classicApiWritePro:"https://write-pro.www.deepl.com/jsonrpc?client=chrome-extension,1.28.2",classicApiGlossary:"https://api.deepl.com/termbases/jsonrpc?client=chrome-extension,1.28.2",login:"https://www.deepl.com/auth/login",token:"https://w.deepl.com/oidc/token",logout:"https://www.deepl.com/auth/logout",feedbackSurvey:"https://deepl.typeform.com/to/MkMfP2Y6",newFeedbackSurvey:"https://deepl.qualtrics.com/jfe/form/SV_cMvbeX0WZGvkKGi",firefoxFeedbackSurvey:"https://deepl.qualtrics.com/jfe/form/SV_eyfDZqQmXuNTFOK",uninstallSurvey:"https://deepl.qualtrics.com/jfe/form/SV_eJxAD8c7J5hqSRU",gslidesFeedbackSurvey:"https://deepl.qualtrics.com/jfe/form/SV_9XBLSAbDmLq5emO",deeplPro:"https://www.deepl.com/pro",deeplProWrite:"https://www.deepl.com/pro-write",deeplTranslator:"https://www.deepl.com/translator",deeplDoctrans:"https://www.deepl.com/translator/files",deeplTermsOfServiceFree:"https://www.deepl.com/en/pro-license?tab=free",deeplCreateAccount:"https://www.deepl.com/signup",extensionStorePage:"https://bit.ly/DeepL-Chrome",supportArticle:"https://support.deepl.com/hc/articles/4407580229522",deeplSupport:"https://support.deepl.com/hc",chromeWebstore:"https://chrome.google.com/webstore/detail/deepl-translate-reading-w/cofdbpoegempjloogbagkncekinflcnj",edgeWebstore:"https://microsoftedge.microsoft.com/addons/detail/deepl-translate-reading-/fancfknaplihpclbhbpclnmmjcjanbaf",firefoxWebstore:"https://addons.mozilla.org/en-US/firefox/addon/deepl-translate",firefoxShortcutDocs:"https://support.mozilla.org/kb/manage-extension-shortcuts-firefox",firefoxPrivacyPolicy:"https://addons.mozilla.org/en-US/firefox/addon/deepl-translate/privacy/",clientStateApi:"https://w.deepl.com/web",experimentsEndpoint:"https://experimentation.deepl.com/experiments",gmailFeedbackSurvey:"https://deepl.qualtrics.com/jfe/form/SV_db8ItFTmYBcZjYW",customerSegmentationSurveyFree:"https://deepl.qualtrics.com/jfe/form/SV_3LbBcdg4mjQuCCq?desc=TG-2071",customerSegmentationSurveyPro:"https://deepl.qualtrics.com/jfe/form/SV_3LbBcdg4mjQuCCq?desc=TG-2070",arabicSurvey:"https://deepl.qualtrics.com/jfe/form/SV_ekTrC2ePp0wn7xQ",msAddinsDeepLAds:"https://www.deepl.com/en/microsoft-365"},APP_VERSION:"1.28.2",FEATURE_FLAGS:{TRANSLATE_INPUT:!0,PAGE_TRANSLATION:!0,IMPROVE_WRITING:!0,DOCUMENT_TRANSLATION:!0,RECOMMEND_TO_A_FRIEND:!0,PRO_LOGIN:!0,WEBPAGE_CUSTOMIZER:!0,GDOCS_INTEGRATION:!0,ZENDESK_INTEGRATION:!0,GMAIL_INTEGRATION:!0,GSLIDES_INTEGRATION:!0,ON_INSTALL_ONBOARDING:!0,WHATSAPP_TRANSLATE_ALL_CHAT:!1,DEEPL_WRITE_GENERAL:!1,DEEPL_WRITE_GDOCS:!0,SHOW_CUSTOMER_SEGMENTATION_SURVEY:!1,ARABIC_SURVEY:!0,REVIEW_UI_WITH_ITA:!1,BATCH_TRANSLATE_HTML_REQUEST:!1}}.DISABLE_DEBUG_LOGS&&console.log(t.tab?`message from a content script: ${t.tab.url} with tab id: ${t.tab.id}. action: ${e.action}`:`message from the extension with action: ${e.action}`),e.action){case"dlRequestHtmlTranslation":Wv(e).then((e=>n(e))).catch((e=>{n(rm(e,mg))}));break;case"dlRequestInlineTranslation":Bv(e).then((e=>{n(e)})).catch((e=>{n(rm(e,mg))}));break;case"dlTriggerTranslateInline":Vv(t.tab.id),n();break;case"dlRequestInputTranslation":Hv(e).then((e=>n(e))).catch((e=>{n(rm(e,mg))}));break;case"dlRequestZendeskInputTranslation":Jv(e).then((e=>n(e))).catch((e=>{n(rm(e,mg))}));break;case"dlRequestGmailReceivedEmailTranslation":zv(e).then((e=>n(e))).catch((e=>{n(rm(e,mg))}));break;case"dlRequestWhatsAppMessageTranslation":Qv(e).then((e=>n(e))).catch((e=>{n(rm(e,mg))}));break;case"dlRequestTwitterTweetTranslation":Yv(e).then((e=>n(e))).catch((e=>{n(rm(e,mg))}));break;case"dlRequestYouTubeTranslation":Xv(e).then((e=>n(e))).catch((e=>{n(rm(e,mg))}));break;case"dlRequestLinkedInPostTranslation":Kv(e).then((e=>n(e))).catch((e=>{n(rm(e,mg))}));break;case"dlRequestZendeskMessageTranslation":sS(e).then((e=>n(e))).catch((e=>{n(rm(e,mg))}));break;case"dlRequestWhatsAppMessagesTranslation":Zv(e).then((e=>n(e))).catch((e=>{n(rm(e,mg))}));break;case"dlRequestGDocsSplitText":eS(e).then((e=>n(e))).catch((e=>{n(rm(e,mg))}));break;case"dlRequestGDocsProcessContent":tS(e).then((e=>n(e))).catch((e=>{n(rm(e,mg))}));break;case"dlRequestGDocsSentenceAlternatives":nS(e).then((e=>n(e))).catch((e=>{n(rm(e,mg))}));break;case"dlRequestGDocsWordAlternatives":rS(e).then((e=>n(e))).catch((e=>{n(rm(e,mg))}));break;case"dlRequestGDocsSentenceFromPartialTranslation":oS(e).then((e=>n(e))).catch((e=>{n(rm(e,mg))}));break;case"dlRequestTermbases":iS().then((e=>n(e))).catch((e=>{n(rm(e,mg))}));break;case"dlTrackDetectLanguage":aS(e),n();break;case"dlRequestLogin":kS().then((()=>n(!0))).catch((e=>{n(rm(e,mg))}));break;case"dlRequestLogout":CS().then((()=>n(!0))).catch((e=>{n(rm(e,mg))}));break;case"dlGetAppSettings":chrome.storage.sync.get(null,(function(e){n(e)}));break;case"dlUpdateAppSettings":chrome.storage.sync.set(e.payload,(function(){n(e.payload)}));break;case"dlTranslatedInputTextNotSet":Vm({errorCode:Vg,errorMessage:"The translated text could not be set",domainName:e.payload}),n();break;case"dlGetUserState":xS().then((e=>n(e))).catch((e=>{n(rm(e,mg))}));break;case"dlExternalURLRedirect":Z(e.payload),n();break;case"dlOpenInternalPage":VC(e),n();break;case"dlTrackInputTranslationInjection":cS(e.payload),n();break;case"dlTrackExtensionOpenedEvent":lS(e.payload),n();break;case"dlTrackLogoClickedEvent":uS(e.payload),n();break;case"dlTrackDocTransClick":dS(),n();break;case"dlTrackRecommendToAFriendClick":pS(),n();break;case"dlSendNotification":OS(e.payload),n();break;case"dlCheckCommandShortcuts":LS().then((e=>n(e)));break;case"dlTrackUseOfShortcut":NS(e.payload),n();break;case"dlTrackUiAction":PS(e.payload),n();break;case"dlTrackInlineSettingOpened":hS(e.payload),n();break;case"dlTrackSettingChanged":fS(e.payload),n();break;case"dlTrackUILocationClicked":tT(e.payload),n();break;case"dlTrackRightClick":gS(e.payload),n();break;case"dlTrackInlinePositionChange":mS(e.payload),n();break;case"dlTrackInlineDragStart":yS(),n();break;case"dlTrackFptHide":_S(e.payload);break;case"dlTrackInlineCopy":SS(e.payload),n();break;case"dlTrackInlineListen":bS(e.payload),n();break;case"dlTrackIconHover":vS(e.payload),n();break;case"dlTrackVoiceOverStops":wS(e.payload),n();break;case"dlTrackOnboardingStepChange":TS(e.payload),n();break;case"dlTrackOnboardingOpenExternalLink":ES(e.payload),n();break;case"dlTrackReadMore":IS(e.payload),n();break;case"dlTrackLandingOnWebsite":MS(e.payload),n();break;case"dlTrackGDocsReplaceText":AS(e.payload),n();break;case"dlGetExperiments":RS(e.payload?.forceFetch).then((e=>n(e))).catch((e=>n(e)));break;case"dlGetClientState":uT(e.payload?.forceFetch).then((e=>n(e))).catch((e=>n(e)));break;case"dlTextToSpeech":FS(e.payload,t.tab.id).then((()=>n())).catch((e=>{n(rm(e,mg))}));break;case"dlGetDictionary":HS(e.payload).then((e=>n(e))).catch((e=>{n(rm(e,mg))}));break;case"dlGetSupportedVoices":jS(e.payload).then((e=>n(e))).catch((e=>{n(rm(e,mg))}));break;case"dlStopSpeech":GS(e.payload).then((()=>n())).catch((e=>{n(rm(e,mg))}));break;case"dlTrackOpenInputHighlighter":VS(e.payload).then((()=>n())).catch((e=>{n(rm(e,mg))}));break;case"dlTrackOpenInlineHighlighter":qS(e.payload).then((()=>n())).catch((e=>{n(rm(e,mg))}));break;case"dlTrackCloseInputHighlighter":WS(e.payload).then((()=>n())).catch((e=>{n(rm(e,mg))}));break;case"dlTrackCloseInlineHighlighter":BS(e.payload).then((()=>n())).catch((e=>{n(rm(e,mg))}));break;case"dlTrackDictionaryStatus":JS(e.payload).then((()=>n())).catch((e=>{n(rm(e,mg))}));break;case"dlTrackOpenDictionarySection":zS(e.payload).then((()=>n())).catch((e=>{n(rm(e,mg))}));break;case"dlTrackDisabledDictionaryHover":YS(e.payload).then((()=>n())).catch((e=>{n(rm(e,mg))}));break;case"dlTrackZendeskCustomizationEvent":XS(e.payload).then((()=>n())).catch((e=>{n(rm(e,mg))}));break;case"dlTrackZendeskGlossaryOpened":fT(e.payload).then((()=>n())).catch((e=>{n(rm(e,mg))}));break;case"dlTrackGlossaryEnabled":gT(e.payload).then((()=>n())).catch((e=>{n(rm(e,mg))}));break;case"dlTrackGlossaryDisabled":mT(e.payload).then((()=>n())).catch((e=>{n(rm(e,mg))}));break;case"dlTrackDeeplWriteEvent":nT(e.payload).then((()=>n())).catch((e=>{n(rm(e,mg))}));break;case"dlTrackLingueeErrorData":KS(e.payload).then((()=>n())).catch((e=>{n(rm(e,mg))}));break;case"dlTrackGdocsMaxCharExceededShown":QS(e.payload).then((()=>n())).catch((e=>{n(rm(e,mg))}));break;case"dlTrackGDocsMaxCharExceededTryProClicked":ZS(e.payload).then((()=>n())).catch((e=>{n(rm(e,mg))}));break;case"dlTrackOnboardingModalShown":eT(e.payload).then((()=>n())).catch((e=>{n(rm(e,mg))}));break;case"dlRequestImproveWriting":rT(e).then((e=>n(e))).catch((e=>{n(rm(e,mg))}));break;case"dlSplitTextRequest":bT(e).then((e=>n(e))).catch((e=>{n(rm(e))}));break;case"dlRequestAlternatives":wT(e).then((e=>n(e))).catch((e=>{n(rm(e))}));break;case"dlTrackTranslateAcceptOrRevertEvent":oT(e.payload).then((()=>n())).catch((e=>{n(rm(e,mg))}));break;case"dlTrackCustomizationEnabledEvent":sT(e.payload).then((()=>n())).catch((e=>{n(rm(e,mg))}));break;case"dlTrackGmailCharLimitReached":aT(e.payload).then((()=>n())).catch((e=>{n(rm(e,mg))}));break;case"dlGetUsersCharacterLimit":dT().then((e=>n(e))).catch((e=>{n(rm(e,mg))}));break;case"dlTrackAlternativesEvent":lT(e.payload).then((()=>n())).catch((e=>{n(rm(e,mg))}));break;case"dlTestClassicAPI":_T(e.payload).then((e=>n(e))).catch((e=>{n(rm(e,mg))}));break;case"dlOnSuccessfulZendeskTranslation":US();break;case"dlTrackUpgradeNotificationIsDisplayed":pT(e.payload.type);break;case"dlTrackUpgradeNotificationClosed":hT(e.payload.type);break;case"dlTrackUpgradeNotificationAction":yT(e.payload.type,e.payload.cta);break;case"dlTrackLanguageDetectionForTextProcessing":vT(e.payload).finally(n());break;case"dlTrackSeeAlternativesClicked":ST(),n();break;case"dlTrackAlternativeSelected":TT(e.payload),n();break;case"dlTrackIframeTranslationSuccessful":IT(),n();break;case"dlTrackIframeTranslationFailed":AT(e.payload),n();break;case"dlTrackClicksOnAdsButton":RT(),n();break;case"dlTrackAdsShown":kT(e.payload),n()}return!0}function JC(e){switch(console.log(`Command "${e}" triggered`),e){case _.triggerTranslation:chrome.tabs.query({active:!0,currentWindow:!0},(function(e){chrome.tabs.sendMessage(e[0].id,{action:"dlTriggerTranslationShortcut"})}));break;case _.changeLanguage:chrome.tabs.query({active:!0,currentWindow:!0},(function(e){chrome.tabs.sendMessage(e[0].id,{action:"dlChangeLanguageShortcut"})}))}}function zC(e){(async function(){let e=!1;const t=await chrome.storage.sync.get(null),n=wg();if(!t||!t.settingSchemeVersion||t.settingSchemeVersion<n.settingSchemeVersion){let r={};for(const[o,s]of Object.entries(n))o in t&&"settingSchemeVersion"!==o?r[o]=t[o]:("installationId"===o&&(e=!0),r[o]=s);await chrome.storage.sync.clear(),await chrome.storage.sync.set(r),console.log("settings set: ",r)}return{installationIdWasSet:e}})().then((t=>{!async function(e,t){const n=await x_();n||e!==chrome.runtime.OnInstalledReason.INSTALL?n||await C_():(await C_(),vy(),My());t&&Dy()}(e.reason,t.installationIdWasSet)})).catch((e=>jm({errorCode:Gg,errorMessage:`setSettingsAfterInstall failed: ${e.message}`}))).finally((()=>{try{RS(),uT(!0),async function(){await chrome.alarms.clearAll(),await chrome.alarms.create($C.syncExperiments,{delayInMinutes:10,periodInMinutes:10}),await chrome.alarms.create($C.syncClientState,{delayInMinutes:30,periodInMinutes:30})}()}catch(e){console.error(e),jm({errorCode:Gg,errorMessage:e.message})}try{chrome.runtime.setUninstallURL("https://deepl.qualtrics.com/jfe/form/SV_eJxAD8c7J5hqSRU"),e.reason===chrome.runtime.OnInstalledReason.UPDATE&&console.log(`Update from version ${e.previousVersion} to ${chrome.runtime.getManifest().version} was completed`),e.reason===chrome.runtime.OnInstalledReason.INSTALL&&Ig()!==Eg.test&&(Y()?VC({payload:{destination:jC.firefox_first_run}}):VC({payload:{destination:jC.create_account}})),chrome.contextMenus.removeAll((function(){chrome.contextMenus.create({id:"dlTranslateWithDeepL",title:chrome.i18n.getMessage("right_click_menu_translate_with_deepl"),contexts:["all"]})})),chrome.tabs.query({},(function(e){for(const t of e)FC(t)&&chrome.scripting.executeScript({target:{tabId:t},files:["build/content.js"]})}))}catch(e){jm({errorCode:Gg,errorMessage:e.message})}}))}function YC(e){switch(e.name){case $C.syncExperiments:RS();break;case $C.syncClientState:uT()}}function XC(e){if("dlTranslateWithDeepL"===e.menuItemId)DS(!1)}function KC(){}function QC(e,t){switch(Ag()&&console.log(`Port message received, port name: ${t.name}, sender: ${t.sender.tab.url}, tab ID: ${t.sender.tab.id}, message type ${e.type}`),e.type){case bC.ITA_REQUEST_TRANSLATION:WC({request:e.payload,port:t}).then().catch((e=>{ex(e,t)}));break;case bC.ITA_UPDATE_TARGET_LANGUAGE:AC({port:t,language:e.payload.language});break;case bC.ITA_UPDATE_FORMALITY:RC(t,e.payload.formality);break;case bC.ITA_RESTORE_TRANSLATE_SESSION:EC({itaDocumentState:e.payload.itaDocumentState,domainName:e.payload.domainName,port:t});break;case bC.ITA_REQUEST_WRITE:BC({request:e.payload,port:t}).then().catch((e=>{ex(e,t)}));break;case bC.ITA_WRITE_UPDATE_REQUESTED_LANGUAGE:DC({port:t,language:e.payload.language});break;case bC.ITA_WRITE_UPDATE_STYLE_VARIANT:MC(t,e.payload.styleVariant);break;case bC.ITA_RESTORE_WRITE_SESSION:NC({itaDocumentState:e.payload.itaDocumentState,domainName:e.payload.domainName,port:t});break;case bC.ITA_WRITE_UPDATE_SOURCE_TEXT:UC(t,e.payload.sourceText);break;case bC.ITA_CLOSE_TRANSLATION_SESSION:CC(t);break;default:Ag()&&console.log(`Unrecognised message type: ${e.type}`)}}function ZC(e){Ag()&&console.log(`Port name: ${e.name} disconnected`),OC(e)}function ex(e,t){t.postMessage({type:bC.ERROR,payload:rm(e,mg)})}const tx={setBrowserExtensionUserAgent:{type:"modifyHeaders",requestHeaders:[{header:"user-agent",operation:"set",value:`DeepLBrowserExtension/1.28.2 ${navigator.userAgent} `}]}},nx={lingueeDomainFilter:{excludedDomains:["linguee.com"],urlFilter:"*://www-app.linguee.com*",resourceTypes:["xmlhttprequest"]},deeplToolingApiDomainFilter:{excludedDomains:["deepl.com"],urlFilter:"*://*.deepl.com/jsonrpc?client=chrome-extension,*",resourceTypes:["xmlhttprequest"]},deeplStatisticsDomainFilter:{excludedDomains:["deepl.com"],urlFilter:"*://s.deepl.*/chrome/statistics*",resourceTypes:["xmlhttprequest"]}};function rx(){if(chrome.declarativeNetRequest)chrome.declarativeNetRequest.updateDynamicRules({removeRuleIds:[2,3,4],addRules:[{id:2,priority:1,action:tx.setBrowserExtensionUserAgent,condition:nx.lingueeDomainFilter},{id:3,priority:1,action:tx.setBrowserExtensionUserAgent,condition:nx.deeplToolingApiDomainFilter},{id:4,priority:1,action:tx.setBrowserExtensionUserAgent,condition:nx.deeplStatisticsDomainFilter}]},(async e=>{Ag()&&await console.log("created",e)}));else if(chrome.webRequest?.onBeforeSendHeaders){const e=Ag()?"https://test.deepl.com/":"https://www.deepl.com/";browser.webRequest.onBeforeSendHeaders.addListener((t=>{const n=t.requestHeaders;return n.push({name:"Referer",value:e}),{requestHeaders:n}}),{urls:["*://*.deepl.com/jsonrpc?client=chrome-extension,*"]},["requestHeaders","blocking"]),browser.webRequest.onBeforeSendHeaders.addListener((function(e){for(const t of e.requestHeaders)if("User-Agent"===t.name){t.value=`DeepLBrowserExtension/1.28.2 ${navigator.userAgent}`;break}return{requestHeaders:e.requestHeaders}}),{urls:["*://www-app.linguee.com/*","*://*.deepl.com/jsonrpc?client=chrome-extension,*","https://s.deepl.com/chrome/statistics"]},["blocking","requestHeaders"])}}var ox;return self.addEventListener("error",(function(e){const t=e.message||"";Mg(t)&&e.preventDefault()})),self.addEventListener("unhandledrejection",(function(e){const t=e.reason&&e.reason.message||"";Mg(t)&&e.preventDefault()})),Jc({...Ug}),Ar("appContext",{location:"background"}),ox=mg,chrome.storage.sync.get(["installationId","session","isLoggedIn","translatorServiceType","writeServiceType"],(function(e){ox.setTag("internal_session_id",e.session.id),ox.setTag("is_translator_pro",Pg(e,P.TRANSLATOR)),ox.setTag("is_write_pro",Pg(e,P.WRITE)),ox.setTag("is_logged_in",e.isLoggedIn)})),chrome.storage.local.get("browserInstanceId",(function(e){ox.setTag("browser_instance_id",e.browserInstanceId)})),chrome.storage.onChanged.addListener((e=>(e?.session?.newValue&&ox.setTag("internal_session_id",e.session.newValue.id),e?.installationId&&ox.setUser({id:e.installationId}),e?.browser_instance_id&&ox.setTag("browser_instance_id",Lg.browserInstanceId.newValue),!0!==e.isLoggedIn?.newValue&&!1!==e.isLoggedIn?.newValue||ox.setTag("is_logged_in",e.isLoggedIn.newValue),e.translatorServiceType&&chrome.storage.sync.get(["isLoggedIn"],ox.setTag("is_translator_pro",Pg({...Lg,translatorServiceType:e.translatorServiceType.newValue},P.TRANSLATOR))),e.writeServiceType&&chrome.storage.sync.get(["isLoggedIn"],ox.setTag("is_write_pro",Pg({...Lg,writeServiceType:e.writeServiceType.newValue},P.WRITE))),!0))),console.info("Sentry initialised"),rx(),chrome.runtime.onInstalled.addListener(zC),chrome.contextMenus.onClicked.addListener(XC),chrome.tabs.onActivated.addListener((async function(e){FC((await chrome.tabs.get(e.tabId)).url)&&chrome.tabs.sendMessage(e.tabId,{action:"dlTabChanged"}),chrome.tabs.query({},(function(t){for(var n=0;n<t.length;++n)chrome.tabs.sendMessage(t[n].id,{action:"dlChangeActiveTabStatus",payload:{isActive:t[n].id===e.tabId}})})),uT()})),chrome.runtime.onConnect.addListener((function(e){Ag()&&console.log(`PORT connected to tab with id: ${e.sender.tab.id}, port name: ${e.name}`),e.onMessage.addListener(QC),e.onDisconnect.addListener(ZC)})),chrome.runtime.onMessage.addListener(HC),chrome.storage.onChanged.addListener(KC),chrome.commands.onCommand.addListener(JC),chrome.alarms.onAlarm.addListener(YC),chrome.runtime.onMessage.addListener((e=>("reload"===e&&chrome.tabs.query({active:!0}).then((()=>{chrome.runtime.reload(),chrome.tabs.reload()})),!0))),chrome.webRequest.onBeforeSendHeaders.addListener((()=>{}),{urls:["<all_urls>"]},["requestHeaders","extraHeaders"]),e.CONTENT_PROCESS_MODE=Cv,e.EVENT_TYPES=uC,e.INTERNAL_PAGE_KEYS=jC,e.PERODIC_CODE_EXECUTION_NAMES=$C,e.URL_ACTIONS=X,e.URL_LIST=K,e.cacheClientState=u_,e.cacheExperiments=p_,e.checkCommandShortcuts=LS,e.checkLimits=Mv,e.clearLoginTimestamp=I_,e.commandListener=JC,e.connectDatabase=a_,e.createBatches=jv,e.createITATranslatorSession=EC,e.createITAWriteSession=NC,e.createInteractiveTranslation=WC,e.createInteractiveWrite=BC,e.deleteAuthTokens=__,e.deletePortSettings=OC,e.deleteTranslationPortSettings=yC,e.deleteWritePortSettings=TC,e.determineEventType=hC,e.disposeTranslateSession=CC,e.doesErrorIndicateBrokenSession=iC,e.extractMostRecentNonIdleRequestFromMessages=lC,e.fetchClientState=X_,e.fetchExperiments=U_,e.fetchGDocsSentenceAlternatives=nS,e.fetchGDocsWordAlternatives=rS,e.fetchTermbases=iS,e.getAccessToken=Z_,e.getAccountID=O_,e.getActiveTermbase=ET,e.getActiveTranslator=IC,e.getActiveWriter=PC,e.getAllServiceLevels=M_,e.getAuthTokens=S_,e.getBrowserInstanceId=x_,e.getCachedClientState=d_,e.getCachedExperiments=h_,e.getCharacterLimit=P_,e.getClientState=uT,e.getCurrentExperiments=async function(){try{const e=await l_(i_,o_);return e&&e.meta&&e.data?e.data:[]}catch(e){return[]}},e.getDapAlternativesSegmentationType=Om,e.getDapApiConfig=om,e.getDapApiExtensionOpenedFromId=am,e.getDapApiInlinePositionType=gm,e.getDapApiLingueeError=im,e.getDapApiLogoClickedFromId=cm,e.getDapApiNotificationType=lm,e.getDapApiSettingType=fm,e.getDapApiShortcutTypes=dm,e.getDapApiTranslationTriggerId=sm,e.getDapApiUiActionEventId=pm,e.getDapApiUiFunctionality=hm,e.getDapApiUiLocation=um,e.getDapContentProcessingModeType=Cm,e.getDapGmailActionType=Rm,e.getDapLogoutTrigger=wm,e.getDapNicheIntegration=Sm,e.getDapOnboardingExternalLink=mm,e.getDapOnboardingStepChangeTrigger=ym,e.getDapOriginStore=_m,e.getDapServiceLevel=Am,e.getDapSessionType=Lm,e.getDapSessionTypeTrigger=Em,e.getDapUpgradeNotificationAction=xm,e.getDapUpgradeNotificationType=km,e.getDapWhatsAppTranslator=Im,e.getDictionary=HS,e.getExperiments=RS,e.getExperimentsData=L_,e.getExternalUrl=Q,e.getInstallationId=w_,e.getRateLimitingErrorType=cC,e.getRequestSize=Gv,e.getSecondsSinceLastLogin=A_,e.getSessionType=b_,e.getSettings=f_,e.getSupportedVoices=jS,e.getTermbases=Nv,e.getTranslationSessionSettings=mC,e.getUserInfo=k_,e.getUserState=xS,e.getUserType=N_,e.getUsersCharacterLimit=dT,e.getWebsiteIdFromWebsite=vm,e.getWriteSessionSettings=SC,e.getWriteStyle=Tm,e.handleJobs=Lv,e.handleSuccessfulGmailTranslationsCount=iT,e.handleSuccessfulGslidesTranslationsCount=cT,e.handleSuccessfulTranslationsCount=$S,e.handleSuccessfulZendeskTranslationsCount=US,e.improveWriting=rT,e.isPayloadNecessaryForUIEvent=bm,e.isProServiceLevel=D_,e.isRateLimitingError=aC,e.isUserLoggedIn=T_,e.jsonrpc_callFunction=tv,e.jsonrpc_composeMethodCallDict=Y_,e.listenToPerodicCodeExecution=YC,e.login=K_,e.loginRequest=kS,e.logout=Q_,e.logoutRequest=CS,e.markLoginTimestamp=E_,e.messageListener=HC,e.onContextMenuClicked=XC,e.onInstalled=zC,e.onPortDisconnect=ZC,e.onStorageChanged=KC,e.openInternalPage=VC,e.performGDocsProcessContent=tS,e.performGDocsSplitText=eS,e.portListener=QC,e.processContent=xv,e.readData=l_,e.rebuildGDocsSentenceFromPartialTranslation=oS,e.redirectToExternalURL=Z,e.requestAlternatives=wT,e.requestDictionary=ov,e.resetGlossary=v_,e.sendDAPAlternativeSelected=Ky,e.sendDAPAlternativesEvent=Jy,e.sendDAPBrowserInstanceIdCreated=My,e.sendDAPCloseInlineHighlighter=Ty,e.sendDAPCloseInputHighlighter=yy,e.sendDAPContentScriptErrorData=Vm,e.sendDAPCustomizationEnabled=Vy,e.sendDAPDeeplWriteEvent=Uy,e.sendDAPDetectLanguage=Zm,e.sendDAPDictionaryStatus=by,e.sendDAPDisabledDictionaryHover=Ey,e.sendDAPDocTransClick=Ym,e.sendDAPErrorData=jm,e.sendDAPExtensionOpened=Wm,e.sendDAPFPTHide=ay,e.sendDAPFTPBlockSizeExceeded=async function(e){return $m((t=>({...t,eventId:60006,fptBlockSizeExceededData:{translationData:{sourceLang:e.websiteLanguage,targetLang:e.targetLanguage,sourceLength:e.characterCount},domainName:e.domainName}})))},e.sendDAPGDocsMaxCharExceededShown=xy,e.sendDAPGDocsMaxCharExceededTryProClicked=Oy,e.sendDAPGDocsReplaceText=_y,e.sendDAPGlossaryEnabledOrDisabled=zy,e.sendDAPGmailCharLimitReached=qy,e.sendDAPIconHover=uy,e.sendDAPInlineCopy=cy,e.sendDAPInlineDragStart=ny,e.sendDAPInlineListen=ly,e.sendDAPInlinePositionChange=ty,e.sendDAPInlineSettingOpened=Km,e.sendDAPInputTranslationInjection=qm,e.sendDAPInstallSuccess=vy,e.sendDAPInstallationIdCreated=Dy,e.sendDAPLandingOnSpecificWebsite=fy,e.sendDAPLingueeErrorData=Iy,e.sendDAPLoggedIn=Fy,e.sendDAPLoggedOut=jy,e.sendDAPLogin=ky,e.sendDAPLogoClicked=Bm,e.sendDAPLogout=Cy,e.sendDAPNotificationViewed=Hm,e.sendDAPOnboardingModalShown=Ny,e.sendDAPOnboardingOpenExternalPage=py,e.sendDAPOnboardingStepChange=dy,e.sendDAPOpenDictionarySection=wy,e.sendDAPOpenInlineHighlighter=Sy,e.sendDAPOpenInputHighlighter=my,e.sendDAPReadMoreClicked=hy,e.sendDAPRecommendToAFriendClick=Xm,e.sendDAPRightClick=ey,e.sendDAPSeeAlternativesClicked=Xy,e.sendDAPSessionStarted=$y,e.sendDAPSettingsChanged=Qm,e.sendDAPShortcutUsed=Jm,e.sendDAPTrackAdsButtonClicked=e_,e.sendDAPTrackAdsShown=t_,e.sendDAPTrackIframeTranslationFailed=Zy,e.sendDAPTrackIframeTranslationSuccessful=Qy,e.sendDAPTrackLanguageDetectionForTextProcessing=Yy,e.sendDAPTrackUpgradeNotificationAction=Hy,e.sendDAPTrackUpgradeNotificationClosed=By,e.sendDAPTrackUpgradeNotificationDisplayed=Wy,e.sendDAPTranslateAcceptOrUndoEvent=Gy,e.sendDAPTranslationErrorData=Gm,e.sendDAPTranslationRequest=Fm,e.sendDAPTwitterTweetTranslationFailed=sy,e.sendDAPUILocationClicked=Py,e.sendDAPUiAction=zm,e.sendDAPVoiceOverStops=gy,e.sendDAPWhatsAppMessageTranslated=ry,e.sendDAPWhatsAppMessageTranslationFailed=oy,e.sendDAPYoutubeCommentTranslationFailed=iy,e.sendDAPZendeskCustomizationEvent=Ay,e.sendDAPZendeskGlossaryConfigOpened=Ry,e.sendDAPtrackSessionType=Ly,e.sendNotification=OS,e.setAuthTokens=y_,e.setBrowserInstanceId=C_,e.setUserInfoFromClientState=R_,e.simpleTextProcessor=Fv,e.splitText=Ov,e.splitTextRequest=bT,e.stopSpeech=GS,e.testClassicApi=_T,e.textToSpeech=FS,e.trackAdsShown=kT,e.trackAlternativeSelected=TT,e.trackAlternativesEvent=lT,e.trackClickOnAdsButton=RT,e.trackCloseInlineHighlighter=BS,e.trackCloseInputHighlighter=WS,e.trackCustomizationEnabled=sT,e.trackDeeplWriteEvent=nT,e.trackDetectLanguage=aS,e.trackDictionaryStatus=JS,e.trackDisabledDictionaryHover=YS,e.trackDocTransClick=dS,e.trackExtensionOpenedEvent=lS,e.trackFptHide=_S,e.trackGDocsMaxCharExceededTryProClicked=ZS,e.trackGDocsReplaceText=AS,e.trackGdocsMaxCharExceededShown=QS,e.trackGlossaryDisabled=mT,e.trackGlossaryEnabled=gT,e.trackGmailCharLimitReached=aT,e.trackIconHover=vS,e.trackIframeTranslationFailed=AT,e.trackIframeTranslationSuccessful=IT,e.trackInlineCopy=SS,e.trackInlineDragStart=yS,e.trackInlineListen=bS,e.trackInlinePositionChange=mS,e.trackInlineSettingsOpened=hS,e.trackInputTranslationInjection=cS,e.trackLandingOnWebsite=MS,e.trackLanguageDetectionForTextProcessing=vT,e.trackLingueeErrorData=KS,e.trackLogoClickedEvent=uS,e.trackOnboardingModalShown=eT,e.trackOnboardingOpenExternalLink=ES,e.trackOnboardingStepChange=TS,e.trackOpenDictionarySection=zS,e.trackOpenInlineHighlighter=qS,e.trackOpenInputHighlighter=VS,e.trackReadMoreClick=IS,e.trackRecommendToAFriendClick=pS,e.trackRightClick=gS,e.trackSeeAlternativesClicked=ST,e.trackSettingChanged=fS,e.trackTranslateAcceptOrUndoEvent=oT,e.trackUILocationClicked=tT,e.trackUiAction=PS,e.trackUpgradeNotificationAction=yT,e.trackUpgradeNotificationClosed=hT,e.trackUpgradeNotificationDisplayed=pT,e.trackUseOfShortcut=NS,e.trackVoiceOverStops=wS,e.trackZendeskCustomizationEvent=XS,e.trackZendeskGlossaryOpened=fT,e.translate=nv,e.translateGmailReceivedEmail=zv,e.translateHtmlRequest=Wv,e.translateInlineRequest=Bv,e.translateInputRequest=Hv,e.translateLinkedInPostRequest=Kv,e.translateSelection=DS,e.translateTwitterTweetRequest=Yv,e.translateWhatsAppMessageRequest=Qv,e.translateWhatsAppMessagesRequest=Zv,e.translateYouTubeCommentRequest=Xv,e.translateZendeskInputRequest=Jv,e.translateZendeskMessageRequest=sS,e.triggerTranslateInline=Vv,e.updateDynamicRules=rx,e.updateITAFormality=RC,e.updateITATargetLanguage=AC,e.updateRequestedLanguage=DC,e.updateSession=m_,e.updateSourceText=UC,e.updateStyleVariant=MC,e.updateTranslationSessionSettings=gC,e.updateWriteSessionSettings=vC,e.writeData=c_,Object.defineProperty(e,"__esModule",{value:!0}),e}({});
//# sourceMappingURL=background.js.map
